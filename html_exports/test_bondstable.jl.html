<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"><meta charset="utf-8">
<meta name="pluto-insertion-spot-meta">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2a2928"><meta name="color-scheme" content="light dark"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon-16x16.347d2855.png" integrity="sha384-3qsGeVLdddzV9oIkj3PhXXQX2CZCjOD/CiyrPQOX6InOWw3HAHClrsQhPfX9uRAj" crossorigin="anonymous"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon-32x32.8789add4.png" integrity="sha384-cOe5vSoBIgKNgkUL27p9RpsGVY0uBg9PejLccDy+fR8ZD1Iv5dF1MGHjIZAIZwm6" crossorigin="anonymous"><link rel="icon" type="image/png" sizes="96x96" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon-96x96.48689391.png" integrity="sha384-TN49cYb8GyNmrZT14bsYXXo4l1x1NJeJ/EHuVAauAKsNPopPHLojijs9jFT4Vs8c" crossorigin="anonymous"><link rel="pluto-logo-big" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/logo.004c1d7c.svg" integrity="sha384-GkQkODcGxsrSRJCkeakBXihum0GUM44cwBgKyutDimectXCbCgj6Vu3jlrueqEcN" crossorigin="anonymous"><link rel="pluto-logo-small" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon_unsaturated.d1387b25.svg" integrity="sha384-omwjH+Qy3hpAVf5FYd/pkaDBuVAfsEDRN7eBxEA8Ek00OAWP+aiV+GpEYk3I7lyo" crossorigin="anonymous"><script type="module" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.307d1245.js" integrity="sha384-7t5v1Xs3lzIHj1Libdf7OWsT7hSJw6fKrWsg4B4wMiPgWrRgvBDCnTZ6sUxIOV6c" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/juliamono.c6034ab4.css" integrity="sha384-n0za6lUXlyf4XC+nGkZWj3TLDnRbNpAcoi4PZGSlQMPoyqGa9kGY+ZXkUgZGIhQt" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.9402a72e.css" integrity="sha384-NJUInpSDijrLS5DfgY1ITvzJ/8HJmHa62lN/13hYf8FknsJEMJdwqQWtyreOFUZ3" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/vollkorn.089565a8.css" integrity="sha384-jnV/84VtSgBLF70H+s2rxJcOUZIMDR+X/ElFZA83i9ZtZSWiIMFAgPyrWkOJV08q" crossorigin="anonymous"><script defer="">console.log("Pluto.jl, by Fons van der Plas (https://github.com/fonsp), MikoÅ‚aj Bochenski (https://github.com/malyvsen), Michiel Dral (https://github.com/dralletje) and friends ðŸŒˆ");</script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.4b96dd74.js" defer="" integrity="sha384-Y+UtWANyXLeovyghpAI8j9/VZXWboD6G5ZCckOsJO99PawAh/utJxFikf62WBaSu" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.9f9dc874.js" defer="" integrity="sha384-tkFo1EK72I9JvoTmHFa199dfRzW8mkXPUkHb/N7UhYI+bxKzX3Kh8LNCZz1ltsFF" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.90ede145.js" defer="" integrity="sha384-CuNU9gQg6fa/yynNqNWjHWzPm4nj+d7O6+HXsNGSqClhs/bYQIbBC3Lw/kh8Ukui" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.dbeed08a.js" defer="" integrity="sha384-1BEdQwXfZi4ZpsNV8w1X8pQcVK1/DS/+/M8OTo3gol7mdEspSN7nT6llX57NQCSt" crossorigin="anonymous"></script><script id="iframe-resizer-content-window-script" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.6386bd9d.js" crossorigin="anonymous" defer="" integrity="sha384-tgN2a0VDi/lCYwZuDqT7L+A/Y/9kpxf3HV7zv2BJ5Fu7zW0EClq0nM4crfK3TRPs"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.2f145fef.css" type="text/css" integrity="sha384-brUzgyAEfbBBVyJ4hyYtkh7JwYXu6+fCsvxz2sbO6aU3IPW0xX7SC9TzwP63TBcB" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.14f23ca4.css" type="text/css" media="all" data-pluto-file="hide-ui" integrity="sha384-++EDAMZbJynENol9onosKuuWP4ex4rhT9Rl/oELs6oVltwZdU9DC0W1nYT4Ttb9V" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.99402935.css" type="text/css" integrity="sha384-Wl7QT6vOzvYxGbF4LKAXVRihsch7DCr4GeiXwOS273IU4E5g7HMSBkrbI9GFP+qI" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.1f4cf2ca.css" type="text/css" integrity="sha384-lBSBsn8FT1UzGOsNVudfV8RSHQEuNWqrCb6xQnF10uvF9AiCzYsCRXvKlhtQvV3c" crossorigin="anonymous"><link rel="preload" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/juliamono.c6034ab4.css" as="style" integrity="sha384-n0za6lUXlyf4XC+nGkZWj3TLDnRbNpAcoi4PZGSlQMPoyqGa9kGY+ZXkUgZGIhQt" crossorigin="anonymous"><link rel="preload" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/vollkorn.089565a8.css" as="style" integrity="sha384-jnV/84VtSgBLF70H+s2rxJcOUZIMDR+X/ElFZA83i9ZtZSWiIMFAgPyrWkOJV08q" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.e82e08bd.css" type="text/css" integrity="sha384-7YN+h8b6N4N65qk8TG/J2KPF95D8z3sGNd06rokz4CX9oWu0KnRAF5cVWu3BkkaN" crossorigin="anonymous"><script data-pluto-file="launch-parameters">
window.pluto_notebook_id = undefined;
window.pluto_isolated_cell_ids = undefined;
window.pluto_notebookfile = "data:text/julia;charset=utf-8;base64,IyMjIEEgUGx1dG8uamwgbm90ZWJvb2sgIyMjCiMgdjAuMTkuMjcKCiM+IGN1c3RvbV9hdHRycyA9IFsiaGlkZS1lbmFibGVkIl0KCnVzaW5nIE1hcmtkb3duCnVzaW5nIEludGVyYWN0aXZlVXRpbHMKCiMgVGhpcyBQbHV0byBub3RlYm9vayB1c2VzIEBiaW5kIGZvciBpbnRlcmFjdGl2aXR5LiBXaGVuIHJ1bm5pbmcgdGhpcyBub3RlYm9vayBvdXRzaWRlIG9mIFBsdXRvLCB0aGUgZm9sbG93aW5nICdtb2NrIHZlcnNpb24nIG9mIEBiaW5kIGdpdmVzIGJvdW5kIHZhcmlhYmxlcyBhIGRlZmF1bHQgdmFsdWUgKGluc3RlYWQgb2YgYW4gZXJyb3IpLgptYWNybyBiaW5kKGRlZiwgZWxlbWVudCkKICAgIHF1b3RlCiAgICAgICAgbG9jYWwgaXYgPSB0cnkgQmFzZS5sb2FkZWRfbW9kdWxlc1tCYXNlLlBrZ0lkKEJhc2UuVVVJRCgiNmU2OTZjNzItNjU0Mi0yMDY3LTcyNjUtNDIyMDZjNzU2MTUwIiksICJBYnN0cmFjdFBsdXRvRGluZ2V0amVzIildLkJvbmRzLmluaXRpYWxfdmFsdWUgY2F0Y2g7IGIgLT4gbWlzc2luZzsgZW5kCiAgICAgICAgbG9jYWwgZWwgPSAkKGVzYyhlbGVtZW50KSkKICAgICAgICBnbG9iYWwgJChlc2MoZGVmKSkgPSBDb3JlLmFwcGxpY2FibGUoQmFzZS5nZXQsIGVsKSA/IEJhc2UuZ2V0KGVsKSA6IGl2KGVsKQogICAgICAgIGVsCiAgICBlbmQKZW5kCgojIOKVlOKVkOKVoSA4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGYKYmVnaW4KCXVzaW5nIFBsdXRvRGV2TWFjcm9zCmVuZAoKIyDilZTilZDilaEgOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzCkBmcm9tcGFja2FnZSAiLi4vLi4iIGJlZ2luCgl1c2luZyBeLlN0cnVjdEJvbmRNb2R1bGUKCXVzaW5nIF46IEV4dGVuZGVkVGFibGVPZkNvbnRlbnRzLCBFZGl0YWJsZQoJdXNpbmcgPi5IeXBlcnRleHRMaXRlcmFsCgl1c2luZyA+LlBsdXRvVUkKZW5kCgojIOKVlOKVkOKVoSA5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGEKbWQiIiIKIyBQYWNrYWdlcwoiIiIKCiMg4pWU4pWQ4pWhIDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5MwpFeHRlbmRlZFRhYmxlT2ZDb250ZW50cygpCgojIOKVlOKVkOKVoSBjYmZjNmVlYy04OTkxLTRhOWMtYWRhMC0yOTVjODA1Mjg1NGQKIyBodG1sIiIiCiMgPHN0eWxlPgojIG1haW4gewojIAltYXJnaW4tcmlnaHQ6IDM1MHB4ICFpbXBvcnRhbnQ7CiMgfQojIDwvc3R5bGU+CiMgIiIiCgojIOKVlOKVkOKVoSA0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzAKbWQiIiIKIyBTdHJ1Y3RCb25kCiIiIgoKIyDilZTilZDilaEgYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwCm1kIiIiCkdlbmVyYXRpbmcgYXV0b21hdGljIHdpZGdldHMgZm9yIGN1c3RvbSBzdHJ1Y3RzIGlzIHF1aXRlIHN0cmFpZ2h0Zm9yd2FyZCB3aXRoIHRoZSBhaWQgb2YgdGhlIGBAZmllbGRkYXRhYCBtYWNybyBhbmQgdGhlIGBTdHJ1Y3RCb25kYCB0eXBlLgoKVGhlIHRvcC1sZWZ0IGFycm93IGNhbiBiZSB1c2VkIHRvIHNob3ctaGlkZSB0aGUgZmllbGQgZWxlbWVudHMgKHVzZWZ1bCBpbnNpZGUgYSBgQm9uZFRhYmxlYCwgc2hvd24gYmVsb3cpLCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLgoiIiIKCiMg4pWU4pWQ4pWhIDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZgpiZWdpbgoiIiIKCXN0cnVjdCBBU0QKIiIiCkJhc2UuQGt3ZGVmIHN0cnVjdCBBU0QKCWE6OkludCAKCWI6OkludAoJYzo6U3RyaW5nCgkiVGhpcyBmaWVsZCBpcyBfc3BlY2lhbF8iCglkOjpTdHJpbmcKCWU6OkludAplbmQKQHR5cGVhc2ZpZWxkIFN0cmluZyA9IFRleHRGaWVsZCgpICMgU3RyaW5nIGZpZWxkcyB3aXRoIG5vIHN0cnVjdC1zcGVjaWZpYyBkZWZhdWx0IHdpbGwgdXNlIHRoaXMgCkBmaWVsZGRhdGEgQVNEIGJlZ2luCglhID0gKG1kIk1hcmtkb3duIGRlc2NyaXB0aW9uLCBpbmNsdWRpbmcgYGBMYVRlWGBgIiwgU2xpZGVyKDE6MTApKQoJYiA9IChAaHRsKCI8c3Bhbj5GaWVsZCB3aXRoIDxiPkhUTUw8L2I+IGRlc2NyaXB0aW9uPC9zcGFuPiIpLCBTY3J1YmJhYmxlKDE6MTApKQoJYyA9ICgiTm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbiIsIFRleHRGaWVsZCgpKQoJIyBkIGhhcyBubyBBU0Qtc3BlY2lmaWMgY3VzdG9tIGJvbmQsIHNvIGl0IHdpbGwgdXNlIHRoZSBmaWVsZCBkb2NzdHJpbmcgYXMgZGVzY3JpcHRpb24gYW5kIHRoZSBkZWZhdWx0IFN0cmluZyB3aWRnZXQgYXMgd2lkZ2V0CgllID0gU2xpZGVyKDIwOjI1KSAjIE5vIGRlc2NyaXB0aW9uLCBkZWZhdWx0cyB0byB0aGUgZmllbGRuYW1lIGFzIG5vIGRvY3N0cmluZyBpcyBwcmVzZW50CmVuZAphc2RfYm9uZCA9IEBiaW5kIGFzZCBTdHJ1Y3RCb25kKEFTRDsgZGVzY3JpcHRpb24gPSAiQ3VzdG9tIERlc2NyaXB0aW9uIikKZW5kCgojIOKVlOKVkOKVoSBjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzYKYXNkCgojIOKVlOKVkOKVoSBmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTIKbWQiIiIKIyMgRGVmYXVsdCBUeXBlIFdpZGdldHMKIiIiCgojIOKVlOKVkOKVoSA4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDgKYmVnaW4KCUBrd2RlZiBzdHJ1Y3QgTUFICgkJYTo6SW50CgllbmQKCUBrd2RlZiBzdHJ1Y3QgQk9ICgkJbWFoOjpNQUgKCWVuZAoJCgkjIFRoaXMgd2lsbCBtYWtlIHRoZSBkZWZhdWx0IHdpZGdldCBmb3IgYW4gSW50IGEgU2xpZGVyCglAdHlwZWFzZmllbGQgSW50ID0gU2xpZGVyKDE6MTApCgkjIFRoaXMgd2lsbCBtYWtlIHRoZSBkZWZhdWx0IHdpZGdldCBmb3IgZmllbGRzIG9mIHR5cGUgQVNEIGEgcG9wb3V0IHRoYXQgd3JhcHMgYSBTdHJ1Y3RCb25ke0FTRH0KCUBwb3BvdXRhc2ZpZWxkIE1BSAoJCglAYmluZCBib2ggU3RydWN0Qm9uZChCT0gpCmVuZAoKIyDilZTilZDilaEgMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0CmJvaAoKIyDilZTilZDilaEgNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1Cm1kIiIiCiMgQE5UQm9uZAoiIiIKCiMg4pWU4pWQ4pWhIDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MAptZCIiIgpTb21ldGltZXMgY3VzdG9tIHN0cnVjdHMgYXJlIG5vdCBuZWVkZWQgYW5kIGl0IHdvdWxkIGJlIHVzZWZ1bCB0byBqdXN0IHVzZSB0aGUgc2FtZSBuaWNlIGJvbmQgc3RydWN0dXJlIG9mIGBTdHJ1Y3RCb25kYCB0byBzaW1wbHkgY3JlYXRlIGFyYml0cmFyeSBOYW1lZFR1cGxlcy4gCgpUaGlzIGlzIHBvc3NpYmxlIHdpdGggdGhlIGNvbnZlbmllbmNlIG1hY3JvIGBATlRCb25kYCB3aGljaCBjYW4gYmUgY2FsbGVkIGFzIHNob3duIGJlbG93IHRvIGNyZWF0ZSBhIG5pY2UgZGlzcGxheSBmb3IgYW4gaW50ZXJhY3RpdmUgYm9uZCBjcmVhdGluZyBhbiBhcmJpdHJhcnkgTmFtZWRUdXBsZS4KClRoZSBtYWNybyBzaW1wbHkgY3JlYXRlIGEgYFN0cnVjdEJvbmRgIHdyYXBwaW5nIHRoZSBkZXNpcmVkIE5hbWVkVHVwbGUgdHlwZS4KIiIiCgojIOKVlOKVkOKVoSAwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjkKbnRfYm9uZCA9IEBiaW5kIG50IEBOVEJvbmQgIk15IEZhbmN5IE5UdXBsZSIgYmVnaW4KCWEgPSAoIkRlc2NyaXB0aW9uIiwgU2xpZGVyKDE6MTApKQoJYiA9IChtZCIqKkJvbGQqKiBmaWVsZCIsIFNsaWRlcigxOjEwKSkKCWMgPSBTbGlkZXIoMToxMCkgIyBObyBkZXNjcmlwdGlvbiwgZGVmYXVsdHMgdG8gdGhlIG5hbWUgb2YgdGhlIGZpZWxkCmVuZAoKIyDilZTilZDilaEgZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4Cm50CgojIOKVlOKVkOKVoSA5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzcKbWQiIiIKIyBAQm9uZHNMaXN0CiIiIgoKIyDilZTilZDilaEgOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3Cm1kIiIiCkluIHNvbWUgY2FzZXMsIG9uZSBkb2VzIG5vdCB3YW50IHRvIGhhdmUgYSBzaW5nbGUgYm9uZCB3cmFwcGluZyBlaXRoZXIgYSBTdHJ1Y3R1cmUgb3IgYSBOYW1lZFR1cGxlIGJlY2F1c2Ugc2luZ2xlIGluZGVwZW5kZW50IGJvbmRzIGFyZSBtb3JlIGNvbnZlbmllbnQuCgpgQEJvbmRzTGlzdGAgaXMgYSBjb252ZW5pZW5jZSBtYWNybyB0byBjcmVhdGUgYW4gb2JqZWN0IG9mIHR5cGUgYEJvbmRzTGlzdGAgd2hpY2ggc2ltcGx5IGFsbG93IHRvIGFkZCBhIGRlc2NyaXB0aW9uIHRvIHNlcGFyYXRlIGJvbmRzIGFuZCBncm91cCB0aGVtIGFsbCB0b2dldGhlciBpbiBhIHRhYmxlLWxpa2UgZm9ybWF0IGVxdWl2YWxlbnQgdG8gdGhvc2Ugb2YgYFN0cnVjdEJvbmRgLgoKISEhIG5vdGUKCVVubGlrZSBgU3RydWN0Qm9uZGAsIGEgQm9uZHNMaXN0IGlzIGFscmVhZHkgY29tcG9zZWQgb2YgYm9uZCBjcmVhdGVkIHdpdGggYEBiaW5kYCBhbmQgaXQganVzdCBncm91cHMgdGhlbSB1cCB3aXRoIGEgZGVzY3JpcHRpb24uIFRoZSBvdXRwdXQgb2YgYEBCb25kc0xpc3RgIGlzIG5vdCBzdXBwb3NlZCB0byBiZSBib3VuZCB0byBhIHZhcmlhYmxlIHVzaW5nIGBAYmluZGAuXAoJVGhlIGJvbmRzIGdyb3VwZWQgaW4gYSBCb25kc0xpc3Qgc3RpbGwgYWN0IGFuZCB1cGRhdGUgaW5kZXBlbmRlbnRseSBmcm9tIG9uZSBhbm90aGVyLgoKU2VlIHRoZSBleGFtcGxlIGJlbG93IGZvciB1bmRlcnN0YW5kaW5nIHRoZSBzeW50aGF4LiBUaGUgaGVhZGVyIG9mIGEgQm9uZHNMaXN0IGlzIHNob3duIGluIGFuIG9yYW5nZSBiYWNrZ3JvdW5kIHRvIGVhc2lseSBkaWZmZXJlbnRpYXRlIGl0IGZyb20gYFN0cnVjdEJvbmRgLgoiIiIKCiMg4pWU4pWQ4pWhIDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiYwpibCA9IEBCb25kc0xpc3QgIk15IEdyb3VwIG9mIEJvbmRzIiBsZXQgdHYgPSBQbHV0b1VJLkV4cGVyaW1lbnRhbC50cmFuc2Zvcm1lZF92YWx1ZQoJICMgV2UgdXNlIHRyYW5zZm9ybWVkX3ZhbHVlIHRvIHRyYW5zbGF0ZSBHSHogdG8gSHogaW4gdGhlIGJvdW5kIHZhcmlhYmxlIGBmcmVxYAoJIkZyZXF1ZW5jeSBbR0h6XSIgPSBAYmluZCBmcmVxIHR2KHggLT4geCAqIDFlOSwgRWRpdGFibGUoMjA7IHN1ZmZpeCA9ICIgR0h6IikpCgltZCJBbHRpdHVkZSBgYGhgYCBbbV0iID0gQGJpbmQgYWx0IFNjcnViYmFibGUoMTAwOjEwOjIwMCkKZW5kCgojIOKVlOKVkOKVoSBhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTQKZnJlcQoKIyDilZTilZDilaEgNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZiCmFsdAoKIyDilZTilZDilaEgMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjCm1kIiIiCiMgUG9wb3V0CiIiIgoKIyDilZTilZDilaEgNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyCm1kIiIiClRoZSBzdHJ1Y3R1cmVzIGFib3ZlIGNhbiBhbHNvIGJlIHVzZWQgbmVzdGVkIHdpdGhpbiBvbmUgYW5vdGhlci4gVG8gZmFjaWxpdGF0ZSBhY2Nlc3NpbmcgbmVzdGVkIHN0cnVjdHVyZXMsIG9uZSBjYW4gdXNlIHRoZSBgUG9wb3V0YCB0eXBlLgoKSW4gaXRzIHNpbXBsZSBmb3JtLCB5b3UgY2FuIGdpdmUgYW4gaW5zdGFuY2Ugb2YgYSBTdHJ1Y3RCb25kLCBhIGJvbmQgd3JhcHBpbmcgYSBTdHJ1Y3RCb25kIG9yIGEgQm9uZHNMaXN0IGFzIGlucHV0IHRvIFBvcG91dCB0byBjcmVhdGUgYSB0YWJsZSB0aGF0IGlzIGhpZGRlbiBiZWhpbmQgYSBwb3B1cCB3aW5kb3cuCklmIGFuIGluc3RhbmNlIHByZXNlbnQsIGJ1dCB5b3Ugd2FudCBhIGN1c3RvbSB0eXBlIGZvciB3aGljaCB5b3UgaGF2ZSBkZWZpbmVkIGN1c3RvbSBib25kcyBhbmQgZGVzY3JpcHRpb25zIHdpdGggYEBmaWVsZGRhdGFgIHRvIGFwcGVhciBhcyBwb3BvdXQsIHlvdSBjYW4gdXNlIHRoZSBmdW5jdGlvbiBgcG9wb3V0d3JhcChUWVBFKWAgdG8gZ2VuZXJhdGUgYSBzbWFsbCBpY29uIHdoaWNoIGhpZGVzIGEgcG9wdXAgY29udGFpbmluZyB0aGUgYFN0cnVjdEJvbmRgIG9mIHRoZSBwcm92aWRlZCB0eXBlIGBUWVBFYC4KClRoZSBTdHJ1Y3RCb25kIHRhYmxlIGFwcGVhcnMgb24gaG92ZXIgdXBvbiB0aGUgaWNvbiwgY2FuIGJlIG1hZGUgZml4ZWQgYnkgY2xpY2tpbmcgb24gdGhlIGljb24gYW5kIGNhbiB0aGVuIGJlIG1vdmVkIGFyb3VuZCBvciByZXNpemVkLgpBIGRvdWJsZSBjbGljayBvbiB0aGUgaGVhZGVyIG9mIHRoZSBwb3BvdXQgaGlkZXMgaXQgYWdhaW46CiIiIgoKIyDilZTilZDilaEgNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyCmJlZ2luCkJhc2UuQGt3ZGVmIHN0cnVjdCBMT0wKCWE6OkludCAKCWI6OkludAplbmQKQGZpZWxkZGF0YSBMT0wgYmVnaW4KCWEgPSAobWQiV29uZGVyISIsIFNsaWRlcigxOjEwKSkKCWIgPSAoQGh0bCgiPHNwYW4+RmllbGQgQjwvc3Bhbj4iKSwgU2NydWJiYWJsZSgxOjEwKSkKZW5kCmVuZAoKIyDilZTilZDilaEgNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0CkBiaW5kIGxvbF9wb3AgcG9wb3V0d3JhcChMT0wpCgojIOKVlOKVkOKVoSAwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDYKbG9sX3BvcAoKIyDilZTilZDilaEgMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk3Cm1kIiIiClRoZSBhYmlsaXR5IHRvIGFsc28gd3JhcCBwcmUtZXhpc3RpbmcgYm9uZHMgYXJvdW5kIFN0cnVjdEJvbmRzIGlzIGNvbnZlbmllbnQgZm9yIG9yZ2FuaXppbmcgdGhlIHZhcmlvdXMgYm9uZHMgb25lIGhhdmUgaW4gYSBgQm9uZHNMaXN0YCBvciBgQm9uZFRhYmxlYAoKQXMgYW4gZXhhbXBsZSwgb25lIGNhbiBjcmVhdGUgYSBgQm9uZHNMaXN0YCBjb250YWluaW5nIHRoZSB0d28gYFN0cnVjdEJvbmRgIGJvbmRzIGdlbmVyYXRlZCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoaXMgbm90ZWJvb2sgd2l0aCB0aGUgZm9sbHdpbmcgY29kZS4KIiIiCgojIOKVlOKVkOKVoSA4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjUKYmxjID0gQEJvbmRzTGlzdCAiUG9wb3V0IENvbnRhaW5lciIgYmVnaW4KCSJTdHJ1Y3R1cmUgQVNEIiA9IFBvcG91dChhc2RfYm9uZCkKCSJOYW1lZFR1cGxlIiA9IFBvcG91dChudF9ib25kKQplbmQKCiMg4pWU4pWQ4pWhIGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNgphc2QKCiMg4pWU4pWQ4pWhIDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YQpudAoKIyDilZTilZDilaEgM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1Cm1kIiIiCiMgQm9uZFRhYmxlCiIiIgoKIyDilZTilZDilaEgMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0Cm1kIiIiClRoZSBmaW5hbCBjb252ZW5pZW5jZSBzdHJ1Y3R1cmUgcHJvdmlkZWQgYnkgdGhpcyBtb2R1bGUgaXMgdGhlIGBCb25kVGFibGVgLiBJdCBjYW4gYmUgY3JlYXRlZCB0byBncm91cCBhIGxpc3Qgb2YgYm9uZHMgaW4gYSBmbG9hdGluZyB0YWJsZSB0aGF0IHN0YXlzIG9uIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIG5vdGVib29rIChzaW1pbGFyIHRvIHRoZSBUYWJsZU9mQ29udGVudHMgb2YgUGx1dG9VSSkgYW5kIGNhbiBiZSBtb3ZlZCBhcm91bmQgYW5kIHJlc2l6ZWQgb3IgaGlkZGVuIGZvciBjb252ZW5pZW5jZS4KClRoZSBCb25kVGFibGUgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBlaXRoZXIgd2l0aCBib25kcyBjb250YWluaW5nIGBTdHJ1Y3RCb25kYCBvciB3aXRoIGBCb25kc0xpc3RgLiBGdXR1cmUgdHlwZXMgd2l0aCBzaW1pbGFyIHN0cnVjdHVyZSB3aWxsIGFsc28gYmUgYWRkZWQuCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgYSBib25kdGFibGUgY29udGFpbmluZyBhbGwgdGhlIGV4YW1wbGVzIG9mIHRoaXMgbm90ZWJvb2suCiIiIgoKIyDilZTilZDilaEgOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2CkJvbmRUYWJsZShbCglhc2RfYm9uZCwKCW50X2JvbmQsCglibCwKCWJsYwpdOyBkZXNjcmlwdGlvbiA9ICJNeSBCb25kcyIpCgojIOKVlOKVkOKVoSAwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWYKbnQKCiMg4pWU4pWQ4pWhIDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OAphc2QKCiMg4pWU4pWQ4pWhIDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjMwpmcmVxCgojIOKVlOKVkOKVoSBiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDYKYWx0CgojIOKVlOKVkOKVoSAwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEKUExVVE9fUFJPSkVDVF9UT01MX0NPTlRFTlRTID0gIiIiCltkZXBzXQpQbHV0b0Rldk1hY3JvcyA9ICJhMDQ5OWYyOS1jMzliLTRjNWMtODA3Yy04ODA3NDIyMWI5NDkiCgpbY29tcGF0XQpQbHV0b0Rldk1hY3JvcyA9ICJ+MC41LjgiCiIiIgoKIyDilZTilZDilaEgMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyClBMVVRPX01BTklGRVNUX1RPTUxfQ09OVEVOVFMgPSAiIiIKIyBUaGlzIGZpbGUgaXMgbWFjaGluZS1nZW5lcmF0ZWQgLSBlZGl0aW5nIGl0IGRpcmVjdGx5IGlzIG5vdCBhZHZpc2VkCgpqdWxpYV92ZXJzaW9uID0gIjEuMTAuMC1iZXRhMiIKbWFuaWZlc3RfZm9ybWF0ID0gIjIuMCIKcHJvamVjdF9oYXNoID0gIjA4NGQ0YTRlZWEzZjUwYzI5MGYwOTNmM2U2MjY2NjljYjRlODY1NmQiCgpbW2RlcHMuQXJnVG9vbHNdXQp1dWlkID0gIjBkYWQ4NGM1LWQxMTItNDJlNi04ZDI4LWVmMTJkYWJiNzg5ZiIKdmVyc2lvbiA9ICIxLjEuMSIKCltbZGVwcy5BcnRpZmFjdHNdXQp1dWlkID0gIjU2ZjIyZDcyLWZkNmQtOThmMS0wMmYwLTA4ZGRjMDkwN2MzMyIKCltbZGVwcy5CYXNlNjRdXQp1dWlkID0gIjJhMGY0NGUzLTZjODMtNTViZC04N2U0LWIxOTc4ZDk4YmQ1ZiIKCltbZGVwcy5EYXRlc11dCmRlcHMgPSBbIlByaW50ZiJdCnV1aWQgPSAiYWRlMmNhNzAtMzg5MS01OTQ1LTk4ZmItZGMwOTk0MzJlMDZhIgoKW1tkZXBzLkRvd25sb2Fkc11dCmRlcHMgPSBbIkFyZ1Rvb2xzIiwgIkZpbGVXYXRjaGluZyIsICJMaWJDVVJMIiwgIk5ldHdvcmtPcHRpb25zIl0KdXVpZCA9ICJmNDNhMjQxZi1jMjBhLTRhZDQtODUyYy1mNmIxMjQ3ODYxYzYiCnZlcnNpb24gPSAiMS42LjAiCgpbW2RlcHMuRmlsZVdhdGNoaW5nXV0KdXVpZCA9ICI3YjFmNjA3OS03MzdhLTU4ZGMtYjhiYy03YTJjYTVjMWI1ZWUiCgpbW2RlcHMuSHlwZXJ0ZXh0TGl0ZXJhbF1dCmRlcHMgPSBbIlRyaWNrcyJdCmdpdC10cmVlLXNoYTEgPSAiYzQ3YzVmYTRjNTMwOGYyN2NjYWFjMzU1MDQ4NThkODkxNGUxMDJmOSIKdXVpZCA9ICJhYzExOTJhOC1mNGIzLTRiZmUtYmEyMi1hZjViOTJjZDNhYjIiCnZlcnNpb24gPSAiMC45LjQiCgpbW2RlcHMuSW50ZXJhY3RpdmVVdGlsc11dCmRlcHMgPSBbIk1hcmtkb3duIl0KdXVpZCA9ICJiNzdlMGE0Yy1kMjkxLTU3YTAtOTBlOC04ZGIyNWEyN2EyNDAiCgpbW2RlcHMuTGliQ1VSTF1dCmRlcHMgPSBbIkxpYkNVUkxfamxsIiwgIk1vemlsbGFDQUNlcnRzX2psbCJdCnV1aWQgPSAiYjI3MDMyYzItYTNlNy01MGM4LTgwY2QtMmQzNmRiY2JmZDIxIgp2ZXJzaW9uID0gIjAuNi40IgoKW1tkZXBzLkxpYkNVUkxfamxsXV0KZGVwcyA9IFsiQXJ0aWZhY3RzIiwgIkxpYlNTSDJfamxsIiwgIkxpYmRsIiwgIk1iZWRUTFNfamxsIiwgIlpsaWJfamxsIiwgIm5naHR0cDJfamxsIl0KdXVpZCA9ICJkZWFjOWI0Ny04YmM3LTU5MDYtYTBmZS0zNWFjNTZkYzg0YzAiCnZlcnNpb24gPSAiOC4wLjErMSIKCltbZGVwcy5MaWJHaXQyXV0KZGVwcyA9IFsiQmFzZTY0IiwgIk5ldHdvcmtPcHRpb25zIiwgIlByaW50ZiIsICJTSEEiXQp1dWlkID0gIjc2Zjg1NDUwLTUyMjYtNWI1YS04ZWFhLTUyOWFkMDQ1YjQzMyIKCltbZGVwcy5MaWJTU0gyX2psbF1dCmRlcHMgPSBbIkFydGlmYWN0cyIsICJMaWJkbCIsICJNYmVkVExTX2psbCJdCnV1aWQgPSAiMjk4MTZiNWEtYjlhYi01NDZmLTkzM2MtZWRhZDE4ODZkZmE4Igp2ZXJzaW9uID0gIjEuMTEuMCsxIgoKW1tkZXBzLkxpYmRsXV0KdXVpZCA9ICI4ZjM5OWRhMy0zNTU3LTU2NzUtYjVmZi1mYjgzMmM5N2NiZGIiCgpbW2RlcHMuTG9nZ2luZ11dCnV1aWQgPSAiNTZkZGIwMTYtODU3Yi01NGUxLWI4M2QtZGI0ZDU4ZGI1NTY4IgoKW1tkZXBzLk1hY3JvVG9vbHNdXQpkZXBzID0gWyJNYXJrZG93biIsICJSYW5kb20iXQpnaXQtdHJlZS1zaGExID0gIjllZTE2MThjYmY1MjQwZTZkNGUwMzcxZDZmMjQwNjUwODNmNjBjNDgiCnV1aWQgPSAiMTkxNGRkMmYtODFjNi01ZmNkLTg3MTktNmQ1Yzk2MTBmZjA5Igp2ZXJzaW9uID0gIjAuNS4xMSIKCltbZGVwcy5NYXJrZG93bl1dCmRlcHMgPSBbIkJhc2U2NCJdCnV1aWQgPSAiZDZmNDM3NmUtYWVmNS01MDVhLTk2YzEtOWMwMjczOTQ2MDdhIgoKW1tkZXBzLk1iZWRUTFNfamxsXV0KZGVwcyA9IFsiQXJ0aWZhY3RzIiwgIkxpYmRsIl0KdXVpZCA9ICJjOGZmZDljMy0zMzBkLTU4NDEtYjc4ZS0wODE3ZDcxNDVmYTEiCnZlcnNpb24gPSAiMi4yOC4yKzEiCgpbW2RlcHMuTW96aWxsYUNBQ2VydHNfamxsXV0KdXVpZCA9ICIxNGEzNjA2ZC1mNjBkLTU2MmUtOTEyMS0xMmQ5NzJjZDgxNTkiCnZlcnNpb24gPSAiMjAyMy4xLjEwIgoKW1tkZXBzLk5ldHdvcmtPcHRpb25zXV0KdXVpZCA9ICJjYTU3NTkzMC1jMmUzLTQzYTktYWNlNC0xZTk4OGIyYzE5MDgiCnZlcnNpb24gPSAiMS4yLjAiCgpbW2RlcHMuUGtnXV0KZGVwcyA9IFsiQXJ0aWZhY3RzIiwgIkRhdGVzIiwgIkRvd25sb2FkcyIsICJGaWxlV2F0Y2hpbmciLCAiTGliR2l0MiIsICJMaWJkbCIsICJMb2dnaW5nIiwgIk1hcmtkb3duIiwgIlByaW50ZiIsICJSRVBMIiwgIlJhbmRvbSIsICJTSEEiLCAiU2VyaWFsaXphdGlvbiIsICJUT01MIiwgIlRhciIsICJVVUlEcyIsICJwN3ppcF9qbGwiXQp1dWlkID0gIjQ0Y2ZlOTVhLTFlYjItNTJlYS1iNjcyLWUyYWZkZjY5Yjc4ZiIKdmVyc2lvbiA9ICIxLjEwLjAiCgpbW2RlcHMuUGx1dG9EZXZNYWNyb3NdXQpkZXBzID0gWyJIeXBlcnRleHRMaXRlcmFsIiwgIkludGVyYWN0aXZlVXRpbHMiLCAiTWFjcm9Ub29scyIsICJNYXJrZG93biIsICJQa2ciLCAiUmFuZG9tIiwgIlRPTUwiXQpnaXQtdHJlZS1zaGExID0gIjZjZTFkOWY3YzA3OGI0OTM4MTIxNjEzNDljNDg3MzVkZWUyNzU0NjYiCnV1aWQgPSAiYTA0OTlmMjktYzM5Yi00YzVjLTgwN2MtODgwNzQyMjFiOTQ5Igp2ZXJzaW9uID0gIjAuNS44IgoKW1tkZXBzLlByaW50Zl1dCmRlcHMgPSBbIlVuaWNvZGUiXQp1dWlkID0gImRlMDg1OGRhLTYzMDMtNWU2Ny04NzQ0LTUxZWRkZWVlYjhkNyIKCltbZGVwcy5SRVBMXV0KZGVwcyA9IFsiSW50ZXJhY3RpdmVVdGlscyIsICJNYXJrZG93biIsICJTb2NrZXRzIiwgIlVuaWNvZGUiXQp1dWlkID0gIjNmYTBjZDk2LWVlZjEtNTY3Ni04YTYxLWIzYjg3NThiYmZmYiIKCltbZGVwcy5SYW5kb21dXQpkZXBzID0gWyJTSEEiXQp1dWlkID0gIjlhM2Y4Mjg0LWEyYzktNWYwMi05YTExLTg0NTk4MGExZmQ1YyIKCltbZGVwcy5TSEFdXQp1dWlkID0gImVhOGU5MTljLTI0M2MtNTFhZi04ODI1LWFhYTYzY2Q3MjFjZSIKdmVyc2lvbiA9ICIwLjcuMCIKCltbZGVwcy5TZXJpYWxpemF0aW9uXV0KdXVpZCA9ICI5ZTg4YjQyYS1mODI5LTViMGMtYmJlOS05ZTkyMzE5ODE2NmIiCgpbW2RlcHMuU29ja2V0c11dCnV1aWQgPSAiNjQ2MmZlMGItMjRkZS01NjMxLTg2OTctZGQ5NDFmOTBkZWNjIgoKW1tkZXBzLlRPTUxdXQpkZXBzID0gWyJEYXRlcyJdCnV1aWQgPSAiZmEyNjdmMWYtNjA0OS00ZjE0LWFhNTQtMzNiYWZhZTFlZDc2Igp2ZXJzaW9uID0gIjEuMC4zIgoKW1tkZXBzLlRhcl1dCmRlcHMgPSBbIkFyZ1Rvb2xzIiwgIlNIQSJdCnV1aWQgPSAiYTRlNTY5YTYtZTgwNC00ZmE0LWIwZjMtZWVmN2ExZDViMTNlIgp2ZXJzaW9uID0gIjEuMTAuMCIKCltbZGVwcy5Ucmlja3NdXQpnaXQtdHJlZS1zaGExID0gImFhZGI3NDhiZTU4YjQ5MjA0NWI0ZjU2MTY2YjUxODhhYTYzY2U1NDkiCnV1aWQgPSAiNDEwYTRiNGQtNDllNC00ZmJjLWFiNmQtY2I3MWIxN2IzNzc1Igp2ZXJzaW9uID0gIjAuMS43IgoKW1tkZXBzLlVVSURzXV0KZGVwcyA9IFsiUmFuZG9tIiwgIlNIQSJdCnV1aWQgPSAiY2Y3MTE4YTctNjk3Ni01YjFhLTlhMzktN2FkYzcyZjU5MWE0IgoKW1tkZXBzLlVuaWNvZGVdXQp1dWlkID0gIjRlYzBhODNlLTQ5M2UtNTBlMi1iOWFjLThmNzJhY2Y1YThmNSIKCltbZGVwcy5abGliX2psbF1dCmRlcHMgPSBbIkxpYmRsIl0KdXVpZCA9ICI4Mzc3NWE1OC0xZjFkLTUxM2YtYjE5Ny1kNzEzNTRhYjAwN2EiCnZlcnNpb24gPSAiMS4yLjEzKzEiCgpbW2RlcHMubmdodHRwMl9qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliZGwiXQp1dWlkID0gIjhlODUwZWRlLTc2ODgtNTMzOS1hMDdjLTMwMmFjZDJhYWY4ZCIKdmVyc2lvbiA9ICIxLjUyLjArMSIKCltbZGVwcy5wN3ppcF9qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliZGwiXQp1dWlkID0gIjNmMTllOTMzLTMzZDgtNTNiMy1hYWFiLWJkNTExMGMzYjdhMCIKdmVyc2lvbiA9ICIxNy40LjArMiIKIiIiCgojIOKVlOKVkOKVoSBDZWxsIG9yZGVyOgojIOKVn+KUgDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YQojIOKVoOKVkDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZgojIOKVoOKVkDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwMwojIOKVoOKVkDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5MwojIOKVoOKVkGNiZmM2ZWVjLTg5OTEtNGE5Yy1hZGEwLTI5NWM4MDUyODU0ZAojIOKVn+KUgDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MAojIOKVn+KUgGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMAojIOKVoOKVkDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZgojIOKVoOKVkGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NgojIOKVn+KUgGZlODkxYjRlLWY0NDAtNDgyMy1iNDNiLTcyNTcyZjZhNmMxMgojIOKVoOKVkDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOAojIOKVoOKVkDIzNThmNjg2LTE5NTAtNDBmOS05ZDVjLWRhYzJkOThmNGMyNAojIOKVn+KUgDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNQojIOKVn+KUgDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MAojIOKVoOKVkDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOQojIOKVoOKVkGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzOAojIOKVn+KUgDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjNwojIOKVn+KUgDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkNwojIOKVoOKVkDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiYwojIOKVoOKVkGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNAojIOKVoOKVkDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYgojIOKVn+KUgDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3YwojIOKVn+KUgDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMgojIOKVoOKVkDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMgojIOKVoOKVkDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NAojIOKVoOKVkDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNgojIOKVn+KUgDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5NwojIOKVoOKVkDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNQojIOKVoOKVkGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNgojIOKVoOKVkDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YQojIOKVn+KUgDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNQojIOKVn+KUgDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNAojIOKVoOKVkDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNgojIOKVoOKVkDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZgojIOKVoOKVkDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OAojIOKVoOKVkDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjMwojIOKVoOKVkGJlMmE3ODIwLWUxOTQtNDQxMC1iMDBkLWE5MzMyYjIzNGFkNgojIOKVn+KUgDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMQojIOKVn+KUgDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMgo=";
window.pluto_disable_ui = true;
window.pluto_slider_server_url = undefined;
window.pluto_binder_url = "https://mybinder.org/v2/gh/fonsp/pluto-on-binder/v0.19.27";
window.pluto_statefile = "data:;base64,3gARpWJvbmRzhqNhbHSBpXZhbHVlzKCibnSBpXZhbHVlkZORA5EDkQijYXNkgaV2YWx1ZZGVkQORCZGqbG9sYXNkYXNkZpGgkQGjYm9ogaV2YWx1ZZGRkZGRkZEBp2xvbF9wb3CBpXZhbHVlkZGSkQWRBKRmcmVxgaV2YWx1ZQ+sY2VsbF9yZXN1bHRz3gAl2SRjYmZjNmVlYy04OTkxLTRhOWMtYWRhMC0yOTVjODA1Mjg1NGSKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5oKRtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8ItJ8Ee2wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGNiZmM2ZWVjLTg5OTEtNGE5Yy1hZGEwLTI5NWM4MDUyODU0ZLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzS2atXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoi0zxib25kc2xpc3QtY29udGFpbmVyIGNsYXNzPSduby1wb3BvdXQnPgoJPGJvbmRzbGlzdC1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2NvbGxhcHNlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJyB0aXRsZT0iVGhpcyBsaXN0IGNvbnRhaW5zIGluZGVwZW5kZW50IGJvbmRzIj5NeSBHcm91cCBvZiBCb25kczwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0ndG9nZ2xlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+Cgk8L2JvbmRzbGlzdC1oZWFkZXI+Cgk8Ym9uZHNsaXN0LWNvbnRlbnRzPgoJPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYGZyZXFgJz4KCQlGcmVxdWVuY3kgW0dIel0KCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxib25kIGRlZj0iZnJlcSIgdW5pcXVlX2lkPSJMQjVnRTRVVmNJTWkiPgo8c2NyaXB0PgoJY29uc3QgZDNmb3JtYXQgPSBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgoJY29uc3QgZWxwID0gaHRtbGAKCTxzcGFuIGNsYXNzPSJudW1iZXJfRWRpdGFibGUiIHN0eWxlPSIKCXRvdWNoLWFjdGlvbjogbm9uZTsKCXBhZGRpbmc6IDBlbSAuMmVtOwoJYm9yZGVyLXJhZGl1czogLjNlbTsKCWZvbnQtd2VpZ2h0OiBib2xkOyI+PHNwYW4gY29udGVudEVkaXRhYmxlPXRydWU+MjA8L3NwYW4+IEdIejwvc3Bhbj4KCWAKCgljb25zdCBmb3JtYXR0ZXIgPSBzID0+IGQzZm9ybWF0LmZvcm1hdCgiIikocykKCWNvbnN0IGVsID0gZWxwLnF1ZXJ5U2VsZWN0b3IoInNwYW4iKQoKCWxldCBsb2NhbFZhbCA9IHBhcnNlRmxvYXQoMjApCgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoMjApCgkKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbHAsInZhbHVlIix7CgkJZ2V0OiAoKSA9PiBsb2NhbFZhbCwKCQlzZXQ6IHggPT4gewoJCQlsb2NhbFZhbCA9IHBhcnNlRmxvYXQoeCkKCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKHgpCgkJfQoJfSkKCgljb25zdCBkaXNwYXRjaEV2ZW50ID0gKGUpID0+IHsKCQlpZiAoZWwuaW5uZXJUZXh0ID09PSAiIikgewoJCQllbHAudmFsdWUgPSAyMCAgIAoJCX0gZWxzZSB7CgkJCS8qIAoJCQlUaGUgcmVwbGFjZSBpcyBuZWVkZWQgYmVjYXVzZSBkMy1mb3JtYXQgb3V0cHV0cyAnLScgYXMgaW4gVSsyMjEyIChtYXRoIHN5bWJvbCkgYnV0IGZhaWxzIHRvIHBhcnNlIG5lZ2F0aXZlIG51bWJlciBjb3JyZWN0bHkgaWYgdGhleSBoYXZlIHRoYXQgc2lnbiBhcyBuZWdhdGl2ZSBzaWduLiBTbyB3ZSBqdXN0IHJlcGxhY2UgaXQgd2l0aCB0aGUgZGFzaCBVKzAwMkQgc2lnbiAKCQkJKi8KCQkJZWxwLnZhbHVlID0gIGVsLmlubmVyVGV4dC5yZXBsYWNlKCfiiJInLCAnLScpCgkJfQoJCWVscC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KCgkvLyBGdW5jdGlvbiB0byBibHVyIHRoZSBlbGVtZW50IHdoZW4gcHJlc3NpbmcgZW50ZXIgaW5zdGVhZCBvZiBhZGRpbmcgYSBuZXdsaW5lCgljb25zdCBvbkVudGVyID0gKGUpID0+IHsKCQlpZiAoZS5rZXlDb2RlID09PSAxMykgewoJCWUucHJldmVudERlZmF1bHQoKTsKCQllbC5ibHVyKCkKCQl9Cgl9CgoJZWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLChlKSA9PiB7CgkJY29uc29sZS5sb2coZSkKCQllLnByZXZlbnREZWZhdWx0KCkKCQllLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpCgl9KQoKCWZ1bmN0aW9uIHNlbGVjdFRleHQoZWwpewoJCXZhciBzZWwsIHJhbmdlOwoJCWlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uICYmIGRvY3VtZW50LmNyZWF0ZVJhbmdlKSB7IC8vQnJvd3NlciBjb21wYXRpYmlsaXR5CgkJc2VsID0gd2luZG93LmdldFNlbGVjdGlvbigpOwoJCWlmKHNlbC50b1N0cmluZygpID09ICcnKXsgLy9ubyB0ZXh0IHNlbGVjdGlvbgoJCQl3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpewoJCQkJcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOyAvL3JhbmdlIG9iamVjdAoJCQkJcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGVsKTsgLy9zZXRzIFJhbmdlCgkJCQlzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7IC8vcmVtb3ZlIGFsbCByYW5nZXMgZnJvbSBzZWxlY3Rpb24KCQkJCXNlbC5hZGRSYW5nZShyYW5nZSk7Ly9hZGQgUmFuZ2UgdG8gYSBTZWxlY3Rpb24uCgkJCX0sMSk7CgkJfQoJCX1lbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHsgLy9vbGRlciBpZQoJCQlzZWwgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTsKCQkJaWYoc2VsLnRleHQgPT0gJycpeyAvL25vIHRleHQgc2VsZWN0aW9uCgkJCQlyYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7Ly9DcmVhdGVzIFRleHRSYW5nZSBvYmplY3QKCQkJCXJhbmdlLm1vdmVUb0VsZW1lbnRUZXh0KGVsKTsvL3NldHMgUmFuZ2UKCQkJCXJhbmdlLnNlbGVjdCgpOyAvL21ha2Ugc2VsZWN0aW9uLgoJCQl9CgkJfQoJfQoKCQoJZWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLGRpc3BhdGNoRXZlbnQpCgllbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJyxvbkVudGVyKQoJZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpKSAvLyBtb2RpZnkgdGV4dAoJZWxwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSkgPT4gc2VsZWN0VGV4dChlbCkpIC8vIFNlbGVjdCBhbGwgdGV4dAoKCXJldHVybiBlbHAKCjwvc2NyaXB0Pgo8c3R5bGU+CglAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBsaWdodCkgewoJCXNwYW4ubnVtYmVyX0VkaXRhYmxlIHsKCQkJYmFja2dyb3VuZDogaHNsKDIwNCwgOTUlLCA4NCUpOwoJCX0KCX0KCUBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHsKCQlzcGFuLm51bWJlcl9FZGl0YWJsZSB7CgkJCWJhY2tncm91bmQ6IGhzbCgyMDQsIDk1JSwgNDAlKTsKCQl9Cgl9Cjwvc3R5bGU+CjwvYm9uZD4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgo8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgYWx0YCc+CgkJPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPkFsdGl0dWRlIDxzcGFuIGNsYXNzPSJ0ZXgiPiRoJDwvc3Bhbj4gJiM5MTttJiM5Mzs8L3A+CjwvZGl2PgoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPGJvbmQgZGVmPSJhbHQiIHVuaXF1ZV9pZD0iSGI0dm8wWW5rUElvIj48c2NyaXB0PgovLyB3ZWlyZCBpbXBvcnQgdG8gbWFrZSBpdCBmYXN0ZXIuIFRoZSBgYXdhaXQgaW1wb3J0YCBjYW4gc3RpbGwgZGVsYXkgZXhlY3V0aW9uIGJ5IG9uZSBmcmFtZSBpZiBpdCBpcyBhbHJlYWR5IGxvYWRlZC4uLgp3aW5kb3cuZDNmb3JtYXQgPSB3aW5kb3cuZDNmb3JtYXQgPz8gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKY29uc3QgYXJnbWluID0geHMgPT4geHMuaW5kZXhPZihNYXRoLm1pbiguLi54cykpCmNvbnN0IGNsb3Nlc3RfaW5kZXggPSAoeHMsIHkpID0+IGFyZ21pbih4cy5tYXAoeCA9PiBNYXRoLmFicyh4LXkpKSkKCmNvbnN0IHZhbHVlcyA9IFsxMDAsIDExMCwgMTIwLCAxMzAsIDE0MCwgMTUwLCAxNjAsIDE3MCwgMTgwLCAxOTAsIDIwMF0KCmNvbnN0IGVsID0gaHRtbGAKPHNwYW4gdGl0bGU9IkNsaWNrIGFuZCBkcmFnIHRoaXMgbnVtYmVyIGxlZnQgb3IgcmlnaHQhIiBzdHlsZT0iY3Vyc29yOiBjb2wtcmVzaXplOwp0b3VjaC1hY3Rpb246IG5vbmU7CmJhY2tncm91bmQ6IHJnYigyNTIsIDIwOSwgMjA0KTsKY29sb3I6IGJsYWNrOwpwYWRkaW5nOiAwZW0gLjJlbTsKYm9yZGVyLXJhZGl1czogLjNlbTsKZm9udC13ZWlnaHQ6IGJvbGQ7Ij4xNTA8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDE1MCkKbGV0IGN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4Cgpjb25zdCBmb3JtYXR0ZXIgPSBzID0+ICIiICsgZDNmb3JtYXQuZm9ybWF0KCIiKShzKSArICIiCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlc1tjdXJyZW50X2luZGV4XSwKCXNldDogeCA9PiB7CgkJY3VycmVudF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCB4KQoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCX0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKLy8gaW5pdGlhbCB2YWx1ZQplbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoMTUwKQoKY29uc3Qgb25TY3J1YiA9IChlKSA9PiB7Cgljb25zdCBvZmZzZXQgPSBlLmNsaWVudFggLSBvbGRfeAoJY29uc3QgbmV3X2luZGV4ID0gTWF0aC5taW4odmFsdWVzLmxlbmd0aC0xLCBNYXRoLm1heCgwLCAKCQlNYXRoLnJvdW5kKG9mZnNldC8xMCkgKyBvbGRfaW5kZXgKCSkpCgoJaWYobmV3X2luZGV4ICE9PSBjdXJyZW50X2luZGV4KSB7CgkJY3VycmVudF9pbmRleCA9IG5ld19pbmRleAoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KfQoKY29uc3Qgb25wb2ludGVyZG93biA9IChlKSA9PiB7Cgl3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKQoJb2xkX3ggPSBlLmNsaWVudFgKCW9sZF9pbmRleCA9IGN1cnJlbnRfaW5kZXgKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoKY29uc3Qgb25kYmxjbGljayA9IChlKSA9PiB7CgljdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoKY29uc3Qgb25wb2ludGVydXAgPSAoKSA9PiB7Cgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCmVsLm9uc2VsZWN0c3RhcnQgPSAoKSA9PiBmYWxzZQoKaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQp9KQoKcmV0dXJuIGVsCgo8L3NjcmlwdD48L2JvbmQ+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCQoJPC9ib25kc2xpc3QtY29udGVudHM+Cgk8c2NyaXB0IGlkPSdpbXZ1ZGdhbG5vJz4KCQljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb250YWluZXIuY29sbGFwc2UgPSAoZm9yY2UpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcsIGZvcmNlKQoJCX0KCQljb25zdCBjb2xsYXBzZV9idG4gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3Bhbi5jb2xsYXBzZScpCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gY29udGFpbmVyLmNvbGxhcHNlKCkKCTwvc2NyaXB0PgoJPHN0eWxlPgoJYm9uZHNsaXN0LWhlYWRlciB7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBkaXNwbGF5OiBmbGV4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKfQpib25kc2xpc3QtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDBweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjZmZhYzQ1NDA7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQgPiBib25kc2xpc3QtaGVhZGVyIHsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIHBhZGRpbmctdG9wOiAxMnB4OwogIG1hcmdpbi10b3A6IC0xMnB4OwogIHotaW5kZXg6IDEwOwp9CmJvbmRzbGlzdC1jb250ZW50cyB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQ6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBibG9jazsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGp1c3RpZnktc2VsZjogY2VudGVyOwogIGJvcmRlci1ib3R0b206IDJweCBzb2xpZDsKICBwYWRkaW5nLXRvcDogNXB4OwogIHdpZHRoOiAxMDAlOwogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogIHotaW5kZXg6IDIwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuYm9uZHNsaXN0LWljb24gewogIC0tc2l6ZTogMTdweDsKICBkaXNwbGF5OiBibG9jazsKICBhbGlnbi1zZWxmOiBzdHJldGNoOwogIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgd2lkdGg6IHZhcigtLXNpemUpOwogIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgY3Vyc29yOiBwb2ludGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkID4gYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB3aWR0aDogMzBweDsKICBtYXJnaW46IDAgMTBweDsKfQpib25kc2xpc3QtaGVhZGVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogIHdpZHRoOiAxMDAlOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBmbGV4LWdyb3c6IDE7CiAgZm9udC1zaXplOiAxOHB4OwogIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGFsaWduLXNlbGY6IGNlbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCBib25kc2xpc3QtaGVhZGVyICsgKiB7CiAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CmJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICByb3ctZ2FwOiA1cHg7Cn0KYm9uZHN0YWJsZS1jb250YWluZXIgYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCQkKCTwvc3R5bGU+CjwvYm9uZHNsaXN0LWNvbnRhaW5lcj4KpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZaJibLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EKEND4ywcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgsJvf21cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ5OTZiNDA4NS0xMTRjLTQ4ZjQtOWY5MC04ZTYzN2YyOWMwNmGKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5g6hlbGVtZW50c5OSoWGSoTOqdGV4dC9wbGFpbpKhYpKhM6p0ZXh0L3BsYWlukqFjkqE4qnRleHQvcGxhaW6kdHlwZapOYW1lZFR1cGxlqG9iamVjdGlksGIxMzE5NTAxY2JiMThiYTWkbWltZdkhYXBwbGljYXRpb24vdm5kLnBsdXRvLnRyZWUrb2JqZWN0rHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPCJnE69HsHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5OTZiNDA4NS0xMTRjLTQ4ZjQtOWY5MC04ZTYzN2YyOWMwNmG5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZT+1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5ozE2MKRtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8ImpQNVCwcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGJlMmE3ODIwLWUxOTQtNDQxMC1iMDBkLWE5MzMyYjIzNGFkNrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lO7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAew8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+U29tZXRpbWVzIGN1c3RvbSBzdHJ1Y3RzIGFyZSBub3QgbmVlZGVkIGFuZCBpdCB3b3VsZCBiZSB1c2VmdWwgdG8ganVzdCB1c2UgdGhlIHNhbWUgbmljZSBib25kIHN0cnVjdHVyZSBvZiA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiB0byBzaW1wbHkgY3JlYXRlIGFyYml0cmFyeSBOYW1lZFR1cGxlcy4gPC9wPgo8cD5UaGlzIGlzIHBvc3NpYmxlIHdpdGggdGhlIGNvbnZlbmllbmNlIG1hY3JvIDxjb2RlPkBOVEJvbmQ8L2NvZGU+IHdoaWNoIGNhbiBiZSBjYWxsZWQgYXMgc2hvd24gYmVsb3cgdG8gY3JlYXRlIGEgbmljZSBkaXNwbGF5IGZvciBhbiBpbnRlcmFjdGl2ZSBib25kIGNyZWF0aW5nIGFuIGFyYml0cmFyeSBOYW1lZFR1cGxlLjwvcD4KPHA+VGhlIG1hY3JvIHNpbXBseSBjcmVhdGUgYSA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiB3cmFwcGluZyB0aGUgZGVzaXJlZCBOYW1lZFR1cGxlIHR5cGUuPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJk3h6WwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAFYTu1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52Sw8ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgxPlBvcG91dDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTulL7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAOQAbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAmg8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhlIGZpbmFsIGNvbnZlbmllbmNlIHN0cnVjdHVyZSBwcm92aWRlZCBieSB0aGlzIG1vZHVsZSBpcyB0aGUgPGNvZGU+Qm9uZFRhYmxlPC9jb2RlPi4gSXQgY2FuIGJlIGNyZWF0ZWQgdG8gZ3JvdXAgYSBsaXN0IG9mIGJvbmRzIGluIGEgZmxvYXRpbmcgdGFibGUgdGhhdCBzdGF5cyBvbiB0aGUgbGVmdCBzaWRlIG9mIHRoZSBub3RlYm9vayAmIzQwO3NpbWlsYXIgdG8gdGhlIFRhYmxlT2ZDb250ZW50cyBvZiBQbHV0b1VJJiM0MTsgYW5kIGNhbiBiZSBtb3ZlZCBhcm91bmQgYW5kIHJlc2l6ZWQgb3IgaGlkZGVuIGZvciBjb252ZW5pZW5jZS48L3A+CjxwPlRoZSBCb25kVGFibGUgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBlaXRoZXIgd2l0aCBib25kcyBjb250YWluaW5nIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IG9yIHdpdGggPGNvZGU+Qm9uZHNMaXN0PC9jb2RlPi4gRnV0dXJlIHR5cGVzIHdpdGggc2ltaWxhciBzdHJ1Y3R1cmUgd2lsbCBhbHNvIGJlIGFkZGVkLjwvcD4KPHA+SGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgYm9uZHRhYmxlIGNvbnRhaW5pbmcgYWxsIHRoZSBleGFtcGxlcyBvZiB0aGlzIG5vdGVib29rLjwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCZPC31sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTS5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABh2ntXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYWmcHJlZml4o0FTRKhlbGVtZW50c5WSoWGSoTOqdGV4dC9wbGFpbpKhYpKhOap0ZXh0L3BsYWlukqFjkqwibG9sYXNkYXNkZiKqdGV4dC9wbGFpbpKhZJKiIiKqdGV4dC9wbGFpbpKhZZKiMjCqdGV4dC9wbGFpbqR0eXBlpnN0cnVjdKxwcmVmaXhfc2hvcnSjQVNEqG9iamVjdGlksGQwMjU5ZGNkZTFjODVkN2KkbWltZdkhYXBwbGljYXRpb24vdm5kLnBsdXRvLnRyZWUrb2JqZWN0rHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPCJpdIK2sHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNza5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZTC1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52wAB4Oc8Ym9uZHRhYmxlLWNvbnRhaW5lciBrZXk9J2d0a3pyeXFybGsnPgoJPGJvbmR0YWJsZS1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J3RhYmxlLWhlbHAgaWNvbic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TXkgQm9uZHM8L3NwYW4+CgkJPHNwYW4gY2xhc3M9J3RhYmxlLWNvbGxhcHNlIGljb24nPjwvc3Bhbj4KCTwvYm9uZHRhYmxlLWhlYWRlcj4KCTxib25kdGFibGUtY29udGVudHM+CgkJPGJvbmQgZGVmPSJhc2QiIHVuaXF1ZV9pZD0iblpyOU80N2k4UzI2Ij48c3RydWN0LWJvbmQgY2xhc3M9J0FTRCc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPkFTRDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2xtdHd4eWVhcXInIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2EnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2EnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGFgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+TWFya2Rvd24gZGVzY3JpcHRpb24sIGluY2x1ZGluZyA8c3BhbiBjbGFzcz0idGV4Ij4kTGFUZVgkPC9zcGFuPjwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2EnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RyeGd6cWpnd2YnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0ndHJ4Z3pxamd3Zic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInRyeGd6cWpnd2YiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2InPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2InIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGJgIj48c3Bhbj5GaWVsZCB3aXRoIDxiPkhUTUw8L2I+IGRlc2NyaXB0aW9uPC9zcGFuPjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlc250dnNtbGJrJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c2NyaXB0PgovLyB3ZWlyZCBpbXBvcnQgdG8gbWFrZSBpdCBmYXN0ZXIuIFRoZSBgYXdhaXQgaW1wb3J0YCBjYW4gc3RpbGwgZGVsYXkgZXhlY3V0aW9uIGJ5IG9uZSBmcmFtZSBpZiBpdCBpcyBhbHJlYWR5IGxvYWRlZC4uLgp3aW5kb3cuZDNmb3JtYXQgPSB3aW5kb3cuZDNmb3JtYXQgPz8gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKY29uc3QgYXJnbWluID0geHMgPT4geHMuaW5kZXhPZihNYXRoLm1pbiguLi54cykpCmNvbnN0IGNsb3Nlc3RfaW5kZXggPSAoeHMsIHkpID0+IGFyZ21pbih4cy5tYXAoeCA9PiBNYXRoLmFicyh4LXkpKSkKCmNvbnN0IHZhbHVlcyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF0KCmNvbnN0IGVsID0gaHRtbGAKPHNwYW4gdGl0bGU9IkNsaWNrIGFuZCBkcmFnIHRoaXMgbnVtYmVyIGxlZnQgb3IgcmlnaHQhIiBzdHlsZT0iY3Vyc29yOiBjb2wtcmVzaXplOwp0b3VjaC1hY3Rpb246IG5vbmU7CmJhY2tncm91bmQ6IHJnYigyNTIsIDIwOSwgMjA0KTsKY29sb3I6IGJsYWNrOwpwYWRkaW5nOiAwZW0gLjJlbTsKYm9yZGVyLXJhZGl1czogLjNlbTsKZm9udC13ZWlnaHQ6IGJvbGQ7Ij42PC9zcGFuPgpgCgoKCmxldCBvbGRfeCA9IDAKbGV0IG9sZF9pbmRleCA9IDAKY29uc3QgaW5pdGlhbF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCA2KQpsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCmNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJc2V0OiB4ID0+IHsKCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7CgovLyBpbml0aWFsIHZhbHVlCmVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcig2KQoKY29uc3Qgb25TY3J1YiA9IChlKSA9PiB7Cgljb25zdCBvZmZzZXQgPSBlLmNsaWVudFggLSBvbGRfeAoJY29uc3QgbmV3X2luZGV4ID0gTWF0aC5taW4odmFsdWVzLmxlbmd0aC0xLCBNYXRoLm1heCgwLCAKCQlNYXRoLnJvdW5kKG9mZnNldC8xMCkgKyBvbGRfaW5kZXgKCSkpCgoJaWYobmV3X2luZGV4ICE9PSBjdXJyZW50X2luZGV4KSB7CgkJY3VycmVudF9pbmRleCA9IG5ld19pbmRleAoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KfQoKY29uc3Qgb25wb2ludGVyZG93biA9IChlKSA9PiB7Cgl3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKQoJb2xkX3ggPSBlLmNsaWVudFgKCW9sZF9pbmRleCA9IGN1cnJlbnRfaW5kZXgKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoKY29uc3Qgb25kYmxjbGljayA9IChlKSA9PiB7CgljdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoKY29uc3Qgb25wb2ludGVydXAgPSAoKSA9PiB7Cgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCmVsLm9uc2VsZWN0c3RhcnQgPSAoKSA9PiBmYWxzZQoKaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQp9KQoKcmV0dXJuIGVsCgo8L3NjcmlwdD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdlc250dnNtbGJrJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZXNudHZzbWxiayIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHN2dnp3emZ0bCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYycgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgY2AiPk5vcm1hbCBTdHJpbmcgRGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ncXVvcW1raWdqaCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3F1b3Fta2lnamgnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJxdW9xbWtpZ2poIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdkJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdkJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBkYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPlRoaXMgZmllbGQgaXMgPGVtPnNwZWNpYWw8L2VtPjwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2QnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2ZjaXp6Ynpnd2EnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSd0ZXh0JyB2YWx1ZT0nJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdmY2l6emJ6Z3dhJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZmNpenpiemd3YSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHN2dnp3emZ0bCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nZSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nZScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgZWAiPmU8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZGlnbWl3d3R2bScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nNicgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2RpZ21pd3d0dm0nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJkaWdtaXd3dHZtIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0ndHN2dnp3emZ0bCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInRzdnZ6d3pmdGwiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBBU0RgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2xtdHd4eWVhcXInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJsbXR3eHllYXFyIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdvdHhmcnB5ZXNnJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nbWt1cnR2em9hcic+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIkN1c3RvbSBEZXNjcmlwdGlvbiIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjxib25kIGRlZj0ibnQiIHVuaXF1ZV9pZD0iVzBTdjlkUXQ2WGhkIj48c3RydWN0LWJvbmQgY2xhc3M9J05hbWVkVHVwbGV7KFN5bWJvbCgmcXVvdDsjIzIzMiZxdW90OyksIDphLCA6YiwgOmMpfSc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPk5hbWVkVHVwbGU8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtdWdidGdrcWZzJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nc2FqeG1tY3p1cCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdzYWp4bW1jenVwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAic2FqeG1tY3p1cCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnVlbm9lZGJieCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd6dmhpb3h5b2FpJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3p2aGlveHlvYWknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ6dmhpb3h5b2FpIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdic2l6dWx0dXJjJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JzaXp1bHR1cmMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJic2l6dWx0dXJjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYnVlbm9lZGJieCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJ1ZW5vZWRiYngiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBOYW1lZFR1cGxlYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdtdWdidGdrcWZzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibXVnYnRna3FmcyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nandnZW90ZHZtcyc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JieHd4bHJidWcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJNeSBGYW5jeSBOVHVwbGUiCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD48Ym9uZHNsaXN0LWNvbnRhaW5lciBjbGFzcz0nbm8tcG9wb3V0Jz4KCTxib25kc2xpc3QtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdjb2xsYXBzZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbicgdGl0bGU9IlRoaXMgbGlzdCBjb250YWlucyBpbmRlcGVuZGVudCBib25kcyI+TXkgR3JvdXAgb2YgQm9uZHM8L3NwYW4+CgkJPHNwYW4gY2xhc3M9J3RvZ2dsZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJPC9ib25kc2xpc3QtaGVhZGVyPgoJPGJvbmRzbGlzdC1jb250ZW50cz4KCTxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBmcmVxYCc+CgkJRnJlcXVlbmN5IFtHSHpdCgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8Ym9uZCBkZWY9ImZyZXEiIHVuaXF1ZV9pZD0iTEI1Z0U0VVZjSU1pIj4KPHNjcmlwdD4KCWNvbnN0IGQzZm9ybWF0ID0gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKCWNvbnN0IGVscCA9IGh0bWxgCgk8c3BhbiBjbGFzcz0ibnVtYmVyX0VkaXRhYmxlIiBzdHlsZT0iCgl0b3VjaC1hY3Rpb246IG5vbmU7CglwYWRkaW5nOiAwZW0gLjJlbTsKCWJvcmRlci1yYWRpdXM6IC4zZW07Cglmb250LXdlaWdodDogYm9sZDsiPjxzcGFuIGNvbnRlbnRFZGl0YWJsZT10cnVlPjIwPC9zcGFuPiBHSHo8L3NwYW4+CglgCgoJY29uc3QgZm9ybWF0dGVyID0gcyA9PiBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpCgljb25zdCBlbCA9IGVscC5xdWVyeVNlbGVjdG9yKCJzcGFuIikKCglsZXQgbG9jYWxWYWwgPSBwYXJzZUZsb2F0KDIwKQoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDIwKQoJCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxwLCJ2YWx1ZSIsewoJCWdldDogKCkgPT4gbG9jYWxWYWwsCgkJc2V0OiB4ID0+IHsKCQkJbG9jYWxWYWwgPSBwYXJzZUZsb2F0KHgpCgkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcih4KQoJCX0KCX0pCgoJY29uc3QgZGlzcGF0Y2hFdmVudCA9IChlKSA9PiB7CgkJaWYgKGVsLmlubmVyVGV4dCA9PT0gIiIpIHsKCQkJZWxwLnZhbHVlID0gMjAgICAKCQl9IGVsc2UgewoJCQkvKiAKCQkJVGhlIHJlcGxhY2UgaXMgbmVlZGVkIGJlY2F1c2UgZDMtZm9ybWF0IG91dHB1dHMgJy0nIGFzIGluIFUrMjIxMiAobWF0aCBzeW1ib2wpIGJ1dCBmYWlscyB0byBwYXJzZSBuZWdhdGl2ZSBudW1iZXIgY29ycmVjdGx5IGlmIHRoZXkgaGF2ZSB0aGF0IHNpZ24gYXMgbmVnYXRpdmUgc2lnbi4gU28gd2UganVzdCByZXBsYWNlIGl0IHdpdGggdGhlIGRhc2ggVSswMDJEIHNpZ24gCgkJCSovCgkJCWVscC52YWx1ZSA9ICBlbC5pbm5lclRleHQucmVwbGFjZSgn4oiSJywgJy0nKQoJCX0KCQllbHAuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgl9CgoJLy8gRnVuY3Rpb24gdG8gYmx1ciB0aGUgZWxlbWVudCB3aGVuIHByZXNzaW5nIGVudGVyIGluc3RlYWQgb2YgYWRkaW5nIGEgbmV3bGluZQoJY29uc3Qgb25FbnRlciA9IChlKSA9PiB7CgkJaWYgKGUua2V5Q29kZSA9PT0gMTMpIHsKCQllLnByZXZlbnREZWZhdWx0KCk7CgkJZWwuYmx1cigpCgkJfQoJfQoKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywoZSkgPT4gewoJCWNvbnNvbGUubG9nKGUpCgkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKQoJfSkKCglmdW5jdGlvbiBzZWxlY3RUZXh0KGVsKXsKCQl2YXIgc2VsLCByYW5nZTsKCQlpZiAod2luZG93LmdldFNlbGVjdGlvbiAmJiBkb2N1bWVudC5jcmVhdGVSYW5nZSkgeyAvL0Jyb3dzZXIgY29tcGF0aWJpbGl0eQoJCXNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKCQlpZihzZWwudG9TdHJpbmcoKSA9PSAnJyl7IC8vbm8gdGV4dCBzZWxlY3Rpb24KCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCQkJCXJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsgLy9yYW5nZSBvYmplY3QKCQkJCXJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyhlbCk7IC8vc2V0cyBSYW5nZQoJCQkJc2VsLnJlbW92ZUFsbFJhbmdlcygpOyAvL3JlbW92ZSBhbGwgcmFuZ2VzIGZyb20gc2VsZWN0aW9uCgkJCQlzZWwuYWRkUmFuZ2UocmFuZ2UpOy8vYWRkIFJhbmdlIHRvIGEgU2VsZWN0aW9uLgoJCQl9LDEpOwoJCX0KCQl9ZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7IC8vb2xkZXIgaWUKCQkJc2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7CgkJCWlmKHNlbC50ZXh0ID09ICcnKXsgLy9ubyB0ZXh0IHNlbGVjdGlvbgoJCQkJcmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpOy8vQ3JlYXRlcyBUZXh0UmFuZ2Ugb2JqZWN0CgkJCQlyYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChlbCk7Ly9zZXRzIFJhbmdlCgkJCQlyYW5nZS5zZWxlY3QoKTsgLy9tYWtlIHNlbGVjdGlvbi4KCQkJfQoJCX0KCX0KCgkKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JyxkaXNwYXRjaEV2ZW50KQoJZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsb25FbnRlcikKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSkgPT4gZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSkgLy8gbW9kaWZ5IHRleHQKCWVscC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IHNlbGVjdFRleHQoZWwpKSAvLyBTZWxlY3QgYWxsIHRleHQKCglyZXR1cm4gZWxwCgo8L3NjcmlwdD4KPHN0eWxlPgoJQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogbGlnaHQpIHsKCQlzcGFuLm51bWJlcl9FZGl0YWJsZSB7CgkJCWJhY2tncm91bmQ6IGhzbCgyMDQsIDk1JSwgODQlKTsKCQl9Cgl9CglAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CgkJc3Bhbi5udW1iZXJfRWRpdGFibGUgewoJCQliYWNrZ3JvdW5kOiBoc2woMjA0LCA5NSUsIDQwJSk7CgkJfQoJfQo8L3N0eWxlPgo8L2JvbmQ+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYGFsdGAnPgoJCTxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5BbHRpdHVkZSA8c3BhbiBjbGFzcz0idGV4Ij4kaCQ8L3NwYW4+ICYjOTE7bSYjOTM7PC9wPgo8L2Rpdj4KCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxib25kIGRlZj0iYWx0IiB1bmlxdWVfaWQ9IkhiNHZvMFlua1BJbyI+PHNjcmlwdD4KLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4Kd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCmNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQpjb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgpjb25zdCB2YWx1ZXMgPSBbMTAwLCAxMTAsIDEyMCwgMTMwLCAxNDAsIDE1MCwgMTYwLCAxNzAsIDE4MCwgMTkwLCAyMDBdCgpjb25zdCBlbCA9IGh0bWxgCjxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKdG91Y2gtYWN0aW9uOiBub25lOwpiYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CmNvbG9yOiBibGFjazsKcGFkZGluZzogMGVtIC4yZW07CmJvcmRlci1yYWRpdXM6IC4zZW07CmZvbnQtd2VpZ2h0OiBib2xkOyI+MTUwPC9zcGFuPgpgCgoKCmxldCBvbGRfeCA9IDAKbGV0IG9sZF9pbmRleCA9IDAKY29uc3QgaW5pdGlhbF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCAxNTApCmxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCglzZXQ6IHggPT4gewoJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgl9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCi8vIGluaXRpYWwgdmFsdWUKZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDE1MCkKCmNvbnN0IG9uU2NydWIgPSAoZSkgPT4gewoJY29uc3Qgb2Zmc2V0ID0gZS5jbGllbnRYIC0gb2xkX3gKCWNvbnN0IG5ld19pbmRleCA9IE1hdGgubWluKHZhbHVlcy5sZW5ndGgtMSwgTWF0aC5tYXgoMCwgCgkJTWF0aC5yb3VuZChvZmZzZXQvMTApICsgb2xkX2luZGV4CgkpKQoKCWlmKG5ld19pbmRleCAhPT0gY3VycmVudF9pbmRleCkgewoJCWN1cnJlbnRfaW5kZXggPSBuZXdfaW5kZXgKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgl9Cn0KCmNvbnN0IG9ucG9pbnRlcmRvd24gPSAoZSkgPT4gewoJd2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KCkKCW9sZF94ID0gZS5jbGllbnRYCglvbGRfaW5kZXggPSBjdXJyZW50X2luZGV4Cgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CmVsLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCmNvbnN0IG9uZGJsY2xpY2sgPSAoZSkgPT4gewoJY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQp9CmVsLmFkZEV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCmNvbnN0IG9ucG9pbnRlcnVwID0gKCkgPT4gewoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgplbC5vbnNlbGVjdHN0YXJ0ID0gKCkgPT4gZmFsc2UKCmludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKfSkKCnJldHVybiBlbAoKPC9zY3JpcHQ+PC9ib25kPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+CgkKCTwvYm9uZHNsaXN0LWNvbnRlbnRzPgoJPHNjcmlwdCBpZD0naW12dWRnYWxubyc+CgkJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29udGFpbmVyLmNvbGxhcHNlID0gKGZvcmNlKSA9PiB7CgkJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnLCBmb3JjZSkKCQl9CgkJY29uc3QgY29sbGFwc2VfYnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4uY29sbGFwc2UnKQoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IGNvbnRhaW5lci5jb2xsYXBzZSgpCgk8L3NjcmlwdD4KCTxzdHlsZT4KCWJvbmRzbGlzdC1oZWFkZXIgewogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgZGlzcGxheTogZmxleDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7Cn0KYm9uZHNsaXN0LWhlYWRlcjpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAwcHg7CiAgYm90dG9tOiAwcHg7CiAgbGVmdDogMHB4OwogIHJpZ2h0OiAwcHg7CiAgei1pbmRleDogLTE7CiAgYmFja2dyb3VuZDogI2ZmYWM0NTQwOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0ID4gYm9uZHNsaXN0LWhlYWRlciB7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBwYWRkaW5nLXRvcDogMTJweDsKICBtYXJnaW4tdG9wOiAtMTJweDsKICB6LWluZGV4OiAxMDsKfQpib25kc2xpc3QtY29udGVudHMgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0OmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogYmxvY2s7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBqdXN0aWZ5LXNlbGY6IGNlbnRlcjsKICBib3JkZXItYm90dG9tOiAycHggc29saWQ7CiAgcGFkZGluZy10b3A6IDVweDsKICB3aWR0aDogMTAwJTsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICB6LWluZGV4OiAyMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLmJvbmRzbGlzdC1pY29uIHsKICAtLXNpemU6IDE3cHg7CiAgZGlzcGxheTogYmxvY2s7CiAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogIHdpZHRoOiB2YXIoLS1zaXplKTsKICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogIGN1cnNvcjogcG9pbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCA+IGJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgd2lkdGg6IDMwcHg7CiAgbWFyZ2luOiAwIDEwcHg7Cn0KYm9uZHNsaXN0LWhlYWRlciB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICB3aWR0aDogMTAwJTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgZmxleC1ncm93OiAxOwogIGZvbnQtc2l6ZTogMThweDsKICBmb250LXdlaWdodDogNjAwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBhbGlnbi1zZWxmOiBjZW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgYm9uZHNsaXN0LWhlYWRlciArICogewogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQpib25kc2xpc3QtY29udGFpbmVyIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgcm93LWdhcDogNXB4Owp9CmJvbmRzdGFibGUtY29udGFpbmVyIGJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CgkJCgk8L3N0eWxlPgo8L2JvbmRzbGlzdC1jb250YWluZXI+Cjxib25kc2xpc3QtY29udGFpbmVyIGNsYXNzPSduby1wb3BvdXQnPgoJPGJvbmRzbGlzdC1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2NvbGxhcHNlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJyB0aXRsZT0iVGhpcyBsaXN0IGNvbnRhaW5zIGluZGVwZW5kZW50IGJvbmRzIj5Qb3BvdXQgQ29udGFpbmVyPC9zcGFuPgoJCTxzcGFuIGNsYXNzPSd0b2dnbGUgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCTwvYm9uZHNsaXN0LWhlYWRlcj4KCTxib25kc2xpc3QtY29udGVudHM+Cgk8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgYXNkYCc+CgkJU3RydWN0dXJlIEFTRAoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSdoaGxxYmdxb3FnJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2djem56aHBycXQnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxib25kIGRlZj0iYXNkIiB1bmlxdWVfaWQ9Im5acjlPNDdpOFMyNiI+PHN0cnVjdC1ib25kIGNsYXNzPSdNYWluLnZhciZxdW90O3dvcmtzcGFjZSM1NiZxdW90Oy5BU0QnPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5BU0Q8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdsbXR3eHllYXFyJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPk1hcmtkb3duIGRlc2NyaXB0aW9uLCBpbmNsdWRpbmcgPHNwYW4gY2xhc3M9InRleCI+JExhVGVYJDwvc3Bhbj48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0cnhnenFqZ3dmJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3RyeGd6cWpnd2YnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ0cnhnenFqZ3dmIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZXNudHZzbWxiaycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNjcmlwdD4KLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4Kd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCmNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQpjb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgpjb25zdCB2YWx1ZXMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTBdCgpjb25zdCBlbCA9IGh0bWxgCjxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKdG91Y2gtYWN0aW9uOiBub25lOwpiYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CmNvbG9yOiBibGFjazsKcGFkZGluZzogMGVtIC4yZW07CmJvcmRlci1yYWRpdXM6IC4zZW07CmZvbnQtd2VpZ2h0OiBib2xkOyI+Njwvc3Bhbj4KYAoKCgpsZXQgb2xkX3ggPSAwCmxldCBvbGRfaW5kZXggPSAwCmNvbnN0IGluaXRpYWxfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgNikKbGV0IGN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4Cgpjb25zdCBmb3JtYXR0ZXIgPSBzID0+ICIiICsgZDNmb3JtYXQuZm9ybWF0KCIiKShzKSArICIiCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlc1tjdXJyZW50X2luZGV4XSwKCXNldDogeCA9PiB7CgkJY3VycmVudF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCB4KQoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCX0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKLy8gaW5pdGlhbCB2YWx1ZQplbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoNikKCmNvbnN0IG9uU2NydWIgPSAoZSkgPT4gewoJY29uc3Qgb2Zmc2V0ID0gZS5jbGllbnRYIC0gb2xkX3gKCWNvbnN0IG5ld19pbmRleCA9IE1hdGgubWluKHZhbHVlcy5sZW5ndGgtMSwgTWF0aC5tYXgoMCwgCgkJTWF0aC5yb3VuZChvZmZzZXQvMTApICsgb2xkX2luZGV4CgkpKQoKCWlmKG5ld19pbmRleCAhPT0gY3VycmVudF9pbmRleCkgewoJCWN1cnJlbnRfaW5kZXggPSBuZXdfaW5kZXgKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgl9Cn0KCmNvbnN0IG9ucG9pbnRlcmRvd24gPSAoZSkgPT4gewoJd2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KCkKCW9sZF94ID0gZS5jbGllbnRYCglvbGRfaW5kZXggPSBjdXJyZW50X2luZGV4Cgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CmVsLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCmNvbnN0IG9uZGJsY2xpY2sgPSAoZSkgPT4gewoJY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQp9CmVsLmFkZEV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCmNvbnN0IG9ucG9pbnRlcnVwID0gKCkgPT4gewoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgplbC5vbnNlbGVjdHN0YXJ0ID0gKCkgPT4gZmFsc2UKCmludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKfSkKCnJldHVybiBlbAoKPC9zY3JpcHQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZXNudHZzbWxiayc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVzbnR2c21sYmsiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5Ob3JtYWwgU3RyaW5nIERlc2NyaXB0aW9uPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3F1b3Fta2lnamgnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSd0ZXh0JyB2YWx1ZT0nJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdxdW9xbWtpZ2poJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAicXVvcW1raWdqaCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHN2dnp3emZ0bCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nZCc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nZCcgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgZGAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5UaGlzIGZpZWxkIGlzIDxlbT5zcGVjaWFsPC9lbT48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdkJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdmY2l6emJ6Z3dhJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZmNpenpiemd3YSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImZjaXp6Ynpnd2EiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2UnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2UnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGVgIj5lPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2UnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2RpZ21pd3d0dm0nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzYnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdkaWdtaXd3dHZtJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZGlnbWl3d3R2bSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J3RzdnZ6d3pmdGwnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ0c3Z2end6ZnRsIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQkKCTxzY3JpcHQ+CgkJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBgQVNEYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdsbXR3eHllYXFyJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibG10d3h5ZWFxciIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nb3R4ZnJweWVzZyc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J21rdXJ0dnpvYXInPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJDdXN0b20gRGVzY3JpcHRpb24iCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvcG9wb3V0LWNvbnRlbnRzPgo8L3BvcG91dC1jb250YWluZXI+CjxzY3JpcHQgaWQ9J2hobHFiZ3FvcWcnPgoJLy8gTG9hZCB0aGUgZmxvYXRpbmctdWkgYW5kIGludGVyYWN0IGxpYnJhcmllcwoJd2luZG93LmZsb2F0aW5nX3VpID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9AZmxvYXRpbmctdWkvZG9tJykKCgljb25zdCB7IGNvbXB1dGVQb3NpdGlvbiwgYXV0b1BsYWNlbWVudCB9ID0gZmxvYXRpbmdfdWkKCQoJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgljb25zdCBoZWFkZXIgPSBjb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGNvbnRlbnRzID0gY29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQKCgkvLyBMb2FkIHRoZSBpbnRlcmFjdGpzIHBhcnQKCQoJLy8gV2UgdXNlIHRoZSBpbnRlcmFjdGpzIGxpYnJhcnkgdG8gcHJvdmlkZSBkcmFnIGFuZCByZXNpemUgaGFuZGxpbmcgYWNyb3NzIGRldmljZXMKCWNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgoJY29udGVudHMub2Zmc2V0ID0gY29udGVudHMub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuZGVzY3JpcHRpb24sIGJvbmRzbGlzdC1oZWFkZXIgLmRlc2NyaXB0aW9uJykpLmRyYWdnYWJsZSh7CgkJbGlzdGVuZXJzOiB7CgkJCXN0YXJ0IChldmVudCkgewoJCQkJY29udGVudHMub2Zmc2V0LnkgPSBzdGFydFBvc2l0aW9uLnkgPSBjb250ZW50cy5vZmZzZXRUb3AKCQkJCWNvbnRlbnRzLm9mZnNldC54ID0gc3RhcnRQb3NpdGlvbi54ID0gY29udGVudHMub2Zmc2V0TGVmdAoJCQl9LAoJCQltb3ZlIChldmVudCkgewoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGVudHMub2Zmc2V0LnkgKz0gZXZlbnQuZHkKCQkKCQkgICAgICBjb250ZW50cy5zdHlsZS50b3AgPSBgbWluKDk1dmgsICR7Y29udGVudHMub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGVudHMuc3R5bGUubGVmdCA9IGBtaW4oOTV2dywgJHtjb250ZW50cy5vZmZzZXQueH1weGAKCQkgICAgfSwKCQl9Cgl9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIGhlYWRlciByZXNldCB0aGUgcG9zaXRpb24KCQljb250YWluZXIucG9wb3V0KCkKCX0pCglpbnRlcmFjdChjb250ZW50cykKCSAgLnJlc2l6YWJsZSh7CgkgICAgZWRnZXM6IHsgdG9wOiB0cnVlLCBsZWZ0OiBmYWxzZSwgYm90dG9tOiB0cnVlLCByaWdodDogdHJ1ZSB9LAoJICAgIGxpc3RlbmVyczogewoJICAgICAgbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7CQkKCSAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudC50YXJnZXQuc3R5bGUsIHsKCSAgICAgICAgICB3aWR0aDogYCR7ZXZlbnQucmVjdC53aWR0aH1weGAsCgkgICAgICAgICAgaGVpZ2h0OiBgJHtldmVudC5yZWN0LmhlaWdodH1weGAsCgkgICAgICAgIH0pCgkgICAgICB9CgkgICAgfQoJICB9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIHJlc2l6ZSByZXNldCB0aGUgd2lkdGgKCQkJY29udGVudHMuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRlbnRzLnN0eWxlLmhlaWdodCA9ICcnCgkgIH0pCgoKCWZ1bmN0aW9uIHBvc2l0aW9uQ29udGVudHMoKSB7CgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFthdXRvUGxhY2VtZW50KCldLAoJCX0pLnRoZW4oKHBvcykgPT4gewoJCQljb250ZW50cy5zdHlsZS5sZWZ0ID0gcG9zLnggKyAicHgiCgkJCWNvbnRlbnRzLnN0eWxlLnRvcCA9IHBvcy55ICsgInB4IgoJCX0pCgl9CgoJY29udGFpbmVyLnBvcG91dCA9IChmb3JjZSA9IHVuZGVmaW5lZCkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdwb3BwZWQnLCBmb3JjZSkKCQlwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCgloZWFkZXIub25jbGljayA9IChlKSA9PiB7Y29udGFpbmVyLnBvcG91dCgpfQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCB0cnVlKQoJY29udGVudHMub25tb3VzZWxlYXZlID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50cy1ob3ZlcicsIGZhbHNlKQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJfQoJaGVhZGVyLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgZmFsc2UpCjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdnY3puemhwcnF0Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZ2N6bnpocHJxdCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+Cjxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBudGAnPgoJCU5hbWVkVHVwbGUKCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwb3BvdXQtY29udGFpbmVyIGtleT0nbHVxcGl0d3VkZyc+Cgk8cG9wb3V0LWhlYWRlcj48c3BhbiBjbGFzcz0ncG9wb3V0LWljb24gcG9wb3V0Jz48L3NwYW4+PC9wb3BvdXQtaGVhZGVyPgoJPHBvcG91dC1jb250ZW50cz48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZm1weXB5Y25oJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48Ym9uZCBkZWY9Im50IiB1bmlxdWVfaWQ9IlcwU3Y5ZFF0NlhoZCI+PHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyMzImcXVvdDspLCA6YSwgOmIsIDpjKX0nPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5OYW1lZFR1cGxlPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbXVnYnRna3Fmcycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnVlbm9lZGJieCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPkRlc2NyaXB0aW9uPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2EnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3NhanhtbWN6dXAnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nc2FqeG1tY3p1cCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInNhanhtbWN6dXAiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2InPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2InIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGJgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+PHN0cm9uZz5Cb2xkPC9zdHJvbmc+IGZpZWxkPC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nenZoaW94eW9haScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd6dmhpb3h5b2FpJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAienZoaW94eW9haSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnVlbm9lZGJieCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYycgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgY2AiPmM8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnNpenVsdHVyYycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdic2l6dWx0dXJjJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiYnNpenVsdHVyYyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2J1ZW5vZWRiYngnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJidWVub2VkYmJ4Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQkKCTxzY3JpcHQ+CgkJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBgTmFtZWRUdXBsZWAiKQoKCQkvLyBhZGQgdGhlIGNvbGxhcHNlIGJ1dHRvbgoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGh0bWxgPHNwYW4gY2xhc3M9J2NvbGxhcHNlJz5gCgkJaGVhZGVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGNvbGxhcHNlX2J0bikKCgkJdHJjLmNvbGxhcHNlID0gKCkgPT4gewogIAkJCXRyYy5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQoJCX0KCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gdHJjLmNvbGxhcHNlKCkKCQkKCTwvc2NyaXB0PgoJCTxzdHlsZT4KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogY29udGVudHM7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCQkJZmxleDogMTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZ3JpZC1jb2x1bW46IDEgLyAtMTsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCS0tc2l6ZTogMTdweDsKCQkJICAgIGRpc3BsYXk6IGJsb2NrOwoJCQkgICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKCQkJICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkJCSAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwoJCQkgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwoJCQkgICAgd2lkdGg6IHZhcigtLXNpemUpOwoJCQkgICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgPiB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCQlhbGlnbi1pdGVtczogc3RyZXRjaDsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQlmbGV4LWdyb3c6IDE7CgkJCQlmb250LXNpemU6IDE4cHg7CgkJCQlmb250LXdlaWdodDogNjAwOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewoJCQkJYWxpZ24tc2VsZjogY2VudGVyCgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgKyAqIHsKCQkJCWRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nbXVnYnRna3Fmcyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm11Z2J0Z2txZnMiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J2p3Z2VvdGR2bXMnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdyYnh3eGxyYnVnJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5pbm5lckhUTUwgPSAiTXkgRmFuY3kgTlR1cGxlIgoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdsdXFwaXR3dWRnJz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbScpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkKCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewoJCWNvbXB1dGVQb3NpdGlvbihoZWFkZXIsIGNvbnRlbnRzLCB7CgkJCXN0cmF0ZWd5OiAiZml4ZWQiLAoJCQltaWRkbGV3YXJlOiBbYXV0b1BsYWNlbWVudCgpXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgljb250ZW50cy5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCBmYWxzZSkKCgloZWFkZXIub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgdHJ1ZSkKCQljb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3BwZWQnKSA/IG51bGwgOiBwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIGZhbHNlKQo8L3NjcmlwdD4KPHN0eWxlPgoJcG9wb3V0LWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYm9yZGVyOiAzcHggZGFzaGVkIHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwp9CnBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBub25lOwogICAgd2lkdGg6IDQwMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tb3ZlcmxheS1idXR0b24tYm9yZGVyKTsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBwYWRkaW5nOiA4cHg7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgPiBwb3BvdXQtY29udGVudHMsCnBvcG91dC1jb250YWluZXIuaGVhZGVyLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgei1pbmRleDogNTAwOwp9CnBvcG91dC1jb250YWluZXIuY29udGVudHMtaG92ZXIgPiBwb3BvdXQtaGVhZGVyIHsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcGx1dG8tbG9ncy13YXJuLWFjY2VudC1jb2xvcik7Cn0KLnBvcG91dC1pY29uIHsKICAgIC0tc2l6ZTogMjBweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgbWluLWhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9Ci5wb3BvdXQtaWNvbi5wb3BvdXQgewkKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V4cGFuZC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIC5wb3BvdXQgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY29udHJhY3Quc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogICAgdG91Y2gtYWN0aW9uOiBub25lOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KPC9zdHlsZT4KPHNjcmlwdCBpZD0nbmZtcHlweWNuaCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm5mbXB5cHljbmgiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgoJCgk8L2JvbmRzbGlzdC1jb250ZW50cz4KCTxzY3JpcHQgaWQ9J2RndGJ1dXpvdXYnPgoJCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnRhaW5lci5jb2xsYXBzZSA9IChmb3JjZSkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJywgZm9yY2UpCgkJfQoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuLmNvbGxhcHNlJykKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBjb250YWluZXIuY29sbGFwc2UoKQoJPC9zY3JpcHQ+Cgk8c3R5bGU+Cglib25kc2xpc3QtaGVhZGVyIHsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGRpc3BsYXk6IGZsZXg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwp9CmJvbmRzbGlzdC1oZWFkZXI6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMHB4OwogIGJvdHRvbTogMHB4OwogIGxlZnQ6IDBweDsKICByaWdodDogMHB4OwogIHotaW5kZXg6IC0xOwogIGJhY2tncm91bmQ6ICNmZmFjNDU0MDsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dCA+IGJvbmRzbGlzdC1oZWFkZXIgewogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgcGFkZGluZy10b3A6IDEycHg7CiAgbWFyZ2luLXRvcDogLTEycHg7CiAgei1pbmRleDogMTA7Cn0KYm9uZHNsaXN0LWNvbnRlbnRzIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dDpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGJsb2NrOwogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAganVzdGlmeS1zZWxmOiBjZW50ZXI7CiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkOwogIHBhZGRpbmctdG9wOiA1cHg7CiAgd2lkdGg6IDEwMCU7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgei1pbmRleDogMjA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5ib25kc2xpc3QtaWNvbiB7CiAgLS1zaXplOiAxN3B4OwogIGRpc3BsYXk6IGJsb2NrOwogIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgPiBib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAzMHB4OwogIG1hcmdpbjogMCAxMHB4Owp9CmJvbmRzbGlzdC1oZWFkZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgd2lkdGg6IDEwMCU7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIGZsZXgtZ3JvdzogMTsKICBmb250LXNpemU6IDE4cHg7CiAgZm9udC13ZWlnaHQ6IDYwMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgYWxpZ24tc2VsZjogY2VudGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkIGJvbmRzbGlzdC1oZWFkZXIgKyAqIHsKICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHJvdy1nYXA6IDVweDsKfQpib25kc3RhYmxlLWNvbnRhaW5lciBib25kc2xpc3QtY29udGFpbmVyIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQoJCQoJPC9zdHlsZT4KPC9ib25kc2xpc3QtY29udGFpbmVyPgoKCTwvYm9uZHRhYmxlLWNvbnRlbnRzPgo8L2JvbmR0YWJsZS1jb250YWluZXI+CjxzY3JpcHQgaWQ9J2d0a3pyeXFybGsnPgoJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgljb25zdCBoZWFkZXIgPSBjb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGNvbnRlbnRzID0gY29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQKCgljb25zdCBjZWxsID0gY29udGFpbmVyLmNsb3Nlc3QoJ3BsdXRvLWNlbGwnKQoKCQoJY29uc3QgaGVscF9idG4gPSBoZWFkZXIuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGNvbGxhcHNlX2J0biA9IGhlYWRlci5sYXN0RWxlbWVudENoaWxkCgoJY29udGFpbmVyLmNvbGxhcHNlID0gKGZvcmNlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcsIGZvcmNlKQoJfQoJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSBlID0+IGNvbnRhaW5lci5jb2xsYXBzZSgpCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3Qgc2NyaXB0CgkKCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRhaW5lci5vZmZzZXQgPSBjb250YWluZXIub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdib25kdGFibGUtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRhaW5lci5vZmZzZXQueSA9IHN0YXJ0UG9zaXRpb24ueSA9IGNvbnRhaW5lci5vZmZzZXRUb3AKCQkJCWNvbnRhaW5lci5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRhaW5lci5vZmZzZXRMZWZ0CgkJCX0sCgkJCW1vdmUgKGV2ZW50KSB7CgkJICAgICAgY29udGFpbmVyLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGFpbmVyLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IGBtaW4oOTV2aCwgJHtjb250YWluZXIub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGFpbmVyLm9mZnNldC54fXB4YAoJCSAgICB9LAoJCX0KCX0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gaGVhZGVyIHJlc2V0IHRoZSBwb3NpdGlvbgoJCWNvbnRhaW5lci5zdHlsZS50b3AgPSAnJwoJCWNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gJycKCX0pCglpbnRlcmFjdChjb250YWluZXIpCgkgIC5yZXNpemFibGUoewoJCWlnbm9yZUZyb206ICdwb3BvdXQtY29udGFpbmVyJywKCSAgICBlZGdlczogeyB0b3A6IHRydWUsIGxlZnQ6IGZhbHNlLCBib3R0b206IHRydWUsIHJpZ2h0OiB0cnVlIH0sCgkgICAgbGlzdGVuZXJzOiB7CgkgICAgICBtb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHsJCQoJICAgICAgICBPYmplY3QuYXNzaWduKGV2ZW50LnRhcmdldC5zdHlsZSwgewoJICAgICAgICAgIHdpZHRoOiBgJHtldmVudC5yZWN0LndpZHRofXB4YCwKCSAgICAgICAgICBoZWlnaHQ6IGAke2V2ZW50LnJlY3QuaGVpZ2h0fXB4YCwKCQkJICBtYXhIZWlnaHQ6ICdub25lJywKCSAgICAgICAgfSkKCSAgICAgIH0KCSAgICB9CgkgIH0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gcmVzaXplIHJlc2V0IHRoZSB3aWR0aAoJCQljb250YWluZXIuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnJwoJCSAgCWNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSAnJwoJICB9KQoKCgkvLyBOb3cgd2UgYXNzaWduIGEgc3BlY2lmaWMgY2xhc3MgdG8gYWxsIHRvZ2dsZS1jb250YWluZXIgdGhhdCBhcmUgZGlyZWN0IGNoaWxkcmVuCglmb3IgKGNvbnN0IHRyIG9mIGNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpKSB7CgkJdHIuY2xvc2VzdCgncG9wb3V0LWNvbnRhaW5lcicpID8/IHRyLmNsYXNzTGlzdC50b2dnbGUoJ25vLXBvcG91dCcsIHRydWUpCgl9CgkvLyBXZSBhbHNvIGZsYWcgdGhlIGZpcnN0IHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBpbiB0aGUgdGFibGUKCWNvbnRlbnRzLmZpcnN0RWxlbWVudENoaWxkLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5uby1wb3BvdXQnKT8uY2xhc3NMaXN0LnRvZ2dsZSgnZmlyc3QnLHRydWUpCgoJLy8gQ2xpY2sgdG8gZ28gdG8gZGVmaW5pdGlvbgoJY29udGFpbmVyLmp1bXBUb0NlbGwgPSAoKSA9PiB7CgkJY2VsbC5zY3JvbGxJbnRvVmlldygpCgl9CgloZWxwX2J0bi5vbmNsaWNrID0gY29udGFpbmVyLmp1bXBUb0NlbGwKPC9zY3JpcHQ+CjxzdHlsZT4KCWJvbmR0YWJsZS1jb250YWluZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDUwcHg7CiAgICBsZWZ0OiAxMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgYm9yZGVyOiAzcHggc29saWQgI2U3ZTdlNzsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBwYWRkaW5nLWxlZnQ6IDhweDsKICAgIHBhZGRpbmctdG9wOiA4cHg7CiAgICB6LWluZGV4OiA2MDA7CiAgICB3aWR0aDogNDAwcHg7CiAgICBtYXgtaGVpZ2h0OiA2MDBweDsKICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAzMDBtcyBjdWJpYy1iZXppZXIoMC4xOCwgMC44OSwgMC40NSwgMS4xMik7Cn0KYm9uZHRhYmxlLWNvbnRhaW5lcjpub3QoLmNvbGxhcHNlZCkgPiAqIHsKICAgIHBhZGRpbmctcmlnaHQ6IDhweDsKfQpib25kdGFibGUtY29udGVudHMgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgcGFkZGluZy1ib3R0b206IDhweDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICBvdmVyZmxvdzogYXV0bzsKfQpib25kdGFibGUtY29udGVudHMgdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLm5vLXBvcG91dCwKYm9uZHRhYmxlLWNvbnRlbnRzID4gKiwgCmJvbmR0YWJsZS1jb250ZW50cyBzdHJ1Y3QtYm9uZCB7CiAgICBkaXNwbGF5OiBjb250ZW50cwp9CnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5uby1wb3BvdXQ6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgZGlzcGxheTogYmxvY2s7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAganVzdGlmeS1zZWxmOiBjZW50ZXI7CiAgICBib3JkZXItYm90dG9tOiAycHggc29saWQ7CiAgICBwYWRkaW5nLXRvcDogNXB4OwogICAgd2lkdGg6IDEwMCU7CiAgICBhbGlnbi1zZWxmOiBzdGFydDsKICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICB0b3A6IDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIHotaW5kZXg6IDIwOwp9CnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5uby1wb3BvdXQgPiB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgICBwb3NpdGlvbjogc3RpY2t5OwogICAgdG9wOiAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBwYWRkaW5nLXRvcDogMTJweDsKICAgIG1hcmdpbi10b3A6IC0xMnB4OwogICAgei1pbmRleDogMTA7Cn0KYm9uZHRhYmxlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1pdGVtczogc3RyZXRjaDsKfQpib25kdGFibGUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIGZsZXgtZ3JvdzogMTsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZvbnQtc2l6ZTogMjBweDsKICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQpib25kdGFibGUtaGVhZGVyID4gLmljb24gewogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQpib25kdGFibGUtaGVhZGVyIC50YWJsZS1jb2xsYXBzZSB7CiAgICAtLXNpemU6IDIzcHg7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvYXJyb3ctYmFjay5zdmciKTsKfQpib25kdGFibGUtY29udGFpbmVyLmNvbGxhcHNlZCAudGFibGUtY29sbGFwc2UgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL29wdGlvbnMtb3V0bGluZS5zdmciKTsKICAgIG1hcmdpbi1yaWdodDogMHB4Owp9CmJvbmR0YWJsZS1jb250YWluZXIuY29sbGFwc2VkIC50YWJsZS1jb2xsYXBzZTpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvYXJyb3ctZm9yd2FyZC5zdmciKTsKfQpib25kdGFibGUtY29udGFpbmVyLmNvbGxhcHNlZCB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoY2FsYygtMTAwJSArIDM1cHgpKTsKICAgIGhlaWdodDogYXV0byAhaW1wb3J0YW50OwogICAgbGVmdDogMHB4ICFpbXBvcnRhbnQ7CiAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgcGFkZGluZzogNXB4Owp9CmJvbmR0YWJsZS1jb250YWluZXIuY29sbGFwc2VkIGJvbmR0YWJsZS1jb250ZW50cywKYm9uZHRhYmxlLWNvbnRhaW5lci5jb2xsYXBzZWQgc2VwYXJhdG9yIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykgewogICAgYm9uZHRhYmxlLWNvbnRhaW5lciB7CiAgICAgICAgYm9yZGVyLWNvbG9yOiAjN2Q3ZDdkOwogICAgfQp9Cjwvc3R5bGU+CgqkbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8ImNoXymwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzWpTtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedpqCTxib25kIGRlZj0iYXNkIiB1bmlxdWVfaWQ9Im5acjlPNDdpOFMyNiI+PHN0cnVjdC1ib25kIGNsYXNzPSdBU0QnPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5BU0Q8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdsbXR3eHllYXFyJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPk1hcmtkb3duIGRlc2NyaXB0aW9uLCBpbmNsdWRpbmcgPHNwYW4gY2xhc3M9InRleCI+JExhVGVYJDwvc3Bhbj48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0cnhnenFqZ3dmJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3RyeGd6cWpnd2YnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ0cnhnenFqZ3dmIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZXNudHZzbWxiaycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNjcmlwdD4KLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4Kd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCmNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQpjb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgpjb25zdCB2YWx1ZXMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTBdCgpjb25zdCBlbCA9IGh0bWxgCjxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKdG91Y2gtYWN0aW9uOiBub25lOwpiYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CmNvbG9yOiBibGFjazsKcGFkZGluZzogMGVtIC4yZW07CmJvcmRlci1yYWRpdXM6IC4zZW07CmZvbnQtd2VpZ2h0OiBib2xkOyI+Njwvc3Bhbj4KYAoKCgpsZXQgb2xkX3ggPSAwCmxldCBvbGRfaW5kZXggPSAwCmNvbnN0IGluaXRpYWxfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgNikKbGV0IGN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4Cgpjb25zdCBmb3JtYXR0ZXIgPSBzID0+ICIiICsgZDNmb3JtYXQuZm9ybWF0KCIiKShzKSArICIiCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlc1tjdXJyZW50X2luZGV4XSwKCXNldDogeCA9PiB7CgkJY3VycmVudF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCB4KQoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCX0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKLy8gaW5pdGlhbCB2YWx1ZQplbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoNikKCmNvbnN0IG9uU2NydWIgPSAoZSkgPT4gewoJY29uc3Qgb2Zmc2V0ID0gZS5jbGllbnRYIC0gb2xkX3gKCWNvbnN0IG5ld19pbmRleCA9IE1hdGgubWluKHZhbHVlcy5sZW5ndGgtMSwgTWF0aC5tYXgoMCwgCgkJTWF0aC5yb3VuZChvZmZzZXQvMTApICsgb2xkX2luZGV4CgkpKQoKCWlmKG5ld19pbmRleCAhPT0gY3VycmVudF9pbmRleCkgewoJCWN1cnJlbnRfaW5kZXggPSBuZXdfaW5kZXgKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgl9Cn0KCmNvbnN0IG9ucG9pbnRlcmRvd24gPSAoZSkgPT4gewoJd2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KCkKCW9sZF94ID0gZS5jbGllbnRYCglvbGRfaW5kZXggPSBjdXJyZW50X2luZGV4Cgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CmVsLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCmNvbnN0IG9uZGJsY2xpY2sgPSAoZSkgPT4gewoJY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQp9CmVsLmFkZEV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCmNvbnN0IG9ucG9pbnRlcnVwID0gKCkgPT4gewoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgplbC5vbnNlbGVjdHN0YXJ0ID0gKCkgPT4gZmFsc2UKCmludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKfSkKCnJldHVybiBlbAoKPC9zY3JpcHQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZXNudHZzbWxiayc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVzbnR2c21sYmsiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5Ob3JtYWwgU3RyaW5nIERlc2NyaXB0aW9uPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3F1b3Fta2lnamgnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSd0ZXh0JyB2YWx1ZT0nJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdxdW9xbWtpZ2poJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAicXVvcW1raWdqaCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHN2dnp3emZ0bCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nZCc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nZCcgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgZGAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5UaGlzIGZpZWxkIGlzIDxlbT5zcGVjaWFsPC9lbT48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdkJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdmY2l6emJ6Z3dhJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZmNpenpiemd3YSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImZjaXp6Ynpnd2EiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2UnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2UnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGVgIj5lPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2UnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2RpZ21pd3d0dm0nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzYnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdkaWdtaXd3dHZtJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZGlnbWl3d3R2bSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J3RzdnZ6d3pmdGwnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ0c3Z2end6ZnRsIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQkKCTxzY3JpcHQ+CgkJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBgQVNEYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdsbXR3eHllYXFyJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibG10d3h5ZWFxciIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nb3R4ZnJweWVzZyc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J21rdXJ0dnpvYXInPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJDdXN0b20gRGVzY3JpcHRpb24iCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8IJqfxLWwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgWZDpC1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjSKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijQk9IqGVsZW1lbnRzkZKjbWFokoWmcHJlZml4o01BSKhlbGVtZW50c5GSoWGSoTGqdGV4dC9wbGFpbqR0eXBlpnN0cnVjdKxwcmVmaXhfc2hvcnSjTUFIqG9iamVjdGlksDViY2E3YzY5YzhjY2Q5MDfZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKR0eXBlpnN0cnVjdKxwcmVmaXhfc2hvcnSjQk9IqG9iamVjdGlksDViY2E3YzY5OWRkNjE4NzWkbWltZdkhYXBwbGljYXRpb24vdm5kLnBsdXRvLnRyZWUrb2JqZWN0rHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPCB4FzQBsHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjS5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZTy1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijTE9MqGVsZW1lbnRzkpKhYZKhNap0ZXh0L3BsYWlukqFikqE0qnRleHQvcGxhaW6kdHlwZaZzdHJ1Y3SscHJlZml4X3Nob3J0o0xPTKhvYmplY3RpZK9kNTE5Y2YxMmZiOTI3NTGkbWltZdkhYXBwbGljYXRpb24vdm5kLnBsdXRvLnRyZWUrb2JqZWN0rHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPCGSEJprsHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZTK1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NziKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijQVNEqGVsZW1lbnRzlZKhYZKhM6p0ZXh0L3BsYWlukqFikqE5qnRleHQvcGxhaW6SoWOSrCJsb2xhc2Rhc2RmIqp0ZXh0L3BsYWlukqFkkqIiIqp0ZXh0L3BsYWlukqFlkqIyMKp0ZXh0L3BsYWlupHR5cGWmc3RydWN0rHByZWZpeF9zaG9ydKNBU0Sob2JqZWN0aWSwZDAyNTlkY2RlMWM4NWQ3YqRtaW1l2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3Sscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8Iml0xKCwcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lMbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmmMS41ZTEwpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwiBSfseLBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMzuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWUvtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoB0zxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5HZW5lcmF0aW5nIGF1dG9tYXRpYyB3aWRnZXRzIGZvciBjdXN0b20gc3RydWN0cyBpcyBxdWl0ZSBzdHJhaWdodGZvcndhcmQgd2l0aCB0aGUgYWlkIG9mIHRoZSA8Y29kZT5AZmllbGRkYXRhPC9jb2RlPiBtYWNybyBhbmQgdGhlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IHR5cGUuPC9wPgo8cD5UaGUgdG9wLWxlZnQgYXJyb3cgY2FuIGJlIHVzZWQgdG8gc2hvdy1oaWRlIHRoZSBmaWVsZCBlbGVtZW50cyAmIzQwO3VzZWZ1bCBpbnNpZGUgYSA8Y29kZT5Cb25kVGFibGU8L2NvZGU+LCBzaG93biBiZWxvdyYjNDE7LCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLjwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCZN05NsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTC5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABOBAtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEyiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedk6PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxoMj5EZWZhdWx0IFR5cGUgV2lkZ2V0czwvaDI+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2Twazd264LBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEyuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAOVIrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZLTxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+QE5UQm9uZDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTdod7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAL4J7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmgpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQnU4c57BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhmuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAqlxnrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZLjxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+UGFja2FnZXM8L2gxPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJk3FECwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YblkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgADeB21cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ3MDcxNzVhOS1kMzU2LTQzY2YtODAzOC02MjBlYmM0MDFjOTOKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52tKnPHNjcmlwdD4KCQovLyBMb2FkIHRoZSBsaWJyYXJ5IGZvciBjb25zaXN0ZW50IHNtb290aCBzY3JvbGxpbmcKY29uc3Qge2RlZmF1bHQ6IHNjcm9sbEludG9WaWV3fSA9IGF3YWl0IGltcG9ydCgiZGF0YTp0ZXh0L2phdmFzY3JpcHQ7YmFzZTY0LGRtRnlJRkU5WlQwK0ltOWlhbVZqZENJOVBYUjVjR1Z2WmlCbEppWnVkV3hzSVQxbEppWXhQVDA5WlM1dWIyUmxWSGx3WlN4VlBTaGxMSFFwUFQ0b0lYUjhmQ0pvYVdSa1pXNGlJVDA5WlNrbUppSjJhWE5wWW14bElpRTlQV1VtSmlKamJHbHdJaUU5UFdVc1FUMG9aU3gwS1QwK2UybG1LR1V1WTJ4cFpXNTBTR1ZwWjJoMFBHVXVjMk55YjJ4c1NHVnBaMmgwZkh4bExtTnNhV1Z1ZEZkcFpIUm9QR1V1YzJOeWIyeHNWMmxrZEdncGUyeGxkQ0JzUFdkbGRFTnZiWEIxZEdWa1UzUjViR1VvWlN4dWRXeHNLVHR5WlhSMWNtNGdWU2hzTG05MlpYSm1iRzkzV1N4MEtYeDhWU2hzTG05MlpYSm1iRzkzV0N4MEtYeDhLR1U5UG50c1pYUWdkRDBvWlQwK2UybG1LQ0ZsTG05M2JtVnlSRzlqZFcxbGJuUjhmQ0ZsTG05M2JtVnlSRzlqZFcxbGJuUXVaR1ZtWVhWc2RGWnBaWGNwY21WMGRYSnVJRzUxYkd3N2RISjVlM0psZEhWeWJpQmxMbTkzYm1WeVJHOWpkVzFsYm5RdVpHVm1ZWFZzZEZacFpYY3VabkpoYldWRmJHVnRaVzUwZldOaGRHTm9lM0psZEhWeWJpQnVkV3hzZlgwcEtHVXBPM0psZEhWeWJpRWhkQ1ltS0hRdVkyeHBaVzUwU0dWcFoyaDBQR1V1YzJOeWIyeHNTR1ZwWjJoMGZIeDBMbU5zYVdWdWRGZHBaSFJvUEdVdWMyTnliMnhzVjJsa2RHZ3BmU2tvWlNsOWNtVjBkWEp1SVRGOUxGZzlLR1VzZEN4c0xHOHNiaXh5TEdrc2N5azlQbkk4WlNZbWFUNTBmSHh5UG1VbUptazhkRDh3T25JOFBXVW1Kbk04UFd4OGZHaytQWFFtSm5NK1BXdy9jaTFsTFc4NmFUNTBKaVp6UEd4OGZISThaU1ltY3o1c1Aya3RkQ3R1T2pBc0pEMWxQVDVsTG5CaGNtVnVkRVZzWlcxbGJuUS9QeWhsTG1kbGRGSnZiM1JPYjJSbEtDa3VhRzl6ZEh4OGJuVnNiQ2tzZEhROUtHVXNkQ2s5UG50MllYSWdiQ3h2TEc0c2NqdHBaaWgwZVhCbGIyWWdaRzlqZFcxbGJuUStJblVpS1hKbGRIVnlibHRkTzJ4bGRIdHpZM0p2Ykd4TmIyUmxPbWtzWW14dlkyczZjeXhwYm14cGJtVTZZU3hpYjNWdVpHRnllVHBvTEhOcmFYQlBkbVZ5Wm14dmQwaHBaR1JsYmtWc1pXMWxiblJ6T25WOVBYUXNaejBpWm5WdVkzUnBiMjRpUFQxMGVYQmxiMllnYUQ5b09tVTlQbVVoUFQxb08ybG1LQ0ZSS0dVcEtYUm9jbTkzSUZSNWNHVkZjbkp2Y2lnaVNXNTJZV3hwWkNCMFlYSm5aWFFpS1R0c1pYUWdkajFrYjJOMWJXVnVkQzV6WTNKdmJHeHBibWRGYkdWdFpXNTBmSHhrYjJOMWJXVnVkQzVrYjJOMWJXVnVkRVZzWlcxbGJuUXNiVDFiWFN4M1BXVTdabTl5S0R0UktIY3BKaVpuS0hjcE95bDdhV1lvS0hjOUpDaDNLU2s5UFQxMktYdHRMbkIxYzJnb2R5azdZbkpsWVd0OWJuVnNiQ0U5ZHlZbWR6MDlQV1J2WTNWdFpXNTBMbUp2WkhrbUprRW9keWttSmlGQktHUnZZM1Z0Wlc1MExtUnZZM1Z0Wlc1MFJXeGxiV1Z1ZENsOGZHNTFiR3doUFhjbUprRW9keXgxS1NZbWJTNXdkWE5vS0hjcGZXeGxkQ0JYUFc1MWJHd2hQU2h2UFc1MWJHdzlQU2hzUFhkcGJtUnZkeTUyYVhOMVlXeFdhV1YzY0c5eWRDay9kbTlwWkNBd09td3VkMmxrZEdncFAyODZhVzV1WlhKWGFXUjBhQ3hJUFc1MWJHd2hQU2h5UFc1MWJHdzlQU2h1UFhkcGJtUnZkeTUyYVhOMVlXeFdhV1YzY0c5eWRDay9kbTlwWkNBd09tNHVhR1ZwWjJoMEtUOXlPbWx1Ym1WeVNHVnBaMmgwTEh0elkzSnZiR3hZT2w4c2MyTnliMnhzV1RwNGZUMTNhVzVrYjNjc2UyaGxhV2RvZERwRkxIZHBaSFJvT2xRc2RHOXdPazRzY21sbmFIUTZUQ3hpYjNSMGIyMDZXU3hzWldaME9rTjlQV1V1WjJWMFFtOTFibVJwYm1kRGJHbGxiblJTWldOMEtDa3NVajBpYzNSaGNuUWlQVDA5YzN4OEltNWxZWEpsYzNRaVBUMDljejlPT2lKbGJtUWlQVDA5Y3o5Wk9rNHJSUzh5TEZZOUltTmxiblJsY2lJOVBUMWhQME1yVkM4eU9pSmxibVFpUFQwOVlUOU1Pa01zUWoxYlhUdG1iM0lvYkdWMElFUTlNRHRFUEcwdWJHVnVaM1JvTzBRckt5bDdiR1YwSUU4OWJWdEVYU3g3YUdWcFoyaDBPbW9zZDJsa2RHZzZTU3gwYjNBNlV5eHlhV2RvZERweExHSnZkSFJ2YlRwNkxHeGxablE2Um4wOVR5NW5aWFJDYjNWdVpHbHVaME5zYVdWdWRGSmxZM1FvS1R0cFppZ2lhV1l0Ym1WbFpHVmtJajA5UFdrbUprNCtQVEFtSmtNK1BUQW1KbGs4UFVnbUprdzhQVmNtSms0K1BWTW1KbGs4UFhvbUprTStQVVltSmt3OFBYRXBZbkpsWVdzN2JHVjBJRWM5WjJWMFEyOXRjSFYwWldSVGRIbHNaU2hQS1N4S1BYQmhjbk5sU1c1MEtFY3VZbTl5WkdWeVRHVm1kRmRwWkhSb0xERXdLU3hMUFhCaGNuTmxTVzUwS0VjdVltOXlaR1Z5Vkc5d1YybGtkR2dzTVRBcExGQTljR0Z5YzJWSmJuUW9SeTVpYjNKa1pYSlNhV2RvZEZkcFpIUm9MREV3S1N4YVBYQmhjbk5sU1c1MEtFY3VZbTl5WkdWeVFtOTBkRzl0VjJsa2RHZ3NNVEFwTEdWbFBUQXNaWFE5TUN4bGJEMGliMlptYzJWMFYybGtkR2dpYVc0Z1R6OVBMbTltWm5ObGRGZHBaSFJvTFU4dVkyeHBaVzUwVjJsa2RHZ3RTaTFRT2pBc1pXODlJbTltWm5ObGRFaGxhV2RvZENKcGJpQlBQMDh1YjJabWMyVjBTR1ZwWjJoMExVOHVZMnhwWlc1MFNHVnBaMmgwTFVzdFdqb3dMR1Z1UFNKdlptWnpaWFJYYVdSMGFDSnBiaUJQUHpBOVBUMVBMbTltWm5ObGRGZHBaSFJvUHpBNlNTOVBMbTltWm5ObGRGZHBaSFJvT2pBc1pYSTlJbTltWm5ObGRFaGxhV2RvZENKcGJpQlBQekE5UFQxUExtOW1abk5sZEVobGFXZG9kRDh3T21vdlR5NXZabVp6WlhSSVpXbG5hSFE2TUR0cFppaDJQVDA5VHlsbFpUMGljM1JoY25RaVBUMDljejlTT2lKbGJtUWlQVDA5Y3o5U0xVZzZJbTVsWVhKbGMzUWlQVDA5Y3o5WUtIZ3NlQ3RJTEVnc1N5eGFMSGdyVWl4NEsxSXJSU3hGS1RwU0xVZ3ZNaXhsZEQwaWMzUmhjblFpUFQwOVlUOVdPaUpqWlc1MFpYSWlQVDA5WVQ5V0xWY3ZNam9pWlc1a0lqMDlQV0UvVmkxWE9sZ29YeXhmSzFjc1Z5eEtMRkFzWHl0V0xGOHJWaXRVTEZRcExHVmxQVTFoZEdndWJXRjRLREFzWldVcmVDa3NaWFE5VFdGMGFDNXRZWGdvTUN4bGRDdGZLVHRsYkhObGUyVmxQU0p6ZEdGeWRDSTlQVDF6UDFJdFV5MUxPaUpsYm1RaVBUMDljejlTTFhvcldpdGxiem9pYm1WaGNtVnpkQ0k5UFQxelAxZ29VeXg2TEdvc1N5eGFLMlZ2TEZJc1VpdEZMRVVwT2xJdEtGTXJhaTh5S1N0bGJ5OHlMR1YwUFNKemRHRnlkQ0k5UFQxaFAxWXRSaTFLT2lKalpXNTBaWElpUFQwOVlUOVdMU2hHSzBrdk1pa3JaV3d2TWpvaVpXNWtJajA5UFdFL1ZpMXhLMUFyWld3NldDaEdMSEVzU1N4S0xGQXJaV3dzVml4V0sxUXNWQ2s3YkdWMGUzTmpjbTlzYkV4bFpuUTZaV2tzYzJOeWIyeHNWRzl3T21Wa2ZUMVBPMlZsUFUxaGRHZ3ViV0Y0S0RBc1RXRjBhQzV0YVc0b1pXUXJaV1V2WlhJc1R5NXpZM0p2Ykd4SVpXbG5hSFF0YWk5bGNpdGxieWtwTEdWMFBVMWhkR2d1YldGNEtEQXNUV0YwYUM1dGFXNG9aV2tyWlhRdlpXNHNUeTV6WTNKdmJHeFhhV1IwYUMxSkwyVnVLMlZzS1Nrc1VpczlaV1F0WldVc1ZpczlaV2t0WlhSOVFpNXdkWE5vS0h0bGJEcFBMSFJ2Y0RwbFpTeHNaV1owT21WMGZTbDljbVYwZFhKdUlFSjlMR1k5WlQwK2UzWmhjaUIwTzNKbGRIVnliaUV4UFQwOVpUOTdZbXh2WTJzNkltVnVaQ0lzYVc1c2FXNWxPaUp1WldGeVpYTjBJbjA2S0hROVpTazlQVDFQWW1wbFkzUW9kQ2ttSmpBaFBUMVBZbXBsWTNRdWEyVjVjeWgwS1M1c1pXNW5kR2cvWlRwN1lteHZZMnM2SW5OMFlYSjBJaXhwYm14cGJtVTZJbTVsWVhKbGMzUWlmWDA3Wm5WdVkzUnBiMjRnWXlobExIUXBlM1poY2lCc08ybG1LQ0ZsTG1selEyOXVibVZqZEdWa2ZId2hLR1U5UG50c1pYUWdkRDFsTzJadmNpZzdkQ1ltZEM1d1lYSmxiblJPYjJSbE95bDdhV1lvZEM1d1lYSmxiblJPYjJSbFBUMDlaRzlqZFcxbGJuUXBjbVYwZFhKdUlUQTdkRDEwTG5CaGNtVnVkRTV2WkdVZ2FXNXpkR0Z1WTJWdlppQlRhR0ZrYjNkU2IyOTBQM1F1Y0dGeVpXNTBUbTlrWlM1b2IzTjBPblF1Y0dGeVpXNTBUbTlrWlgxeVpYUjFjbTRoTVgwcEtHVXBLWEpsZEhWeWJqdHBaaWdpYjJKcVpXTjBJajA5ZEhsd1pXOW1LR3c5ZENrbUppSm1kVzVqZEdsdmJpSTlQWFI1Y0dWdlppQnNMbUpsYUdGMmFXOXlLWEpsZEhWeWJpQjBMbUpsYUdGMmFXOXlLSFIwS0dVc2RDa3BPMnhsZENCdlBTSmliMjlzWldGdUlqMDlkSGx3Wlc5bUlIUjhmRzUxYkd3OVBYUS9kbTlwWkNBd09uUXVZbVZvWVhacGIzSTdabTl5S0d4bGRIdGxiRHB1TEhSdmNEcHlMR3hsWm5RNmFYMXZaaUIwZENobExHWW9kQ2twS1c0dWMyTnliMnhzS0h0MGIzQTZjaXhzWldaME9ta3NZbVZvWVhacGIzSTZiMzBwZlhaaGNpQmtMSEE5S0NrOVBpaGtmSHdvWkQwaWNHVnlabTl5YldGdVkyVWlhVzRnZDJsdVpHOTNQM0JsY21admNtMWhibU5sTG01dmR5NWlhVzVrS0hCbGNtWnZjbTFoYm1ObEtUcEVZWFJsTG01dmR5a3NaQ2dwS1R0bWRXNWpkR2x2YmlCaUtHVXBlMnhsZENCMFBVMWhkR2d1YldsdUtDaHdLQ2t0WlM1emRHRnlkRlJwYldVcEwyVXVaSFZ5WVhScGIyNHNNU2tzYkQxbExtVmhjMlVvZENrc2J6MWxMbk4wWVhKMFdDc29aUzU0TFdVdWMzUmhjblJZS1Nwc0xHNDlaUzV6ZEdGeWRGa3JLR1V1ZVMxbExuTjBZWEowV1NrcWJEdGxMbTFsZEdodlpDaHZMRzRzZEN4c0tTeHZJVDA5WlM1NGZIeHVJVDA5WlM1NVAzSmxjWFZsYzNSQmJtbHRZWFJwYjI1R2NtRnRaU2dvS1QwK1lpaGxLU2s2WlM1allpZ3BmV1oxYm1OMGFXOXVJSGtvWlN4MExHd3BlMnhsZENCdlBXRnlaM1Z0Wlc1MGN5NXNaVzVuZEdnK015WW1kbTlwWkNBd0lUMDlZWEpuZFcxbGJuUnpXek5kUDJGeVozVnRaVzUwYzFzelhUbzJNREFzYmoxaGNtZDFiV1Z1ZEhNdWJHVnVaM1JvUGpRbUpuWnZhV1FnTUNFOVBXRnlaM1Z0Wlc1MGMxczBYVDloY21kMWJXVnVkSE5iTkYwNlpUMCtNU3N0TFdVcVpTcGxLbVVxWlN4eVBXRnlaM1Z0Wlc1MGN5NXNaVzVuZEdnK05UOWhjbWQxYldWdWRITmJOVjA2ZG05cFpDQXdMR2s5WVhKbmRXMWxiblJ6TG14bGJtZDBhRDQyUDJGeVozVnRaVzUwYzFzMlhUcDJiMmxrSURBc2N6MWxMbk5qY205c2JFeGxablFzWVQxbExuTmpjbTlzYkZSdmNEdGlLSHR6WTNKdmJHeGhZbXhsT21Vc2JXVjBhRzlrS0hRc2JDeHZMRzRwZTJ4bGRDQnlQVTFoZEdndVkyVnBiQ2gwS1N4elBVMWhkR2d1WTJWcGJDaHNLVHRsTG5OamNtOXNiRXhsWm5ROWNpeGxMbk5qY205c2JGUnZjRDF6TEdrL0xpaDdkR0Z5WjJWME9tVXNaV3hoY0hObFpEcHZMSFpoYkhWbE9tNHNiR1ZtZERweUxIUnZjRHB6ZlNsOUxITjBZWEowVkdsdFpUcHdLQ2tzYzNSaGNuUllPbk1zYzNSaGNuUlpPbUVzZURwMExIazZiQ3hrZFhKaGRHbHZianB2TEdWaGMyVTZiaXhqWWpweWZTbDlkbUZ5SUUwOVpUMCtaU1ltSVdVdVltVm9ZWFpwYjNKOGZDSnpiVzl2ZEdnaVBUMDlaUzVpWldoaGRtbHZjaXhyUFdaMWJtTjBhVzl1S0dVc2RDbDdiR1YwSUd3OWRIeDhlMzA3Y21WMGRYSnVJRTBvYkNrL1l5aGxMSHRpYkc5amF6cHNMbUpzYjJOckxHbHViR2x1WlRwc0xtbHViR2x1WlN4elkzSnZiR3hOYjJSbE9td3VjMk55YjJ4c1RXOWtaU3hpYjNWdVpHRnllVHBzTG1KdmRXNWtZWEo1TEhOcmFYQlBkbVZ5Wm14dmQwaHBaR1JsYmtWc1pXMWxiblJ6T213dWMydHBjRTkyWlhKbWJHOTNTR2xrWkdWdVJXeGxiV1Z1ZEhNc1ltVm9ZWFpwYjNJNlpUMCtVSEp2YldselpTNWhiR3dvWlM1eVpXUjFZMlVvS0dVc2RDazlQbnRzWlhSN1pXdzZieXhzWldaME9tNHNkRzl3T25KOVBYUXNhVDF2TG5OamNtOXNiRXhsWm5Rc2N6MXZMbk5qY205c2JGUnZjRHR5WlhSMWNtNGdhVDA5UFc0bUpuTTlQVDF5UDJVNld5NHVMbVVzYm1WM0lGQnliMjFwYzJVb1pUMCtlU2h2TEc0c2NpeHNMbVIxY21GMGFXOXVMR3d1WldGelpTd29LVDArWlNoN1pXdzZieXhzWldaME9sdHBMRzVkTEhSdmNEcGJjeXh5WFgwcExHd3ViMjVUWTNKdmJHeERhR0Z1WjJVcEtWMTlMRnRkS1NsOUtUcFFjbTl0YVhObExuSmxjMjlzZG1Vb1l5aGxMSFFwS1gwN1pYaHdiM0owZTJzZ1lYTWdaR1ZtWVhWc2RIMDciKQoKY29uc3QgaW5kZW50ID0gdHJ1ZQpjb25zdCBhc2lkZSA9IHRydWUKY29uc3QgdGl0bGVfdGV4dCA9ICJUYWJsZSBvZiBDb250ZW50cyIKY29uc3QgaW5jbHVkZV9kZWZpbml0aW9ucyA9IGZhbHNlCgoKY29uc3QgdG9jTm9kZSA9IGh0bWxgPG5hdiBjbGFzcz0icGx1dG91aS10b2MiPgoJPGhlYWRlcj4KCSA8c3BhbiBjbGFzcz0idG9jLXRvZ2dsZSBvcGVuLXRvYyI+PC9zcGFuPgoJIDxzcGFuIGNsYXNzPSJ0b2MtdG9nZ2xlIGNsb3NlZC10b2MiPjwvc3Bhbj4KCSAke3RpdGxlX3RleHR9Cgk8L2hlYWRlcj4KCTxzZWN0aW9uPjwvc2VjdGlvbj4KPC9uYXY+YAoKdG9jTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCJhc2lkZSIsIGFzaWRlKQp0b2NOb2RlLmNsYXNzTGlzdC50b2dnbGUoImluZGVudCIsIGluZGVudCkKCgpjb25zdCBnZXRQYXJlbnRDZWxsID0gZWwgPT4gZWwuY2xvc2VzdCgicGx1dG8tY2VsbCIpCgpjb25zdCBnZXRIZWFkZXJzID0gKCkgPT4gewoJY29uc3QgZGVwdGggPSBNYXRoLm1heCgxLCBNYXRoLm1pbig2LCAzKSkgLy8gc2hvdWxkIGJlIGluIHJhbmdlIDE6NgoJY29uc3QgcmFuZ2UgPSBBcnJheS5mcm9tKHtsZW5ndGg6IGRlcHRofSwgKHgsIGkpID0+IGkrMSkgLy8gWzEsIC4uLiwgZGVwdGhdCgkKCWNvbnN0IHNlbGVjdG9yID0gWwoJCS4uLihpbmNsdWRlX2RlZmluaXRpb25zID8gWwoJCQlgcGx1dG8tbm90ZWJvb2sgcGx1dG8tY2VsbCAucGx1dG8tZG9jcy1iaW5kaW5nYCwgCgkJCWBwbHV0by1ub3RlYm9vayBwbHV0by1jZWxsIGFzc2lnbmVlOm5vdCg6ZW1wdHkpYCwgCgkJXSA6IFtdKSwKCQkuLi5yYW5nZS5tYXAoaSA9PiBgcGx1dG8tbm90ZWJvb2sgcGx1dG8tY2VsbCBoJHtpfWApCgldLmpvaW4oIiwiKQoJcmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpLmZpbHRlcihlbCA9PiAKCQkvLyBleGNsdWRlIGhlYWRlcnMgaW5zaWRlIG9mIGEgcGx1dG8tZG9jcy1iaW5kaW5nIGJsb2NrCgkJIShlbC5ub2RlTmFtZS5zdGFydHNXaXRoKCJIIikgJiYgZWwuY2xvc2VzdCgiLnBsdXRvLWRvY3MtYmluZGluZyIpKQoJKQp9CgoKY29uc3QgZG9jdW1lbnRfY2xpY2tfaGFuZGxlciA9IChldmVudCkgPT4gewoJY29uc3QgcGF0aCA9IChldmVudC5wYXRoIHx8IGV2ZW50LmNvbXBvc2VkUGF0aCgpKQoJY29uc3QgdG9jID0gcGF0aC5maW5kKGVsZW0gPT4gZWxlbT8uY2xhc3NMaXN0Py5jb250YWlucz8uKCJ0b2MtdG9nZ2xlIikpCglpZiAodG9jKSB7CgkJZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkKCQl0b2MuY2xvc2VzdCgiLnBsdXRvdWktdG9jIikuY2xhc3NMaXN0LnRvZ2dsZSgiaGlkZSIpCgl9Cn0KCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZG9jdW1lbnRfY2xpY2tfaGFuZGxlcikKCgpjb25zdCBoZWFkZXJfdG9faW5kZXhfZW50cnlfbWFwID0gbmV3IE1hcCgpCmNvbnN0IGN1cnJlbnRseV9oaWdobGlnaHRlZF9zZXQgPSBuZXcgU2V0KCkKCmNvbnN0IGxhc3RfdG9jX2VsZW1lbnRfY2xpY2tfdGltZSA9IHsgY3VycmVudDogMCB9Cgpjb25zdCBpbnRlcnNlY3Rpb25fY2FsbGJhY2sgPSAoaXhzKSA9PiB7CglsZXQgb25fdG9wID0gaXhzLmZpbHRlcihpeCA9PiBpeC5pbnRlcnNlY3Rpb25SYXRpbyA+IDAgJiYgaXguaW50ZXJzZWN0aW9uUmVjdC55IDwgaXgucm9vdEJvdW5kcy5oZWlnaHQgLyAyKQoJaWYob25fdG9wLmxlbmd0aCA+IDApewoJCWN1cnJlbnRseV9oaWdobGlnaHRlZF9zZXQuZm9yRWFjaChhID0+IGEuY2xhc3NMaXN0LnJlbW92ZSgiaW4tdmlldyIpKQoJCWN1cnJlbnRseV9oaWdobGlnaHRlZF9zZXQuY2xlYXIoKQoJCW9uX3RvcC5zbGljZSgwLDEpLmZvckVhY2goaSA9PiB7CgkJCWxldCBkaXYgPSBoZWFkZXJfdG9faW5kZXhfZW50cnlfbWFwLmdldChpLnRhcmdldCkKCQkJZGl2LmNsYXNzTGlzdC5hZGQoImluLXZpZXciKQoJCQljdXJyZW50bHlfaGlnaGxpZ2h0ZWRfc2V0LmFkZChkaXYpCgkJCQoJCQkvLy8gc2Nyb2xsIGludG8gdmlldwoJCQkvKgoJCQljb25zdCB0b2NfaGVpZ2h0ID0gdG9jTm9kZS5vZmZzZXRIZWlnaHQKCQkJY29uc3QgZGl2X3BvcyA9IGRpdi5vZmZzZXRUb3AKCQkJY29uc3QgZGl2X2hlaWdodCA9IGRpdi5vZmZzZXRIZWlnaHQKCQkJY29uc3QgY3VycmVudF9zY3JvbGwgPSB0b2NOb2RlLnNjcm9sbFRvcAoJCQljb25zdCBoZWFkZXJfaGVpZ2h0ID0gdG9jTm9kZS5xdWVyeVNlbGVjdG9yKCJoZWFkZXIiKS5vZmZzZXRIZWlnaHQKCQkJCgkJCWNvbnN0IHNjcm9sbF90b190b3AgPSBkaXZfcG9zIC0gaGVhZGVyX2hlaWdodAoJCQljb25zdCBzY3JvbGxfdG9fYm90dG9tID0gZGl2X3BvcyArIGRpdl9oZWlnaHQgLSB0b2NfaGVpZ2h0CgkJCQoJCQkvLyBpZiB3ZSBzZXQgYSBzY3JvbGxUb3AsIHRoZW4gdGhlIGJyb3dzZXIgd2lsbCBzdG9wIGFueSBjdXJyZW50bHkgb25nb2luZyBzbW9vdGhzY3JvbGwgYW5pbWF0aW9uLiBTbyBsZXQncyBvbmx5IGRvIHRoaXMgaWYgeW91IGFyZSBub3QgY3VycmVudGx5IGluIGEgc21vb3Roc2Nyb2xsLgoJCQlpZihEYXRlLm5vdygpIC0gbGFzdF90b2NfZWxlbWVudF9jbGlja190aW1lLmN1cnJlbnQgPj0gMjAwMCkKCQkJCWlmKGN1cnJlbnRfc2Nyb2xsIDwgc2Nyb2xsX3RvX2JvdHRvbSl7CgkJCQkJdG9jTm9kZS5zY3JvbGxUb3AgPSBzY3JvbGxfdG9fYm90dG9tCgkJCQl9IGVsc2UgaWYoY3VycmVudF9zY3JvbGwgPiBzY3JvbGxfdG9fdG9wKXsKCQkJCQl0b2NOb2RlLnNjcm9sbFRvcCA9IHNjcm9sbF90b190b3AKCQkJCX0KCQkJKi8KCQl9KQoJfQp9CmxldCBpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMSA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihpbnRlcnNlY3Rpb25fY2FsbGJhY2ssIHsKCXJvb3Q6IG51bGwsIC8vIGkuZS4gdGhlIHZpZXdwb3J0CiAgCXRocmVzaG9sZDogMSwKCXJvb3RNYXJnaW46ICItMTVweCIsIC8vIHNsaWdodGx5IHNtYWxsZXIgdGhhbiB0aGUgdmlld3BvcnQKCS8vIGRlbGF5OiAxMDAsCn0pCmxldCBpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMiA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihpbnRlcnNlY3Rpb25fY2FsbGJhY2ssIHsKCXJvb3Q6IG51bGwsIC8vIGkuZS4gdGhlIHZpZXdwb3J0CiAgCXRocmVzaG9sZDogMSwKCXJvb3RNYXJnaW46ICIxNXB4IiwgLy8gc2xpZ2h0bHkgbGFyZ2VyIHRoYW4gdGhlIHZpZXdwb3J0CgkvLyBkZWxheTogMTAwLAp9KQoKY29uc3QgcmVuZGVyID0gKGVsZW1lbnRzKSA9PiB7CgloZWFkZXJfdG9faW5kZXhfZW50cnlfbWFwLmNsZWFyKCkKCWN1cnJlbnRseV9oaWdobGlnaHRlZF9zZXQuY2xlYXIoKQoJaW50ZXJzZWN0aW9uX29ic2VydmVyXzEuZGlzY29ubmVjdCgpCglpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMi5kaXNjb25uZWN0KCkKCgkJbGV0IGxhc3RfbGV2ZWwgPSBgSDFgCglyZXR1cm4gaHRtbGAke2VsZW1lbnRzLm1hcChoID0+IHsKCWNvbnN0IHBhcmVudF9jZWxsID0gZ2V0UGFyZW50Q2VsbChoKQoKCQlsZXQgW2NsYXNzTmFtZSwgdGl0bGVfZWxdID0gaC5tYXRjaGVzKGAucGx1dG8tZG9jcy1iaW5kaW5nYCkgPyBbInBsdXRvLWRvY3MtYmluZGluZy1lbCIsIGguZmlyc3RFbGVtZW50Q2hpbGRdIDogW2gubm9kZU5hbWUsIGhdCgoJY29uc3QgYSA9IGh0bWxgPGEgCgkJY2xhc3M9IiR7Y2xhc3NOYW1lfSIgCgkJdGl0bGU9IiR7dGl0bGVfZWwuaW5uZXJUZXh0fSIKCQlocmVmPSIjJHtwYXJlbnRfY2VsbC5pZH0iCgk+JHt0aXRsZV9lbC5pbm5lckhUTUx9PC9hPmAKCS8qIGEub25tb3VzZW92ZXI9KCk9PnsKCQlwYXJlbnRfY2VsbC5maXJzdEVsZW1lbnRDaGlsZC5jbGFzc0xpc3QuYWRkKAoJCQknaGlnaGxpZ2h0LXBsdXRvLWNlbGwtc2hvdWxkZXInCgkJKQoJfQoJYS5vbm1vdXNlb3V0PSgpID0+IHsKCQlwYXJlbnRfY2VsbC5maXJzdEVsZW1lbnRDaGlsZC5jbGFzc0xpc3QucmVtb3ZlKAoJCQknaGlnaGxpZ2h0LXBsdXRvLWNlbGwtc2hvdWxkZXInCgkJKQoJfSAqLwoJCQoJCQoJYS5vbmNsaWNrPShlKSA9PiB7CgkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCWxhc3RfdG9jX2VsZW1lbnRfY2xpY2tfdGltZS5jdXJyZW50ID0gRGF0ZS5ub3coKQoJCXNjcm9sbEludG9WaWV3KGgsIHsKCQkJYmVoYXZpb3I6ICdzbW9vdGgnLCAKCQkJYmxvY2s6ICdzdGFydCcsCgkJfSkudGhlbigoKSA9PiAKCQkJLy8gc29tZXRpbWVzIGl0IGRvZXNuJ3Qgc2Nyb2xsIHRvIHRoZSByaWdodCBwbGFjZQoJCQkvLyBzb2x1dGlvbjogdHJ5IGEgc2Vjb25kIHRpbWUhCgkJCXNjcm9sbEludG9WaWV3KGgsIHsKCQkJCWJlaGF2aW9yOiAnc21vb3RoJywgCgkJCQlibG9jazogJ3N0YXJ0JywKCQkJfSkKCSAgICkKCX0KCgljb25zdCByb3cgPSAgaHRtbGA8ZGl2IGNsYXNzPSJ0b2Mtcm93ICR7Y2xhc3NOYW1lfSBhZnRlci0ke2xhc3RfbGV2ZWx9Ij4ke2F9PC9kaXY+YAoJCWludGVyc2VjdGlvbl9vYnNlcnZlcl8xLm9ic2VydmUodGl0bGVfZWwpCgkJaW50ZXJzZWN0aW9uX29ic2VydmVyXzIub2JzZXJ2ZSh0aXRsZV9lbCkKCQloZWFkZXJfdG9faW5kZXhfZW50cnlfbWFwLnNldCh0aXRsZV9lbCwgcm93KQoKCWlmKGNsYXNzTmFtZS5zdGFydHNXaXRoKCJIIikpCgkJbGFzdF9sZXZlbCA9IGNsYXNzTmFtZQoJCQoJcmV0dXJuIHJvdwp9KX1gCn0KCmNvbnN0IGludmFsaWRhdGVkID0geyBjdXJyZW50OiBmYWxzZSB9Cgpjb25zdCB1cGRhdGVDYWxsYmFjayA9ICgpID0+IHsKCWlmICghaW52YWxpZGF0ZWQuY3VycmVudCkgewoJCXRvY05vZGUucXVlcnlTZWxlY3Rvcigic2VjdGlvbiIpLnJlcGxhY2VXaXRoKAoJCQlodG1sYDxzZWN0aW9uPiR7cmVuZGVyKGdldEhlYWRlcnMoKSl9PC9zZWN0aW9uPmAKCQkpCgl9Cn0KdXBkYXRlQ2FsbGJhY2soKQpzZXRUaW1lb3V0KHVwZGF0ZUNhbGxiYWNrLCAxMDApCnNldFRpbWVvdXQodXBkYXRlQ2FsbGJhY2ssIDEwMDApCnNldFRpbWVvdXQodXBkYXRlQ2FsbGJhY2ssIDUwMDApCgpjb25zdCBub3RlYm9vayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInBsdXRvLW5vdGVib29rIikKCgovLyBXZSBoYXZlIGEgbXV0YXRpb25vYnNlcnZlciBmb3IgZWFjaCBjZWxsOgpjb25zdCBtdXRfb2JzZXJ2ZXJzID0gewoJY3VycmVudDogW10sCn0KCmNvbnN0IGNyZWF0ZUNlbGxPYnNlcnZlcnMgPSAoKSA9PiB7CgltdXRfb2JzZXJ2ZXJzLmN1cnJlbnQuZm9yRWFjaCgobykgPT4gby5kaXNjb25uZWN0KCkpCgltdXRfb2JzZXJ2ZXJzLmN1cnJlbnQgPSBBcnJheS5mcm9tKG5vdGVib29rLnF1ZXJ5U2VsZWN0b3JBbGwoInBsdXRvLWNlbGwiKSkubWFwKGVsID0+IHsKCQljb25zdCBvID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIodXBkYXRlQ2FsbGJhY2spCgkJby5vYnNlcnZlKGVsLCB7YXR0cmlidXRlRmlsdGVyOiBbImNsYXNzIl19KQoJCXJldHVybiBvCgl9KQp9CmNyZWF0ZUNlbGxPYnNlcnZlcnMoKQoKLy8gQW5kIG9uZSBmb3IgdGhlIG5vdGVib29rJ3MgY2hpbGQgbGlzdCwgd2hpY2ggdXBkYXRlcyBvdXIgY2VsbCBvYnNlcnZlcnM6CmNvbnN0IG5vdGVib29rT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7Cgl1cGRhdGVDYWxsYmFjaygpCgljcmVhdGVDZWxsT2JzZXJ2ZXJzKCkKfSkKbm90ZWJvb2tPYnNlcnZlci5vYnNlcnZlKG5vdGVib29rLCB7Y2hpbGRMaXN0OiB0cnVlfSkKCi8vIEFuZCBmaW5hbGx5LCBhbiBvYnNlcnZlciBmb3IgdGhlIGRvY3VtZW50LmJvZHkgY2xhc3NMaXN0LCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgdG9jIGFsc28gd29ya3Mgd2hlbiBpdCBpcyBsb2FkZWQgZHVyaW5nIG5vdGVib29rIGluaXRpYWxpemF0aW9uCmNvbnN0IGJvZHlDbGFzc09ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIodXBkYXRlQ2FsbGJhY2spCmJvZHlDbGFzc09ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge2F0dHJpYnV0ZUZpbHRlcjogWyJjbGFzcyJdfSkKCi8vIEhpZGUvc2hvdyB0aGUgVG9DIHdoZW4gdGhlIHNjcmVlbiBnZXRzIHNtYWxsCmxldCBtID0gbWF0Y2hNZWRpYSgiKG1heC13aWR0aDogMTAwMHB4KSIpCmxldCBtYXRjaF9saXN0ZW5lciA9ICgpID0+IAoJdG9jTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRlIiwgbS5tYXRjaGVzKQptYXRjaF9saXN0ZW5lcigpCm0uYWRkTGlzdGVuZXIobWF0Y2hfbGlzdGVuZXIpCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CglpbnZhbGlkYXRlZC5jdXJyZW50ID0gdHJ1ZQoJaW50ZXJzZWN0aW9uX29ic2VydmVyXzEuZGlzY29ubmVjdCgpCglpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMi5kaXNjb25uZWN0KCkKCW5vdGVib29rT2JzZXJ2ZXIuZGlzY29ubmVjdCgpCglib2R5Q2xhc3NPYnNlcnZlci5kaXNjb25uZWN0KCkKCW11dF9vYnNlcnZlcnMuY3VycmVudC5mb3JFYWNoKChvKSA9PiBvLmRpc2Nvbm5lY3QoKSkKCWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZG9jdW1lbnRfY2xpY2tfaGFuZGxlcikKCW0ucmVtb3ZlTGlzdGVuZXIobWF0Y2hfbGlzdGVuZXIpCn0pCgpyZXR1cm4gdG9jTm9kZQo8L3NjcmlwdD4KPHN0eWxlPgpAbWVkaWEgbm90IHByaW50IHsKCi5wbHV0b3VpLXRvYyB7Cglmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAiU2Vnb2UgVUkiLCBSb2JvdG8sIE94eWdlbi1TYW5zLCBDYW50YXJlbGwsIEhlbHZldGljYSwgQXJpYWwsICJBcHBsZSBDb2xvciBFbW9qaSIsCgkJIlNlZ29lIFVJIEVtb2ppIiwgIlNlZ29lIFVJIFN5bWJvbCIsIHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKCS0tbWFpbi1iZy1jb2xvcjogI2ZhZmFmYTsKCS0tcGx1dG8tb3V0cHV0LWNvbG9yOiBoc2woMCwgMCUsIDM2JSk7CgktLXBsdXRvLW91dHB1dC1oLWNvbG9yOiBoc2woMCwgMCUsIDIxJSk7CgktLXNpZGViYXItbGktYWN0aXZlLWJnOiByZ2IoMjM1LCAyMzUsIDIzNSk7CgktLWljb24tZmlsdGVyOiB1bnNldDsKfQoKQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykgewoJLnBsdXRvdWktdG9jIHsKCQktLW1haW4tYmctY29sb3I6ICMzMDMwMzA7CgkJLS1wbHV0by1vdXRwdXQtY29sb3I6IGhzbCgwLCAwJSwgOTAlKTsKCQktLXBsdXRvLW91dHB1dC1oLWNvbG9yOiBoc2woMCwgMCUsIDk3JSk7CgkJLS1zaWRlYmFyLWxpLWFjdGl2ZS1iZzogcmdiKDgyLCA4MiwgODIpOwoJCS0taWNvbi1maWx0ZXI6IGludmVydCgxKTsKCX0KfQoKLnBsdXRvdWktdG9jLmFzaWRlIHsKCWNvbG9yOiB2YXIoLS1wbHV0by1vdXRwdXQtY29sb3IpOwoJcG9zaXRpb246IGZpeGVkOwoJcmlnaHQ6IDFyZW07Cgl0b3A6IDVyZW07Cgl3aWR0aDogbWluKDgwdncsIDMwMHB4KTsKCXBhZGRpbmc6IDAuNXJlbTsKCXBhZGRpbmctdG9wOiAwZW07CgkvKiBib3JkZXI6IDNweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMTUpOyAqLwoJYm9yZGVyLXJhZGl1czogMTBweDsKCS8qIGJveC1zaGFkb3c6IDAgMCAxMXB4IDBweCAjMDAwMDAwMTA7ICovCgltYXgtaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNXJlbSAtIDkwcHgpOwoJb3ZlcmZsb3c6IGF1dG87Cgl6LWluZGV4OiA0MDsKCWJhY2tncm91bmQtY29sb3I6IHZhcigtLW1haW4tYmctY29sb3IpOwoJdHJhbnNpdGlvbjogdHJhbnNmb3JtIDMwMG1zIGN1YmljLWJlemllcigwLjE4LCAwLjg5LCAwLjQ1LCAxLjEyKTsKfQoKLnBsdXRvdWktdG9jLmFzaWRlLmhpZGUgewoJdHJhbnNmb3JtOiB0cmFuc2xhdGVYKGNhbGMoMTAwJSAtIDI4cHgpKTsKfQoucGx1dG91aS10b2MuYXNpZGUuaGlkZSBzZWN0aW9uIHsKCWRpc3BsYXk6IG5vbmU7Cn0KLnBsdXRvdWktdG9jLmFzaWRlLmhpZGUgaGVhZGVyIHsKCW1hcmdpbi1ib3R0b206IDBlbTsKCXBhZGRpbmctYm90dG9tOiAwZW07Cglib3JkZXItYm90dG9tOiBub25lOwp9Cn0gIC8qIEVuZCBvZiBNZWRpYSBwcmludCBxdWVyeSAqLwoucGx1dG91aS10b2MuYXNpZGUuaGlkZSAub3Blbi10b2MsCi5wbHV0b3VpLXRvYy5hc2lkZTpub3QoLmhpZGUpIC5jbG9zZWQtdG9jLAoucGx1dG91aS10b2M6bm90KC5hc2lkZSkgLmNsb3NlZC10b2MgewoJZGlzcGxheTogbm9uZTsKfQoKQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uKSB7CiAgLnBsdXRvdWktdG9jLmFzaWRlIHsKCXRyYW5zaXRpb24tZHVyYXRpb246IDBzOwogIH0KfQoKLnRvYy10b2dnbGUgewoJY3Vyc29yOiBwb2ludGVyOwogICAgcGFkZGluZzogMWVtOwogICAgbWFyZ2luOiAtMWVtOwogICAgbWFyZ2luLXJpZ2h0OiAtMC43ZW07CiAgICBsaW5lLWhlaWdodDogMWVtOwogICAgZGlzcGxheTogZmxleDsKfQoKLnRvYy10b2dnbGU6OmJlZm9yZSB7CiAgICBjb250ZW50OiAiIjsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIGhlaWdodDogMWVtOwogICAgd2lkdGg6IDFlbTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9saXN0LW91dGxpbmUuc3ZnIik7CgkvKiBnZW5lcmF0ZWQgdXNpbmcgaHR0cHM6Ly9kb3BpYXphLm9yZy90b29scy9kYXRhdXJpL2luZGV4LnBocCAqLwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSTFNVElpSUdobGFXZG9kRDBpTlRFeUlpQjJhV1YzUW05NFBTSXdJREFnTlRFeUlEVXhNaUkrUEhScGRHeGxQbWx2Ym1samIyNXpMWFkxTFc4OEwzUnBkR3hsUGp4c2FXNWxJSGd4UFNJeE5qQWlJSGt4UFNJeE5EUWlJSGd5UFNJME5EZ2lJSGt5UFNJeE5EUWlJSE4wZVd4bFBTSm1hV3hzT201dmJtVTdjM1J5YjJ0bE9pTXdNREE3YzNSeWIydGxMV3hwYm1WallYQTZjbTkxYm1RN2MzUnliMnRsTFd4cGJtVnFiMmx1T25KdmRXNWtPM04wY205clpTMTNhV1IwYURvek1uQjRJaTgrUEd4cGJtVWdlREU5SWpFMk1DSWdlVEU5SWpJMU5pSWdlREk5SWpRME9DSWdlVEk5SWpJMU5pSWdjM1I1YkdVOUltWnBiR3c2Ym05dVpUdHpkSEp2YTJVNkl6QXdNRHR6ZEhKdmEyVXRiR2x1WldOaGNEcHliM1Z1WkR0emRISnZhMlV0YkdsdVpXcHZhVzQ2Y205MWJtUTdjM1J5YjJ0bExYZHBaSFJvT2pNeWNIZ2lMejQ4YkdsdVpTQjRNVDBpTVRZd0lpQjVNVDBpTXpZNElpQjRNajBpTkRRNElpQjVNajBpTXpZNElpQnpkSGxzWlQwaVptbHNiRHB1YjI1bE8zTjBjbTlyWlRvak1EQXdPM04wY205clpTMXNhVzVsWTJGd09uSnZkVzVrTzNOMGNtOXJaUzFzYVc1bGFtOXBianB5YjNWdVpEdHpkSEp2YTJVdGQybGtkR2c2TXpKd2VDSXZQanhqYVhKamJHVWdZM2c5SWpnd0lpQmplVDBpTVRRMElpQnlQU0l4TmlJZ2MzUjViR1U5SW1acGJHdzZibTl1WlR0emRISnZhMlU2SXpBd01EdHpkSEp2YTJVdGJHbHVaV05oY0RweWIzVnVaRHR6ZEhKdmEyVXRiR2x1WldwdmFXNDZjbTkxYm1RN2MzUnliMnRsTFhkcFpIUm9Pak15Y0hnaUx6NDhZMmx5WTJ4bElHTjRQU0k0TUNJZ1kzazlJakkxTmlJZ2NqMGlNVFlpSUhOMGVXeGxQU0ptYVd4c09tNXZibVU3YzNSeWIydGxPaU13TURBN2MzUnliMnRsTFd4cGJtVmpZWEE2Y205MWJtUTdjM1J5YjJ0bExXeHBibVZxYjJsdU9uSnZkVzVrTzNOMGNtOXJaUzEzYVdSMGFEb3pNbkI0SWk4K1BHTnBjbU5zWlNCamVEMGlPREFpSUdONVBTSXpOamdpSUhJOUlqRTJJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxPM04wY205clpUb2pNREF3TzNOMGNtOXJaUzFzYVc1bFkyRndPbkp2ZFc1a08zTjBjbTlyWlMxc2FXNWxhbTlwYmpweWIzVnVaRHR6ZEhKdmEyVXRkMmxrZEdnNk16SndlQ0l2UGp3dmMzWm5QZz09Iik7CiAgICBiYWNrZ3JvdW5kLXNpemU6IDFlbTsKCWZpbHRlcjogdmFyKC0taWNvbi1maWx0ZXIpOwp9CgouYXNpZGUgLnRvYy10b2dnbGUub3Blbi10b2M6aG92ZXI6OmJlZm9yZSB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvYXJyb3ctZm9yd2FyZC1vdXRsaW5lLnN2ZyIpOwoJLyogZ2VuZXJhdGVkIHVzaW5nIGh0dHBzOi8vZG9waWF6YS5vcmcvdG9vbHMvZGF0YXVyaS9pbmRleC5waHAgKi8KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0kxTVRJaUlHaGxhV2RvZEQwaU5URXlJaUIyYVdWM1FtOTRQU0l3SURBZ05URXlJRFV4TWlJK1BIUnBkR3hsUG1sdmJtbGpiMjV6TFhZMUxXRThMM1JwZEd4bFBqeHdiMng1YkdsdVpTQndiMmx1ZEhNOUlqSTJPQ0F4TVRJZ05ERXlJREkxTmlBeU5qZ2dOREF3SWlCemRIbHNaVDBpWm1sc2JEcHViMjVsTzNOMGNtOXJaVG9qTURBd08zTjBjbTlyWlMxc2FXNWxZMkZ3T25KdmRXNWtPM04wY205clpTMXNhVzVsYW05cGJqcHliM1Z1WkR0emRISnZhMlV0ZDJsa2RHZzZORGh3ZUNJdlBqeHNhVzVsSUhneFBTSXpPVElpSUhreFBTSXlOVFlpSUhneVBTSXhNREFpSUhreVBTSXlOVFlpSUhOMGVXeGxQU0ptYVd4c09tNXZibVU3YzNSeWIydGxPaU13TURBN2MzUnliMnRsTFd4cGJtVmpZWEE2Y205MWJtUTdjM1J5YjJ0bExXeHBibVZxYjJsdU9uSnZkVzVrTzNOMGNtOXJaUzEzYVdSMGFEbzBPSEI0SWk4K1BDOXpkbWMrIik7Cn0KLmFzaWRlIC50b2MtdG9nZ2xlLmNsb3NlZC10b2M6aG92ZXI6OmJlZm9yZSB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvYXJyb3ctYmFjay1vdXRsaW5lLnN2ZyIpOwoJLyogZ2VuZXJhdGVkIHVzaW5nIGh0dHBzOi8vZG9waWF6YS5vcmcvdG9vbHMvZGF0YXVyaS9pbmRleC5waHAgKi8KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0kxTVRJaUlHaGxhV2RvZEQwaU5URXlJaUIyYVdWM1FtOTRQU0l3SURBZ05URXlJRFV4TWlJK1BIUnBkR3hsUG1sdmJtbGpiMjV6TFhZMUxXRThMM1JwZEd4bFBqeHdiMng1YkdsdVpTQndiMmx1ZEhNOUlqSTBOQ0EwTURBZ01UQXdJREkxTmlBeU5EUWdNVEV5SWlCemRIbHNaVDBpWm1sc2JEcHViMjVsTzNOMGNtOXJaVG9qTURBd08zTjBjbTlyWlMxc2FXNWxZMkZ3T25KdmRXNWtPM04wY205clpTMXNhVzVsYW05cGJqcHliM1Z1WkR0emRISnZhMlV0ZDJsa2RHZzZORGh3ZUNJdlBqeHNhVzVsSUhneFBTSXhNakFpSUhreFBTSXlOVFlpSUhneVBTSTBNVElpSUhreVBTSXlOVFlpSUhOMGVXeGxQU0ptYVd4c09tNXZibVU3YzNSeWIydGxPaU13TURBN2MzUnliMnRsTFd4cGJtVmpZWEE2Y205MWJtUTdjM1J5YjJ0bExXeHBibVZxYjJsdU9uSnZkVzVrTzNOMGNtOXJaUzEzYVdSMGFEbzBPSEI0SWk4K1BDOXpkbWMrIik7Cn0KCgoKLnBsdXRvdWktdG9jIGhlYWRlciB7CglkaXNwbGF5OiBmbGV4OwoJYWxpZ24taXRlbXM6IGNlbnRlcjsKCWdhcDogLjNlbTsKCWZvbnQtc2l6ZTogMS41ZW07CgkvKiBtYXJnaW4tdG9wOiAtMC4xZW07ICovCgltYXJnaW4tYm90dG9tOiAwLjRlbTsKCXBhZGRpbmc6IDAuNXJlbTsKCW1hcmdpbi1sZWZ0OiAwOwoJbWFyZ2luLXJpZ2h0OiAwOwoJZm9udC13ZWlnaHQ6IGJvbGQ7CgkvKiBib3JkZXItYm90dG9tOiAycHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjE1KTsgKi8KCXBvc2l0aW9uOiBzdGlja3k7Cgl0b3A6IDBweDsKCWJhY2tncm91bmQ6IHZhcigtLW1haW4tYmctY29sb3IpOwoJei1pbmRleDogNDE7Cn0KLnBsdXRvdWktdG9jLmFzaWRlIGhlYWRlciB7CglwYWRkaW5nLWxlZnQ6IDA7CglwYWRkaW5nLXJpZ2h0OiAwOwp9CgoucGx1dG91aS10b2Mgc2VjdGlvbiAudG9jLXJvdyB7Cgl3aGl0ZS1zcGFjZTogbm93cmFwOwoJb3ZlcmZsb3c6IGhpZGRlbjsKCXRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwoJcGFkZGluZzogLjFlbTsKCWJvcmRlci1yYWRpdXM6IC4yZW07Cn0KCi5wbHV0b3VpLXRvYyBzZWN0aW9uIC50b2Mtcm93LkgxIHsKCW1hcmdpbi10b3A6IDFlbTsKfQoKCi5wbHV0b3VpLXRvYy5hc2lkZSBzZWN0aW9uIC50b2Mtcm93LmluLXZpZXcgewoJYmFja2dyb3VuZDogdmFyKC0tc2lkZWJhci1saS1hY3RpdmUtYmcpOwp9CgoKCQouaGlnaGxpZ2h0LXBsdXRvLWNlbGwtc2hvdWxkZXIgewoJYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsKCWJhY2tncm91bmQtY2xpcDogcGFkZGluZy1ib3g7Cn0KCi5wbHV0b3VpLXRvYyBzZWN0aW9uIGEgewoJdGV4dC1kZWNvcmF0aW9uOiBub25lOwoJZm9udC13ZWlnaHQ6IG5vcm1hbDsKCWNvbG9yOiB2YXIoLS1wbHV0by1vdXRwdXQtY29sb3IpOwp9Ci5wbHV0b3VpLXRvYyBzZWN0aW9uIGE6aG92ZXIgewoJY29sb3I6IHZhcigtLXBsdXRvLW91dHB1dC1oLWNvbG9yKTsKfQoKLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDEgewoJZm9udC13ZWlnaHQ6IDcwMDsKCWxpbmUtaGVpZ2h0OiAxZW07Cn0KCi5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiAuYWZ0ZXItSDIgYSB7IHBhZGRpbmctbGVmdDogMTBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gLmFmdGVyLUgzIGEgeyBwYWRkaW5nLWxlZnQ6IDIwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIC5hZnRlci1INCBhIHsgcGFkZGluZy1sZWZ0OiAzMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiAuYWZ0ZXItSDUgYSB7IHBhZGRpbmctbGVmdDogNDBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gLmFmdGVyLUg2IGEgeyBwYWRkaW5nLWxlZnQ6IDUwcHg7IH0KCi5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkgxIHsgcGFkZGluZy1sZWZ0OiAwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDIgeyBwYWRkaW5nLWxlZnQ6IDEwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDMgeyBwYWRkaW5nLWxlZnQ6IDIwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDQgeyBwYWRkaW5nLWxlZnQ6IDMwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDUgeyBwYWRkaW5nLWxlZnQ6IDQwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDYgeyBwYWRkaW5nLWxlZnQ6IDUwcHg7IH0KCgoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5wbHV0by1kb2NzLWJpbmRpbmctZWwsCi5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkFTU0lHTkVFCgl7Cglmb250LWZhbWlseTogSnVsaWFNb25vLCBtb25vc3BhY2U7Cglmb250LXNpemU6IC44ZW07CgkvKiBiYWNrZ3JvdW5kOiBibGFjazsgKi8KCWZvbnQtd2VpZ2h0OiA3MDA7CiAgICBmb250LXN0eWxlOiBpdGFsaWM7Cgljb2xvcjogdmFyKC0tY20tdmFyLWNvbG9yKTsgLyogdGhpcyBpcyBzdGVhbGluZyBhIHZhcmlhYmxlIGZyb20gUGx1dG8sIGJ1dCBpdCdzIGZpbmUgaWYgdGhhdCBkb2VzbnQgd29yayAqLwp9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLnBsdXRvLWRvY3MtYmluZGluZy1lbDo6YmVmb3JlLAoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5BU1NJR05FRTo6YmVmb3JlCgl7Cgljb250ZW50OiAiPiAiOwoJb3BhY2l0eTogLjM7Cn0KPC9zdHlsZT4KCjxzY3JpcHQgaWQ9JzNlaHlLSic+CiAgICAKCS8qICMjIyMgQkVHSU5OSU5HIE9GIFBBUlQgQVVUT01BVElDQUxMWSBBRERFRCBCWSBIVExTQ1JJUFQgIyMjIyAqLwoJLy8gQXJyYXkgd2hlcmUgYWxsIHRoZSBldmVudCBsaXN0ZW5lcnMgYXJlIHN0b3JlZAoJY29uc3QgX2V2ZW50c19saXN0ZW5lcnNfID0gW10KCgkvLyBGdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgdG8gYWRkIGV2ZW50cyBsaXN0ZW5lcnMgd2l0aGluIHRoZSBzY3JpcHQKCWZ1bmN0aW9uIGFkZFNjcmlwdEV2ZW50TGlzdGVuZXJzKGVsZW1lbnQsIGxpc3RlbmVycykgewoJCWlmIChsaXN0ZW5lcnMuY29uc3RydWN0b3IgIT0gT2JqZWN0KSB7ZXJyb3IoJ09ubHkgb2JqZWN0cyB3aXRoIGtleXMgYXMgZXZlbnQgbmFtZXMgYW5kIHZhbHVlcyBhcyBsaXN0ZW5lciBmdW5jdGlvbnMgYXJlIHN1cHBvcnRlZCcpfQoJCV9ldmVudHNfbGlzdGVuZXJzXy5wdXNoKHtlbGVtZW50LCBsaXN0ZW5lcnN9KQoJfQoJLyogIyMjIyBFTkQgT0YgUEFSVCBBVVRPTUFUSUNBTExZIEFEREVEIEJZIEhUTFNDUklQVCAjIyMjICovCmNvbnN0IGhpZGVfcHJlYW1ibGUgPSB0cnVlCmNvbnN0IGZvcmNlX2hpZGVfZW5hYmxlZCA9IHRydWUKCi8vIExvYWQgdGhlIGxpYnJhcnkgZm9yIGNvbnNpc3RlbnQgc21vb3RoIHNjcm9sbGluZwpjb25zdCB7ZGVmYXVsdDogc2Nyb2xsSW50b1ZpZXd9ID0gYXdhaXQgaW1wb3J0KCJkYXRhOnRleHQvamF2YXNjcmlwdDtiYXNlNjQsZG1GeUlGRTlaVDArSW05aWFtVmpkQ0k5UFhSNWNHVnZaaUJsSmladWRXeHNJVDFsSmlZeFBUMDlaUzV1YjJSbFZIbHdaU3hWUFNobExIUXBQVDRvSVhSOGZDSm9hV1JrWlc0aUlUMDlaU2ttSmlKMmFYTnBZbXhsSWlFOVBXVW1KaUpqYkdsd0lpRTlQV1VzUVQwb1pTeDBLVDArZTJsbUtHVXVZMnhwWlc1MFNHVnBaMmgwUEdVdWMyTnliMnhzU0dWcFoyaDBmSHhsTG1Oc2FXVnVkRmRwWkhSb1BHVXVjMk55YjJ4c1YybGtkR2dwZTJ4bGRDQnNQV2RsZEVOdmJYQjFkR1ZrVTNSNWJHVW9aU3h1ZFd4c0tUdHlaWFIxY200Z1ZTaHNMbTkyWlhKbWJHOTNXU3gwS1h4OFZTaHNMbTkyWlhKbWJHOTNXQ3gwS1h4OEtHVTlQbnRzWlhRZ2REMG9aVDArZTJsbUtDRmxMbTkzYm1WeVJHOWpkVzFsYm5SOGZDRmxMbTkzYm1WeVJHOWpkVzFsYm5RdVpHVm1ZWFZzZEZacFpYY3BjbVYwZFhKdUlHNTFiR3c3ZEhKNWUzSmxkSFZ5YmlCbExtOTNibVZ5Ukc5amRXMWxiblF1WkdWbVlYVnNkRlpwWlhjdVpuSmhiV1ZGYkdWdFpXNTBmV05oZEdOb2UzSmxkSFZ5YmlCdWRXeHNmWDBwS0dVcE8zSmxkSFZ5YmlFaGRDWW1LSFF1WTJ4cFpXNTBTR1ZwWjJoMFBHVXVjMk55YjJ4c1NHVnBaMmgwZkh4MExtTnNhV1Z1ZEZkcFpIUm9QR1V1YzJOeWIyeHNWMmxrZEdncGZTa29aU2w5Y21WMGRYSnVJVEY5TEZnOUtHVXNkQ3hzTEc4c2JpeHlMR2tzY3lrOVBuSThaU1ltYVQ1MGZIeHlQbVVtSm1rOGREOHdPbkk4UFdVbUpuTThQV3g4ZkdrK1BYUW1Kbk0rUFd3L2NpMWxMVzg2YVQ1MEppWnpQR3g4ZkhJOFpTWW1jejVzUDJrdGRDdHVPakFzSkQxbFBUNWxMbkJoY21WdWRFVnNaVzFsYm5RL1B5aGxMbWRsZEZKdmIzUk9iMlJsS0NrdWFHOXpkSHg4Ym5Wc2JDa3NkSFE5S0dVc2RDazlQbnQyWVhJZ2JDeHZMRzRzY2p0cFppaDBlWEJsYjJZZ1pHOWpkVzFsYm5RK0luVWlLWEpsZEhWeWJsdGRPMnhsZEh0elkzSnZiR3hOYjJSbE9ta3NZbXh2WTJzNmN5eHBibXhwYm1VNllTeGliM1Z1WkdGeWVUcG9MSE5yYVhCUGRtVnlabXh2ZDBocFpHUmxia1ZzWlcxbGJuUnpPblY5UFhRc1p6MGlablZ1WTNScGIyNGlQVDEwZVhCbGIyWWdhRDlvT21VOVBtVWhQVDFvTzJsbUtDRlJLR1VwS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWdpU1c1MllXeHBaQ0IwWVhKblpYUWlLVHRzWlhRZ2RqMWtiMk4xYldWdWRDNXpZM0p2Ykd4cGJtZEZiR1Z0Wlc1MGZIeGtiMk4xYldWdWRDNWtiMk4xYldWdWRFVnNaVzFsYm5Rc2JUMWJYU3gzUFdVN1ptOXlLRHRSS0hjcEppWm5LSGNwT3lsN2FXWW9LSGM5SkNoM0tTazlQVDEyS1h0dExuQjFjMmdvZHlrN1luSmxZV3Q5Ym5Wc2JDRTlkeVltZHowOVBXUnZZM1Z0Wlc1MExtSnZaSGttSmtFb2R5a21KaUZCS0dSdlkzVnRaVzUwTG1SdlkzVnRaVzUwUld4bGJXVnVkQ2w4Zkc1MWJHd2hQWGNtSmtFb2R5eDFLU1ltYlM1d2RYTm9LSGNwZld4bGRDQlhQVzUxYkd3aFBTaHZQVzUxYkd3OVBTaHNQWGRwYm1SdmR5NTJhWE4xWVd4V2FXVjNjRzl5ZENrL2RtOXBaQ0F3T213dWQybGtkR2dwUDI4NmFXNXVaWEpYYVdSMGFDeElQVzUxYkd3aFBTaHlQVzUxYkd3OVBTaHVQWGRwYm1SdmR5NTJhWE4xWVd4V2FXVjNjRzl5ZENrL2RtOXBaQ0F3T200dWFHVnBaMmgwS1Q5eU9tbHVibVZ5U0dWcFoyaDBMSHR6WTNKdmJHeFlPbDhzYzJOeWIyeHNXVHA0ZlQxM2FXNWtiM2NzZTJobGFXZG9kRHBGTEhkcFpIUm9PbFFzZEc5d09rNHNjbWxuYUhRNlRDeGliM1IwYjIwNldTeHNaV1owT2tOOVBXVXVaMlYwUW05MWJtUnBibWREYkdsbGJuUlNaV04wS0Nrc1VqMGljM1JoY25RaVBUMDljM3g4SW01bFlYSmxjM1FpUFQwOWN6OU9PaUpsYm1RaVBUMDljejlaT2s0clJTOHlMRlk5SW1ObGJuUmxjaUk5UFQxaFAwTXJWQzh5T2lKbGJtUWlQVDA5WVQ5TU9rTXNRajFiWFR0bWIzSW9iR1YwSUVROU1EdEVQRzB1YkdWdVozUm9PMFFyS3lsN2JHVjBJRTg5YlZ0RVhTeDdhR1ZwWjJoME9tb3NkMmxrZEdnNlNTeDBiM0E2VXl4eWFXZG9kRHB4TEdKdmRIUnZiVHA2TEd4bFpuUTZSbjA5VHk1blpYUkNiM1Z1WkdsdVowTnNhV1Z1ZEZKbFkzUW9LVHRwWmlnaWFXWXRibVZsWkdWa0lqMDlQV2ttSms0K1BUQW1Ka00rUFRBbUpsazhQVWdtSmt3OFBWY21KazQrUFZNbUpsazhQWG9tSmtNK1BVWW1Ka3c4UFhFcFluSmxZV3M3YkdWMElFYzlaMlYwUTI5dGNIVjBaV1JUZEhsc1pTaFBLU3hLUFhCaGNuTmxTVzUwS0VjdVltOXlaR1Z5VEdWbWRGZHBaSFJvTERFd0tTeExQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlWRzl3VjJsa2RHZ3NNVEFwTEZBOWNHRnljMlZKYm5Rb1J5NWliM0prWlhKU2FXZG9kRmRwWkhSb0xERXdLU3hhUFhCaGNuTmxTVzUwS0VjdVltOXlaR1Z5UW05MGRHOXRWMmxrZEdnc01UQXBMR1ZsUFRBc1pYUTlNQ3hsYkQwaWIyWm1jMlYwVjJsa2RHZ2lhVzRnVHo5UExtOW1abk5sZEZkcFpIUm9MVTh1WTJ4cFpXNTBWMmxrZEdndFNpMVFPakFzWlc4OUltOW1abk5sZEVobGFXZG9kQ0pwYmlCUFAwOHViMlptYzJWMFNHVnBaMmgwTFU4dVkyeHBaVzUwU0dWcFoyaDBMVXN0V2pvd0xHVnVQU0p2Wm1aelpYUlhhV1IwYUNKcGJpQlBQekE5UFQxUExtOW1abk5sZEZkcFpIUm9QekE2U1M5UExtOW1abk5sZEZkcFpIUm9PakFzWlhJOUltOW1abk5sZEVobGFXZG9kQ0pwYmlCUFB6QTlQVDFQTG05bVpuTmxkRWhsYVdkb2REOHdPbW92VHk1dlptWnpaWFJJWldsbmFIUTZNRHRwWmloMlBUMDlUeWxsWlQwaWMzUmhjblFpUFQwOWN6OVNPaUpsYm1RaVBUMDljejlTTFVnNkltNWxZWEpsYzNRaVBUMDljejlZS0hnc2VDdElMRWdzU3l4YUxIZ3JVaXg0SzFJclJTeEZLVHBTTFVndk1peGxkRDBpYzNSaGNuUWlQVDA5WVQ5V09pSmpaVzUwWlhJaVBUMDlZVDlXTFZjdk1qb2laVzVrSWowOVBXRS9WaTFYT2xnb1h5eGZLMWNzVnl4S0xGQXNYeXRXTEY4clZpdFVMRlFwTEdWbFBVMWhkR2d1YldGNEtEQXNaV1VyZUNrc1pYUTlUV0YwYUM1dFlYZ29NQ3hsZEN0ZktUdGxiSE5sZTJWbFBTSnpkR0Z5ZENJOVBUMXpQMUl0VXkxTE9pSmxibVFpUFQwOWN6OVNMWG9yV2l0bGJ6b2libVZoY21WemRDSTlQVDF6UDFnb1V5eDZMR29zU3l4YUsyVnZMRklzVWl0RkxFVXBPbEl0S0ZNcmFpOHlLU3RsYnk4eUxHVjBQU0p6ZEdGeWRDSTlQVDFoUDFZdFJpMUtPaUpqWlc1MFpYSWlQVDA5WVQ5V0xTaEdLMGt2TWlrclpXd3ZNam9pWlc1a0lqMDlQV0UvVmkxeEsxQXJaV3c2V0NoR0xIRXNTU3hLTEZBclpXd3NWaXhXSzFRc1ZDazdiR1YwZTNOamNtOXNiRXhsWm5RNlpXa3NjMk55YjJ4c1ZHOXdPbVZrZlQxUE8yVmxQVTFoZEdndWJXRjRLREFzVFdGMGFDNXRhVzRvWldRclpXVXZaWElzVHk1elkzSnZiR3hJWldsbmFIUXRhaTlsY2l0bGJ5a3BMR1YwUFUxaGRHZ3ViV0Y0S0RBc1RXRjBhQzV0YVc0b1pXa3JaWFF2Wlc0c1R5NXpZM0p2Ykd4WGFXUjBhQzFKTDJWdUsyVnNLU2tzVWlzOVpXUXRaV1VzVmlzOVpXa3RaWFI5UWk1d2RYTm9LSHRsYkRwUExIUnZjRHBsWlN4c1pXWjBPbVYwZlNsOWNtVjBkWEp1SUVKOUxHWTlaVDArZTNaaGNpQjBPM0psZEhWeWJpRXhQVDA5WlQ5N1lteHZZMnM2SW1WdVpDSXNhVzVzYVc1bE9pSnVaV0Z5WlhOMEluMDZLSFE5WlNrOVBUMVBZbXBsWTNRb2RDa21KakFoUFQxUFltcGxZM1F1YTJWNWN5aDBLUzVzWlc1bmRHZy9aVHA3WW14dlkyczZJbk4wWVhKMElpeHBibXhwYm1VNkltNWxZWEpsYzNRaWZYMDdablZ1WTNScGIyNGdZeWhsTEhRcGUzWmhjaUJzTzJsbUtDRmxMbWx6UTI5dWJtVmpkR1ZrZkh3aEtHVTlQbnRzWlhRZ2REMWxPMlp2Y2lnN2RDWW1kQzV3WVhKbGJuUk9iMlJsT3lsN2FXWW9kQzV3WVhKbGJuUk9iMlJsUFQwOVpHOWpkVzFsYm5RcGNtVjBkWEp1SVRBN2REMTBMbkJoY21WdWRFNXZaR1VnYVc1emRHRnVZMlZ2WmlCVGFHRmtiM2RTYjI5MFAzUXVjR0Z5Wlc1MFRtOWtaUzVvYjNOME9uUXVjR0Z5Wlc1MFRtOWtaWDF5WlhSMWNtNGhNWDBwS0dVcEtYSmxkSFZ5Ymp0cFppZ2liMkpxWldOMElqMDlkSGx3Wlc5bUtHdzlkQ2ttSmlKbWRXNWpkR2x2YmlJOVBYUjVjR1Z2WmlCc0xtSmxhR0YyYVc5eUtYSmxkSFZ5YmlCMExtSmxhR0YyYVc5eUtIUjBLR1VzZENrcE8yeGxkQ0J2UFNKaWIyOXNaV0Z1SWowOWRIbHdaVzltSUhSOGZHNTFiR3c5UFhRL2RtOXBaQ0F3T25RdVltVm9ZWFpwYjNJN1ptOXlLR3hsZEh0bGJEcHVMSFJ2Y0RweUxHeGxablE2YVgxdlppQjBkQ2hsTEdZb2RDa3BLVzR1YzJOeWIyeHNLSHQwYjNBNmNpeHNaV1owT21rc1ltVm9ZWFpwYjNJNmIzMHBmWFpoY2lCa0xIQTlLQ2s5UGloa2ZId29aRDBpY0dWeVptOXliV0Z1WTJVaWFXNGdkMmx1Wkc5M1AzQmxjbVp2Y20xaGJtTmxMbTV2ZHk1aWFXNWtLSEJsY21admNtMWhibU5sS1RwRVlYUmxMbTV2ZHlrc1pDZ3BLVHRtZFc1amRHbHZiaUJpS0dVcGUyeGxkQ0IwUFUxaGRHZ3ViV2x1S0Nod0tDa3RaUzV6ZEdGeWRGUnBiV1VwTDJVdVpIVnlZWFJwYjI0c01Ta3NiRDFsTG1WaGMyVW9kQ2tzYnoxbExuTjBZWEowV0Nzb1pTNTRMV1V1YzNSaGNuUllLU3BzTEc0OVpTNXpkR0Z5ZEZrcktHVXVlUzFsTG5OMFlYSjBXU2txYkR0bExtMWxkR2h2WkNodkxHNHNkQ3hzS1N4dklUMDlaUzU0Zkh4dUlUMDlaUzU1UDNKbGNYVmxjM1JCYm1sdFlYUnBiMjVHY21GdFpTZ29LVDArWWlobEtTazZaUzVqWWlncGZXWjFibU4wYVc5dUlIa29aU3gwTEd3cGUyeGxkQ0J2UFdGeVozVnRaVzUwY3k1c1pXNW5kR2crTXlZbWRtOXBaQ0F3SVQwOVlYSm5kVzFsYm5Seld6TmRQMkZ5WjNWdFpXNTBjMXN6WFRvMk1EQXNiajFoY21kMWJXVnVkSE11YkdWdVozUm9QalFtSm5admFXUWdNQ0U5UFdGeVozVnRaVzUwYzFzMFhUOWhjbWQxYldWdWRITmJORjA2WlQwK01Tc3RMV1VxWlNwbEttVXFaU3h5UFdGeVozVnRaVzUwY3k1c1pXNW5kR2crTlQ5aGNtZDFiV1Z1ZEhOYk5WMDZkbTlwWkNBd0xHazlZWEpuZFcxbGJuUnpMbXhsYm1kMGFENDJQMkZ5WjNWdFpXNTBjMXMyWFRwMmIybGtJREFzY3oxbExuTmpjbTlzYkV4bFpuUXNZVDFsTG5OamNtOXNiRlJ2Y0R0aUtIdHpZM0p2Ykd4aFlteGxPbVVzYldWMGFHOWtLSFFzYkN4dkxHNHBlMnhsZENCeVBVMWhkR2d1WTJWcGJDaDBLU3h6UFUxaGRHZ3VZMlZwYkNoc0tUdGxMbk5qY205c2JFeGxablE5Y2l4bExuTmpjbTlzYkZSdmNEMXpMR2svTGloN2RHRnlaMlYwT21Vc1pXeGhjSE5sWkRwdkxIWmhiSFZsT200c2JHVm1kRHB5TEhSdmNEcHpmU2w5TEhOMFlYSjBWR2x0WlRwd0tDa3NjM1JoY25SWU9uTXNjM1JoY25SWk9tRXNlRHAwTEhrNmJDeGtkWEpoZEdsdmJqcHZMR1ZoYzJVNmJpeGpZanB5ZlNsOWRtRnlJRTA5WlQwK1pTWW1JV1V1WW1Wb1lYWnBiM0o4ZkNKemJXOXZkR2dpUFQwOVpTNWlaV2hoZG1sdmNpeHJQV1oxYm1OMGFXOXVLR1VzZENsN2JHVjBJR3c5ZEh4OGUzMDdjbVYwZFhKdUlFMG9iQ2svWXlobExIdGliRzlqYXpwc0xtSnNiMk5yTEdsdWJHbHVaVHBzTG1sdWJHbHVaU3h6WTNKdmJHeE5iMlJsT213dWMyTnliMnhzVFc5a1pTeGliM1Z1WkdGeWVUcHNMbUp2ZFc1a1lYSjVMSE5yYVhCUGRtVnlabXh2ZDBocFpHUmxia1ZzWlcxbGJuUnpPbXd1YzJ0cGNFOTJaWEptYkc5M1NHbGtaR1Z1Uld4bGJXVnVkSE1zWW1Wb1lYWnBiM0k2WlQwK1VISnZiV2x6WlM1aGJHd29aUzV5WldSMVkyVW9LR1VzZENrOVBudHNaWFI3Wld3NmJ5eHNaV1owT200c2RHOXdPbko5UFhRc2FUMXZMbk5qY205c2JFeGxablFzY3oxdkxuTmpjbTlzYkZSdmNEdHlaWFIxY200Z2FUMDlQVzRtSm5NOVBUMXlQMlU2V3k0dUxtVXNibVYzSUZCeWIyMXBjMlVvWlQwK2VTaHZMRzRzY2l4c0xtUjFjbUYwYVc5dUxHd3VaV0Z6WlN3b0tUMCtaU2g3Wld3NmJ5eHNaV1owT2x0cExHNWRMSFJ2Y0RwYmN5eHlYWDBwTEd3dWIyNVRZM0p2Ykd4RGFHRnVaMlVwS1YxOUxGdGRLU2w5S1RwUWNtOXRhWE5sTG5KbGMyOXNkbVVvWXlobExIUXBLWDA3Wlhod2IzSjBlMnNnWVhNZ1pHVm1ZWFZzZEgwNyIpCgpmdW5jdGlvbiBzY3JvbGxfdG8oaCwgY29uZmlnID0gewoJCQliZWhhdmlvcjogJ3Ntb290aCcsIAoJCQlibG9jazogJ3N0YXJ0JywKCQl9KSB7CglzY3JvbGxJbnRvVmlldyhoLCBjb25maWcpLnRoZW4oKCkgPT4gCgkJCS8vIHNvbWV0aW1lcyBpdCBkb2Vzbid0IHNjcm9sbCB0byB0aGUgcmlnaHQgcGxhY2UKCQkJLy8gc29sdXRpb246IHRyeSBhIHNlY29uZCB0aW1lIQoJCQlzY3JvbGxJbnRvVmlldyhoLCBjb25maWcpCgkgICApCgl9CgoKbGV0IGNlbGwgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3BsdXRvLWNlbGwnKQpsZXQgcGx1dG9fYWN0aW9ucyA9IGNlbGwuX2ludGVybmFsX3BsdXRvX2FjdGlvbnMKbGV0IHRvYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ25hdi5wbHV0b3VpLXRvYycpCgpmdW5jdGlvbiBnZXRSb3coZWwpIHsKCWNvbnN0IHJvdyA9IGVsPy5jbG9zZXN0KCcudG9jLXJvdycpCglyZXR1cm4gcm93Cn0KCQpmdW5jdGlvbiBnZXRfbGlua19pZChlbCkgewoJY29uc3Qgcm93ID0gZ2V0Um93KGVsKQoJaWYgKF8uaXNOaWwocm93KSkgeyByZXR1cm4gbnVsbCB9Cgljb25zdCBhID0gcm93LnF1ZXJ5U2VsZWN0b3IoJ2EnKQoJcmV0dXJuIGEuaHJlZi5zbGljZSgtMzYpIC8vIGV4dHJhY3QgdGhlIGxhc3QgMzYgY2hhcmFjdGVycywgY29ycmVzcG9uZGluZyB0byB0aGUgY2VsbCBpZAp9CgpmdW5jdGlvbiBnZXRIZWFkaW5nTGV2ZWwocm93KSB7Cgljb25zdCBhID0gcm93LnF1ZXJ5U2VsZWN0b3IoJ2EnKQoJLy8gV2UgcmV0dXJuIHRoZSBsaW5rIGNsYXNzIHdpdGhvdXQgdGhlIGZpcnN0IEgKCXJldHVybiBOdW1iZXIoYS5jbGFzc0xpc3RbMF0uc2xpY2UoMSkpCn0KCmZ1bmN0aW9uIGdlbmVyYXRlQ2hlY2tlcihzZWxlY3RvcikgewoJc3dpdGNoICh0eXBlb2Ygc2VsZWN0b3IpIHsKCQljYXNlICdzdHJpbmcnOgoJCQljb25zdCBmdW5jID0gZWwgPT4gewoJCQkJcmV0dXJuIGVsLm1hdGNoZXMoc2VsZWN0b3IpCgkJCX0KCQkJcmV0dXJuIGZ1bmMKCQljYXNlICdmdW5jdGlvbic6CgkJCXJldHVybiBzZWxlY3RvcgoJCWRlZmF1bHQ6CgkJCWNvbnNvbGUuZXJyb3IoYFRoZSB0eXBlICgke3R5cGVvZiBzZWxlY3Rvcn0pIG9mIHRoZSBwcm92aWRlZCBhcmd1bWVudCBpcyBub3QgdmFsaWRgKQoJfQp9CgovLyBHZXQgbmV4dCBhbmQgcHJldmlvdXMgc2libGluZywgYWRhcHRlZCBmcm9tOgovLyBodHRwczovL2dvbWFrZXRoaW5ncy5jb20vZmluZGluZy10aGUtbmV4dC1hbmQtcHJldmlvdXMtc2libGluZy1lbGVtZW50cy10aGF0LW1hdGNoLWEtc2VsZWN0b3Itd2l0aC12YW5pbGxhLWpzLwp2YXIgZ2V0TmV4dFNpYmxpbmcgPSBmdW5jdGlvbiAoZWxlbSwgc2VsZWN0b3IpIHsKCgkvLyBBZGRlZCB0byByZXR1cm4gdW5kZWZpbmVkIGlzIGNhbGxlZCB3aXRoIHVuZGVmaW5lZAoJaWYgKF8uaXNOaWwoZWxlbSkpIHtyZXR1cm4gdW5kZWZpbmVkfQoKCS8vIEdldCB0aGUgbmV4dCBzaWJsaW5nIGVsZW1lbnQKCXZhciBzaWJsaW5nID0gZWxlbS5uZXh0RWxlbWVudFNpYmxpbmc7CgoJLy8gSWYgdGhlcmUncyBubyBzZWxlY3RvciwgcmV0dXJuIHRoZSBmaXJzdCBzaWJsaW5nCglpZiAoIXNlbGVjdG9yKSByZXR1cm4gc2libGluZzsKCgljb25zdCBjaGVja2VyID0gZ2VuZXJhdGVDaGVja2VyKHNlbGVjdG9yKQoKCS8vIElmIHRoZSBzaWJsaW5nIG1hdGNoZXMgb3VyIHNlbGVjdG9yLCB1c2UgaXQKCS8vIElmIG5vdCwganVtcCB0byB0aGUgbmV4dCBzaWJsaW5nIGFuZCBjb250aW51ZSB0aGUgbG9vcAoJd2hpbGUgKHNpYmxpbmcpIHsKCQlpZiAoY2hlY2tlcihzaWJsaW5nKSkgcmV0dXJuIHNpYmxpbmc7CgkJc2libGluZyA9IHNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nCgl9Cgp9Owp2YXIgZ2V0UHJldmlvdXNTaWJsaW5nID0gZnVuY3Rpb24gKGVsZW0sIHNlbGVjdG9yKSB7CgoJLy8gQWRkZWQgdG8gcmV0dXJuIHVuZGVmaW5lZCBpcyBjYWxsZWQgd2l0aCB1bmRlZmluZWQKCWlmIChfLmlzTmlsKGVsZW0pKSB7cmV0dXJuIHVuZGVmaW5lZH0KCQoJLy8gR2V0IHRoZSBuZXh0IHNpYmxpbmcgZWxlbWVudAoJdmFyIHNpYmxpbmcgPSBlbGVtLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7CgoJLy8gSWYgdGhlcmUncyBubyBzZWxlY3RvciwgcmV0dXJuIHRoZSBmaXJzdCBzaWJsaW5nCglpZiAoIXNlbGVjdG9yKSByZXR1cm4gc2libGluZzsKCgljb25zdCBjaGVja2VyID0gZ2VuZXJhdGVDaGVja2VyKHNlbGVjdG9yKQoKCS8vIElmIHRoZSBzaWJsaW5nIG1hdGNoZXMgb3VyIHNlbGVjdG9yLCB1c2UgaXQKCS8vIElmIG5vdCwganVtcCB0byB0aGUgbmV4dCBzaWJsaW5nIGFuZCBjb250aW51ZSB0aGUgbG9vcAoJd2hpbGUgKHNpYmxpbmcpIHsKCQlpZiAoY2hlY2tlcihzaWJsaW5nKSkgcmV0dXJuIHNpYmxpbmc7CgkJc2libGluZyA9IHNpYmxpbmcucHJldmlvdXNFbGVtZW50U2libGluZzsKCX0KCn07CgoKLy8gR2V0IHRoZSBsYXN0IHRvYyBlbnRyeSBkZXNjZW5kYW50IGZyb20gdGhlIHByb3ZpZGVkIG9uZQpmdW5jdGlvbiBnZXRMYXN0RGVzY2VuZGFudChlbCkgewoJY29uc3Qgcm93ID0gZ2V0Um93KGVsKQoJaWYgKF8uaXNOaWwocm93KSkge3JldHVybn0KCWNvbnN0IGNoaWxkcmVuID0gcm93LmRpcmVjdENoaWxkcmVuCglpZiAoXy5pc0VtcHR5KGNoaWxkcmVuKSkgewoJCXJldHVybiByb3cKCX0gZWxzZSB7CgkJcmV0dXJuIGdldExhc3REZXNjZW5kYW50KF8ubGFzdChjaGlsZHJlbikpCgl9Cn0KCi8vIEZpbmQgYWxsIHRoZSBjZWxsIGlkcyBjb250YWluZWQgd2l0aGluIHRoZSB0YXJnZXQgdG9jIHJvd3MgYW5kIGFsbCBpdHMgZGVzY2VuZGFudHMKZnVuY3Rpb24gZ2V0QmxvY2tJZHMoZWwpIHsKCWNvbnN0IHJvdyA9IGdldFJvdyhlbCkKCWlmIChfLmlzTmlsKHJvdykpIHtyZXR1cm59CglmdW5jdGlvbiBnZXRJbmRleChyb3cpIHsKCQlyZXR1cm4gZWRpdG9yX3N0YXRlLm5vdGVib29rLmNlbGxfb3JkZXIuaW5kZXhPZihnZXRfbGlua19pZChyb3cpKQoJfQoJY29uc3Qgc3RhcnQgPSBnZXRJbmRleChyb3cpCgoJY29uc3QgbGFzdENoaWxkID0gZ2V0TGFzdERlc2NlbmRhbnQocm93KQoJY29uc3QgZW5kID0gZ2V0SW5kZXgoZ2V0TmV4dFNpYmxpbmcobGFzdENoaWxkLCAnLnRvYy1yb3cnKSkKCglyZXR1cm4gZWRpdG9yX3N0YXRlLm5vdGVib29rLmNlbGxfb3JkZXIuc2xpY2Uoc3RhcnQsIGVuZCA8IDAgPyBJbmZpbml0eSA6IGVuZCkKfQoJCndpbmRvdy50b2NfdXRpbHMgPSB7CglnZXROZXh0U2libGluZywKCWdldFByZXZpb3VzU2libGluZywKCWdldExhc3REZXNjZW5kYW50LAoJZ2V0QmxvY2tJZHMsCn0KCi8vIEZ1bmN0aW9ucyB0byBzZXQgYW5kIHByb3BhZ2F0ZSBoaWRkZW4gYW5kIGNvbGxhcHNlZCBzdGF0ZXMKCmZ1bmN0aW9uIHByb3BhZ2F0ZV9wYXJlbnQoZGl2LCBwYXJlbnQ9bnVsbCkgewoJaWYgKHBhcmVudCAhPSBudWxsKSB7CgkJZGl2LmFsbFBhcmVudHMgPSBfLnVuaW9uKGRpdi5hbGxQYXJlbnRzLCBbcGFyZW50XSkJCgl9CglpZiAoXy5pc0VtcHR5KGRpdi5kaXJlY3RDaGlsZHJlbikpIHtyZXR1cm59Cglmb3IgKGNvbnN0IGNoaWxkIG9mIGRpdi5kaXJlY3RDaGlsZHJlbikgewoJCXByb3BhZ2F0ZV9wYXJlbnQoY2hpbGQsIHBhcmVudCA/PyBkaXYpCgl9Cn0KCi8vIFJldHVybnMgdHJ1ZSBpZiB0aGUgY3VycmVudCBoaWRkZW4vY29sbGFwc2VkIHRvYyBzdGF0ZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgb25lIHNhdmVkIGluIHRoZSBmaWxlIHdpdGhpbiBjZWxsIG1ldGFkYXRhCmZ1bmN0aW9uIHN0YXRlRGlmZmVyc0ZpbGUoc3RhdGUpIHsKCWZvciAoY29uc3QgW2lkLCBzdF0gb2YgXy5lbnRyaWVzKHN0YXRlKSkgewoJCWlmIChoYXNfY2VsbF9hdHRyaWJ1dGUoaWQsICd0b2MtaGlkZGVuJykgIT0gc3QuaGlkZGVuKSB7IHJldHVybiB0cnVlIH0KCQlpZiAoaGFzX2NlbGxfYXR0cmlidXRlKGlkLCAndG9jLWNvbGxhcHNlZCcpICE9IHN0LmNvbGxhcHNlZCkgeyByZXR1cm4gdHJ1ZSB9Cgl9CglyZXR1cm4gZmFsc2UKfQoKZnVuY3Rpb24gc2V0X3N0YXRlKGRpdiwgc3RhdGUsIHZhbHVlLCBpbml0ID0gZmFsc2UpIHsKCWRpdi5jbGFzc0xpc3QudG9nZ2xlKHN0YXRlLCB2YWx1ZSkKCWlmICghaW5pdCkgewoJCXdpbmRvdy50b2Nfc3RhdGVbZ2V0X2xpbmtfaWQoZGl2KV1bc3RhdGVdID0gdmFsdWUKCQl0b2MuY2xhc3NMaXN0LnRvZ2dsZSgnZmlsZS1zdGF0ZS1kaWZmZXJzJywgc3RhdGVEaWZmZXJzRmlsZSh3aW5kb3cudG9jX3N0YXRlKSkKCX0KCWlmIChfLmlzRW1wdHkoZGl2LmRpcmVjdENoaWxkcmVuKSkge3JldHVybn0KCWZvciAoY29uc3QgY2hpbGQgb2YgZGl2LmRpcmVjdENoaWxkcmVuKSB7CgkJcHJvcGFnYXRlX3N0YXRlKGNoaWxkLCBzdGF0ZSkKCX0KfQpmdW5jdGlvbiBwcm9wYWdhdGVfc3RhdGUoZGl2LCBzdGF0ZSkgewoJbGV0IG5ld19zdGF0ZSA9IGBwYXJlbnQtJHtzdGF0ZX1gCglkaXYuY2xhc3NMaXN0LnRvZ2dsZShuZXdfc3RhdGUsIGZhbHNlKQoJLy8gQ2hlY2sgdGhlIHBhcmVudHMgZm9yIHRoZSBzdGF0ZQoJZm9yIChjb25zdCBwYXJlbnQgb2YgZGl2LmFsbFBhcmVudHMpIHsKCQlpZiAocGFyZW50LmNsYXNzTGlzdC5jb250YWlucyhzdGF0ZSkpIHsKCQkJZGl2LmNsYXNzTGlzdC50b2dnbGUobmV3X3N0YXRlLCB0cnVlKQoJCQlicmVhawoJCX0KCX0KCWlmIChfLmlzRW1wdHkoZGl2LmRpcmVjdENoaWxkcmVuKSkge3JldHVybn0KCWZvciAoY29uc3QgY2hpbGQgb2YgZGl2LmRpcmVjdENoaWxkcmVuKSB7CgkJcHJvcGFnYXRlX3N0YXRlKGNoaWxkLCBzdGF0ZSkKCX0KfQoKCgljb25zdCBmbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbScpCgkvLyB3aW5kb3cuZmxvYXRpbmdfdWkgPSBmbG9hdGluZ191aQoKCgkJZnVuY3Rpb24gYWRkX25vdGVib29rX2F0dHJpYnV0ZXMoYXR0cnMpIHsKCQlwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKCQkJbGV0IG1kID0gbm90ZWJvb2subWV0YWRhdGEKCQkJbWRbImN1c3RvbV9hdHRycyJdID0gXy51bmlvbihtZFsiY3VzdG9tX2F0dHJzIl0sIGF0dHJzKQoJCX0pCgkJbGV0IG5vdGVib29rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncGx1dG8tbm90ZWJvb2snKQoJCWZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHsKCQkJbm90ZWJvb2sudG9nZ2xlQXR0cmlidXRlKGF0dHIsIHRydWUpCgkJfQoJfQoKCWZ1bmN0aW9uIHJlbW92ZV9ub3RlYm9va19hdHRyaWJ1dGVzKGF0dHJzKSB7CgkJcGx1dG9fYWN0aW9ucy51cGRhdGVfbm90ZWJvb2soKG5vdGVib29rKSA9PiB7CgkJCWxldCBtZCA9IG5vdGVib29rLm1ldGFkYXRhCgkJCWxldCBhZnRlciA9IF8uZGlmZmVyZW5jZShtZFsiY3VzdG9tX2F0dHJzIl0sIGF0dHJzKQoJCQlpZiAoXy5pc0VtcHR5KGFmdGVyKSkgewoJCQkJZGVsZXRlIG1kWyJjdXN0b21fYXR0cnMiXQoJCQl9IGVsc2UgewoJCQkJbWRbImN1c3RvbV9hdHRycyJdID0gYWZ0ZXIKCQkJfQoJCX0pCgkJbGV0IG5vdGVib29rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncGx1dG8tbm90ZWJvb2snKQoJCWZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHsKCQkJbm90ZWJvb2sudG9nZ2xlQXR0cmlidXRlKGF0dHIsIGZhbHNlKQoJCX0KCX0KCglmdW5jdGlvbiB0b2dnbGVfbm90ZWJvb2tfYXR0cmlidXRlKGF0dHIsIGZvcmNlPSd0b2dnbGUnKSB7CgkJcGx1dG9fYWN0aW9ucy51cGRhdGVfbm90ZWJvb2soKG5vdGVib29rKSA9PiB7CgkJCWxldCBtZCA9IG5vdGVib29rLm1ldGFkYXRhCgkJCWxldCBmID0gZm9yY2UgPT0gJ3RvZ2dsZScgPyBfLnhvciA6IGZvcmNlID8gXy51bmlvbiA6IF8uZGlmZmVyZW5jZQoJCQlsZXQgYWZ0ZXIgPSBmKG1kWyJjdXN0b21fYXR0cnMiXSwgW2F0dHJdKQoJCQlpZiAoXy5pc0VtcHR5KGFmdGVyKSkgewoJCQkJZGVsZXRlIG1kWyJjdXN0b21fYXR0cnMiXQoJCQl9IGVsc2UgewoJCQkJbWRbImN1c3RvbV9hdHRycyJdID0gYWZ0ZXIKCQkJfQoJCX0pCgkJbGV0IG5vdGVib29rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncGx1dG8tbm90ZWJvb2snKQoJCWZvcmNlID09ICd0b2dnbGUnID8gbm90ZWJvb2sudG9nZ2xlQXR0cmlidXRlKGF0dHIpIDogbm90ZWJvb2sudG9nZ2xlQXR0cmlidXRlKGF0dHIsIGZvcmNlKQoJfQoKCWlmIChmb3JjZV9oaWRlX2VuYWJsZWQpIHsKCSAJdG9nZ2xlX25vdGVib29rX2F0dHJpYnV0ZSgnaGlkZS1lbmFibGVkJyx0cnVlKQoJfQoKCglmdW5jdGlvbiBoYXNfY2VsbF9hdHRyaWJ1dGUoY2VsbF9pZCwgYXR0cikgewoJCWNvbnN0IG1kID0gZWRpdG9yX3N0YXRlLm5vdGVib29rLmNlbGxfaW5wdXRzW2NlbGxfaWRdLm1ldGFkYXRhCgkJcmV0dXJuIF8uaW5jbHVkZXMobWRbImN1c3RvbV9hdHRycyJdLCBhdHRyKQoJfQoJCglmdW5jdGlvbiBhZGRfY2VsbF9hdHRyaWJ1dGVzKGNlbGxfaWQsIGF0dHJzKSB7CgkJcGx1dG9fYWN0aW9ucy51cGRhdGVfbm90ZWJvb2soKG5vdGVib29rKSA9PiB7CgkJCWxldCBtZCA9IG5vdGVib29rLmNlbGxfaW5wdXRzW2NlbGxfaWRdLm1ldGFkYXRhCgkJCW1kWyJjdXN0b21fYXR0cnMiXSA9IF8udW5pb24obWRbImN1c3RvbV9hdHRycyJdLCBhdHRycykKCQl9KQoJCWxldCBjZWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2VsbF9pZCkKCQlmb3IgKGxldCBhdHRyIG9mIGF0dHJzKSB7CgkJCWNlbGwudG9nZ2xlQXR0cmlidXRlKGF0dHIsIHRydWUpCgkJfQoJfQoKCWZ1bmN0aW9uIHJlbW92ZV9jZWxsX2F0dHJpYnV0ZXMoY2VsbF9pZCwgYXR0cnMpIHsKCQlwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKCQkJbGV0IG1kID0gbm90ZWJvb2suY2VsbF9pbnB1dHNbY2VsbF9pZF0ubWV0YWRhdGEKCQkJbGV0IGFmdGVyID0gXy5kaWZmZXJlbmNlKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cnMpCgkJCWlmIChfLmlzRW1wdHkoYWZ0ZXIpKSB7CgkJCQlkZWxldGUgbWRbImN1c3RvbV9hdHRycyJdCgkJCX0gZWxzZSB7CgkJCQltZFsiY3VzdG9tX2F0dHJzIl0gPSBhZnRlcgoJCQl9CgkJfSkKCQlsZXQgY2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNlbGxfaWQpCgkJZm9yIChsZXQgYXR0ciBvZiBhdHRycykgewoJCQljZWxsLnRvZ2dsZUF0dHJpYnV0ZShhdHRyLCBmYWxzZSkKCQl9Cgl9CgoJZnVuY3Rpb24gdG9nZ2xlX2NlbGxfYXR0cmlidXRlKGNlbGxfaWQsIGF0dHIsIGZvcmNlPSd0b2dnbGUnKSB7CgkJcGx1dG9fYWN0aW9ucy51cGRhdGVfbm90ZWJvb2soKG5vdGVib29rKSA9PiB7CgkJCWxldCBtZCA9IG5vdGVib29rLmNlbGxfaW5wdXRzW2NlbGxfaWRdLm1ldGFkYXRhCgkJCWxldCBmID0gZm9yY2UgPT0gJ3RvZ2dsZScgPyBfLnhvciA6IGZvcmNlID8gXy51bmlvbiA6IF8uZGlmZmVyZW5jZQoJCQlsZXQgYWZ0ZXIgPSBmKG1kWyJjdXN0b21fYXR0cnMiXSwgW2F0dHJdKQoJCQlpZiAoXy5pc0VtcHR5KGFmdGVyKSkgewoJCQkJZGVsZXRlIG1kWyJjdXN0b21fYXR0cnMiXQoJCQl9IGVsc2UgewoJCQkJbWRbImN1c3RvbV9hdHRycyJdID0gYWZ0ZXIKCQkJfQoJCX0pCgkJbGV0IGNlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjZWxsX2lkKQoJCWZvcmNlID09ICd0b2dnbGUnID8gY2VsbC50b2dnbGVBdHRyaWJ1dGUoYXR0cikgOiBjZWxsLnRvZ2dsZUF0dHJpYnV0ZShhdHRyLCBmb3JjZSkKCX0KCgoJLy8gRm9yIGVhY2ggZnJvbSBhbmQgdG8sIHdlIGhhdmUgdG8gc3BlY2lmeSBgcGx1dG8tY2VsbFtpZF1gIGluIHRoZSBwYXJ0IGJlZm9yZSB0aGUgY29tbSBhbmQganVzdCBgW2lkXWAgaW4gdGhlIHBhcnQgYWZ0ZXIgdGhlIGNvbW1hIHRvIGVuc3VyZSB0aGUgc3BlY2lmaWNpdHkgb2YgdGhlIHR3byBjb21tYS1zZXBhcmF0ZWQgc2VsZWN0b3JzIGlzIHRoZSBzYW1lICh0aGUgcGFydCBhZnRlciB0aGUgY29tbWEgaGFzIHRoZSBhZGRpdGlvbiBvZiBgfiBwbHV0by1jZWxsYCwgc28gaXQgaGFzIGluaGVyZW50bHkgKzEgZWxlbWVudCBzcGVjaWZpY2l0eSkKCWZ1bmN0aW9uIGhpZGVfZnJvbV90b19zdHJpbmcoZnJvbV9pZCwgdG9faWQpIHsKCQlpZiAoXy5pc0VtcHR5KGZyb21faWQpICYmIF8uaXNFbXB0eSh0b19pZCkpIHtyZXR1cm4gJyd9CgkJCgkJY29uc3QgZnJvbV9wcmVzZWxlY3RvciA9IF8uaXNFbXB0eShmcm9tX2lkKSA/ICcnIDogYHBsdXRvLWNlbGxbaWQ9JyR7ZnJvbV9pZH0nXSwgcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBbaWQ9JyR7ZnJvbV9pZH0nXSB+IGAKCQljb25zdCB0b19zdHlsZSA9IF8uaXNFbXB0eSh0b19pZCkgPyAnJyA6IGBwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbaWQ9JyR7dG9faWR9J10sIHBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gW2lkPScke3RvX2lkfSddIH4gcGx1dG8tY2VsbCB7CgkJZGlzcGxheTogYmxvY2s7Cgl9CgkgYAoJCWNvbnN0IHN0eWxlX3N0cmluZyA9IAlgcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSAke2Zyb21fcHJlc2VsZWN0b3J9cGx1dG8tY2VsbCB7CgkJZGlzcGxheTogbm9uZTsKCX0KCSR7dG9fc3R5bGV9CiBgCgkJcmV0dXJuIHN0eWxlX3N0cmluZwoJCS8vcmV0dXJuIGh0bWxgPHN0eWxlPiR7c3R5bGVfc3RyaW5nfTwvc3R5bGU+YAoJfQoKCWZ1bmN0aW9uIGhpZGVfZnJvbV90b19saXN0X3N0cmluZyh2ZWN0b3IpIHsKCQlsZXQgb3V0ID0gYGAKCQlmb3IgKGNvbnN0IGxpbXMgb2YgdmVjdG9yKSB7CgkJCWNvbnN0IGZyb20gPSBsaW1zWzBdCgkJCWNvbnN0IHRvID0gbGltc1sxXQoJCQkKCQkJb3V0ID0gYCR7b3V0fQkke2hpZGVfZnJvbV90b19zdHJpbmcoZnJvbSx0byl9YAoJCX0KCQlvdXQgPSBgJHtvdXR9CXBsdXRvLWNlbGxbYWx3YXlzLXNob3ddIHsKICAJCQlkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50OwogIAkJfQogIGAKCQlyZXR1cm4gb3V0Cgl9CglmdW5jdGlvbiBoaWRlX2Zyb21fdG9fbGlzdCh2ZWN0b3IpIHsKCQljb25zdCBzdHIgPSBoaWRlX2Zyb21fdG9fbGlzdF9zdHJpbmcodmVjdG9yKQoJCXJldHVybiBodG1sYDxzdHlsZT4ke3N0cn08L3N0eWxlPmAKCX0KCWZ1bmN0aW9uIGhpZGVfbGlzdF9zdHlsZSh2ZWN0b3IpIHsKCQlsZXQgc3R5bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGlkZS1jZWxscy1zdHlsZScpCgkJaWYgKHN0eWxlID09IG51bGwpIHsKICAJCQlzdHlsZSA9IGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoaHRtbGA8c3R5bGUgaWQ9J2hpZGUtY2VsbHMtc3R5bGUnPjwvc3R5bGU+YCkKCQl9CgkJc3R5bGUuaW5uZXJIVE1MID0gaGlkZV9mcm9tX3RvX2xpc3Rfc3RyaW5nKHZlY3RvcikKCX0KCgoJZnVuY3Rpb24gc2F2ZV90b19maWxlKCkgewoJCWNvbnN0IHN0YXRlID0gd2luZG93LnRvY19zdGF0ZQoJCWZvciAoY29uc3QgW2ssdl0gb2YgT2JqZWN0LmVudHJpZXMoc3RhdGUpKSB7CgkJCXRvZ2dsZV9jZWxsX2F0dHJpYnV0ZShrLCAndG9jLWhpZGRlbicsIHYuaGlkZGVuKQkKCQkJdG9nZ2xlX2NlbGxfYXR0cmlidXRlKGssICd0b2MtY29sbGFwc2VkJywgdi5jb2xsYXBzZWQpCQoJCX0KCQlzZXRUaW1lb3V0KCgpID0+IHsKCQkJdG9jLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbGUtc3RhdGUtZGlmZmVycycsIHN0YXRlRGlmZmVyc0ZpbGUoc3RhdGUpKQoJCX0sIDUwMCkKCX0KCgoJY29uc3QgaGVhZGVyID0gdG9jLnF1ZXJ5U2VsZWN0b3IoJ2hlYWRlcicpCgljb25zdCBoZWFkZXJfY29udGFpbmVyID0gaGVhZGVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1oZWFkZXItY29udGFpbmVyJz5gKQoJCgkKCWNvbnN0IG5vdGVib29rX2hpZGVfaWNvbiA9IGhlYWRlcl9jb250YWluZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdiZWZvcmVlbmQnLCBodG1sYDxzcGFuIGNsYXNzPSd0b2MtaGVhZGVyLWljb24gdG9jLWhlYWRlci1oaWRlJz5gKQoJCgljb25zdCBzYXZlX2ZpbGVfaWNvbiA9IGhlYWRlcl9jb250YWluZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdiZWZvcmVlbmQnLCBodG1sYDxzcGFuIGNsYXNzPSd0b2MtaGVhZGVyLWljb24gdG9jLWhlYWRlci1zYXZlJz5gKQoJc2F2ZV9maWxlX2ljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzYXZlX3RvX2ZpbGUpCgoJaGVhZGVyX2NvbnRhaW5lci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1oZWFkZXItZmlsbGVyJz5gKQoJCgloZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHsKCQlpZiAoZS50YXJnZXQgIT0gaGVhZGVyKSB7cmV0dXJufQoJCXNjcm9sbF90byhjZWxsLCB7YmxvY2s6ICdjZW50ZXInLCBiZWhhdmlvcjogJ3Ntb290aCd9KQoJfSkKCgloZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIChlKSA9PiB7CgkJZmxvYXRpbmdfdWkuY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgaGVhZGVyX2NvbnRhaW5lciwgewoJCQlwbGFjZW1lbnQ6ICJsZWZ0IiwKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJfSkudGhlbihwb3MgPT4gewoJCQloZWFkZXJfY29udGFpbmVyLnN0eWxlLnRvcCA9IHBvcy55ICsgInB4IgoJCQkvLyBoZWFkZXJfY29udGFpbmVyLnN0eWxlLmxlZnQgPSBwb3MueCArICJweCIKCQkJLy8gaGVhZGVyX2NvbnRhaW5lci5zdHlsZS5yaWdodCA9IGBjYWxjKDFyZW0gKyBtaW4oODB2dywgMzAwcHgpKWAKCQl9KQoJfSkKCglub3RlYm9va19oaWRlX2ljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewoJCQkvLyBXZSBmaW5kIHRoZSB4IGNvb3JkaW5hdGUgb2YgdGhlIHBsdXRvLW5vdGVib29rIGVsZW1lbnQsIHRvIGF2b2lkIG1pc3NpbmcgdGhlIGNlbGwgd2hlbiBVSSBpcyBkaXNhYmxlZAoJCQljb25zdCB7IHggfSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3BsdXRvLW5vdGVib29rJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKCQkJY29uc3QgcmVmID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh4KzEsMTAwKS5jbG9zZXN0KCdwbHV0by1jZWxsJykKCQkJY29uc3QgeyB5IH0gPSByZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKCQkJdG9nZ2xlX25vdGVib29rX2F0dHJpYnV0ZSgnaGlkZS1lbmFibGVkJykKCQkJY29uc3QgZHkgPSByZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkueSAtIHkKCQkJd2luZG93LnNjcm9sbEJ5KDAsIGR5KQoJfSkKCmNlbGwudG9nZ2xlQXR0cmlidXRlKCdhbHdheXMtc2hvdycsIHRydWUpCgoJZnVuY3Rpb24gdG9nZ2xlX3N0YXRlKG5hbWUpIHsKCQlyZXR1cm4gKGUpID0+IHsKCQkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJbGV0IGRpdiA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2RpdicpCgkJCWNvbnN0IG5ld192YWwgPSAhZGl2LmNsYXNzTGlzdC5jb250YWlucyhuYW1lKQoJCQlzZXRfc3RhdGUoZGl2LCBuYW1lLCBuZXdfdmFsKQoJCX0KCX0KCglmdW5jdGlvbiB1cGRhdGVfaGlkZGVuKGUpIHsKCQlsZXQgbmV3X2hpZGUgPSBbXQoJCWlmIChoaWRlX3ByZWFtYmxlKSB7CgkJCW5ld19oaWRlLnB1c2goWycnLCBnZXRfbGlua19pZCh0b2MucXVlcnlTZWxlY3RvcignZGl2LnRvYy1yb3cnKSldKQoJCX0KCQlsZXQgdHJhY2tpbmdfaGlkZGVuID0gbnVsbAoJCWxldCBkaXZzID0gdG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi50b2Mtcm93JykKCQlmb3IgKGNvbnN0IGRpdiBvZiBkaXZzKSB7CgkJCWlmICh0cmFja2luZ19oaWRkZW4gIT0gbnVsbCkgewoJCQkJY29uc3QgaGlkZGVuID0gZGl2LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykgfHwgZGl2LmNsYXNzTGlzdC5jb250YWlucygncGFyZW50LWhpZGRlbicpCgkJCQlpZiAoIWhpZGRlbikgewoJCQkJCW5ld19oaWRlLnB1c2goW3RyYWNraW5nX2hpZGRlbiwgZ2V0X2xpbmtfaWQoZGl2KV0pCQoJCQkJCXRyYWNraW5nX2hpZGRlbiA9IG51bGwKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWNvbnN0IGhpZGRlbiA9IGRpdi5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGRlbicpCgkJCQlpZiAoaGlkZGVuKSB7CgkJCQkJdHJhY2tpbmdfaGlkZGVuID0gZ2V0X2xpbmtfaWQoZGl2KQoJCQkJfQoJCQl9CgkJfQoJCWlmICh0cmFja2luZ19oaWRkZW4gIT0gbnVsbCkgewoJCQkJbmV3X2hpZGUucHVzaChbdHJhY2tpbmdfaGlkZGVuLCAiIl0pCQoJCX0KCQloaWRlX2xpc3Rfc3R5bGUobmV3X2hpZGUpCgl9CgoJLy8gUmVwb3NpdGlvbiB0aGUgaGlkZV9jb250YWluZXIgdXNpbmcgdGhlIGZsb2F0aW5nLXVpIGxpYnJhcnkKCWZ1bmN0aW9uIHJlcG9zaXRpb25Ub29sdGlwKGUpIHsKCQljb25zdCB7IGNvbXB1dGVQb3NpdGlvbiB9ID0gZmxvYXRpbmdfdWkKCQljb25zdCByZWYgPSBlLnRhcmdldAoJCWNvbnN0IHRvb2x0aXAgPSByZWYucXVlcnlTZWxlY3RvcignLnRvYy1oaWRlLWNvbnRhaW5lcicpCgkJaWYgKF8uaXNOaWwodG9vbHRpcCkpIHsKCQkJY29uc29sZS53YXJuKCJTb21ldGhpbmcgd2VudCB3cm9uZywgbm8gdG9vbHRpcCBmb3VuZCIpCgkJCXJldHVybgoJCX0KCQljb21wdXRlUG9zaXRpb24ocmVmLCB0b29sdGlwLCB7CgkJCXBsYWNlbWVudDogImxlZnQiLAoJCQlzdHJhdGVneTogImZpeGVkIiwKCQl9KS50aGVuKHBvcyA9PiB7CgkJCXRvb2x0aXAuc3R5bGUudG9wID0gcG9zLnkgKyAicHgiCgkJfSkKCX0KCQoJZnVuY3Rpb24gcHJvY2Vzc19yb3coZGl2LCBoaXN0b3J5LCBvbGRfc3RhdGUsIG5ld19zdGF0ZSkgewoKCQkvLyBXZSBhZGQgdGhlIHNlcGFyYXRvcgoJCWRpdi5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWJlZ2luJywgaHRtbGA8ZGl2IGNsYXNzPSd0b2Mtcm93LXNlcGFyYXRvcic+PC9kaXY+YCkKCQkvLyBJZiB3ZSBhcmUganVzdCBwcm9jZXNzaW5nIHRoZSBmaXJzdCBlbGVtZW50IChzbyB0aGUgbGFzdCByb3cpIHdlIGFsc28gYWRkIGEgc2VwYXJhdG9yIGF0IHRoZSBib3R0b20KCQlpZiAoXy5pc0VtcHR5KG5ld19zdGF0ZSkgJiYgXy5ldmVyeShoaXN0b3J5LCBfLmlzRW1wdHkpKSB7CgkJCWRpdi5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgaHRtbGA8ZGl2IGNsYXNzPSd0b2Mtcm93LXNlcGFyYXRvcic+PC9kaXY+YCkKCQl9CgoJCS8vIFdlIGFkZCB0aGUgcmVwb3NpdGlvbiBldmVudCB0byB0aGUgcm93CgkJZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCByZXBvc2l0aW9uVG9vbHRpcCkKCQkKCQlsZXQgaWQgPSBnZXRfbGlua19pZChkaXYpCgkJY29uc3QgYSA9IGRpdi5xdWVyeVNlbGVjdG9yKCdhJykKCQlsZXQgb2xkX2YgPSBhLm9uY2xpY2s7CgkJYS5vbmNsaWNrID0gKGUpID0+IHsKCQkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJCS8vIFdlIGF2b2lkIHRyaWdnZXJpbmcgdGhlIGNsaWNrIGlmIGNvbWluZyBvdXQgb2YgYSBkcmFnCgkJCWlmICh0b2MuY2xhc3NMaXN0LmNvbnRhaW5zKCdyZWNlbnQtZHJhZycpKSB7IHJldHVybiB9CgkJCW9sZF9mKGUpCgkJfQkJCQoJCWNvbnN0IGxldmVsID0gZ2V0SGVhZGluZ0xldmVsKGRpdikKCQlpZiAobGV2ZWwgPiAxKSB7CgkJCWhpc3RvcnlbbGV2ZWxdLnVuc2hpZnQoZGl2KQoJCX0KCQkvLyBXZSBpdGVyYXRlIHRocm91Z2ggdGhlIGhpc3RvcnkgYW5kIGFzc2lnbiB0aGUgZGlyZWN0IGNoaWxkcmVuIGlmIHRoZXkgZXhpc3QsIHdoaWxlIGNsZWFyaW5nIGxvd2VyIGxldmVscyBoaXN0b3J5CgkJZm9yIChsZXQgaSA9IDY7IGkgPiBsZXZlbDsgaS0tKSB7CgkJCWlmIChfLmlzRW1wdHkoaGlzdG9yeVtpXSkpIHtjb250aW51ZX0KCQkJaWYgKGRpdi5kaXJlY3RDaGlsZHJlbiAhPSB1bmRlZmluZWQpIHt0aHJvdygnbXVsdGlwbGUgbGV2ZWwgd2l0aCBjaGlsZHJlbiwgdW5leHBlY3RlZCEnKX0KCQkJZGl2LmRpcmVjdENoaWxkcmVuID0gaGlzdG9yeVtpXQoJCQloaXN0b3J5W2ldID0gW10gLy8gZW1wdHkgYXJyYXkKCQl9CgkJY29uc3QgY29sbGFwc2Vfc3BhbiA9IGEuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWljb24gdG9jLWNvbGxhcHNlJz5gKQoJCWxldCBoaWRlX3N0eWxlID0gYC0taGVpZ2h0OiAke2EuY2xpZW50SGVpZ2h0fXB4YAoJCWNvbnN0IGhpZGVfY29udGFpbmVyID0gZGl2Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1oaWRlLWNvbnRhaW5lcicgc3R5bGU9JyR7aGlkZV9zdHlsZX0nPmApCgkJY29uc3QgaGlkZV9zcGFuID0gaGlkZV9jb250YWluZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWljb24gdG9jLWhpZGUnPmApCgkJaGlkZV9zcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKCQkJdG9nZ2xlX3N0YXRlKCdoaWRkZW4nKShlKQoJCQl1cGRhdGVfaGlkZGVuKGUpCgkJfSkKCQlpZiAoZGl2LmRpcmVjdENoaWxkcmVuID09IHVuZGVmaW5lZCkgewoJCQljb2xsYXBzZV9zcGFuLmNsYXNzTGlzdC50b2dnbGUoJ25vLWNoaWxkcmVuJywgdHJ1ZSkKCQl9IGVsc2UgewoJCQlwcm9wYWdhdGVfcGFyZW50KGRpdikKCQkJY29sbGFwc2Vfc3Bhbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZV9zdGF0ZSgnY29sbGFwc2VkJykpCgkJfQoJCWxldCBtZCA9IGVkaXRvcl9zdGF0ZS5ub3RlYm9vay5jZWxsX2lucHV0c1tpZF0ubWV0YWRhdGEKCQlsZXQgY29sbGFwc2VkID0gb2xkX3N0YXRlW2lkXT8uY29sbGFwc2VkID8/ICBfLmluY2x1ZGVzKG1kWydjdXN0b21fYXR0cnMnXSwgJ3RvYy1jb2xsYXBzZWQnKQoJCWxldCBoaWRkZW4gPSBvbGRfc3RhdGVbaWRdPy5oaWRkZW4gPz8gXy5pbmNsdWRlcyhtZFsnY3VzdG9tX2F0dHJzJ10sICd0b2MtaGlkZGVuJykKCQlzZXRfc3RhdGUoZGl2LCAnY29sbGFwc2VkJywgY29sbGFwc2VkLCB0cnVlKQoJCXNldF9zdGF0ZShkaXYsICdoaWRkZW4nLCBoaWRkZW4sIHRydWUpCgkJbmV3X3N0YXRlW2lkXSA9IHsgY29sbGFwc2VkLCBoaWRkZW4gfQoJCQoJfQoKCWNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4gewoJCWNvbnN0IHJvd3MgPSB0b2MucXVlcnlTZWxlY3RvckFsbCgnc2VjdGlvbiBkaXYudG9jLXJvdycpCgkJbGV0IG9sZF9zdGF0ZSA9IHdpbmRvdy50b2Nfc3RhdGUgPz8ge30KCQlsZXQgbmV3X3N0YXRlID0ge30KCQlsZXQgaGlzdG9yeSA9IHsKCQkJMjogW10sCgkJCTM6IFtdLAoJCQk0OiBbXSwKCQkJNTogW10sCgkJCTY6IFtdLAoJCX0KCQlmb3IgKGNvbnN0IHJvdyBvZiBbLi4ucm93c10ucmV2ZXJzZSgpKSB7CgkJCXByb2Nlc3Nfcm93KHJvdywgaGlzdG9yeSwgb2xkX3N0YXRlLCBuZXdfc3RhdGUpCgkJfQoJCXdpbmRvdy50b2Nfc3RhdGUgPSBuZXdfc3RhdGUKCQl0b2MuY2xhc3NMaXN0LnRvZ2dsZSgnZmlsZS1zdGF0ZS1kaWZmZXJzJywgc3RhdGVEaWZmZXJzRmlsZShuZXdfc3RhdGUpKQoJCXVwZGF0ZV9oaWRkZW4oKQoJfSkKCglvYnNlcnZlci5vYnNlcnZlKHRvYywge2NoaWxkTGlzdDogdHJ1ZX0pCgoKCWNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgoJLy8gV2UgaGF2ZSB0byBlbmFibGUgZHluYW1pY0Ryb3AgdG8gaGF2ZSBkcm9wem9uZSByZWNvbXB1dGVkIG9uIGRyYWdtb3ZlCglpbnRlcmFjdC5keW5hbWljRHJvcCh0cnVlKQoKCWZ1bmN0aW9uIGRyYWdFbmFibGVyKGUpIHsKCQlpZiAoIXRvYy5jbGFzc0xpc3QuY29udGFpbnMoJ2RyYWdfZW5hYmxlZCcpIHx8IGUua2V5ICE9PSAnU2hpZnQnKSB7IHJldHVybiB0cnVlIH0KCQlzd2l0Y2ggKGUudHlwZSkgewoJCQljYXNlICJrZXlkb3duIjoKCQkJCXRvYy5jbGFzc0xpc3QuYWRkKCdhbGxvd19hbGxfZHJvcCcpCgkJCQlicmVhazsKCQkJY2FzZSAia2V5dXAiOgoJCQkJdG9jLmNsYXNzTGlzdC5yZW1vdmUoJ2FsbG93X2FsbF9kcm9wJykKCQkJCWJyZWFrOwoJCX0KCQl1cGRhdGVBY3RpdmVTZXBhcmF0b3IoKQoJfQoKCWNvbnN0IHdpbmRvd19ldmVudHMgPSB7CgkJa2V5ZG93bjogZHJhZ0VuYWJsZXIsCgkJa2V5dXA6IGRyYWdFbmFibGVyLAoJfQoKCWFkZFNjcmlwdEV2ZW50TGlzdGVuZXJzKHdpbmRvdywgd2luZG93X2V2ZW50cykKCgkvLyBJbnRlcmFjdC5qcyBwYXJ0CgoJbGV0IGFjdGl2ZURyb3AgPSB1bmRlZmluZWQKCglmdW5jdGlvbiB0YWdBZGphY2VudFNlcGFyYXRvcnMoZWwsIGFjdGl2ZSkgewoJCWNvbnN0IG5leHQgPSBnZXROZXh0U2libGluZyhlbCwgJy50b2Mtcm93LXNlcGFyYXRvcicpCgkJY29uc3QgcHJldiA9IGdldFByZXZpb3VzU2libGluZyhlbCwgJy50b2Mtcm93LXNlcGFyYXRvcicpCgkJaWYgKGFjdGl2ZSkgewogIAkJCW5leHQ/LmNsYXNzTGlzdC5hZGQoJ25vc2hvdycpCiAgCQkJcHJldj8uY2xhc3NMaXN0LmFkZCgnbm9zaG93JykKCQl9IGVsc2UgewogIAkJCW5leHQ/LmNsYXNzTGlzdC5yZW1vdmUoJ25vc2hvdycpCiAgCQkJcHJldj8uY2xhc3NMaXN0LnJlbW92ZSgnbm9zaG93JykJCQkJCgkJfQoJfQoKCWZ1bmN0aW9uIGdldFNlcGFyYXRvcihzdGFydEVsZW1lbnQsIGJlbG93LCBhbGxvd0FsbCwgaGVhZGluZ0xldmVsID0gOCkgewoJCWxldCBzZXBhcmF0b3IKCQlpZiAoYmVsb3cpIHsKCQkJY29uc3Qgc2VsZWN0b3IgPSAnLnRvYy1yb3c6bm90KC5wYXJlbnQtY29sbGFwc2VkKScKCQkJY29uc3QgY2hlY2tlckZ1bmMgPSBhbGxvd0FsbCA/IGdlbmVyYXRlQ2hlY2tlcihzZWxlY3RvcikgOiAoZWwpID0+IHsKCQkJCWlmICghZWwubWF0Y2hlcyhzZWxlY3RvcikpIHsgcmV0dXJuIGZhbHNlIH0KCQkJCS8vIENoZWNrIGZvciB0aGUgcmlnaHQgaGVhZGluZyBsZXZlbAoJCQkJZm9yIChsZXQgaSA9IGhlYWRpbmdMZXZlbDsgaSA+IDA7IGktLSkgewoJCQkJCWNvbnN0IGNsID0gIkgiICsgaQoJCQkJCWlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoY2wpKSB7IHJldHVybiB0cnVlIH0KCQkJCX0KCQkJCXJldHVybiBmYWxzZQoJCQl9CgkJCWNvbnN0IHZhbGlkUm93ID0gZ2V0TmV4dFNpYmxpbmcoc3RhcnRFbGVtZW50LCBjaGVja2VyRnVuYykKCQkJLy8gSWYgdGhlIGFjdGl2ZURyb3AgaXMgdGhlIGxhc3Qgcm93IG9yIHRoZSB0aGUgbGFzdCBub24tY29sbGFwc2VkIG9uZSwgdGhlIHZhbGlkUm93IHdpbGwgYmUgYHVuZGVmaW5lZGAsIHNvIGluIHRoYXQgY2FzZSB3ZSB0YWtlIHRoZSBsYXN0IHNlcGFyYXRvcgoJCQlzZXBhcmF0b3IgPSBnZXRQcmV2aW91c1NpYmxpbmcodmFsaWRSb3csICcudG9jLXJvdy1zZXBhcmF0b3InKSA/PyBfLmxhc3QodG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2Mtcm93LXNlcGFyYXRvcicpKQoJCX0gZWxzZSB7CgkJCXNlcGFyYXRvciA9IGdldFByZXZpb3VzU2libGluZyhzdGFydEVsZW1lbnQsICcudG9jLXJvdy1zZXBhcmF0b3InKQoJCX0KCQlyZXR1cm4gc2VwYXJhdG9yCgl9CgoJZnVuY3Rpb24gZ2V0SGlnaGVyUGFyZW50KHJvdywgbGV2ZWwpIHsKCQljb25zdCBjdXJyZW50TGV2ZWwgPSBnZXRIZWFkaW5nTGV2ZWwocm93KQoJCWlmIChjdXJyZW50TGV2ZWwgPD0gbGV2ZWwpIHtyZXR1cm4gcm93fQoJCWZvciAoY29uc3QgcGFyIG9mIHJvdy5hbGxQYXJlbnRzKSB7CgkJCS8vIFBhcmVudHMgY3ljbGUgZnJvbSBoaWdoZXIgbGV2ZWwgdG8gbG93ZXIgbGV2ZWxzCgkJCWlmIChnZXRIZWFkaW5nTGV2ZWwocGFyKSA8PSBsZXZlbCkge3JldHVybiBwYXJ9CgkJfQoJCXJldHVybiByb3cKCX0KCQkKCWxldCB1bmNvbGxhcHNlZCA9IFtdCgoJZnVuY3Rpb24gcmVDb2xsYXBzZShyb3cpIHsKCQljb25zdCBwYXJlbnRzID0gcm93Py5hbGxQYXJlbnRzID8/IFtdCgkJY29uc3QgdG9SZW1vdmUgPSBfLmRpZmZlcmVuY2UodW5jb2xsYXBzZWQsIFsuLi5wYXJlbnRzLCByb3ddKQoJCWZvciAoY29uc3QgZWwgb2YgdG9SZW1vdmUpIHsKCQkJLy8gZGVidWdnZXIKCQkJc2V0X3N0YXRlKGVsLCAiY29sbGFwc2VkIiwgdHJ1ZSkKCQkJXy5yZW1vdmUodW5jb2xsYXBzZWQsIHggPT4geCA9PT0gZWwpCgkJfQoJfQoKCglmdW5jdGlvbiB1cGRhdGVEcm9wWm9uZShyb3cpIHsKCQljb25zdCBwcmV2ID0gdG9jLnF1ZXJ5U2VsZWN0b3IoJy50b2Mtcm93LmFjdGl2ZV9kcm9wJykKCQlpZiAoXy5pc05pbChyb3cpIHx8IHByZXYgPT09IHJvdykge3JldHVybn0KCQlpZiAocHJldj8udGltZW91dElkKSB7CgkJCWNsZWFyVGltZW91dChwcmV2LnRpbWVvdXRJZCkKCQkJcHJldi50aW1lb3V0SWQgPSB1bmRlZmluZWQKCQl9CgkJcHJldj8uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlX2Ryb3AnKQoJCXJvdy5jbGFzc0xpc3QuYWRkKCdhY3RpdmVfZHJvcCcpCgkJcmVDb2xsYXBzZShyb3cpCgkJaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpKSB7CgkJCXJvdy50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKCQkJCXVuY29sbGFwc2VkLnB1c2gocm93KQoJCQkJc2V0X3N0YXRlKHJvdywgImNvbGxhcHNlZCIsIGZhbHNlKQoJCQkJdXBkYXRlQWN0aXZlU2VwYXJhdG9yKCkKCQkJfSwgNTAwKQoJCX0KCQlhY3RpdmVEcm9wID0gcm93Cgl9CgoJZnVuY3Rpb24gdXBkYXRlQWN0aXZlU2VwYXJhdG9yKCkgewoJCWNvbnN0IGUgPSB0b2MubGFzdERyYWdFdmVudAoJCWlmIChfLmlzTmlsKGUpKSB7IHJldHVybiB9CgkJY29uc3QgZWxCZWxvdyA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZS5jbGllbnQueCwgZS5jbGllbnQueSkKCQlpZiAoIWVsQmVsb3cubWF0Y2hlcygnLnBsdXRvdWktdG9jIDpzY29wZScpKSB7CgkJCS8vIFdlIGFyZSBvdXQgb2YgdGhlIFRvQywgcmVjb2xsYXBzZSBhbmQgcmVtb3ZlIGFjdGl2ZSBzZXBhcmF0b3IKCQkJcmVDb2xsYXBzZSh1bmRlZmluZWQpCgkJCXRvYy5xdWVyeVNlbGVjdG9yKCcudG9jLXJvdy1zZXBhcmF0b3IuYWN0aXZlJyk/LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpCgkJCXJldHVybgoJCX0KCQljb25zdCByb3dCZWxvdyA9IGdldFJvdyhlbEJlbG93KQoJCXVwZGF0ZURyb3Bab25lKHJvd0JlbG93KQoJCWlmIChfLmlzTmlsKGFjdGl2ZURyb3ApKSB7cmV0dXJufQoJCWNvbnN0IGFsbG93QWxsID0gdG9jLmNsYXNzTGlzdC5jb250YWlucygnYWxsb3dfYWxsX2Ryb3AnKQoJCWNvbnN0IGhlYWRpbmdMZXZlbCA9IGdldEhlYWRpbmdMZXZlbCh0b2MuZHJhZ2dlZEVsZW1lbnQpCgkJY29uc3QgeyB5LCBoZWlnaHQgfSA9IGFjdGl2ZURyb3AuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKCQlsZXQgdGhyZXNob2xkWSA9IHkgKyBoZWlnaHQvMgoJCWlmICghYWxsb3dBbGwpIHsKCQkJLy8gV2Ugb25seSBhbGxvdyBwdXR0aW5nIHRoZSBkcmFnZ2VkIGVsZW1lbnQgYWJvdmUvYmVsb3cgcm93cyB3aXRoIGVxdWFsIG9yIGhpZ2hlciBoZWFkaW5nIGxldmVsCgkJCWNvbnN0IGN1cnJlbnRIZWFkaW5nTGV2ZWwgPSBnZXRIZWFkaW5nTGV2ZWwoYWN0aXZlRHJvcCkKCQkJaWYgKGN1cnJlbnRIZWFkaW5nTGV2ZWwgPiBoZWFkaW5nTGV2ZWwpIHsKCQkJCS8vIFdlIHVwZGF0ZSB0aGUgdGhyZXNob2xkIGJhc2VkIG9uIHRoZSByZWxldmFudCBwYXJlbnQKCQkJCWNvbnN0IHBhciA9IGdldEhpZ2hlclBhcmVudChhY3RpdmVEcm9wLCBoZWFkaW5nTGV2ZWwpCgkJCQljb25zdCB7IHksIGhlaWdodCB9ID0gcGFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpCgkJCQl0aHJlc2hvbGRZID0geSArIGhlaWdodC8yCQkJCQkJCgkJCX0KCQl9CgkJLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIG1vdXNlIGlzIGJlbG93IG9yIGFib3ZlIHRoZSBtaWRkbGUgb2YgdGhlIGFjdGl2ZSBkcm9wIHpvbmUKCQljb25zdCBpc0JlbG93ID0gZS5jbGllbnQueSA+IHRocmVzaG9sZFkKCQljb25zdCBuZXdTZXAgPSBnZXRTZXBhcmF0b3IoYWN0aXZlRHJvcCwgaXNCZWxvdywgYWxsb3dBbGwsIGhlYWRpbmdMZXZlbCkKCQljb25zdCBjdXJyZW50U2VwID0gdG9jLnF1ZXJ5U2VsZWN0b3IoJy50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUnKSA/PyBuZXdTZXAKCQlpZiAoY3VycmVudFNlcCAhPT0gbmV3U2VwKSB7CgkJCWN1cnJlbnRTZXAuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykKCQl9CgkJbmV3U2VwLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpCgl9CgoJY29uc3QgZHJhZ0hhbmRsZXMgPSBpbnRlcmFjdCgnLnRvYy1yb3cnKS5kcmFnZ2FibGUoewoJCWN1cnNvckNoZWNrZXIgKGFjdGlvbiwgaW50ZXJhY3RhYmxlLCBlbGVtZW50LCBpbnRlcmFjdGluZykgewoJCQkvLyBjb25zb2xlLmxvZyh7YWN0aW9uLCBpbnRlcmFjdGFibGUsIGVsZW1lbnQsIGludGVyYWN0aW5nfSkKCQkJcmV0dXJuIG51bGwKCQl9LAoJCW1hbnVhbFN0YXJ0OiB0cnVlLCAvLyBuZWVkZWQgZm9yIGNvbnNpc3RlbnQgc3RhcnQgYWZ0ZXIgaG9sZAoJCWxpc3RlbmVyczogewoJCQlzdGFydDogZnVuY3Rpb24gKGUpIHsKCQkJCXRvYy5jbGFzc0xpc3QuYWRkKCdkcmFnX2VuYWJsZWQnKQoJCQkJY29uc3Qgcm93ID0gZS50YXJnZXQKCQkJCS8vIGNvbnNvbGUubG9nKCdzdGFydDogJywgZSkKCQkJCXRvYy5sYXN0RHJhZ0V2ZW50ID0gZQoJCQkJcm93LmNsYXNzTGlzdC5hZGQoJ2RyYWdnZWQnKQoJCQkJdG9jLmRyYWdnZWRFbGVtZW50ID0gcm93CgkJCQl0YWdBZGphY2VudFNlcGFyYXRvcnMocm93LCB0cnVlKQoJCQl9LAoJCQltb3ZlOiBmdW5jdGlvbiAoZSkgewoJCQkJdG9jLmxhc3REcmFnRXZlbnQgPSBlCgkJCQl1cGRhdGVBY3RpdmVTZXBhcmF0b3IoKQoJCQl9LAoJCQkvLyBtb3ZlOiBmdW5jdGlvbiAoZSkge2NvbnNvbGUubG9nKCdtb3ZlOiAnLGUpfSwKCQkJZW5kOiBmdW5jdGlvbiAoZSkgewoJCQkJYWN0aXZlRHJvcCA9IHVuZGVmaW5lZAoJCQkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJCQl0b2MubGFzdERyYWdFdmVudCA9IGUKCQkJCS8vIGNvbnNvbGUubG9nKCdlbmQ6ICcsIGUpCgkJCQljb25zdCByb3cgPSBlLnRhcmdldAoJCQkJLy8gQ2xlYW51cAoJCQkJcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnZWQnKQoJCQkJdG9jLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdfZW5hYmxlZCcpCQoJCQkJZm9yIChjb25zdCBlbCBvZiB0b2MucXVlcnlTZWxlY3RvckFsbCgnLmFjdGl2ZV9kcm9wJykpIHsKCQkJCQllbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmVfZHJvcCcpCgkJCQl9CgkJCQlyZUNvbGxhcHNlKCkJCQkJCgkJCQl0YWdBZGphY2VudFNlcGFyYXRvcnMocm93LCBmYWxzZSkJCQkJCgkJCQl0b2MuY2xhc3NMaXN0LnJlbW92ZSgnYWxsb3dfYWxsX2Ryb3AnKQoJCQkJLy8gV2UgdGVtcG9yYXJ5IHNldCB0aGUgcmVjZW50RHJhZyBmbGFnCgkJCQl0b2MuY2xhc3NMaXN0LmFkZCgncmVjZW50LWRyYWcnKQoJCQkJc2V0VGltZW91dCgoKSA9PiB7CgkJCQkJdG9jLmNsYXNzTGlzdC5yZW1vdmUoJ3JlY2VudC1kcmFnJykKCQkJCX0sIDMwMCkKCQkJCS8vIENoZWNrIGlmIHRoZXJlIGlzIGFuIGFjdGl2ZSBkcm9wem9uZQoJCQkJY29uc3QgZHJvcFpvbmUgPSB0b2MucXVlcnlTZWxlY3RvcignLnRvYy1yb3ctc2VwYXJhdG9yLmFjdGl2ZScpCgkJCQlpZiAoXy5pc05pbChkcm9wWm9uZSkgfHwgZHJvcFpvbmUuY2xhc3NMaXN0LmNvbnRhaW5zKCdub3Nob3cnKSkge3JldHVybn0KCQkJCWRyb3Bab25lLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpCgkJCQkvLyBXZSBmaW5kIHRoZSBjZWxsIGFmdGVyIHRoZSBhY3RpdmUgc2VwYXJhdG9yIGFuZCBtb3ZlIHRoZSBkcmFnZ2VkIHJvdyBiZWZvcmUgdGhhdAoJCQkJY29uc3Qgcm93QWZ0ZXIgPSBnZXROZXh0U2libGluZyhkcm9wWm9uZSkKCQkJCWNvbnN0IGNlbGxJZHNUb01vdmUgPSBnZXRCbG9ja0lkcyhyb3cpCgkJCQkvLyBGaW5kIHRoZSBpbmRleCBvZiB0aGUgY2VsbCB0aGF0IHdpbGwgc3RheSBhZnRlciBvdXIgbW92ZWQgYmxvY2sKCQkJCWNvbnN0IGVuZCA9IGVkaXRvcl9zdGF0ZS5ub3RlYm9vay5jZWxsX29yZGVyLmluZGV4T2YoZ2V0X2xpbmtfaWQocm93QWZ0ZXIpKQoJCQkJLy8gSWYgd2UgZ290IC0xLCBpdCBtZWFucyB3ZSBoYXZlIHRvIHB1dCB0aGUgY2VsbHMgYXQgdGhlIGVuZAoJCQkJcGx1dG9fYWN0aW9ucy5tb3ZlX3JlbW90ZV9jZWxscyhjZWxsSWRzVG9Nb3ZlLCBlbmQgPCAwID8gSW5maW5pdHkgOiBlbmQpCgkJCQl0b2MuZHJhZ2dlZEVsZW1lbnQgPSB1bmRlZmluZWQJCQoJCQl9LAoJCX0KCX0pLm9uKCdob2xkJyxmdW5jdGlvbiAoZSkgewoJCWlmIChkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygnZGlzYWJsZV91aScpKSB7IGNvbnNvbGUubG9nKCdVSSBkaXNhYmxlZCwgbm8gaW50ZXJhY3Rpb24hJyk7IHJldHVybiB9CgkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKQoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkvLyBjb25zb2xlLmxvZygndGhpcyBpcyBob2xkJywgZSkKCQl2YXIgaW50ZXJhY3Rpb24gPSBlLmludGVyYWN0aW9uCgoJICAgIGlmICghaW50ZXJhY3Rpb24uaW50ZXJhY3RpbmcoKSkgewoJICAgICAgaW50ZXJhY3Rpb24uc3RhcnQoCgkgICAgICAgIHsgbmFtZTogJ2RyYWcnIH0sCgkgICAgICAgIGUuaW50ZXJhY3RhYmxlLAoJICAgICAgICBlLmN1cnJlbnRUYXJnZXQsCgkgICAgICApCgkgICAgfQoJfSkKCgoKCS8qICMjIyMgQkVHSU5OSU5HIE9GIFBBUlQgQVVUT01BVElDQUxMWSBBRERFRCBCWSBIVExTQ1JJUFQgIyMjIyAqLwoJLy8gQXNzaWduIHRoZSB2YXJpb3VzIGV2ZW50cyBsaXN0ZW5lcnMgZGVmaW5lZCB3aXRoaW4gdGhlIHNjcmlwdAoJZm9yIChjb25zdCBpdGVtIG9mIF9ldmVudHNfbGlzdGVuZXJzXykgewoJCWNvbnN0IHsgZWxlbWVudCwgbGlzdGVuZXJzIH0gPSBpdGVtCgkJZm9yIChjb25zdCBbbmFtZSwgZnVuY10gb2YgXy5lbnRyaWVzKGxpc3RlbmVycykpIHsKICAJCQllbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuYykKCQl9Cgl9CgkvKiAjIyMjIEVORCBPRiBQQVJUIEFVVE9NQVRJQ0FMTFkgQURERUQgQlkgSFRMU0NSSVBUICMjIyMgKi8KCiAgICBpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CiAgICAJCgkJLyogIyMjIyBCRUdJTk5JTkcgT0YgUEFSVCBBVVRPTUFUSUNBTExZIEFEREVEIEJZIEhUTFNDUklQVCAjIyMjICovCgkJLy8gUmVtb3ZlIHRoZSBldmVudHMgbGlzdGVuZXJzIGR1cmluZyBpbnZhbGlkYXRpb24KCQlmb3IgKGNvbnN0IGl0ZW0gb2YgX2V2ZW50c19saXN0ZW5lcnNfKSB7CgkJCWNvbnN0IHsgZWxlbWVudCwgbGlzdGVuZXJzIH0gPSBpdGVtCgkJCWZvciAoY29uc3QgW25hbWUsIGZ1bmNdIG9mIF8uZW50cmllcyhsaXN0ZW5lcnMpKSB7CgkgIAkJCWVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jKQoJCQl9CgkJfQoJCS8qICMjIyMgRU5EIE9GIFBBUlQgQVVUT01BVElDQUxMWSBBRERFRCBCWSBIVExTQ1JJUFQgIyMjIyAqLwpvYnNlcnZlci5kaXNjb25uZWN0KCkKZHJhZ0hhbmRsZXMudW5zZXQoKQoKCiAgICB9KQoKPC9zY3JpcHQ+Cgo8c3R5bGU+CQoJLnBsdXRvdWktdG9jIGhlYWRlciB7CgkJY3Vyc29yOiBwb2ludGVyOwoJfQoJc3Bhbi50b2MtaGVhZGVyLWNvbnRhaW5lciB7CgkJcG9zaXRpb246IGZpeGVkOwoJCWRpc3BsYXk6IG5vbmU7CgkJLS1zaXplOiAyNXB4OwoJCWhlaWdodDogY2FsYyg1MXB4IC0gMXJlbSk7CgkJZmxleC1kaXJlY3Rpb246IHJvdy1yZXZlcnNlOwoJCXJpZ2h0OiBjYWxjKDFyZW0gKyBtaW4oODB2aCwgMzAwcHgpKTsKCX0KCS50b2MtaGVhZGVyLWljb24gewoJCW1hcmdpbi1yaWdodDogMC4zcmVtOwoJCWFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJZGlzcGxheTogaW5saW5lLWJsb2NrOwoJCXdpZHRoOiB2YXIoLS1zaXplKTsKCQliYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwoJCWZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJY3Vyc29yOiBwb2ludGVyOwoJfQoJLnRvYy1oZWFkZXItZmlsbGVyIHsKCQltYXJnaW46IC4yNXJlbTsKCX0KCWhlYWRlcjpob3ZlciBzcGFuLnRvYy1oZWFkZXItY29udGFpbmVyLAoJc3Bhbi50b2MtaGVhZGVyLWNvbnRhaW5lcjpob3ZlciB7CgkJZGlzcGxheTogZmxleDsKCX0KCS50b2MtaGVhZGVyLWhpZGUgewoJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V5ZS1vdXRsaW5lLnN2Zyk7CgkJb3BhY2l0eTogNTAlOwoJCS0tc2l6ZTogMWVtOwoJfQoJLnRvYy1oZWFkZXItc2F2ZSB7CgkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvc2F2ZS1vdXRsaW5lLnN2Zyk7CgkJb3BhY2l0eTogNTAlOwoJfQoJbmF2Om5vdCguZmlsZS1zdGF0ZS1kaWZmZXJzKSAudG9jLWhlYWRlci1zYXZlIHsKCQlkaXNwbGF5OiBub25lOwoJfQoJcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBzcGFuLnRvYy1oZWFkZXItaGlkZSB7CgkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXllLW9mZi1vdXRsaW5lLnN2Zyk7Cgl9Cjwvc3R5bGU+Cgo8c3R5bGU+CglzcGFuLnRvYy1oaWRlLWNvbnRhaW5lciB7CgkJLS13aWR0aDogbWluKDgwdncsIDMwMHB4KTsKCQlwb3NpdGlvbjogZml4ZWQ7CgkJZGlzcGxheTogZmxleDsKCQlyaWdodDogY2FsYyh2YXIoLS13aWR0aCkgKyAxcmVtICsgMjJweCAtIDEwMHB4KTsKCQloZWlnaHQ6IHZhcigtLWhlaWdodCk7CgkJd2lkdGg6IDEwMHB4OwoJCXotaW5kZXg6IC0xOwoJfQoJc3Bhbi50b2MtaGlkZSB7CgkJdmlzaWJpbGl0eTogaGlkZGVuOwoJCW9wYWNpdHk6IDUwJTsKCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leWUtb3V0bGluZS5zdmcpOwoJCWN1cnNvcjogcG9pbnRlcjsKCX0KCWRpdi50b2Mtcm93LmhpZGRlbiBzcGFuLnRvYy1oaWRlIHsKCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leWUtb2ZmLW91dGxpbmUuc3ZnKTsKCX0KCXNwYW4udG9jLWhpZGUtY29udGFpbmVyOmhvdmVyID4gLnRvYy1oaWRlLAoJZGl2LnRvYy1yb3c6aG92ZXIgLnRvYy1oaWRlIHsKCQl2aXNpYmlsaXR5OiB2aXNpYmxlOwoJfQoJZGl2LnRvYy1yb3cgYSB7CgkJZGlzcGxheTogZmxleDsKCX0KCXNwYW4udG9jLWljb24gewoJCS0tc2l6ZTogMTdweDsKCQlkaXNwbGF5OiBibG9jazsKCQlhbGlnbi1zZWxmOiBzdHJldGNoOwoJCWJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJd2lkdGg6IHZhcigtLXNpemUpOwoJCWZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cgl9CglzcGFuLnRvYy1jb2xsYXBzZSB7CgkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJbWFyZ2luLXJpZ2h0OiAzcHg7CgkJbWluLXdpZHRoOiB2YXIoLS1zaXplKTsKCX0KCS5wbHV0b3VpLXRvYyBzZWN0aW9uIGRpdi50b2Mtcm93LmNvbGxhcHNlZCBzcGFuLnRvYy1jb2xsYXBzZSB7CgkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cgl9CgkucGx1dG91aS10b2Mgc2VjdGlvbiBkaXYudG9jLXJvdyBhIHNwYW4udG9jLWNvbGxhcHNlLm5vLWNoaWxkcmVuIHsKCQliYWNrZ3JvdW5kLWltYWdlOiBub25lOwoJfQoJZGl2LnRvYy1yb3cucGFyZW50LWhpZGRlbiB7CgkJdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmUgZG90dGVkIC41cHg7CgkJdGV4dC11bmRlcmxpbmUtb2Zmc2V0OiAycHg7Cgl9CglkaXYudG9jLXJvdy5oaWRkZW4gewoJCXRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lIGRhc2hlZCAxcHg7CgkJdGV4dC11bmRlcmxpbmUtb2Zmc2V0OiAycHg7Cgl9CgkucGx1dG91aS10b2MgZGl2LnBhcmVudC1jb2xsYXBzZWQgewoJCWRpc3BsYXk6IG5vbmU7Cgl9CglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIGRpdi50b2Mtcm93LmhpZGRlbiwKCXBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gZGl2LnRvYy1yb3cucGFyZW50LWhpZGRlbiB7CgkJZGlzcGxheTogbm9uZTsKCX0KCS5kcmFnX2VuYWJsZWQgLnRvYy1yb3cuZHJhZ2dlZCB7CgkJYm9yZGVyOiAycHggZGFzaGVkIGdyZXk7Cgl9Cjwvc3R5bGU+Cgo8c3R5bGU+CglkaXYudG9jLXJvdy1zZXBhcmF0b3IgewoJCWhlaWdodDogMnB4OwoJCW1hcmdpbjogM3B4IDBweDsKCQliYWNrZ3JvdW5kOiAjYWFhOwoJCWRpc3BsYXk6IG5vbmU7Cgl9CglkaXYudG9jLXJvdy1zZXBhcmF0b3IuYWN0aXZlIHsKCQlkaXNwbGF5OiBibG9jazsKCX0KCWRpdi50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUubm9zaG93IHsKCQlkaXNwbGF5OiBub25lOwoJfQo8L3N0eWxlPgoKPHN0eWxlPgoJLyogVGhpcyBzdHlsZSBwZXJtaXRzIHRvIGhhdmUgYSBjZWxsIHdob3NlIG91dHB1dCBpcyBzdGlsbCBiZWluZyBzaG93biB3aGVuCgkgICB0aGUgY2VsbCBpcyBoaWRkZW4uIFRoaXMgaXMgdXNlZnVsIGZvciBoYXZpbmcgaGlkZGVuIGNlbGxzIHRoYXQgc3RpbGwgYXJlCgkgICBzZW5kaW5nIEhUTUwgYXMgb3V0cHV0IChsaWtlIFRvQyBhbmQgQm9uZFRhYmxlKSAqLwoJCglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XSB7CgkJZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsKCX0KCXBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdOm5vdCguY29kZV9kaWZmZXJzKSA+IHBsdXRvLWlucHV0LAoJcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF06bm90KC5jb2RlX2RpZmZlcnMpID4gcGx1dG8tc2hvdWxkZXIsCglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XTpub3QoLmNvZGVfZGlmZmVycykgPiBwbHV0by10cmFmZmljbGlnaHQsCglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XTpub3QoLmNvZGVfZGlmZmVycykgPiBwbHV0by1ydW5hcmVhLAoJcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF06bm90KC5jb2RlX2RpZmZlcnMpID4gYnV0dG9uIHsKCQlkaXNwbGF5OiBub25lOwoJfQoJcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF06bm90KC5jb2RlX2RpZmZlcnMpIHsKCQltYXJnaW4tdG9wOiAwcHg7Cgl9Cjwvc3R5bGU+CgqkbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJ+Wz8SwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgabn1e1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTKKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52gOYPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPlRoZSBzdHJ1Y3R1cmVzIGFib3ZlIGNhbiBhbHNvIGJlIHVzZWQgbmVzdGVkIHdpdGhpbiBvbmUgYW5vdGhlci4gVG8gZmFjaWxpdGF0ZSBhY2Nlc3NpbmcgbmVzdGVkIHN0cnVjdHVyZXMsIG9uZSBjYW4gdXNlIHRoZSA8Y29kZT5Qb3BvdXQ8L2NvZGU+IHR5cGUuPC9wPgo8cD5JbiBpdHMgc2ltcGxlIGZvcm0sIHlvdSBjYW4gZ2l2ZSBhbiBpbnN0YW5jZSBvZiBhIFN0cnVjdEJvbmQsIGEgYm9uZCB3cmFwcGluZyBhIFN0cnVjdEJvbmQgb3IgYSBCb25kc0xpc3QgYXMgaW5wdXQgdG8gUG9wb3V0IHRvIGNyZWF0ZSBhIHRhYmxlIHRoYXQgaXMgaGlkZGVuIGJlaGluZCBhIHBvcHVwIHdpbmRvdy4gSWYgYW4gaW5zdGFuY2UgcHJlc2VudCwgYnV0IHlvdSB3YW50IGEgY3VzdG9tIHR5cGUgZm9yIHdoaWNoIHlvdSBoYXZlIGRlZmluZWQgY3VzdG9tIGJvbmRzIGFuZCBkZXNjcmlwdGlvbnMgd2l0aCA8Y29kZT5AZmllbGRkYXRhPC9jb2RlPiB0byBhcHBlYXIgYXMgcG9wb3V0LCB5b3UgY2FuIHVzZSB0aGUgZnVuY3Rpb24gPGNvZGU+cG9wb3V0d3JhcCYjNDA7VFlQRSYjNDE7PC9jb2RlPiB0byBnZW5lcmF0ZSBhIHNtYWxsIGljb24gd2hpY2ggaGlkZXMgYSBwb3B1cCBjb250YWluaW5nIHRoZSA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiBvZiB0aGUgcHJvdmlkZWQgdHlwZSA8Y29kZT5UWVBFPC9jb2RlPi48L3A+CjxwPlRoZSBTdHJ1Y3RCb25kIHRhYmxlIGFwcGVhcnMgb24gaG92ZXIgdXBvbiB0aGUgaWNvbiwgY2FuIGJlIG1hZGUgZml4ZWQgYnkgY2xpY2tpbmcgb24gdGhlIGljb24gYW5kIGNhbiB0aGVuIGJlIG1vdmVkIGFyb3VuZCBvciByZXNpemVkLiBBIGRvdWJsZSBjbGljayBvbiB0aGUgaGVhZGVyIG9mIHRoZSBwb3BvdXQgaGlkZXMgaXQgYWdhaW46PC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJk7yAiwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAHFjy1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDWKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52S88ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgxPkJvbmRUYWJsZTwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTv/drBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAMoarVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHna9Oo8Ym9uZHNsaXN0LWNvbnRhaW5lciBjbGFzcz0nbm8tcG9wb3V0Jz4KCTxib25kc2xpc3QtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdjb2xsYXBzZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbicgdGl0bGU9IlRoaXMgbGlzdCBjb250YWlucyBpbmRlcGVuZGVudCBib25kcyI+UG9wb3V0IENvbnRhaW5lcjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0ndG9nZ2xlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+Cgk8L2JvbmRzbGlzdC1oZWFkZXI+Cgk8Ym9uZHNsaXN0LWNvbnRlbnRzPgoJPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYGFzZGAnPgoJCVN0cnVjdHVyZSBBU0QKCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwb3BvdXQtY29udGFpbmVyIGtleT0naGhscWJncW9xZyc+Cgk8cG9wb3V0LWhlYWRlcj48c3BhbiBjbGFzcz0ncG9wb3V0LWljb24gcG9wb3V0Jz48L3NwYW4+PC9wb3BvdXQtaGVhZGVyPgoJPHBvcG91dC1jb250ZW50cz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd2cHJ5Y3Nxcml5JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48Ym9uZCBkZWY9ImFzZCIgdW5pcXVlX2lkPSJuWnI5TzQ3aThTMjYiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTWFpbi52YXImcXVvdDt3b3Jrc3BhY2UjNTYmcXVvdDsuQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbG10d3h5ZWFxcicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHN2dnp3emZ0bCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5NYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIDxzcGFuIGNsYXNzPSJ0ZXgiPiRMYVRlWCQ8L3NwYW4+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHJ4Z3pxamd3Zicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd0cnhnenFqZ3dmJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidHJ4Z3pxamd3ZiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHN2dnp3emZ0bCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2VzbnR2c21sYmsnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzY3JpcHQ+Ci8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCndpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgpjb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKY29uc3QgdmFsdWVzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXQoKY29uc3QgZWwgPSBodG1sYAo8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CnRvdWNoLWFjdGlvbjogbm9uZTsKYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwpjb2xvcjogYmxhY2s7CnBhZGRpbmc6IDBlbSAuMmVtOwpib3JkZXItcmFkaXVzOiAuM2VtOwpmb250LXdlaWdodDogYm9sZDsiPjY8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCmxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCglzZXQ6IHggPT4gewoJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgl9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCi8vIGluaXRpYWwgdmFsdWUKZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgpjb25zdCBvblNjcnViID0gKGUpID0+IHsKCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94Cgljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJKSkKCglpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQp9Cgpjb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCglvbGRfeCA9IGUuY2xpZW50WAoJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQplbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgpjb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKfQplbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgpjb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCn0pCgpyZXR1cm4gZWwKCjwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2VzbnR2c21sYmsnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJlc250dnNtbGJrIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdxdW9xbWtpZ2poJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0ncXVvcW1raWdqaCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInF1b3Fta2lnamgiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RzdnZ6d3pmdGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZmNpenpiemd3YScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ZjaXp6Ynpnd2EnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJmY2l6emJ6Z3dhIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0c3Z2end6ZnRsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdkaWdtaXd3dHZtJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZGlnbWl3d3R2bSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImRpZ21pd3d0dm0iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSd0c3Z2end6ZnRsJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidHN2dnp3emZ0bCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYEFTRGAiKQoKCQkvLyBhZGQgdGhlIGNvbGxhcHNlIGJ1dHRvbgoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGh0bWxgPHNwYW4gY2xhc3M9J2NvbGxhcHNlJz5gCgkJaGVhZGVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGNvbGxhcHNlX2J0bikKCgkJdHJjLmNvbGxhcHNlID0gKCkgPT4gewogIAkJCXRyYy5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQoJCX0KCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gdHJjLmNvbGxhcHNlKCkKCQkKCTwvc2NyaXB0PgoJCTxzdHlsZT4KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogY29udGVudHM7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCQkJZmxleDogMTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZ3JpZC1jb2x1bW46IDEgLyAtMTsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCS0tc2l6ZTogMTdweDsKCQkJICAgIGRpc3BsYXk6IGJsb2NrOwoJCQkgICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKCQkJICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkJCSAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwoJCQkgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwoJCQkgICAgd2lkdGg6IHZhcigtLXNpemUpOwoJCQkgICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgPiB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCQlhbGlnbi1pdGVtczogc3RyZXRjaDsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQlmbGV4LWdyb3c6IDE7CgkJCQlmb250LXNpemU6IDE4cHg7CgkJCQlmb250LXdlaWdodDogNjAwOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewoJCQkJYWxpZ24tc2VsZjogY2VudGVyCgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgKyAqIHsKCQkJCWRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nbG10d3h5ZWFxcic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImxtdHd4eWVhcXIiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J290eGZycHllc2cnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdta3VydHZ6b2FyJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5pbm5lckhUTUwgPSAiQ3VzdG9tIERlc2NyaXB0aW9uIgoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdoaGxxYmdxb3FnJz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbScpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkKCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewoJCWNvbXB1dGVQb3NpdGlvbihoZWFkZXIsIGNvbnRlbnRzLCB7CgkJCXN0cmF0ZWd5OiAiZml4ZWQiLAoJCQltaWRkbGV3YXJlOiBbYXV0b1BsYWNlbWVudCgpXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgljb250ZW50cy5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCBmYWxzZSkKCgloZWFkZXIub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgdHJ1ZSkKCQljb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3BwZWQnKSA/IG51bGwgOiBwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIGZhbHNlKQo8L3NjcmlwdD4KPHN0eWxlPgoJcG9wb3V0LWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYm9yZGVyOiAzcHggZGFzaGVkIHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwp9CnBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBub25lOwogICAgd2lkdGg6IDQwMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tb3ZlcmxheS1idXR0b24tYm9yZGVyKTsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBwYWRkaW5nOiA4cHg7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgPiBwb3BvdXQtY29udGVudHMsCnBvcG91dC1jb250YWluZXIuaGVhZGVyLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgei1pbmRleDogNTAwOwp9CnBvcG91dC1jb250YWluZXIuY29udGVudHMtaG92ZXIgPiBwb3BvdXQtaGVhZGVyIHsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcGx1dG8tbG9ncy13YXJuLWFjY2VudC1jb2xvcik7Cn0KLnBvcG91dC1pY29uIHsKICAgIC0tc2l6ZTogMjBweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgbWluLWhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9Ci5wb3BvdXQtaWNvbi5wb3BvdXQgewkKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V4cGFuZC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIC5wb3BvdXQgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY29udHJhY3Quc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogICAgdG91Y2gtYWN0aW9uOiBub25lOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KPC9zdHlsZT4KPHNjcmlwdCBpZD0ndnByeWNzcXJpeSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInZwcnljc3FyaXkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgo8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgbnRgJz4KCQlOYW1lZFR1cGxlCgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cG9wb3V0LWNvbnRhaW5lciBrZXk9J2x1cXBpdHd1ZGcnPgoJPHBvcG91dC1oZWFkZXI+PHNwYW4gY2xhc3M9J3BvcG91dC1pY29uIHBvcG91dCc+PC9zcGFuPjwvcG9wb3V0LWhlYWRlcj4KCTxwb3BvdXQtY29udGVudHM+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbmZzdWlod2phaicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGJvbmQgZGVmPSJudCIgdW5pcXVlX2lkPSJXMFN2OWRRdDZYaGQiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTmFtZWRUdXBsZXsoU3ltYm9sKCZxdW90OyMjMjMyJnF1b3Q7KSwgOmEsIDpiLCA6Yyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TmFtZWRUdXBsZTwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J211Z2J0Z2txZnMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2EnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2EnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGFgIj5EZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdzYWp4bW1jenVwJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NhanhtbWN6dXAnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJzYWp4bW1jenVwIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPjxzdHJvbmc+Qm9sZDwvc3Ryb25nPiBmaWVsZDwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3p2aGlveHlvYWknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nenZoaW94eW9haSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInp2aGlveHlvYWkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5jPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2JzaXp1bHR1cmMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nYnNpenVsdHVyYyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJzaXp1bHR1cmMiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdidWVub2VkYmJ4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiYnVlbm9lZGJieCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYE5hbWVkVHVwbGVgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J211Z2J0Z2txZnMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJtdWdidGdrcWZzIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdqd2dlb3Rkdm1zJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0ncmJ4d3hscmJ1Zyc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIk15IEZhbmN5IE5UdXBsZSIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0nbHVxcGl0d3VkZyc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb20nKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCgkvLyBXZSB1c2UgdGhlIGludGVyYWN0anMgbGlicmFyeSB0byBwcm92aWRlIGRyYWcgYW5kIHJlc2l6ZSBoYW5kbGluZyBhY3Jvc3MgZGV2aWNlcwoJY29uc3QgeyBkZWZhdWx0OiBpbnRlcmFjdCB9ID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9pbnRlcmFjdGpzJykKCgljb250ZW50cy5vZmZzZXQgPSBjb250ZW50cy5vZmZzZXQgPz8geyB4OiAwLCB5OiAwfQoJY29uc3Qgc3RhcnRQb3NpdGlvbiA9IHt4OiAwLCB5OiAwfQoJaW50ZXJhY3QoY29udGVudHMucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5kZXNjcmlwdGlvbiwgYm9uZHNsaXN0LWhlYWRlciAuZGVzY3JpcHRpb24nKSkuZHJhZ2dhYmxlKHsKCQlsaXN0ZW5lcnM6IHsKCQkJc3RhcnQgKGV2ZW50KSB7CgkJCQljb250ZW50cy5vZmZzZXQueSA9IHN0YXJ0UG9zaXRpb24ueSA9IGNvbnRlbnRzLm9mZnNldFRvcAoJCQkJY29udGVudHMub2Zmc2V0LnggPSBzdGFydFBvc2l0aW9uLnggPSBjb250ZW50cy5vZmZzZXRMZWZ0CgkJCX0sCgkJCW1vdmUgKGV2ZW50KSB7CgkJICAgICAgY29udGVudHMub2Zmc2V0LnggKz0gZXZlbnQuZHgKCQkgICAgICBjb250ZW50cy5vZmZzZXQueSArPSBldmVudC5keQoJCQoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLnRvcCA9IGBtaW4oOTV2aCwgJHtjb250ZW50cy5vZmZzZXQueX1weGAKCQkgICAgICBjb250ZW50cy5zdHlsZS5sZWZ0ID0gYG1pbig5NXZ3LCAke2NvbnRlbnRzLm9mZnNldC54fXB4YAoJCSAgICB9LAoJCX0KCX0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gaGVhZGVyIHJlc2V0IHRoZSBwb3NpdGlvbgoJCWNvbnRhaW5lci5wb3BvdXQoKQoJfSkKCWludGVyYWN0KGNvbnRlbnRzKQoJICAucmVzaXphYmxlKHsKCSAgICBlZGdlczogeyB0b3A6IHRydWUsIGxlZnQ6IGZhbHNlLCBib3R0b206IHRydWUsIHJpZ2h0OiB0cnVlIH0sCgkgICAgbGlzdGVuZXJzOiB7CgkgICAgICBtb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHsJCQoJICAgICAgICBPYmplY3QuYXNzaWduKGV2ZW50LnRhcmdldC5zdHlsZSwgewoJICAgICAgICAgIHdpZHRoOiBgJHtldmVudC5yZWN0LndpZHRofXB4YCwKCSAgICAgICAgICBoZWlnaHQ6IGAke2V2ZW50LnJlY3QuaGVpZ2h0fXB4YCwKCSAgICAgICAgfSkKCSAgICAgIH0KCSAgICB9CgkgIH0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gcmVzaXplIHJlc2V0IHRoZSB3aWR0aAoJCQljb250ZW50cy5zdHlsZS53aWR0aCA9ICcnCgkJICAJY29udGVudHMuc3R5bGUuaGVpZ2h0ID0gJycKCSAgfSkKCgoJZnVuY3Rpb24gcG9zaXRpb25Db250ZW50cygpIHsKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogW2F1dG9QbGFjZW1lbnQoKV0sCgkJfSkudGhlbigocG9zKSA9PiB7CgkJCWNvbnRlbnRzLnN0eWxlLmxlZnQgPSBwb3MueCArICJweCIKCQkJY29udGVudHMuc3R5bGUudG9wID0gcG9zLnkgKyAicHgiCgkJfSkKCX0KCgljb250YWluZXIucG9wb3V0ID0gKGZvcmNlID0gdW5kZWZpbmVkKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ3BvcHBlZCcsIGZvcmNlKQoJCXBvc2l0aW9uQ29udGVudHMoKQoJfQoKCWhlYWRlci5vbmNsaWNrID0gKGUpID0+IHtjb250YWluZXIucG9wb3V0KCl9CgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50cy1ob3ZlcicsIHRydWUpCgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgZmFsc2UpCgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCBmYWxzZSkKPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J25mc3VpaHdqYWonPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJuZnN1aWh3amFqIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCQoJPC9ib25kc2xpc3QtY29udGVudHM+Cgk8c2NyaXB0IGlkPSdkZ3RidXV6b3V2Jz4KCQljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb250YWluZXIuY29sbGFwc2UgPSAoZm9yY2UpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcsIGZvcmNlKQoJCX0KCQljb25zdCBjb2xsYXBzZV9idG4gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3Bhbi5jb2xsYXBzZScpCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gY29udGFpbmVyLmNvbGxhcHNlKCkKCTwvc2NyaXB0PgoJPHN0eWxlPgoJYm9uZHNsaXN0LWhlYWRlciB7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBkaXNwbGF5OiBmbGV4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKfQpib25kc2xpc3QtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDBweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjZmZhYzQ1NDA7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQgPiBib25kc2xpc3QtaGVhZGVyIHsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIHBhZGRpbmctdG9wOiAxMnB4OwogIG1hcmdpbi10b3A6IC0xMnB4OwogIHotaW5kZXg6IDEwOwp9CmJvbmRzbGlzdC1jb250ZW50cyB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQ6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBibG9jazsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGp1c3RpZnktc2VsZjogY2VudGVyOwogIGJvcmRlci1ib3R0b206IDJweCBzb2xpZDsKICBwYWRkaW5nLXRvcDogNXB4OwogIHdpZHRoOiAxMDAlOwogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogIHotaW5kZXg6IDIwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuYm9uZHNsaXN0LWljb24gewogIC0tc2l6ZTogMTdweDsKICBkaXNwbGF5OiBibG9jazsKICBhbGlnbi1zZWxmOiBzdHJldGNoOwogIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgd2lkdGg6IHZhcigtLXNpemUpOwogIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgY3Vyc29yOiBwb2ludGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkID4gYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB3aWR0aDogMzBweDsKICBtYXJnaW46IDAgMTBweDsKfQpib25kc2xpc3QtaGVhZGVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogIHdpZHRoOiAxMDAlOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBmbGV4LWdyb3c6IDE7CiAgZm9udC1zaXplOiAxOHB4OwogIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGFsaWduLXNlbGY6IGNlbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCBib25kc2xpc3QtaGVhZGVyICsgKiB7CiAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CmJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICByb3ctZ2FwOiA1cHg7Cn0KYm9uZHN0YWJsZS1jb250YWluZXIgYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCQkKCTwvc3R5bGU+CjwvYm9uZHNsaXN0LWNvbnRhaW5lcj4KpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZaNibGOybGFzdF9ydW5fdGltZXN0YW1wy0HZPCCasA93sHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjW5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc0O27VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnae7o8Ym9uZCBkZWY9ImJvaCIgdW5pcXVlX2lkPSJOQVpyJiM0MztwWlpTd21rIj48c3RydWN0LWJvbmQgY2xhc3M9J0JPSCc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPkJPSDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3d3Y3Bwd2JjangnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2xiY2pyZXJ0Zm8nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J21haCc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nbWFoJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBtYWhgIj5tYWg8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nbWFoJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdyanNuemFrbHhuJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cG9wb3V0LWNvbnRhaW5lciBrZXk9J250YW1udGd2bGMnPgoJPHBvcG91dC1oZWFkZXI+PHNwYW4gY2xhc3M9J3BvcG91dC1pY29uIHBvcG91dCc+PC9zcGFuPjwvcG9wb3V0LWhlYWRlcj4KCTxwb3BvdXQtY29udGVudHM+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndmlydXR3dmR4Yycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHN0cnVjdC1ib25kIGNsYXNzPSdNYWluLnZhciZxdW90O3dvcmtzcGFjZSM0OCZxdW90Oy5NQUgnPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5NQUg8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSd6dG1mYWh5Z2R6JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdsZ21ibWdveXN3JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+YTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd2dm9zYml4c2RrJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3Z2b3NiaXhzZGsnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ2dm9zYml4c2RrIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nbGdtYm1nb3lzdyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImxnbWJtZ295c3ciCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBNQUhgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3p0bWZhaHlnZHonPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ6dG1mYWh5Z2R6Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSd5dHFxdmRuaHRhJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nZHNzcXJhc2lubSc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIk1BSCIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdudGFtbnRndmxjJz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbScpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkKCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewoJCWNvbXB1dGVQb3NpdGlvbihoZWFkZXIsIGNvbnRlbnRzLCB7CgkJCXN0cmF0ZWd5OiAiZml4ZWQiLAoJCQltaWRkbGV3YXJlOiBbYXV0b1BsYWNlbWVudCgpXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgljb250ZW50cy5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCBmYWxzZSkKCgloZWFkZXIub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgdHJ1ZSkKCQljb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3BwZWQnKSA/IG51bGwgOiBwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIGZhbHNlKQo8L3NjcmlwdD4KPHN0eWxlPgoJcG9wb3V0LWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYm9yZGVyOiAzcHggZGFzaGVkIHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwp9CnBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBub25lOwogICAgd2lkdGg6IDQwMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tb3ZlcmxheS1idXR0b24tYm9yZGVyKTsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBwYWRkaW5nOiA4cHg7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgPiBwb3BvdXQtY29udGVudHMsCnBvcG91dC1jb250YWluZXIuaGVhZGVyLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgei1pbmRleDogNTAwOwp9CnBvcG91dC1jb250YWluZXIuY29udGVudHMtaG92ZXIgPiBwb3BvdXQtaGVhZGVyIHsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcGx1dG8tbG9ncy13YXJuLWFjY2VudC1jb2xvcik7Cn0KLnBvcG91dC1pY29uIHsKICAgIC0tc2l6ZTogMjBweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgbWluLWhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9Ci5wb3BvdXQtaWNvbi5wb3BvdXQgewkKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V4cGFuZC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIC5wb3BvdXQgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY29udHJhY3Quc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogICAgdG91Y2gtYWN0aW9uOiBub25lOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KPC9zdHlsZT4KPHNjcmlwdCBpZD0ndmlydXR3dmR4Yyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInZpcnV0d3ZkeGMiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdyanNuemFrbHhuJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAicmpzbnpha2x4biIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2xiY2pyZXJ0Zm8nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJsYmNqcmVydGZvIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQkKCTxzY3JpcHQ+CgkJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBgQk9IYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd3d2NwcHdiY2p4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAid3djcHB3YmNqeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0namZwZG93ZWxrYic+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2l5dmZudnNzbHgnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJCT0giCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8IHf/pH+wcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzg3DMJq1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5oKRtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8Gn8qA1OwcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgBHOF61cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijQVNEqGVsZW1lbnRzlZKhYZKhM6p0ZXh0L3BsYWlukqFikqE5qnRleHQvcGxhaW6SoWOSrCJsb2xhc2Rhc2RmIqp0ZXh0L3BsYWlukqFkkqIiIqp0ZXh0L3BsYWlukqFlkqIyMKp0ZXh0L3BsYWlupHR5cGWmc3RydWN0rHByZWZpeF9zaG9ydKNBU0Sob2JqZWN0aWSwZDAyNTlkY2RlMWM4NWQ3YqRtaW1l2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3Sscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8Iml0o0iwcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lLrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM4qmcXVldWVkwqRsb2dzkYikbGluZf+jbXNnktlCV0FSTklORzogY291bGQgbm90IGltcG9ydCBQbHV0b1VJLkB3aXRoX3Rlcm1pbmFsIGludG8gd29ya3NwYWNlIzMKqnRleHQvcGxhaW6nY2VsbF9pZNkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpmt3YXJnc5CiaWS5TWFpbl9QbHV0b1J1bm5lcl8zMDQzZGI4Y6RmaWxl2UQvaG9tZS9hbWVuZ2FsaS8uanVsaWEvcGFja2FnZXMvUGx1dG8va3hlc28vc3JjL3J1bm5lci9QbHV0b1J1bm5lci5qbKVncm91cKtQbHV0b1J1bm5lcqVsZXZlbK5Mb2dMZXZlbCgtNTU1KadydW5uaW5nwqZvdXRwdXSGpGJvZHnaCOM8c2NyaXB0IGlkPSd5U3dqd24nPgogICAgCgkJY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZnJvbXBhcmVudC1jb250YWluZXInKSA/PyBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGh0bWxgPGZyb21wYXJlbnQtY29udGFpbmVyPmApCgkJY29udGFpbmVyLmlubmVySFRNTCA9ICJSZWxvYWQgQGZyb21wYWNrYWdlIgoJCS8vIFdlIHNldCB0aGUgZXJyb3JlZCBzdGF0ZQoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdlcnJvcmVkJywgZmFsc2UpCgkJY29uc3Qgc3R5bGUgPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3R5bGUnKSA/PyBjb250YWluZXIuYXBwZW5kQ2hpbGQoaHRtbGA8c3R5bGU+YCkKCQlzdHlsZS5pbm5lckhUTUwgPSAiCWZyb21wYXJlbnQtY29udGFpbmVyIHtcbgkgICAgaGVpZ2h0OiAyMHB4O1xuCSAgICBwb3NpdGlvbjogZml4ZWQ7XG4JICAgIHRvcDogNDBweDtcbgkJcmlnaHQ6IDEwcHg7XG4JICAgIG1hcmdpbi10b3A6IDVweDtcbgkgICAgcGFkZGluZy1yaWdodDogNXB4O1xuCSAgICB6LWluZGV4OiAyMDA7XG4JCWJhY2tncm91bmQ6ICNmZmZmZmY7XG4JICAgIHBhZGRpbmc6IDVweCA4cHg7XG4JICAgIGJvcmRlcjogM3B4IHNvbGlkICNlM2UzZTM7XG4JICAgIGJvcmRlci1yYWRpdXM6IDEycHg7XG4JICAgIGhlaWdodDogMzVweDtcbgkgICAgZm9udC1mYW1pbHk6IFwiU2Vnb2UgVUkgRW1vamlcIiwgXCJSb2JvdG8gTW9ub1wiLCBtb25vc3BhY2U7XG4JICAgIGZvbnQtc2l6ZTogMC43NXJlbTtcbgl9XG4JZnJvbXBhcmVudC1jb250YWluZXIuZXJyb3JlZCB7XG4JCWJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY2VsbC1jb2xvcilcbgl9XG4JZnJvbXBhcmVudC1jb250YWluZXI6aG92ZXIge1xuCSAgICBmb250LXdlaWdodDogODAwO1xuCQljdXJzb3I6IHBvaW50ZXI7XG4JfVxuCWJvZHkuZGlzYWJsZV91aSBmcm9tcGFyZW50LWNvbnRhaW5lciB7XG4JCWRpc3BsYXk6IG5vbmU7XG4JfVxuCXBsdXRvLWxvZy1kb3QtcG9zaXRpb25lcltoaWRkZW5dIHtcbgkJZGlzcGxheTogbm9uZTtcbgl9XG4iCgkJY29uc3QgY2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCI5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDMiKQoJCWNvbnN0IGFjdGlvbnMgPSBjZWxsLl9pbnRlcm5hbF9wbHV0b19hY3Rpb25zCgkJY29udGFpbmVyLm9uY2xpY2sgPSAoZSkgPT4gewoJCQlpZiAoZS5jdHJsS2V5KSB7CgkJCQloaXN0b3J5LnB1c2hTdGF0ZSh7fSwnJykJCQkKCQkJCWNlbGwuc2Nyb2xsSW50b1ZpZXcoewoJCQkJCWJlaGF2aW9yOiAnYXV0bycsCgkJCQkJYmxvY2s6ICdjZW50ZXInLAkJCQkKCQkJCX0pCgkJCX0gZWxzZSB7CgkJCQlhY3Rpb25zLnNldF9hbmRfcnVuX211bHRpcGxlKFsiOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzIl0pCgkJCX0KCQl9Cgpjb25zdCBsb2dzX3Bvc2l0aW9uZXIgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3BsdXRvLWxvZy1kb3QtcG9zaXRpb25lcicpCmlmIChsb2dzX3Bvc2l0aW9uZXIgPT0gdW5kZWZpbmVkKSB7cmV0dXJufQpjb25zdCBsb2dzID0gbG9nc19wb3NpdGlvbmVyLnBhcmVudEVsZW1lbnQKY29uc3QgbG9nc19jb250YWluZXIgPSBsb2dzLnBhcmVudEVsZW1lbnQKCmNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9uTGlzdCwgb2JzZXJ2ZXIpID0+IHsKCWZvciAoY29uc3QgY2hpbGQgb2YgbG9ncy5jaGlsZHJlbikgewoJCWlmICghY2hpbGQuaGFzQXR0cmlidXRlKCdoaWRkZW4nKSkgewoJCQlsb2dzLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siCgkJCWxvZ3NfY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siCgkJCXJldHVybgoJCX0KCX0KCS8vIElmIHdlIHJlYWNoIGhlcmUgYWxsIHRoZSBjaGlsZHJlbiBhcmUgaGlkZGVuLCBzbyB3ZSBoaWRlIHRoZSBjb250YWluZXIgYXMgd2VsbAkJCglsb2dzLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIKCWxvZ3NfY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIKfSkKCm9ic2VydmVyLm9ic2VydmUobG9ncywge3N1YnRyZWU6IHRydWUsIGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZX0pCmxvZ3NfcG9zaXRpb25lci50b2dnbGVBdHRyaWJ1dGUoJ2hpZGRlbicsdHJ1ZSkKCgogICAgaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewogICAgCWNvbnNvbGUubG9nKCdpbnZhbGlkYXRpb24nKQoJb2JzZXJ2ZXIuZGlzY29ubmVjdCgpCgoKICAgIH0pCgo8L3NjcmlwdD4KpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCe59vosHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDO5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc8AAAABAgT/qLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZMDxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+U3RydWN0Qm9uZDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTcvG7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAMSarVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjN4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZMDxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+QEJvbmRzTGlzdDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTekI7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAPp9LVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmmMS41ZTEwpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwiBSfQhbBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWUrtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkMDhkNzExYzAtZTJjYy00NDQ0LTk0Y2EtMGM0YzNjZmU5MDFmiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYOoZWxlbWVudHOTkqFhkqEzqnRleHQvcGxhaW6SoWKSoTOqdGV4dC9wbGFpbpKhY5KhOKp0ZXh0L3BsYWlupHR5cGWqTmFtZWRUdXBsZahvYmplY3RpZLBiMTMxOTUwMWNiYjE4YmE1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwiZxPLjrBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMDhkNzExYzAtZTJjYy00NDQ0LTk0Y2EtMGM0YzNjZmU5MDFmuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWU0tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYOoZWxlbWVudHOTkqFhkqEzqnRleHQvcGxhaW6SoWKSoTOqdGV4dC9wbGFpbpKhY5KhOKp0ZXh0L3BsYWlupHR5cGWqTmFtZWRUdXBsZahvYmplY3RpZLBiMTMxOTUwMWNiYjE4YmE1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwiZxOQirBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWUztXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoEHTxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5JbiBzb21lIGNhc2VzLCBvbmUgZG9lcyBub3Qgd2FudCB0byBoYXZlIGEgc2luZ2xlIGJvbmQgd3JhcHBpbmcgZWl0aGVyIGEgU3RydWN0dXJlIG9yIGEgTmFtZWRUdXBsZSBiZWNhdXNlIHNpbmdsZSBpbmRlcGVuZGVudCBib25kcyBhcmUgbW9yZSBjb252ZW5pZW50LjwvcD4KPHA+PGNvZGU+QEJvbmRzTGlzdDwvY29kZT4gaXMgYSBjb252ZW5pZW5jZSBtYWNybyB0byBjcmVhdGUgYW4gb2JqZWN0IG9mIHR5cGUgPGNvZGU+Qm9uZHNMaXN0PC9jb2RlPiB3aGljaCBzaW1wbHkgYWxsb3cgdG8gYWRkIGEgZGVzY3JpcHRpb24gdG8gc2VwYXJhdGUgYm9uZHMgYW5kIGdyb3VwIHRoZW0gYWxsIHRvZ2V0aGVyIGluIGEgdGFibGUtbGlrZSBmb3JtYXQgZXF1aXZhbGVudCB0byB0aG9zZSBvZiA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPi48L3A+CjxkaXYgY2xhc3M9ImFkbW9uaXRpb24gbm90ZSI+PHAgY2xhc3M9ImFkbW9uaXRpb24tdGl0bGUiPk5vdGU8L3A+PHA+VW5saWtlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+LCBhIEJvbmRzTGlzdCBpcyBhbHJlYWR5IGNvbXBvc2VkIG9mIGJvbmQgY3JlYXRlZCB3aXRoIDxjb2RlPkBiaW5kPC9jb2RlPiBhbmQgaXQganVzdCBncm91cHMgdGhlbSB1cCB3aXRoIGEgZGVzY3JpcHRpb24uIFRoZSBvdXRwdXQgb2YgPGNvZGU+QEJvbmRzTGlzdDwvY29kZT4gaXMgbm90IHN1cHBvc2VkIHRvIGJlIGJvdW5kIHRvIGEgdmFyaWFibGUgdXNpbmcgPGNvZGU+QGJpbmQ8L2NvZGU+LjxiciAvPlRoZSBib25kcyBncm91cGVkIGluIGEgQm9uZHNMaXN0IHN0aWxsIGFjdCBhbmQgdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSBvbmUgYW5vdGhlci48L3A+CjwvZGl2Pgo8cD5TZWUgdGhlIGV4YW1wbGUgYmVsb3cgZm9yIHVuZGVyc3RhbmRpbmcgdGhlIHN5bnRoYXguIFRoZSBoZWFkZXIgb2YgYSBCb25kc0xpc3QgaXMgc2hvd24gaW4gYW4gb3JhbmdlIGJhY2tncm91bmQgdG8gZWFzaWx5IGRpZmZlcmVudGlhdGUgaXQgZnJvbSA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPi48L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwhB6U7OrBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAJEYPLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAYM8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhlIGFiaWxpdHkgdG8gYWxzbyB3cmFwIHByZS1leGlzdGluZyBib25kcyBhcm91bmQgU3RydWN0Qm9uZHMgaXMgY29udmVuaWVudCBmb3Igb3JnYW5pemluZyB0aGUgdmFyaW91cyBib25kcyBvbmUgaGF2ZSBpbiBhIDxjb2RlPkJvbmRzTGlzdDwvY29kZT4gb3IgPGNvZGU+Qm9uZFRhYmxlPC9jb2RlPjwvcD4KPHA+QXMgYW4gZXhhbXBsZSwgb25lIGNhbiBjcmVhdGUgYSA8Y29kZT5Cb25kc0xpc3Q8L2NvZGU+IGNvbnRhaW5pbmcgdGhlIHR3byA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiBib25kcyBnZW5lcmF0ZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGlzIG5vdGVib29rIHdpdGggdGhlIGZvbGx3aW5nIGNvZGUuPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJk75N6wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAEtUW1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52l6QPGJvbmQgZGVmPSJsb2xfcG9wIiB1bmlxdWVfaWQ9InVVbmQ0Rm9aZ0MvSyI+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSdkc2l5cHl4bWpyJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J29rZnRnc29yaWUnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTWFpbi52YXImcXVvdDt3b3Jrc3BhY2UjMjcmcXVvdDsuTE9MJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TE9MPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nem9ia3Fpa3d4dycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbG9id2l6ZHVrdScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5Xb25kZXImIzMzOzwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2EnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3Z5dGptc2FsYWwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0ndnl0am1zYWxhbCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInZ5dGptc2FsYWwiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2xvYndpemR1a3UnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2InPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2InIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGJgIj48c3Bhbj5GaWVsZCBCPC9zcGFuPjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0dW5wbm1yZ2VsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c2NyaXB0PgovLyB3ZWlyZCBpbXBvcnQgdG8gbWFrZSBpdCBmYXN0ZXIuIFRoZSBgYXdhaXQgaW1wb3J0YCBjYW4gc3RpbGwgZGVsYXkgZXhlY3V0aW9uIGJ5IG9uZSBmcmFtZSBpZiBpdCBpcyBhbHJlYWR5IGxvYWRlZC4uLgp3aW5kb3cuZDNmb3JtYXQgPSB3aW5kb3cuZDNmb3JtYXQgPz8gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKY29uc3QgYXJnbWluID0geHMgPT4geHMuaW5kZXhPZihNYXRoLm1pbiguLi54cykpCmNvbnN0IGNsb3Nlc3RfaW5kZXggPSAoeHMsIHkpID0+IGFyZ21pbih4cy5tYXAoeCA9PiBNYXRoLmFicyh4LXkpKSkKCmNvbnN0IHZhbHVlcyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF0KCmNvbnN0IGVsID0gaHRtbGAKPHNwYW4gdGl0bGU9IkNsaWNrIGFuZCBkcmFnIHRoaXMgbnVtYmVyIGxlZnQgb3IgcmlnaHQhIiBzdHlsZT0iY3Vyc29yOiBjb2wtcmVzaXplOwp0b3VjaC1hY3Rpb246IG5vbmU7CmJhY2tncm91bmQ6IHJnYigyNTIsIDIwOSwgMjA0KTsKY29sb3I6IGJsYWNrOwpwYWRkaW5nOiAwZW0gLjJlbTsKYm9yZGVyLXJhZGl1czogLjNlbTsKZm9udC13ZWlnaHQ6IGJvbGQ7Ij42PC9zcGFuPgpgCgoKCmxldCBvbGRfeCA9IDAKbGV0IG9sZF9pbmRleCA9IDAKY29uc3QgaW5pdGlhbF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCA2KQpsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCmNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJc2V0OiB4ID0+IHsKCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7CgovLyBpbml0aWFsIHZhbHVlCmVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcig2KQoKY29uc3Qgb25TY3J1YiA9IChlKSA9PiB7Cgljb25zdCBvZmZzZXQgPSBlLmNsaWVudFggLSBvbGRfeAoJY29uc3QgbmV3X2luZGV4ID0gTWF0aC5taW4odmFsdWVzLmxlbmd0aC0xLCBNYXRoLm1heCgwLCAKCQlNYXRoLnJvdW5kKG9mZnNldC8xMCkgKyBvbGRfaW5kZXgKCSkpCgoJaWYobmV3X2luZGV4ICE9PSBjdXJyZW50X2luZGV4KSB7CgkJY3VycmVudF9pbmRleCA9IG5ld19pbmRleAoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KfQoKY29uc3Qgb25wb2ludGVyZG93biA9IChlKSA9PiB7Cgl3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKQoJb2xkX3ggPSBlLmNsaWVudFgKCW9sZF9pbmRleCA9IGN1cnJlbnRfaW5kZXgKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoKY29uc3Qgb25kYmxjbGljayA9IChlKSA9PiB7CgljdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoKY29uc3Qgb25wb2ludGVydXAgPSAoKSA9PiB7Cgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCmVsLm9uc2VsZWN0c3RhcnQgPSAoKSA9PiBmYWxzZQoKaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQp9KQoKcmV0dXJuIGVsCgo8L3NjcmlwdD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd0dW5wbm1yZ2VsJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidHVucG5tcmdlbCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2xvYndpemR1a3UnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJsb2J3aXpkdWt1Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQkKCTxzY3JpcHQ+CgkJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBgTE9MYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd6b2JrcWlrd3h3Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiem9ia3Fpa3d4dyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nd25pdnFrbGVqcSc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J21uc3J6d2NwZnQnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJMT0wiCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0nZHNpeXB5eG1qcic+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb20nKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCgkvLyBXZSB1c2UgdGhlIGludGVyYWN0anMgbGlicmFyeSB0byBwcm92aWRlIGRyYWcgYW5kIHJlc2l6ZSBoYW5kbGluZyBhY3Jvc3MgZGV2aWNlcwoJY29uc3QgeyBkZWZhdWx0OiBpbnRlcmFjdCB9ID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9pbnRlcmFjdGpzJykKCgljb250ZW50cy5vZmZzZXQgPSBjb250ZW50cy5vZmZzZXQgPz8geyB4OiAwLCB5OiAwfQoJY29uc3Qgc3RhcnRQb3NpdGlvbiA9IHt4OiAwLCB5OiAwfQoJaW50ZXJhY3QoY29udGVudHMucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5kZXNjcmlwdGlvbiwgYm9uZHNsaXN0LWhlYWRlciAuZGVzY3JpcHRpb24nKSkuZHJhZ2dhYmxlKHsKCQlsaXN0ZW5lcnM6IHsKCQkJc3RhcnQgKGV2ZW50KSB7CgkJCQljb250ZW50cy5vZmZzZXQueSA9IHN0YXJ0UG9zaXRpb24ueSA9IGNvbnRlbnRzLm9mZnNldFRvcAoJCQkJY29udGVudHMub2Zmc2V0LnggPSBzdGFydFBvc2l0aW9uLnggPSBjb250ZW50cy5vZmZzZXRMZWZ0CgkJCX0sCgkJCW1vdmUgKGV2ZW50KSB7CgkJICAgICAgY29udGVudHMub2Zmc2V0LnggKz0gZXZlbnQuZHgKCQkgICAgICBjb250ZW50cy5vZmZzZXQueSArPSBldmVudC5keQoJCQoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLnRvcCA9IGBtaW4oOTV2aCwgJHtjb250ZW50cy5vZmZzZXQueX1weGAKCQkgICAgICBjb250ZW50cy5zdHlsZS5sZWZ0ID0gYG1pbig5NXZ3LCAke2NvbnRlbnRzLm9mZnNldC54fXB4YAoJCSAgICB9LAoJCX0KCX0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gaGVhZGVyIHJlc2V0IHRoZSBwb3NpdGlvbgoJCWNvbnRhaW5lci5wb3BvdXQoKQoJfSkKCWludGVyYWN0KGNvbnRlbnRzKQoJICAucmVzaXphYmxlKHsKCSAgICBlZGdlczogeyB0b3A6IHRydWUsIGxlZnQ6IGZhbHNlLCBib3R0b206IHRydWUsIHJpZ2h0OiB0cnVlIH0sCgkgICAgbGlzdGVuZXJzOiB7CgkgICAgICBtb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHsJCQoJICAgICAgICBPYmplY3QuYXNzaWduKGV2ZW50LnRhcmdldC5zdHlsZSwgewoJICAgICAgICAgIHdpZHRoOiBgJHtldmVudC5yZWN0LndpZHRofXB4YCwKCSAgICAgICAgICBoZWlnaHQ6IGAke2V2ZW50LnJlY3QuaGVpZ2h0fXB4YCwKCSAgICAgICAgfSkKCSAgICAgIH0KCSAgICB9CgkgIH0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gcmVzaXplIHJlc2V0IHRoZSB3aWR0aAoJCQljb250ZW50cy5zdHlsZS53aWR0aCA9ICcnCgkJICAJY29udGVudHMuc3R5bGUuaGVpZ2h0ID0gJycKCSAgfSkKCgoJZnVuY3Rpb24gcG9zaXRpb25Db250ZW50cygpIHsKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogW2F1dG9QbGFjZW1lbnQoKV0sCgkJfSkudGhlbigocG9zKSA9PiB7CgkJCWNvbnRlbnRzLnN0eWxlLmxlZnQgPSBwb3MueCArICJweCIKCQkJY29udGVudHMuc3R5bGUudG9wID0gcG9zLnkgKyAicHgiCgkJfSkKCX0KCgljb250YWluZXIucG9wb3V0ID0gKGZvcmNlID0gdW5kZWZpbmVkKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ3BvcHBlZCcsIGZvcmNlKQoJCXBvc2l0aW9uQ29udGVudHMoKQoJfQoKCWhlYWRlci5vbmNsaWNrID0gKGUpID0+IHtjb250YWluZXIucG9wb3V0KCl9CgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50cy1ob3ZlcicsIHRydWUpCgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgZmFsc2UpCgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCBmYWxzZSkKPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J29rZnRnc29yaWUnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJva2Z0Z3NvcmllIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9ib25kPqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwhhMCaLLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOBWukH7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmjMTYwpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwialAaxbBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZiuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWUvtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedpJ+Txib25kIGRlZj0ibnQiIHVuaXF1ZV9pZD0iVzBTdjlkUXQ2WGhkIj48c3RydWN0LWJvbmQgY2xhc3M9J05hbWVkVHVwbGV7KFN5bWJvbCgmcXVvdDsjIzIzMiZxdW90OyksIDphLCA6YiwgOmMpfSc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPk5hbWVkVHVwbGU8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtdWdidGdrcWZzJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nc2FqeG1tY3p1cCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdzYWp4bW1jenVwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAic2FqeG1tY3p1cCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnVlbm9lZGJieCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd6dmhpb3h5b2FpJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3p2aGlveHlvYWknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ6dmhpb3h5b2FpIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdic2l6dWx0dXJjJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JzaXp1bHR1cmMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJic2l6dWx0dXJjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYnVlbm9lZGJieCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJ1ZW5vZWRiYngiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBOYW1lZFR1cGxlYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdtdWdidGdrcWZzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibXVnYnRna3FmcyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nandnZW90ZHZtcyc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JieHd4bHJidWcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJNeSBGYW5jeSBOVHVwbGUiCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlp250X2JvbmSybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCg19ORsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjm5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4XSi+CtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwqtzdGF0dXNfdHJlZYSkbmFtZahub3RlYm9va6hzdWJ0YXNrc4Smc2F2aW5nhKRuYW1lpnNhdmluZ6hzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8ItJ7Yyiqc3RhcnRlZF9hdMtB2Twi0ntehal3b3Jrc3BhY2WEpG5hbWWpd29ya3NwYWNlqHN1YnRhc2tzgqxpbml0X3Byb2Nlc3OEpG5hbWWsaW5pdF9wcm9jZXNzqHN1YnRhc2tzhKE0hKRuYW1loTSoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HZPBCcE2yLqnN0YXJ0ZWRfYXTLQdk8EJtg39+hMYSkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2TwQm1pz2qpzdGFydGVkX2F0y0HZPBCa8espoTKEpG5hbWWhMqhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EJtfQLOqc3RhcnRlZF9hdMtB2TwQm1qRfaEzhKRuYW1loTOoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HZPBCbYN+1qnN0YXJ0ZWRfYXTLQdk8EJtfXkqrZmluaXNoZWRfYXTLQdk8EJwTsnSqc3RhcnRlZF9hdMtB2TwQmvHq3a5jcmVhdGVfcHJvY2Vzc4SkbmFtZa5jcmVhdGVfcHJvY2Vzc6hzdWJ0YXNrc4KhMYSkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2TwQmgjKyapzdGFydGVkX2F0y0HZPBCZPEnpoTKEpG5hbWWhMqhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EJrx6siqc3RhcnRlZF9hdMtB2TwQmgjpS6tmaW5pc2hlZF9hdMtB2TwQmvHK5qpzdGFydGVkX2F0y0HZPBCZPEnLq2ZpbmlzaGVkX2F0y0HZPBCcE7KOqnN0YXJ0ZWRfYXTLQdk8EJk8SaqjcGtnhKRuYW1lo3BrZ6hzdWJ0YXNrc4SjYWRkhKRuYW1lo2FkZKhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8ItJ7L3+qc3RhcnRlZF9hdMtB2Twi0nsvf6hhbmFseXNpc4SkbmFtZahhbmFseXNpc6hzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8ItJ6Ooaqc3RhcnRlZF9hdMtB2Twi0notAqxpbnN0YW50aWF0ZTKEpG5hbWWsaW5zdGFudGlhdGUyqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2Twi0nsvjKpzdGFydGVkX2F0y0HZPCLSey+MqnByZWNvbXBpbGWEpG5hbWWqcHJlY29tcGlsZahzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8ItJ7L4iqc3RhcnRlZF9hdMtB2Twi0nsviKtmaW5pc2hlZF9hdMtB2Twi0nsve6pzdGFydGVkX2F0y0HZPCLSeizUo3J1boSkbmFtZaNydW6oc3VidGFza3OCsHJlc29sdmVfdG9wb2xvZ3mEpG5hbWWwcmVzb2x2ZV90b3BvbG9neahzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8ItJ7Yzmqc3RhcnRlZF9hdMtB2Twi0ntXDKhldmFsdWF0ZYSkbmFtZahldmFsdWF0ZahzdWJ0YXNrc4GhMYSkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2Twi0nwSCqpzdGFydGVkX2F0y0HZPCLSe4J3q2ZpbmlzaGVkX2F0y0HZPCLSfDo2qnN0YXJ0ZWRfYXTLQdk8ItJ7YzmrZmluaXNoZWRfYXTLQdk8ItJ8Ojaqc3RhcnRlZF9hdMtB2Twi0ntW4qtmaW5pc2hlZF9hdMCqc3RhcnRlZF9hdMtB2TwQmSC8DrFjZWxsX2RlcGVuZGVuY2llc94AJdkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRkhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRktGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCA2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmO0ZG93bnN0cmVhbV9jZWxsc19tYXCDo2FsdJLZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYtkkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2pGZyZXGS2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTTZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM6JibJHZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNrJ1cHN0cmVhbV9jZWxsc19tYXCNqkBCb25kc0xpc3SR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOtQmFzZS5nZXRpbmRleJChOpDZIE1haW4uUGx1dG9SdW5uZXIuQ29yZS5hcHBsaWNhYmxlkKdQbHV0b1VJkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzuU1haW4uUGx1dG9SdW5uZXIuQmFzZS5nZXSQpUBiaW5kkKhFZGl0YWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9koTWFpbi5QbHV0b1J1bm5lci5QbHV0b1J1bm5lci5jcmVhdGVfYm9uZJCkTWFpbpCkQmFzZZChKpCqU2NydWJiYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZhhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZhtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBom50kdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY52SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDaEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDa0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGjYWx0kdkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDCEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDC0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2O0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTSEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTS0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzaEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNza0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGjYXNkkdkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTaEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTa0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIWnbnRfYm9uZJHZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOaNibGOR2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjWpQm9uZFRhYmxlkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzqGFzZF9ib25kkdkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmomJskdkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2aEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2a0ZG93bnN0cmVhbV9jZWxsc19tYXCGq3R5cGVhc2ZpZWxkkKlmaWVsZGJvbmSQsGZpZWxkZGVzY3JpcHRpb26Qo2FzZJPZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NtkkZTdkNjc2NjItNzdiMy00ODJhLWIwMzItOGRiNGFmYmMwMWE22SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NzioYXNkX2JvbmSS2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjXZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNqNBU0SQsnVwc3RyZWFtX2NlbGxzX21hcN4AHadAbWRfc3RykKhoYXNmaWVsZJCmU3RyaW5nkKRAaHRskdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpE1haW6QqVRleHRGaWVsZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6pAZmllbGRkYXRhkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzt0h5cGVydGV4dExpdGVyYWwuUmVzdWx0kKRAZG9jkK1CYXNlLmdldGluZGV4kNkgTWFpbi5QbHV0b1J1bm5lci5Db3JlLmFwcGxpY2FibGWQoTqQpWVycm9ykLdIeXBlcnRleHRMaXRlcmFsLkJ5cGFzc5CqU3RydWN0Qm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM7lNYWluLlBsdXRvUnVubmVyLkJhc2UuZ2V0kKVAYmluZJC6I19fX3RoaXNfcGx1dG9fbW9kdWxlX25hbWWQq0Jhc2UuQGt3ZGVmkKZTbGlkZXKR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZKE1haW4uUGx1dG9SdW5uZXIuUGx1dG9SdW5uZXIuY3JlYXRlX2JvbmSQpEJhc2WQo1ZhbJCjSW50kLBIeXBlcnRleHRMaXRlcmFskdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpFR5cGWQpVVuaW9ukKxAdHlwZWFzZmllbGSR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOqU2NydWJiYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBo2JvaJHZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkONkkMDY1YmFkNzMtNWZhOC00NDk2LWJhMzMtOWU2Njk0MGI1ODA2hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMDY1YmFkNzMtNWZhOC00NDk2LWJhMzMtOWU2Njk0MGI1ODA2tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBp2xvbF9wb3CR2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODTZJDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaNhc2SR2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM4S0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM7Rkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaRmcmVxkdkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTCEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTC0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SRmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTKEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTK0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjWEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjW0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGaEtHByZWNlZGVuY2VfaGV1cmlzdGljB6djZWxsX2lk2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGa0ZG93bnN0cmVhbV9jZWxsc19tYXCBrlBsdXRvRGV2TWFjcm9zkLJ1cHN0cmVhbV9jZWxsc19tYXCA2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGGEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGG0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ3MDcxNzVhOS1kMzU2LTQzY2YtODAzOC02MjBlYmM0MDFjOTOEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ3MDcxNzVhOS1kMzU2LTQzY2YtODAzOC02MjBlYmM0MDFjOTO0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIG3RXh0ZW5kZWRUYWJsZU9mQ29udGVudHOR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNbRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNbRkb3duc3RyZWFtX2NlbGxzX21hcIGjYmxjkdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2snVwc3RyZWFtX2NlbGxzX21hcISqQEJvbmRzTGlzdJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6dudF9ib25kkdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5plBvcG91dJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6hhc2RfYm9uZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ4hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ4tGRvd25zdHJlYW1fY2VsbHNfbWFwhKNCT0iQq3R5cGVhc2ZpZWxkkKNNQUiQo2JvaJHZJDIzNThmNjg2LTE5NTAtNDBmOS05ZDVjLWRhYzJkOThmNGMyNLJ1cHN0cmVhbV9jZWxsc19tYXCN2SBNYWluLlBsdXRvUnVubmVyLkNvcmUuYXBwbGljYWJsZZChOpCqU3RydWN0Qm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM7lNYWluLlBsdXRvUnVubmVyLkJhc2UuZ2V0kKVAYmluZJCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2ShNYWluLlBsdXRvUnVubmVyLlBsdXRvUnVubmVyLmNyZWF0ZV9ib25kkKRNYWlukKZAa3dkZWaQo0ludJCkVHlwZZCuQHBvcG91dGFzZmllbGSR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOsQHR5cGVhc2ZpZWxkkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjK0ZG93bnN0cmVhbV9jZWxsc19tYXCDqWZpZWxkYm9uZJCwZmllbGRkZXNjcmlwdGlvbpCjTE9MkdkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0snVwc3RyZWFtX2NlbGxzX21hcN4AEadAbWRfc3RykK1CYXNlLmdldGluZGV4kKE6kKhoYXNmaWVsZJClZXJyb3KQt0h5cGVydGV4dExpdGVyYWwuQnlwYXNzkKtCYXNlLkBrd2RlZpCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpEBodGyR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkQmFzZZCqQGZpZWxkZGF0YZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6NWYWyQo0ludJCkVHlwZZCwSHlwZXJ0ZXh0TGl0ZXJhbJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM7dIeXBlcnRleHRMaXRlcmFsLlJlc3VsdJCqU2NydWJiYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkZTdkNjc2NjItNzdiMy00ODJhLWIwMzItOGRiNGFmYmMwMWE2hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkZTdkNjc2NjItNzdiMy00ODJhLWIwMzItOGRiNGFmYmMwMWE2tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBo2FzZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzhLRwcmVjZWRlbmNlX2hldXJpc3RpYwenY2VsbF9pZNkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAztGRvd25zdHJlYW1fY2VsbHNfbWFw3gBFsEJ1aWx0aW5zTm90ZWJvb2uQqEBodGxfc3RykKVQcmludJCnUGx1dG9VSZHZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY61Db3VudGVyQnV0dG9ukKtNdWx0aVNlbGVjdJCoRWRpdGFibGWR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOvVGFibGVPZkNvbnRlbnRzkK9Db25maXJtTm90ZWJvb2uQqVRleHRGaWVsZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZqtMYWJlbEJ1dHRvbpCmYXNfc3ZnkKpAZmllbGRkYXRhktkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKqcG9wb3V0d3JhcJHZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NKJicpClUmFkaW+QrlJlbW90ZVJlc291cmNlkKZCdXR0b26QrkRvd25sb2FkQnV0dG9ukKdjb25maXJtkKtXZWJjYW1JbnB1dJCqQEJvbmRzTGlzdJLZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1plBvcG91dJHZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNa1DbG9ja05vdGVib29rkKpUaW1lUGlja2VykKREdW1wkKZTbGlkZXKU2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkONkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY52SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKpRGF0ZUZpZWxkkLdUYWJsZU9mQ29udGVudHNOb3RlYm9va5ClQ2xvY2uQsUNvbG9yU3RyaW5nUGlja2VykK13aXRoX3Rlcm1pbmFskKRTaG93kKtOdW1iZXJGaWVsZJCnYXNfbWltZZCwVGVybWluYWxOb3RlYm9va5CnYXNfdGV4dJCsQHR5cGVhc2ZpZWxkktkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDixQGZpZWxkZGVzY3JpcHRpb26QpmFzX3BuZ5CrUmFuZ2VTbGlkZXKQsFN0cnVjdEJvbmRNb2R1bGWQ2ThfZnJvbXBhcmVudF9jZWxsX2lkXzk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM5CrQ29sb3JQaWNrZXKQqkRhdGVQaWNrZXKQs1JhbmdlU2xpZGVyTm90ZWJvb2uQtU11bHRpQ2hlY2tCb3hOb3RlYm9va5CkQGh0bJLZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyt0V4dGVuZGVkVGFibGVPZkNvbnRlbnRzkdkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzrVdpdGhJT0NvbnRleHSQqUJvbmRUYWJsZZHZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNq5AcG9wb3V0YXNmaWVsZJHZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOKpAZmllbGRib25kkKdATlRCb25kkdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5qlN0cnVjdEJvbmSS2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOK1Mb2NhbFJlc291cmNlkKlUaW1lRmllbGSQs1dlYmNhbUlucHV0Tm90ZWJvb2uQrVBhc3N3b3JkRmllbGSQrkB3aXRoX3Rlcm1pbmFskKhDaGVja0JveJCtTXVsdGlDaGVja0JveJCoUmVzb3VyY2WQqkZpbGVQaWNrZXKQsEh5cGVydGV4dExpdGVyYWyS2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMrJTY3J1YmJhYmxlTm90ZWJvb2uQp2FzX2h0bWyQplNlbGVjdJCqU2NydWJiYWJsZZPZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKydXBzdHJlYW1fY2VsbHNfbWFwjL1CYXNlLkNvcmVMb2dnaW5nLmludm9rZWxhdGVzdJC0QmFzZS5Db3JlTG9nZ2luZy49PT2QuiNfX190aGlzX3BsdXRvX21vZHVsZV9uYW1lkKdyZXRocm93kLJCYXNlLkNvcmVMb2dnaW5nLiGQ2SdCYXNlLkNvcmVMb2dnaW5nLkJhc2UuZml4dXBfc3RkbGliX3BhdGiQpEJhc2WQtEJhc2UuQ29yZUxvZ2dpbmcuaXNhkLFCYXNlLmludm9rZWxhdGVzdJCsQGZyb21wYWNrYWdlkLNCYXNlLkNvcmVMb2dnaW5nLj49kNknQmFzZS5Db3JlTG9nZ2luZy5jdXJyZW50X2xvZ2dlcl9mb3JfZW52kNkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBpGZyZXGR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaJudJHZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBom50kdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY52SQ5NTlhY2I0MC0xZmQ2LTQzZjUtYTFhNi03M2E2Y2VhYWUxZDeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5NTlhY2I0MC0xZmQ2LTQzZjUtYTFhNi03M2E2Y2VhYWUxZDe0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTe0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODS0ZG93bnN0cmVhbV9jZWxsc19tYXCBp2xvbF9wb3CR2SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDaydXBzdHJlYW1fY2VsbHNfbWFwiaRDb3JlkKRCYXNlkLdQbHV0b1J1bm5lci5jcmVhdGVfYm9uZJCrUGx1dG9SdW5uZXKQqnBvcG91dHdyYXCR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOvQ29yZS5hcHBsaWNhYmxlkKVAYmluZJCoQmFzZS5nZXSQo0xPTJHZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMtkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZihLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZitGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBo2FsdJHZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5tGRvd25zdHJlYW1fY2VsbHNfbWFwgqdudF9ib25kktkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY12SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTaibnST2SRlMmI3OWE1OC1lNjZlLTRkNDAtODY3My00MTg4MjM3NTNiMzjZJDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YdkkMDhkNzExYzAtZTJjYy00NDQ0LTk0Y2EtMGM0YzNjZmU5MDFmsnVwc3RyZWFtX2NlbGxzX21hcI+nQG1kX3N0cpCtQmFzZS5nZXRpbmRleJCnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kgTWFpbi5QbHV0b1J1bm5lci5Db3JlLmFwcGxpY2FibGWQoTqQpWVycm9ykLlNYWluLlBsdXRvUnVubmVyLkJhc2UuZ2V0kKVAYmluZJCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2ShNYWluLlBsdXRvUnVubmVyLlBsdXRvUnVubmVyLmNyZWF0ZV9ib25kkKRNYWlukKRCYXNlkKNWYWyQpFR5cGWQqGhhc2ZpZWxkkLRjZWxsX2V4ZWN1dGlvbl9vcmRlctwAJdkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhm2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YdkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkz2SRjYmZjNmVlYy04OTkxLTRhOWMtYWRhMC0yOTVjODA1Mjg1NGTZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MNkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2Ew2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NtkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEy2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDjZJDIzNThmNjg2LTE5NTAtNDBmOS05ZDVjLWRhYzJkOThmNGMyNNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI12SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDDZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM42SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzfZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN9kkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYtkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0Njdj2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTLZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMtkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg02SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDbZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N9kkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY12SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTbZJDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YdkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ12SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTTZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNtkkMDhkNzExYzAtZTJjYy00NDQ0LTk0Y2EtMGM0YzNjZmU5MDFm2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NzjZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM9kkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2tGxhc3RfaG90X3JlbG9hZF90aW1lywAAAAAAAAAAqXNob3J0cGF0aLNzdHJ1Y3Rib25kbW9kdWxlLmpsrnByb2Nlc3Nfc3RhdHVzpXJlYWR5pHBhdGjZTy9ob21lL2FtZW5nYWxpL1JlcG9zL2dpdGh1Yi9taW5lL1BsdXRvRXh0cmFzL3Rlc3Qvbm90ZWJvb2tzL3N0cnVjdGJvbmRtb2R1bGUuamyubGFzdF9zYXZlX3RpbWXLQdk8ItJ7XoGqY2VsbF9vcmRlctwAJdkkOWQ0NDU1YWYtOTZmMS00NmQ3LWE0ZjMtNDM0NDk1YjExYzhh2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGbZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkz2SRjYmZjNmVlYy04OTkxLTRhOWMtYWRhMC0yOTVjODA1Mjg1NGTZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MNkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2Ew2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NtkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEy2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDjZJDIzNThmNjg2LTE5NTAtNDBmOS05ZDVjLWRhYzJkOThmNGMyNNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI12SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDDZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM42SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzfZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN9kkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYtkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0Njdj2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTLZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMtkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg02SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDbZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N9kkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY12SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTbZJDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YdkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ12SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTTZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNtkkMDhkNzExYzAtZTJjYy00NDQ0LTk0Y2EtMGM0YzNjZmU5MDFm2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NzjZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM9kkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2sXB1Ymxpc2hlZF9vYmplY3RzgKVuYnBrZ4iyaW5zdGFsbGVkX3ZlcnNpb25zga5QbHV0b0Rldk1hY3Jvc6UwLjUuOLB0ZXJtaW5hbF9vdXRwdXRzhKpuYnBrZ19zeW5j2e8KSW5zdGFudGlhdGluZy4uLgoKUmVzb2x2aW5nLi4uChtbMzJtG1sxbSAgTm8gQ2hhbmdlcxtbMjJtG1szOW0gdG8gYC90bXAvamxfVWpUQmRLL1Byb2plY3QudG9tbGAKG1szMm0bWzFtICBObyBDaGFuZ2VzG1syMm0bWzM5bSB0byBgL3RtcC9qbF9ValRCZEsvTWFuaWZlc3QudG9tbGAKClByZWNvbXBpbGluZy4uLgobWzMybRtbMW0gIEFjdGl2YXRpbmcbWzIybRtbMzltIHByb2plY3QgYXQgYC90bXAvamxfVWpUQmRLYK5QbHV0b0Rldk1hY3Jvc9nvCkluc3RhbnRpYXRpbmcuLi4KClJlc29sdmluZy4uLgobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9Qcm9qZWN0LnRvbWxgChtbMzJtG1sxbSAgTm8gQ2hhbmdlcxtbMjJtG1szOW0gdG8gYC90bXAvamxfVWpUQmRLL01hbmlmZXN0LnRvbWxgCgpQcmVjb21waWxpbmcuLi4KG1szMm0bWzFtICBBY3RpdmF0aW5nG1syMm0bWzM5bSBwcm9qZWN0IGF0IGAvdG1wL2psX1VqVEJkS2ChXtnvCkluc3RhbnRpYXRpbmcuLi4KClJlc29sdmluZy4uLgobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9Qcm9qZWN0LnRvbWxgChtbMzJtG1sxbSAgTm8gQ2hhbmdlcxtbMjJtG1szOW0gdG8gYC90bXAvamxfVWpUQmRLL01hbmlmZXN0LnRvbWxgCgpQcmVjb21waWxpbmcuLi4KG1szMm0bWzFtICBBY3RpdmF0aW5nG1syMm0bWzM5bSBwcm9qZWN0IGF0IGAvdG1wL2psX1VqVEJkS2ChPtnvCkluc3RhbnRpYXRpbmcuLi4KClJlc29sdmluZy4uLgobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9Qcm9qZWN0LnRvbWxgChtbMzJtG1sxbSAgTm8gQ2hhbmdlcxtbMjJtG1szOW0gdG8gYC90bXAvamxfVWpUQmRLL01hbmlmZXN0LnRvbWxgCgpQcmVjb21waWxpbmcuLi4KG1szMm0bWzFtICBBY3RpdmF0aW5nG1syMm0bWzM5bSBwcm9qZWN0IGF0IGAvdG1wL2psX1VqVEJkS2CnZW5hYmxlZMO3cmVzdGFydF9yZWNvbW1lbmRlZF9tc2fAtHJlc3RhcnRfcmVxdWlyZWRfbXNnwK1idXN5X3BhY2thZ2VzkK9pbnN0YWxsX3RpbWVfbnPPAAAAARddvMysaW5zdGFudGlhdGVkw6tjZWxsX2lucHV0c94AJdkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRkhKdjZWxsX2lk2SRjYmZjNmVlYy04OTkxLTRhOWMtYWRhMC0yOTVjODA1Mjg1NGSkY29kZdlUIyBodG1sIiIiCiMgPHN0eWxlPgojIG1haW4gewojIAltYXJnaW4tcmlnaHQ6IDM1MHB4ICFpbXBvcnRhbnQ7CiMgfQojIDwvc3R5bGU+CiMgIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOEp2NlbGxfaWTZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY6Rjb2Rl2gEzYmwgPSBAQm9uZHNMaXN0ICJNeSBHcm91cCBvZiBCb25kcyIgbGV0IHR2ID0gUGx1dG9VSS5FeHBlcmltZW50YWwudHJhbnNmb3JtZWRfdmFsdWUKCSAjIFdlIHVzZSB0cmFuc2Zvcm1lZF92YWx1ZSB0byB0cmFuc2xhdGUgR0h6IHRvIEh6IGluIHRoZSBib3VuZCB2YXJpYWJsZSBgZnJlcWAKCSJGcmVxdWVuY3kgW0dIel0iID0gQGJpbmQgZnJlcSB0dih4IC0+IHggKiAxZTksIEVkaXRhYmxlKDIwOyBzdWZmaXggPSAiIEdIeiIpKQoJbWQiQWx0aXR1ZGUgYGBoYGAgW21dIiA9IEBiaW5kIGFsdCBTY3J1YmJhYmxlKDEwMDoxMDoyMDApCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZhhKdjZWxsX2lk2SQ5OTZiNDA4NS0xMTRjLTQ4ZjQtOWY5MC04ZTYzN2YyOWMwNmGkY29kZaJudKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2hKdjZWxsX2lk2SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDakY29kZaNhbHSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MISnY2VsbF9pZNkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwpGNvZGXaAaVtZCIiIgpTb21ldGltZXMgY3VzdG9tIHN0cnVjdHMgYXJlIG5vdCBuZWVkZWQgYW5kIGl0IHdvdWxkIGJlIHVzZWZ1bCB0byBqdXN0IHVzZSB0aGUgc2FtZSBuaWNlIGJvbmQgc3RydWN0dXJlIG9mIGBTdHJ1Y3RCb25kYCB0byBzaW1wbHkgY3JlYXRlIGFyYml0cmFyeSBOYW1lZFR1cGxlcy4gCgpUaGlzIGlzIHBvc3NpYmxlIHdpdGggdGhlIGNvbnZlbmllbmNlIG1hY3JvIGBATlRCb25kYCB3aGljaCBjYW4gYmUgY2FsbGVkIGFzIHNob3duIGJlbG93IHRvIGNyZWF0ZSBhIG5pY2UgZGlzcGxheSBmb3IgYW4gaW50ZXJhY3RpdmUgYm9uZCBjcmVhdGluZyBhbiBhcmJpdHJhcnkgTmFtZWRUdXBsZS4KClRoZSBtYWNybyBzaW1wbHkgY3JlYXRlIGEgYFN0cnVjdEJvbmRgIHdyYXBwaW5nIHRoZSBkZXNpcmVkIE5hbWVkVHVwbGUgdHlwZS4KIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OEp2NlbGxfaWTZJDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3Y6Rjb2Rlsm1kIiIiCiMgUG9wb3V0CiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0hKdjZWxsX2lk2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTSkY29kZdoCGW1kIiIiClRoZSBmaW5hbCBjb252ZW5pZW5jZSBzdHJ1Y3R1cmUgcHJvdmlkZWQgYnkgdGhpcyBtb2R1bGUgaXMgdGhlIGBCb25kVGFibGVgLiBJdCBjYW4gYmUgY3JlYXRlZCB0byBncm91cCBhIGxpc3Qgb2YgYm9uZHMgaW4gYSBmbG9hdGluZyB0YWJsZSB0aGF0IHN0YXlzIG9uIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIG5vdGVib29rIChzaW1pbGFyIHRvIHRoZSBUYWJsZU9mQ29udGVudHMgb2YgUGx1dG9VSSkgYW5kIGNhbiBiZSBtb3ZlZCBhcm91bmQgYW5kIHJlc2l6ZWQgb3IgaGlkZGVuIGZvciBjb252ZW5pZW5jZS4KClRoZSBCb25kVGFibGUgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBlaXRoZXIgd2l0aCBib25kcyBjb250YWluaW5nIGBTdHJ1Y3RCb25kYCBvciB3aXRoIGBCb25kc0xpc3RgLiBGdXR1cmUgdHlwZXMgd2l0aCBzaW1pbGFyIHN0cnVjdHVyZSB3aWxsIGFsc28gYmUgYWRkZWQuCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgYSBib25kdGFibGUgY29udGFpbmluZyBhbGwgdGhlIGV4YW1wbGVzIG9mIHRoaXMgbm90ZWJvb2suCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2hKdjZWxsX2lk2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzakY29kZaNhc2SobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNoSnY2VsbF9pZNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2pGNvZGXZR0JvbmRUYWJsZShbCglhc2RfYm9uZCwKCW50X2JvbmQsCglibCwKCWJsYwpdOyBkZXNjcmlwdGlvbiA9ICJNeSBCb25kcyIpqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2aEp2NlbGxfaWTZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZqRjb2Rl2gLjYmVnaW4KIiIiCglzdHJ1Y3QgQVNECiIiIgpCYXNlLkBrd2RlZiBzdHJ1Y3QgQVNECglhOjpJbnQgCgliOjpJbnQKCWM6OlN0cmluZwoJIlRoaXMgZmllbGQgaXMgX3NwZWNpYWxfIgoJZDo6U3RyaW5nCgllOjpJbnQKZW5kCkB0eXBlYXNmaWVsZCBTdHJpbmcgPSBUZXh0RmllbGQoKSAjIFN0cmluZyBmaWVsZHMgd2l0aCBubyBzdHJ1Y3Qtc3BlY2lmaWMgZGVmYXVsdCB3aWxsIHVzZSB0aGlzIApAZmllbGRkYXRhIEFTRCBiZWdpbgoJYSA9IChtZCJNYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIGBgTGFUZVhgYCIsIFNsaWRlcigxOjEwKSkKCWIgPSAoQGh0bCgiPHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj4iKSwgU2NydWJiYWJsZSgxOjEwKSkKCWMgPSAoIk5vcm1hbCBTdHJpbmcgRGVzY3JpcHRpb24iLCBUZXh0RmllbGQoKSkKCSMgZCBoYXMgbm8gQVNELXNwZWNpZmljIGN1c3RvbSBib25kLCBzbyBpdCB3aWxsIHVzZSB0aGUgZmllbGQgZG9jc3RyaW5nIGFzIGRlc2NyaXB0aW9uIGFuZCB0aGUgZGVmYXVsdCBTdHJpbmcgd2lkZ2V0IGFzIHdpZGdldAoJZSA9IFNsaWRlcigyMDoyNSkgIyBObyBkZXNjcmlwdGlvbiwgZGVmYXVsdHMgdG8gdGhlIGZpZWxkbmFtZSBhcyBubyBkb2NzdHJpbmcgaXMgcHJlc2VudAplbmQKYXNkX2JvbmQgPSBAYmluZCBhc2QgU3RydWN0Qm9uZChBU0Q7IGRlc2NyaXB0aW9uID0gIkN1c3RvbSBEZXNjcmlwdGlvbiIpCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0hKdjZWxsX2lk2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjSkY29kZaNib2iobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNoSnY2VsbF9pZNkkMDY1YmFkNzMtNWZhOC00NDk2LWJhMzMtOWU2Njk0MGI1ODA2pGNvZGWnbG9sX3BvcKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMDNlOWQ3NWUtZTZjOS00MTk5LTkzM2ItMmJlMzA2ZGFmOTc4hKdjZWxsX2lk2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NzikY29kZaNhc2SobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM4SnY2VsbF9pZNkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMzpGNvZGWkZnJlcahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwhKdjZWxsX2lk2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTCkY29kZdoBim1kIiIiCkdlbmVyYXRpbmcgYXV0b21hdGljIHdpZGdldHMgZm9yIGN1c3RvbSBzdHJ1Y3RzIGlzIHF1aXRlIHN0cmFpZ2h0Zm9yd2FyZCB3aXRoIHRoZSBhaWQgb2YgdGhlIGBAZmllbGRkYXRhYCBtYWNybyBhbmQgdGhlIGBTdHJ1Y3RCb25kYCB0eXBlLgoKVGhlIHRvcC1sZWZ0IGFycm93IGNhbiBiZSB1c2VkIHRvIHNob3ctaGlkZSB0aGUgZmllbGQgZWxlbWVudHMgKHVzZWZ1bCBpbnNpZGUgYSBgQm9uZFRhYmxlYCwgc2hvd24gYmVsb3cpLCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGZlODkxYjRlLWY0NDAtNDgyMy1iNDNiLTcyNTcyZjZhNmMxMoSnY2VsbF9pZNkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEypGNvZGXZIW1kIiIiCiMjIERlZmF1bHQgVHlwZSBXaWRnZXRzCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1hKdjZWxsX2lk2SQ0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjWkY29kZbNtZCIiIgojIEBOVEJvbmQKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGaEp2NlbGxfaWTZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZqRjb2Rlv2JlZ2luCgl1c2luZyBQbHV0b0Rldk1hY3JvcwplbmSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YYSnY2VsbF9pZNkkOWQ0NDU1YWYtOTZmMS00NmQ3LWE0ZjMtNDM0NDk1YjExYzhhpGNvZGW0bWQiIiIKIyBQYWNrYWdlcwoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M4SnY2VsbF9pZNkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzpGNvZGW5RXh0ZW5kZWRUYWJsZU9mQ29udGVudHMoKahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyhKdjZWxsX2lk2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTKkY29kZdoDM21kIiIiClRoZSBzdHJ1Y3R1cmVzIGFib3ZlIGNhbiBhbHNvIGJlIHVzZWQgbmVzdGVkIHdpdGhpbiBvbmUgYW5vdGhlci4gVG8gZmFjaWxpdGF0ZSBhY2Nlc3NpbmcgbmVzdGVkIHN0cnVjdHVyZXMsIG9uZSBjYW4gdXNlIHRoZSBgUG9wb3V0YCB0eXBlLgoKSW4gaXRzIHNpbXBsZSBmb3JtLCB5b3UgY2FuIGdpdmUgYW4gaW5zdGFuY2Ugb2YgYSBTdHJ1Y3RCb25kLCBhIGJvbmQgd3JhcHBpbmcgYSBTdHJ1Y3RCb25kIG9yIGEgQm9uZHNMaXN0IGFzIGlucHV0IHRvIFBvcG91dCB0byBjcmVhdGUgYSB0YWJsZSB0aGF0IGlzIGhpZGRlbiBiZWhpbmQgYSBwb3B1cCB3aW5kb3cuCklmIGFuIGluc3RhbmNlIHByZXNlbnQsIGJ1dCB5b3Ugd2FudCBhIGN1c3RvbSB0eXBlIGZvciB3aGljaCB5b3UgaGF2ZSBkZWZpbmVkIGN1c3RvbSBib25kcyBhbmQgZGVzY3JpcHRpb25zIHdpdGggYEBmaWVsZGRhdGFgIHRvIGFwcGVhciBhcyBwb3BvdXQsIHlvdSBjYW4gdXNlIHRoZSBmdW5jdGlvbiBgcG9wb3V0d3JhcChUWVBFKWAgdG8gZ2VuZXJhdGUgYSBzbWFsbCBpY29uIHdoaWNoIGhpZGVzIGEgcG9wdXAgY29udGFpbmluZyB0aGUgYFN0cnVjdEJvbmRgIG9mIHRoZSBwcm92aWRlZCB0eXBlIGBUWVBFYC4KClRoZSBTdHJ1Y3RCb25kIHRhYmxlIGFwcGVhcnMgb24gaG92ZXIgdXBvbiB0aGUgaWNvbiwgY2FuIGJlIG1hZGUgZml4ZWQgYnkgY2xpY2tpbmcgb24gdGhlIGljb24gYW5kIGNhbiB0aGVuIGJlIG1vdmVkIGFyb3VuZCBvciByZXNpemVkLgpBIGRvdWJsZSBjbGljayBvbiB0aGUgaGVhZGVyIG9mIHRoZSBwb3BvdXQgaGlkZXMgaXQgYWdhaW46CiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1hKdjZWxsX2lk2SQzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDWkY29kZbVtZCIiIgojIEJvbmRUYWJsZQoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNYSnY2VsbF9pZNkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1pGNvZGXZcWJsYyA9IEBCb25kc0xpc3QgIlBvcG91dCBDb250YWluZXIiIGJlZ2luCgkiU3RydWN0dXJlIEFTRCIgPSBQb3BvdXQoYXNkX2JvbmQpCgkiTmFtZWRUdXBsZSIgPSBQb3BvdXQobnRfYm9uZCkKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDiEp2NlbGxfaWTZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOKRjb2Rl2gE8YmVnaW4KCUBrd2RlZiBzdHJ1Y3QgTUFICgkJYTo6SW50CgllbmQKCUBrd2RlZiBzdHJ1Y3QgQk9ICgkJbWFoOjpNQUgKCWVuZAoJCgkjIFRoaXMgd2lsbCBtYWtlIHRoZSBkZWZhdWx0IHdpZGdldCBmb3IgYW4gSW50IGEgU2xpZGVyCglAdHlwZWFzZmllbGQgSW50ID0gU2xpZGVyKDE6MTApCgkjIFRoaXMgd2lsbCBtYWtlIHRoZSBkZWZhdWx0IHdpZGdldCBmb3IgZmllbGRzIG9mIHR5cGUgQVNEIGEgcG9wb3V0IHRoYXQgd3JhcHMgYSBTdHJ1Y3RCb25ke0FTRH0KCUBwb3BvdXRhc2ZpZWxkIE1BSAoJCglAYmluZCBib2ggU3RydWN0Qm9uZChCT0gpCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyhKdjZWxsX2lk2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKkY29kZdmlYmVnaW4KQmFzZS5Aa3dkZWYgc3RydWN0IExPTAoJYTo6SW50IAoJYjo6SW50CmVuZApAZmllbGRkYXRhIExPTCBiZWdpbgoJYSA9IChtZCJXb25kZXIhIiwgU2xpZGVyKDE6MTApKQoJYiA9IChAaHRsKCI8c3Bhbj5GaWVsZCBCPC9zcGFuPiIpLCBTY3J1YmJhYmxlKDE6MTApKQplbmQKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTaEp2NlbGxfaWTZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNqRjb2Rlo2FzZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzhKdjZWxsX2lk2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkY29kZdmPQGZyb21wYWNrYWdlICIuLi8uLiIgYmVnaW4KCXVzaW5nIF4uU3RydWN0Qm9uZE1vZHVsZQoJdXNpbmcgXjogRXh0ZW5kZWRUYWJsZU9mQ29udGVudHMsIEVkaXRhYmxlCgl1c2luZyA+Lkh5cGVydGV4dExpdGVyYWwKCXVzaW5nID4uUGx1dG9VSQplbmSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MISnY2VsbF9pZNkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwpGNvZGW2bWQiIiIKIyBTdHJ1Y3RCb25kCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3hKdjZWxsX2lk2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzekY29kZbZtZCIiIgojIEBCb25kc0xpc3QKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTSEp2NlbGxfaWTZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNKRjb2RlpGZyZXGobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZoSnY2VsbF9pZNkkMDhkNzExYzAtZTJjYy00NDQ0LTk0Y2EtMGM0YzNjZmU5MDFmpGNvZGWibnSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzOISnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4pGNvZGWibnSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN4SnY2VsbF9pZNkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3pGNvZGXaA1htZCIiIgpJbiBzb21lIGNhc2VzLCBvbmUgZG9lcyBub3Qgd2FudCB0byBoYXZlIGEgc2luZ2xlIGJvbmQgd3JhcHBpbmcgZWl0aGVyIGEgU3RydWN0dXJlIG9yIGEgTmFtZWRUdXBsZSBiZWNhdXNlIHNpbmdsZSBpbmRlcGVuZGVudCBib25kcyBhcmUgbW9yZSBjb252ZW5pZW50LgoKYEBCb25kc0xpc3RgIGlzIGEgY29udmVuaWVuY2UgbWFjcm8gdG8gY3JlYXRlIGFuIG9iamVjdCBvZiB0eXBlIGBCb25kc0xpc3RgIHdoaWNoIHNpbXBseSBhbGxvdyB0byBhZGQgYSBkZXNjcmlwdGlvbiB0byBzZXBhcmF0ZSBib25kcyBhbmQgZ3JvdXAgdGhlbSBhbGwgdG9nZXRoZXIgaW4gYSB0YWJsZS1saWtlIGZvcm1hdCBlcXVpdmFsZW50IHRvIHRob3NlIG9mIGBTdHJ1Y3RCb25kYC4KCiEhISBub3RlCglVbmxpa2UgYFN0cnVjdEJvbmRgLCBhIEJvbmRzTGlzdCBpcyBhbHJlYWR5IGNvbXBvc2VkIG9mIGJvbmQgY3JlYXRlZCB3aXRoIGBAYmluZGAgYW5kIGl0IGp1c3QgZ3JvdXBzIHRoZW0gdXAgd2l0aCBhIGRlc2NyaXB0aW9uLiBUaGUgb3V0cHV0IG9mIGBAQm9uZHNMaXN0YCBpcyBub3Qgc3VwcG9zZWQgdG8gYmUgYm91bmQgdG8gYSB2YXJpYWJsZSB1c2luZyBgQGJpbmRgLlwKCVRoZSBib25kcyBncm91cGVkIGluIGEgQm9uZHNMaXN0IHN0aWxsIGFjdCBhbmQgdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSBvbmUgYW5vdGhlci4KClNlZSB0aGUgZXhhbXBsZSBiZWxvdyBmb3IgdW5kZXJzdGFuZGluZyB0aGUgc3ludGhheC4gVGhlIGhlYWRlciBvZiBhIEJvbmRzTGlzdCBpcyBzaG93biBpbiBhbiBvcmFuZ2UgYmFja2dyb3VuZCB0byBlYXNpbHkgZGlmZmVyZW50aWF0ZSBpdCBmcm9tIGBTdHJ1Y3RCb25kYC4KIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTeEp2NlbGxfaWTZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N6Rjb2Rl2gE3bWQiIiIKVGhlIGFiaWxpdHkgdG8gYWxzbyB3cmFwIHByZS1leGlzdGluZyBib25kcyBhcm91bmQgU3RydWN0Qm9uZHMgaXMgY29udmVuaWVudCBmb3Igb3JnYW5pemluZyB0aGUgdmFyaW91cyBib25kcyBvbmUgaGF2ZSBpbiBhIGBCb25kc0xpc3RgIG9yIGBCb25kVGFibGVgCgpBcyBhbiBleGFtcGxlLCBvbmUgY2FuIGNyZWF0ZSBhIGBCb25kc0xpc3RgIGNvbnRhaW5pbmcgdGhlIHR3byBgU3RydWN0Qm9uZGAgYm9uZHMgZ2VuZXJhdGVkIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhpcyBub3RlYm9vayB3aXRoIHRoZSBmb2xsd2luZyBjb2RlLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NISnY2VsbF9pZNkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0pGNvZGW9QGJpbmQgbG9sX3BvcCBwb3BvdXR3cmFwKExPTCmobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYoSnY2VsbF9pZNkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZipGNvZGWjYWx0qG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjmEp2NlbGxfaWTZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOaRjb2Rl2cdudF9ib25kID0gQGJpbmQgbnQgQE5UQm9uZCAiTXkgRmFuY3kgTlR1cGxlIiBiZWdpbgoJYSA9ICgiRGVzY3JpcHRpb24iLCBTbGlkZXIoMToxMCkpCgliID0gKG1kIioqQm9sZCoqIGZpZWxkIiwgU2xpZGVyKDE6MTApKQoJYyA9IFNsaWRlcigxOjEwKSAjIE5vIGRlc2NyaXB0aW9uLCBkZWZhdWx0cyB0byB0aGUgbmFtZSBvZiB0aGUgZmllbGQKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTCq25vdGVib29rX2lk2SRiZGYyZjUxMC00N2QwLTExZWUtMzQwOS00ZDU0ODM2ZjkxMDSraW5fdGVtcF9kaXLCqG1ldGFkYXRhgaxjdXN0b21fYXR0cnORrGhpZGUtZW5hYmxlZA==";
window.pluto_preamble_html = undefined;
</script>

<meta name="pluto-insertion-spot-parameters">
<script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.0caa001c.js" type="module" defer="" integrity="sha384-pHXNjYSrnFaNwPp9QkuM2L6oJwAC/Oa8XjuXJ4lBzdeKwH4AcU1yYMGLN0NEAXWx" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.8a3292da.js" integrity="sha384-itp4oE2PRbSrrTHVpWh8sqAuVUsz7ja6L2Dgp/JRfMCD2AwVdTk56K96POF3oLmu" crossorigin="anonymous"></script><script type="text/javascript" id="MathJax-script" integrity="sha384-4kE/rQ11E8xT9QgrCBTyvenkuPfQo8rXYQvJZuMgxyPOoUfpatjQPlgdv6V5yhUK" crossorigin="" not-the-src-yet="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-svg-full.js" async=""></script></head><body class="loading no-MÎ±Î¸Jax"> <div style="display:flex;min-height:100vh;"> <pluto-editor class="fullscreen"></pluto-editor> </div> </body></html>