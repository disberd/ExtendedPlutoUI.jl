<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"><meta charset="utf-8">
<meta name="pluto-insertion-spot-meta">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2a2928"><meta name="color-scheme" content="light dark"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon-16x16.347d2855.png" integrity="sha384-3qsGeVLdddzV9oIkj3PhXXQX2CZCjOD/CiyrPQOX6InOWw3HAHClrsQhPfX9uRAj" crossorigin="anonymous"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon-32x32.8789add4.png" integrity="sha384-cOe5vSoBIgKNgkUL27p9RpsGVY0uBg9PejLccDy+fR8ZD1Iv5dF1MGHjIZAIZwm6" crossorigin="anonymous"><link rel="icon" type="image/png" sizes="96x96" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon-96x96.48689391.png" integrity="sha384-TN49cYb8GyNmrZT14bsYXXo4l1x1NJeJ/EHuVAauAKsNPopPHLojijs9jFT4Vs8c" crossorigin="anonymous"><link rel="pluto-logo-big" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/logo.004c1d7c.svg" integrity="sha384-GkQkODcGxsrSRJCkeakBXihum0GUM44cwBgKyutDimectXCbCgj6Vu3jlrueqEcN" crossorigin="anonymous"><link rel="pluto-logo-small" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/favicon_unsaturated.d1387b25.svg" integrity="sha384-omwjH+Qy3hpAVf5FYd/pkaDBuVAfsEDRN7eBxEA8Ek00OAWP+aiV+GpEYk3I7lyo" crossorigin="anonymous"><script type="module" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.307d1245.js" integrity="sha384-7t5v1Xs3lzIHj1Libdf7OWsT7hSJw6fKrWsg4B4wMiPgWrRgvBDCnTZ6sUxIOV6c" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/juliamono.c6034ab4.css" integrity="sha384-n0za6lUXlyf4XC+nGkZWj3TLDnRbNpAcoi4PZGSlQMPoyqGa9kGY+ZXkUgZGIhQt" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.9402a72e.css" integrity="sha384-NJUInpSDijrLS5DfgY1ITvzJ/8HJmHa62lN/13hYf8FknsJEMJdwqQWtyreOFUZ3" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/vollkorn.089565a8.css" integrity="sha384-jnV/84VtSgBLF70H+s2rxJcOUZIMDR+X/ElFZA83i9ZtZSWiIMFAgPyrWkOJV08q" crossorigin="anonymous"><script defer="">console.log("Pluto.jl, by Fons van der Plas (https://github.com/fonsp), MikoÅ‚aj Bochenski (https://github.com/malyvsen), Michiel Dral (https://github.com/dralletje) and friends ðŸŒˆ");</script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.4b96dd74.js" defer="" integrity="sha384-Y+UtWANyXLeovyghpAI8j9/VZXWboD6G5ZCckOsJO99PawAh/utJxFikf62WBaSu" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.9f9dc874.js" defer="" integrity="sha384-tkFo1EK72I9JvoTmHFa199dfRzW8mkXPUkHb/N7UhYI+bxKzX3Kh8LNCZz1ltsFF" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.90ede145.js" defer="" integrity="sha384-CuNU9gQg6fa/yynNqNWjHWzPm4nj+d7O6+HXsNGSqClhs/bYQIbBC3Lw/kh8Ukui" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.dbeed08a.js" defer="" integrity="sha384-1BEdQwXfZi4ZpsNV8w1X8pQcVK1/DS/+/M8OTo3gol7mdEspSN7nT6llX57NQCSt" crossorigin="anonymous"></script><script id="iframe-resizer-content-window-script" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.6386bd9d.js" crossorigin="anonymous" defer="" integrity="sha384-tgN2a0VDi/lCYwZuDqT7L+A/Y/9kpxf3HV7zv2BJ5Fu7zW0EClq0nM4crfK3TRPs"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.2f145fef.css" type="text/css" integrity="sha384-brUzgyAEfbBBVyJ4hyYtkh7JwYXu6+fCsvxz2sbO6aU3IPW0xX7SC9TzwP63TBcB" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.14f23ca4.css" type="text/css" media="all" data-pluto-file="hide-ui" integrity="sha384-++EDAMZbJynENol9onosKuuWP4ex4rhT9Rl/oELs6oVltwZdU9DC0W1nYT4Ttb9V" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.99402935.css" type="text/css" integrity="sha384-Wl7QT6vOzvYxGbF4LKAXVRihsch7DCr4GeiXwOS273IU4E5g7HMSBkrbI9GFP+qI" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.1f4cf2ca.css" type="text/css" integrity="sha384-lBSBsn8FT1UzGOsNVudfV8RSHQEuNWqrCb6xQnF10uvF9AiCzYsCRXvKlhtQvV3c" crossorigin="anonymous"><link rel="preload" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/juliamono.c6034ab4.css" as="style" integrity="sha384-n0za6lUXlyf4XC+nGkZWj3TLDnRbNpAcoi4PZGSlQMPoyqGa9kGY+ZXkUgZGIhQt" crossorigin="anonymous"><link rel="preload" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/vollkorn.089565a8.css" as="style" integrity="sha384-jnV/84VtSgBLF70H+s2rxJcOUZIMDR+X/ElFZA83i9ZtZSWiIMFAgPyrWkOJV08q" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.e82e08bd.css" type="text/css" integrity="sha384-7YN+h8b6N4N65qk8TG/J2KPF95D8z3sGNd06rokz4CX9oWu0KnRAF5cVWu3BkkaN" crossorigin="anonymous"><script data-pluto-file="launch-parameters">
window.pluto_notebook_id = undefined;
window.pluto_isolated_cell_ids = undefined;
window.pluto_notebookfile = "data:text/julia;charset=utf-8;base64,IyMjIEEgUGx1dG8uamwgbm90ZWJvb2sgIyMjCiMgdjAuMTkuMjcKCiM+IGN1c3RvbV9hdHRycyA9IFsiaGlkZS1lbmFibGVkIl0KCnVzaW5nIE1hcmtkb3duCnVzaW5nIEludGVyYWN0aXZlVXRpbHMKCiMgVGhpcyBQbHV0byBub3RlYm9vayB1c2VzIEBiaW5kIGZvciBpbnRlcmFjdGl2aXR5LiBXaGVuIHJ1bm5pbmcgdGhpcyBub3RlYm9vayBvdXRzaWRlIG9mIFBsdXRvLCB0aGUgZm9sbG93aW5nICdtb2NrIHZlcnNpb24nIG9mIEBiaW5kIGdpdmVzIGJvdW5kIHZhcmlhYmxlcyBhIGRlZmF1bHQgdmFsdWUgKGluc3RlYWQgb2YgYW4gZXJyb3IpLgptYWNybyBiaW5kKGRlZiwgZWxlbWVudCkKICAgIHF1b3RlCiAgICAgICAgbG9jYWwgaXYgPSB0cnkgQmFzZS5sb2FkZWRfbW9kdWxlc1tCYXNlLlBrZ0lkKEJhc2UuVVVJRCgiNmU2OTZjNzItNjU0Mi0yMDY3LTcyNjUtNDIyMDZjNzU2MTUwIiksICJBYnN0cmFjdFBsdXRvRGluZ2V0amVzIildLkJvbmRzLmluaXRpYWxfdmFsdWUgY2F0Y2g7IGIgLT4gbWlzc2luZzsgZW5kCiAgICAgICAgbG9jYWwgZWwgPSAkKGVzYyhlbGVtZW50KSkKICAgICAgICBnbG9iYWwgJChlc2MoZGVmKSkgPSBDb3JlLmFwcGxpY2FibGUoQmFzZS5nZXQsIGVsKSA/IEJhc2UuZ2V0KGVsKSA6IGl2KGVsKQogICAgICAgIGVsCiAgICBlbmQKZW5kCgojIOKVlOKVkOKVoSA4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGYKYmVnaW4KCXVzaW5nIFBsdXRvRGV2TWFjcm9zCmVuZAoKIyDilZTilZDilaEgOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzCkBmcm9tcGFja2FnZSAiLi4vLi4iIGJlZ2luCgl1c2luZyBeLlN0cnVjdEJvbmRNb2R1bGUKCXVzaW5nIF46IEV4dGVuZGVkVGFibGVPZkNvbnRlbnRzLCBFZGl0YWJsZQoJdXNpbmcgPi5IeXBlcnRleHRMaXRlcmFsCgl1c2luZyA+LlBsdXRvVUkKZW5kCgojIOKVlOKVkOKVoSA5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGEKbWQiIiIKIyBQYWNrYWdlcwoiIiIKCiMg4pWU4pWQ4pWhIDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5MwpFeHRlbmRlZFRhYmxlT2ZDb250ZW50cygpCgojIOKVlOKVkOKVoSA0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzAKbWQiIiIKIyBTdHJ1Y3RCb25kCiIiIgoKIyDilZTilZDilaEgYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwCm1kIiIiCkdlbmVyYXRpbmcgYXV0b21hdGljIHdpZGdldHMgZm9yIGN1c3RvbSBzdHJ1Y3RzIGlzIHF1aXRlIHN0cmFpZ2h0Zm9yd2FyZCB3aXRoIHRoZSBhaWQgb2YgdGhlIGBAZmllbGRkYXRhYCBtYWNybyBhbmQgdGhlIGBTdHJ1Y3RCb25kYCB0eXBlLgoKVGhlIHRvcC1sZWZ0IGFycm93IGNhbiBiZSB1c2VkIHRvIHNob3ctaGlkZSB0aGUgZmllbGQgZWxlbWVudHMgKHVzZWZ1bCBpbnNpZGUgYSBgQm9uZFRhYmxlYCwgc2hvd24gYmVsb3cpLCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLgoiIiIKCiMg4pWU4pWQ4pWhIDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZgpiZWdpbgoiIiIKCXN0cnVjdCBBU0QKIiIiCkJhc2UuQGt3ZGVmIHN0cnVjdCBBU0QKCWE6OkludCAKCWI6OkludAoJYzo6U3RyaW5nCgkiVGhpcyBmaWVsZCBpcyBfc3BlY2lhbF8iCglkOjpTdHJpbmcKCWU6OkludAplbmQKQGZpZWxkZGF0YSBBU0QgYmVnaW4KCWEgPSAobWQiTWFya2Rvd24gZGVzY3JpcHRpb24sIGluY2x1ZGluZyBgYExhVGVYYGAiLCBTbGlkZXIoMToxMCkpCgliID0gKEBodGwoIjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+IiksIFNjcnViYmFibGUoMToxMCkpCgljID0gKCJOb3JtYWwgU3RyaW5nIERlc2NyaXB0aW9uIiwgVGV4dEZpZWxkKCkpCglkID0gVGV4dEZpZWxkKCkgIyBObyBkZXNjcmlwdGlvbiwgZGVmYXVsdHMgdG8gdGhlIGRvY3N0cmluZyBzaW5jZSBpdCdzIHByZXNlbnQKCWUgPSBTbGlkZXIoMjA6MjUpICMgTm8gZGVzY3JpcHRpb24sIGRlZmF1bHRzIHRvIHRoZSBmaWVsZG5hbWUgYXMgbm8gZG9jc3RyaW5nIGlzIHByZXNlbnQKZW5kCmFzZF9ib25kID0gQGJpbmQgYXNkIFN0cnVjdEJvbmQoQVNEOyBkZXNjcmlwdGlvbiA9ICJDdXN0b20gRGVzY3JpcHRpb24iKQplbmQKCiMg4pWU4pWQ4pWhIGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3Ngphc2QKCiMg4pWU4pWQ4pWhIDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNQptZCIiIgojIEBOVEJvbmQKIiIiCgojIOKVlOKVkOKVoSA4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDAKbWQiIiIKU29tZXRpbWVzIGN1c3RvbSBzdHJ1Y3RzIGFyZSBub3QgbmVlZGVkIGFuZCBpdCB3b3VsZCBiZSB1c2VmdWwgdG8ganVzdCB1c2UgdGhlIHNhbWUgbmljZSBib25kIHN0cnVjdHVyZSBvZiBgU3RydWN0Qm9uZGAgdG8gc2ltcGx5IGNyZWF0ZSBhcmJpdHJhcnkgTmFtZWRUdXBsZXMuIAoKVGhpcyBpcyBwb3NzaWJsZSB3aXRoIHRoZSBjb252ZW5pZW5jZSBtYWNybyBgQE5UQm9uZGAgd2hpY2ggY2FuIGJlIGNhbGxlZCBhcyBzaG93biBiZWxvdyB0byBjcmVhdGUgYSBuaWNlIGRpc3BsYXkgZm9yIGFuIGludGVyYWN0aXZlIGJvbmQgY3JlYXRpbmcgYW4gYXJiaXRyYXJ5IE5hbWVkVHVwbGUuCgpUaGUgbWFjcm8gc2ltcGx5IGNyZWF0ZSBhIGBTdHJ1Y3RCb25kYCB3cmFwcGluZyB0aGUgZGVzaXJlZCBOYW1lZFR1cGxlIHR5cGUuCiIiIgoKIyDilZTilZDilaEgMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5Cm50X2JvbmQgPSBAYmluZCBudCBATlRCb25kICJNeSBGYW5jeSBOVHVwbGUiIGJlZ2luCglhID0gKCJEZXNjcmlwdGlvbiIsIFNsaWRlcigxOjEwKSkKCWIgPSAobWQiKipCb2xkKiogZmllbGQiLCBTbGlkZXIoMToxMCkpCgljID0gU2xpZGVyKDE6MTApICMgTm8gZGVzY3JpcHRpb24sIGRlZmF1bHRzIHRvIHRoZSBuYW1lIG9mIHRoZSBmaWVsZAplbmQKCiMg4pWU4pWQ4pWhIGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzOApudAoKIyDilZTilZDilaEgOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3Cm1kIiIiCiMgQEJvbmRzTGlzdAoiIiIKCiMg4pWU4pWQ4pWhIDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkNwptZCIiIgpJbiBzb21lIGNhc2VzLCBvbmUgZG9lcyBub3Qgd2FudCB0byBoYXZlIGEgc2luZ2xlIGJvbmQgd3JhcHBpbmcgZWl0aGVyIGEgU3RydWN0dXJlIG9yIGEgTmFtZWRUdXBsZSwgYW5kIHNpbmdsZSBpbmRlcGVuZGVudCBib25kcyBhcmUgbW9yZSBjb252ZW5pZW50LgoKYEBCb25kc0xpc3RgIGlzIGEgY29udmVuaWVuY2UgbWFjcm8gdG8gY3JlYXRlIGFuIG9iamVjdCBvZiB0eXBlIGBCb25kc0xpc3RgIHdoaWNoIHNpbXBseSBhbGxvdyB0byBhZGQgYSBkZXNjcmlwdGlvbiB0byBzZXBhcmF0ZSBib25kcyBhbmQgZ3JvdXAgdGhlbSBhbGwgdG9nZXRoZXIgaW4gYSB0YWJsZS1saWtlIGZvcm1hdCBlcXVpdmFsZW50IHRvIHRob3NlIG9mIGBTdHJ1Y3RCb25kYC4KCiEhISBub3RlCglVbmxpa2UgYFN0cnVjdEJvbmRgLCBhIEJvbmRzTGlzdCBpcyBhbHJlYWR5IGNvbXBvc2VkIG9mIGJvbmQgY3JlYXRlZCB3aXRoIGBAYmluZGAgYW5kIGl0IGp1c3QgZ3JvdXBzIHRoZW0gdXAgd2l0aCBhIGRlc2NyaXB0aW9uLiBUaGUgb3V0cHV0IG9mIGBAQm9uZHNMaXN0YCBpcyBub3Qgc3VwcG9zZWQgdG8gYmUgYm91bmQgdG8gYSB2YXJpYWJsZSB1c2luZyBgQGJpbmRgLlwKCVRoZSBib25kcyBncm91cGVkIGluIGEgQm9uZHNMaXN0IHN0aWxsIGFjdCBhbmQgdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSBvbmUgYW5vdGhlci4KClNlZSB0aGUgZXhhbXBsZSBiZWxvdyBmb3IgdW5kZXJzdGFuZGluZyB0aGUgc3ludGhheC4gVGhlIGhlYWRlciBvZiBhIEJvbmRzTGlzdCBpcyBzaG93biBpbiBhbiBvcmFuZ2UgYmFja2dyb3VuZCB0byBlYXNpbHkgZGlmZmVyZW50aWF0ZSBpdCBmcm9tIGBTdHJ1Y3RCb25kYC4KIiIiCgojIOKVlOKVkOKVoSA0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmMKYmwgPSBAQm9uZHNMaXN0ICJNeSBHcm91cCBvZiBCb25kcyIgbGV0IHR2ID0gUGx1dG9VSS5FeHBlcmltZW50YWwudHJhbnNmb3JtZWRfdmFsdWUKCSAjIFdlIHVzZSB0cmFuc2Zvcm1lZF92YWx1ZSB0byB0cmFuc2xhdGUgR0h6IHRvIEh6IGluIHRoZSBib3VuZCB2YXJpYWJsZSBgZnJlcWAKCSJGcmVxdWVuY3kgW0dIel0iID0gQGJpbmQgZnJlcSB0dih4IC0+IHggKiAxZTksIEVkaXRhYmxlKDIwOyBzdWZmaXggPSAiIEdIeiIpKQoJbWQiQWx0aXR1ZGUgYGBoYGAgW21dIiA9IEBiaW5kIGFsdCBTY3J1YmJhYmxlKDEwMDoxMDoyMDApCmVuZAoKIyDilZTilZDilaEgYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0CmZyZXEKCiMg4pWU4pWQ4pWhIDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYgphbHQKCiMg4pWU4pWQ4pWhIDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3YwptZCIiIgojIFBvcG91dAoiIiIKCiMg4pWU4pWQ4pWhIDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMgptZCIiIgpUaGUgc3RydWN0dXJlcyBhYm92ZSBjYW4gYWxzbyBiZSB1c2VkIG5lc3RlZCB3aXRoaW4gb25lIGFub3RoZXIuIFRvIGZhY2lsaXRhdGUgYWNjZXNzaW5nIG5lc3RlZCBzdHJ1Y3R1cmVzLCBvbmUgY2FuIHVzZSB0aGUgYFBvcG91dGAgdHlwZS4KCkluIGl0cyBzaW1wbGUgZm9ybSwgeW91IGNhbiBnaXZlIGFuIGluc3RhbmNlIG9mIGEgU3RydWN0Qm9uZCwgYSBib25kIHdyYXBwaW5nIGEgU3RydWN0Qm9uZCBvciBhIEJvbmRzTGlzdCBhcyBpbnB1dCB0byBQb3BvdXQgdG8gY3JlYXRlIGEgdGFibGUgdGhhdCBpcyBoaWRkZW4gYmVoaW5kIGEgcG9wdXAgd2luZG93LgpJZiBhbiBpbnN0YW5jZSBwcmVzZW50LCBidXQgeW91IHdhbnQgYSBjdXN0b20gdHlwZSBmb3Igd2hpY2ggeW91IGhhdmUgZGVmaW5lZCBjdXN0b20gYm9uZHMgYW5kIGRlc2NyaXB0aW9ucyB3aXRoIGBAZmllbGRkYXRhYCB0byBhcHBlYXIgYXMgcG9wb3V0LCB5b3UgY2FuIHVzZSB0aGUgZnVuY3Rpb24gYHBvcG91dHdyYXAoVFlQRSlgIHRvIGdlbmVyYXRlIGEgc21hbGwgaWNvbiB3aGljaCBoaWRlcyBhIHBvcHVwIGNvbnRhaW5pbmcgdGhlIGBTdHJ1Y3RCb25kYCBvZiB0aGUgcHJvdmlkZWQgdHlwZSBgVFlQRWAuCgpUaGUgU3RydWN0Qm9uZCB0YWJsZSBhcHBlYXJzIG9uIGhvdmVyIHVwb24gdGhlIGljb24sIGNhbiBiZSBtYWRlIGZpeGVkIGJ5IGNsaWNraW5nIG9uIHRoZSBpY29uIGFuZCBjYW4gdGhlbiBiZSBtb3ZlZCBhcm91bmQgb3IgcmVzaXplZC4KQSBkb3VibGUgY2xpY2sgb24gdGhlIGhlYWRlciBvZiB0aGUgcG9wb3V0IGhpZGVzIGl0IGFnYWluOgoiIiIKCiMg4pWU4pWQ4pWhIDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMgpiZWdpbgpCYXNlLkBrd2RlZiBzdHJ1Y3QgTE9MCglhOjpJbnQgCgliOjpJbnQKZW5kCkBmaWVsZGRhdGEgTE9MIGJlZ2luCglhID0gKG1kIldvbmRlciEiLCBTbGlkZXIoMToxMCkpCgliID0gKEBodGwoIjxzcGFuPkZpZWxkIEI8L3NwYW4+IiksIFNjcnViYmFibGUoMToxMCkpCmVuZAplbmQKCiMg4pWU4pWQ4pWhIDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NApwb3BvdXR3cmFwKExPTCkKCiMg4pWU4pWQ4pWhIDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5NwptZCIiIgpUaGUgYWJpbGl0eSB0byBhbHNvIHdyYXAgcHJlLWV4aXN0aW5nIGJvbmRzIGFyb3VuZCBTdHJ1Y3RCb25kcyBpcyBjb252ZW5pZW50IGZvciBvcmdhbml6aW5nIHRoZSB2YXJpb3VzIGJvbmRzIG9uZSBoYXZlIGluIGEgYEJvbmRzTGlzdGAgb3IgYEJvbmRUYWJsZWAKCkFzIGFuIGV4YW1wbGUsIG9uZSBjYW4gY3JlYXRlIGEgYEJvbmRzTGlzdGAgY29udGFpbmluZyB0aGUgdHdvIGBTdHJ1Y3RCb25kYCBib25kcyBnZW5lcmF0ZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGlzIG5vdGVib29rIHdpdGggdGhlIGZvbGx3aW5nIGNvZGUuCiIiIgoKIyDilZTilZDilaEgODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1CmJsYyA9IEBCb25kc0xpc3QgIlBvcG91dCBDb250YWluZXIiIGJlZ2luCgkiU3RydWN0dXJlIEFTRCIgPSBQb3BvdXQoYXNkX2JvbmQpCgkiTmFtZWRUdXBsZSIgPSBQb3BvdXQobnRfYm9uZCkKZW5kCgojIOKVlOKVkOKVoSAzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDUKbWQiIiIKIyBCb25kVGFibGUKIiIiCgojIOKVlOKVkOKVoSAzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTQKbWQiIiIKVGhlIGZpbmFsIGNvbnZlbmllbmNlIHN0cnVjdHVyZSBwcm92aWRlZCBieSB0aGlzIG1vZHVsZSBpcyB0aGUgYEJvbmRUYWJsZWAuIEl0IGNhbiBiZSBjcmVhdGVkIHRvIGdyb3VwIGEgbGlzdCBvZiBib25kcyBpbiBhIGZsb2F0aW5nIHRhYmxlIHRoYXQgc3RheXMgb24gdGhlIGxlZnQgc2lkZSBvZiB0aGUgbm90ZWJvb2sgKHNpbWlsYXIgdG8gdGhlIFRhYmxlT2ZDb250ZW50cyBvZiBQbHV0b1VJKSBhbmQgY2FuIGJlIG1vdmVkIGFyb3VuZCBhbmQgcmVzaXplZCBvciBoaWRkZW4gZm9yIGNvbnZlbmllbmNlLgoKVGhlIEJvbmRUYWJsZSBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIGVpdGhlciB3aXRoIGJvbmRzIGNvbnRhaW5pbmcgYFN0cnVjdEJvbmRgIG9yIHdpdGggYEJvbmRzTGlzdGAuIEZ1dHVyZSB0eXBlcyB3aXRoIHNpbWlsYXIgc3RydWN0dXJlIHdpbGwgYWxzbyBiZSBhZGRlZC4KCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiBhIGJvbmR0YWJsZSBjb250YWluaW5nIGFsbCB0aGUgZXhhbXBsZXMgb2YgdGhpcyBub3RlYm9vay4KIiIiCgojIOKVlOKVkOKVoSA5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTYKQm9uZFRhYmxlKFsKCWFzZF9ib25kLAoJbnRfYm9uZCwKCWJsLAoJYmxjCl07IGRlc2NyaXB0aW9uID0gIk15IEJvbmRzIikKCiMg4pWU4pWQ4pWhIDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMQpQTFVUT19QUk9KRUNUX1RPTUxfQ09OVEVOVFMgPSAiIiIKW2RlcHNdClBsdXRvRGV2TWFjcm9zID0gImEwNDk5ZjI5LWMzOWItNGM1Yy04MDdjLTg4MDc0MjIxYjk0OSIKCltjb21wYXRdClBsdXRvRGV2TWFjcm9zID0gIn4wLjUuOCIKIiIiCgojIOKVlOKVkOKVoSAwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDIKUExVVE9fTUFOSUZFU1RfVE9NTF9DT05URU5UUyA9ICIiIgojIFRoaXMgZmlsZSBpcyBtYWNoaW5lLWdlbmVyYXRlZCAtIGVkaXRpbmcgaXQgZGlyZWN0bHkgaXMgbm90IGFkdmlzZWQKCmp1bGlhX3ZlcnNpb24gPSAiMS4xMC4wLWJldGEyIgptYW5pZmVzdF9mb3JtYXQgPSAiMi4wIgpwcm9qZWN0X2hhc2ggPSAiMDg0ZDRhNGVlYTNmNTBjMjkwZjA5M2YzZTYyNjY2OWNiNGU4NjU2ZCIKCltbZGVwcy5BcmdUb29sc11dCnV1aWQgPSAiMGRhZDg0YzUtZDExMi00MmU2LThkMjgtZWYxMmRhYmI3ODlmIgp2ZXJzaW9uID0gIjEuMS4xIgoKW1tkZXBzLkFydGlmYWN0c11dCnV1aWQgPSAiNTZmMjJkNzItZmQ2ZC05OGYxLTAyZjAtMDhkZGMwOTA3YzMzIgoKW1tkZXBzLkJhc2U2NF1dCnV1aWQgPSAiMmEwZjQ0ZTMtNmM4My01NWJkLTg3ZTQtYjE5NzhkOThiZDVmIgoKW1tkZXBzLkRhdGVzXV0KZGVwcyA9IFsiUHJpbnRmIl0KdXVpZCA9ICJhZGUyY2E3MC0zODkxLTU5NDUtOThmYi1kYzA5OTQzMmUwNmEiCgpbW2RlcHMuRG93bmxvYWRzXV0KZGVwcyA9IFsiQXJnVG9vbHMiLCAiRmlsZVdhdGNoaW5nIiwgIkxpYkNVUkwiLCAiTmV0d29ya09wdGlvbnMiXQp1dWlkID0gImY0M2EyNDFmLWMyMGEtNGFkNC04NTJjLWY2YjEyNDc4NjFjNiIKdmVyc2lvbiA9ICIxLjYuMCIKCltbZGVwcy5GaWxlV2F0Y2hpbmddXQp1dWlkID0gIjdiMWY2MDc5LTczN2EtNThkYy1iOGJjLTdhMmNhNWMxYjVlZSIKCltbZGVwcy5IeXBlcnRleHRMaXRlcmFsXV0KZGVwcyA9IFsiVHJpY2tzIl0KZ2l0LXRyZWUtc2hhMSA9ICJjNDdjNWZhNGM1MzA4ZjI3Y2NhYWMzNTUwNDg1OGQ4OTE0ZTEwMmY5Igp1dWlkID0gImFjMTE5MmE4LWY0YjMtNGJmZS1iYTIyLWFmNWI5MmNkM2FiMiIKdmVyc2lvbiA9ICIwLjkuNCIKCltbZGVwcy5JbnRlcmFjdGl2ZVV0aWxzXV0KZGVwcyA9IFsiTWFya2Rvd24iXQp1dWlkID0gImI3N2UwYTRjLWQyOTEtNTdhMC05MGU4LThkYjI1YTI3YTI0MCIKCltbZGVwcy5MaWJDVVJMXV0KZGVwcyA9IFsiTGliQ1VSTF9qbGwiLCAiTW96aWxsYUNBQ2VydHNfamxsIl0KdXVpZCA9ICJiMjcwMzJjMi1hM2U3LTUwYzgtODBjZC0yZDM2ZGJjYmZkMjEiCnZlcnNpb24gPSAiMC42LjQiCgpbW2RlcHMuTGliQ1VSTF9qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliU1NIMl9qbGwiLCAiTGliZGwiLCAiTWJlZFRMU19qbGwiLCAiWmxpYl9qbGwiLCAibmdodHRwMl9qbGwiXQp1dWlkID0gImRlYWM5YjQ3LThiYzctNTkwNi1hMGZlLTM1YWM1NmRjODRjMCIKdmVyc2lvbiA9ICI4LjAuMSsxIgoKW1tkZXBzLkxpYkdpdDJdXQpkZXBzID0gWyJCYXNlNjQiLCAiTmV0d29ya09wdGlvbnMiLCAiUHJpbnRmIiwgIlNIQSJdCnV1aWQgPSAiNzZmODU0NTAtNTIyNi01YjVhLThlYWEtNTI5YWQwNDViNDMzIgoKW1tkZXBzLkxpYlNTSDJfamxsXV0KZGVwcyA9IFsiQXJ0aWZhY3RzIiwgIkxpYmRsIiwgIk1iZWRUTFNfamxsIl0KdXVpZCA9ICIyOTgxNmI1YS1iOWFiLTU0NmYtOTMzYy1lZGFkMTg4NmRmYTgiCnZlcnNpb24gPSAiMS4xMS4wKzEiCgpbW2RlcHMuTGliZGxdXQp1dWlkID0gIjhmMzk5ZGEzLTM1NTctNTY3NS1iNWZmLWZiODMyYzk3Y2JkYiIKCltbZGVwcy5Mb2dnaW5nXV0KdXVpZCA9ICI1NmRkYjAxNi04NTdiLTU0ZTEtYjgzZC1kYjRkNThkYjU1NjgiCgpbW2RlcHMuTWFjcm9Ub29sc11dCmRlcHMgPSBbIk1hcmtkb3duIiwgIlJhbmRvbSJdCmdpdC10cmVlLXNoYTEgPSAiOWVlMTYxOGNiZjUyNDBlNmQ0ZTAzNzFkNmYyNDA2NTA4M2Y2MGM0OCIKdXVpZCA9ICIxOTE0ZGQyZi04MWM2LTVmY2QtODcxOS02ZDVjOTYxMGZmMDkiCnZlcnNpb24gPSAiMC41LjExIgoKW1tkZXBzLk1hcmtkb3duXV0KZGVwcyA9IFsiQmFzZTY0Il0KdXVpZCA9ICJkNmY0Mzc2ZS1hZWY1LTUwNWEtOTZjMS05YzAyNzM5NDYwN2EiCgpbW2RlcHMuTWJlZFRMU19qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliZGwiXQp1dWlkID0gImM4ZmZkOWMzLTMzMGQtNTg0MS1iNzhlLTA4MTdkNzE0NWZhMSIKdmVyc2lvbiA9ICIyLjI4LjIrMSIKCltbZGVwcy5Nb3ppbGxhQ0FDZXJ0c19qbGxdXQp1dWlkID0gIjE0YTM2MDZkLWY2MGQtNTYyZS05MTIxLTEyZDk3MmNkODE1OSIKdmVyc2lvbiA9ICIyMDIzLjEuMTAiCgpbW2RlcHMuTmV0d29ya09wdGlvbnNdXQp1dWlkID0gImNhNTc1OTMwLWMyZTMtNDNhOS1hY2U0LTFlOTg4YjJjMTkwOCIKdmVyc2lvbiA9ICIxLjIuMCIKCltbZGVwcy5Qa2ddXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiRGF0ZXMiLCAiRG93bmxvYWRzIiwgIkZpbGVXYXRjaGluZyIsICJMaWJHaXQyIiwgIkxpYmRsIiwgIkxvZ2dpbmciLCAiTWFya2Rvd24iLCAiUHJpbnRmIiwgIlJFUEwiLCAiUmFuZG9tIiwgIlNIQSIsICJTZXJpYWxpemF0aW9uIiwgIlRPTUwiLCAiVGFyIiwgIlVVSURzIiwgInA3emlwX2psbCJdCnV1aWQgPSAiNDRjZmU5NWEtMWViMi01MmVhLWI2NzItZTJhZmRmNjliNzhmIgp2ZXJzaW9uID0gIjEuMTAuMCIKCltbZGVwcy5QbHV0b0Rldk1hY3Jvc11dCmRlcHMgPSBbIkh5cGVydGV4dExpdGVyYWwiLCAiSW50ZXJhY3RpdmVVdGlscyIsICJNYWNyb1Rvb2xzIiwgIk1hcmtkb3duIiwgIlBrZyIsICJSYW5kb20iLCAiVE9NTCJdCmdpdC10cmVlLXNoYTEgPSAiNmNlMWQ5ZjdjMDc4YjQ5MzgxMjE2MTM0OWM0ODczNWRlZTI3NTQ2NiIKdXVpZCA9ICJhMDQ5OWYyOS1jMzliLTRjNWMtODA3Yy04ODA3NDIyMWI5NDkiCnZlcnNpb24gPSAiMC41LjgiCgpbW2RlcHMuUHJpbnRmXV0KZGVwcyA9IFsiVW5pY29kZSJdCnV1aWQgPSAiZGUwODU4ZGEtNjMwMy01ZTY3LTg3NDQtNTFlZGRlZWViOGQ3IgoKW1tkZXBzLlJFUExdXQpkZXBzID0gWyJJbnRlcmFjdGl2ZVV0aWxzIiwgIk1hcmtkb3duIiwgIlNvY2tldHMiLCAiVW5pY29kZSJdCnV1aWQgPSAiM2ZhMGNkOTYtZWVmMS01Njc2LThhNjEtYjNiODc1OGJiZmZiIgoKW1tkZXBzLlJhbmRvbV1dCmRlcHMgPSBbIlNIQSJdCnV1aWQgPSAiOWEzZjgyODQtYTJjOS01ZjAyLTlhMTEtODQ1OTgwYTFmZDVjIgoKW1tkZXBzLlNIQV1dCnV1aWQgPSAiZWE4ZTkxOWMtMjQzYy01MWFmLTg4MjUtYWFhNjNjZDcyMWNlIgp2ZXJzaW9uID0gIjAuNy4wIgoKW1tkZXBzLlNlcmlhbGl6YXRpb25dXQp1dWlkID0gIjllODhiNDJhLWY4MjktNWIwYy1iYmU5LTllOTIzMTk4MTY2YiIKCltbZGVwcy5Tb2NrZXRzXV0KdXVpZCA9ICI2NDYyZmUwYi0yNGRlLTU2MzEtODY5Ny1kZDk0MWY5MGRlY2MiCgpbW2RlcHMuVE9NTF1dCmRlcHMgPSBbIkRhdGVzIl0KdXVpZCA9ICJmYTI2N2YxZi02MDQ5LTRmMTQtYWE1NC0zM2JhZmFlMWVkNzYiCnZlcnNpb24gPSAiMS4wLjMiCgpbW2RlcHMuVGFyXV0KZGVwcyA9IFsiQXJnVG9vbHMiLCAiU0hBIl0KdXVpZCA9ICJhNGU1NjlhNi1lODA0LTRmYTQtYjBmMy1lZWY3YTFkNWIxM2UiCnZlcnNpb24gPSAiMS4xMC4wIgoKW1tkZXBzLlRyaWNrc11dCmdpdC10cmVlLXNoYTEgPSAiYWFkYjc0OGJlNThiNDkyMDQ1YjRmNTYxNjZiNTE4OGFhNjNjZTU0OSIKdXVpZCA9ICI0MTBhNGI0ZC00OWU0LTRmYmMtYWI2ZC1jYjcxYjE3YjM3NzUiCnZlcnNpb24gPSAiMC4xLjciCgpbW2RlcHMuVVVJRHNdXQpkZXBzID0gWyJSYW5kb20iLCAiU0hBIl0KdXVpZCA9ICJjZjcxMThhNy02OTc2LTViMWEtOWEzOS03YWRjNzJmNTkxYTQiCgpbW2RlcHMuVW5pY29kZV1dCnV1aWQgPSAiNGVjMGE4M2UtNDkzZS01MGUyLWI5YWMtOGY3MmFjZjVhOGY1IgoKW1tkZXBzLlpsaWJfamxsXV0KZGVwcyA9IFsiTGliZGwiXQp1dWlkID0gIjgzNzc1YTU4LTFmMWQtNTEzZi1iMTk3LWQ3MTM1NGFiMDA3YSIKdmVyc2lvbiA9ICIxLjIuMTMrMSIKCltbZGVwcy5uZ2h0dHAyX2psbF1dCmRlcHMgPSBbIkFydGlmYWN0cyIsICJMaWJkbCJdCnV1aWQgPSAiOGU4NTBlZGUtNzY4OC01MzM5LWEwN2MtMzAyYWNkMmFhZjhkIgp2ZXJzaW9uID0gIjEuNTIuMCsxIgoKW1tkZXBzLnA3emlwX2psbF1dCmRlcHMgPSBbIkFydGlmYWN0cyIsICJMaWJkbCJdCnV1aWQgPSAiM2YxOWU5MzMtMzNkOC01M2IzLWFhYWItYmQ1MTEwYzNiN2EwIgp2ZXJzaW9uID0gIjE3LjQuMCsyIgoiIiIKCiMg4pWU4pWQ4pWhIENlbGwgb3JkZXI6CiMg4pWf4pSAOWQ0NDU1YWYtOTZmMS00NmQ3LWE0ZjMtNDM0NDk1YjExYzhhCiMg4pWg4pWQOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhmCiMg4pWg4pWQOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzCiMg4pWg4pWQNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzCiMg4pWf4pSANDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwCiMg4pWf4pSAYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwCiMg4pWg4pWQOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmCiMg4pWg4pWQY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2CiMg4pWg4pWQNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1CiMg4pWf4pSAOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwCiMg4pWg4pWQMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5CiMg4pWg4pWQZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4CiMg4pWf4pSAOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3CiMg4pWf4pSAOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3CiMg4pWg4pWQNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjCiMg4pWg4pWQYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0CiMg4pWg4pWQNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZiCiMg4pWf4pSAMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjCiMg4pWf4pSANzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyCiMg4pWg4pWQNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyCiMg4pWg4pWQNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0CiMg4pWf4pSAMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk3CiMg4pWg4pWQODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1CiMg4pWf4pSAM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1CiMg4pWf4pSAMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0CiMg4pWg4pWQOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2CiMg4pWf4pSAMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxCiMg4pWf4pSAMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyCg==";
window.pluto_disable_ui = true;
window.pluto_slider_server_url = undefined;
window.pluto_binder_url = "https://mybinder.org/v2/gh/fonsp/pluto-on-binder/v0.19.27";
window.pluto_statefile = "data:;base64,3gARpWJvbmRzhKNhbHSBpXZhbHVlzJaibnSBpXZhbHVlkZORAZEBkQGjYXNkgaV2YWx1ZZGVkQGRBpGgkaCRAaRmcmVxgaV2YWx1ZRSsY2VsbF9yZXN1bHRz3gAa2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52iLTPGJvbmRzbGlzdC1jb250YWluZXIgY2xhc3M9J25vLXBvcG91dCc+Cgk8Ym9uZHNsaXN0LWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nY29sbGFwc2UgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nIHRpdGxlPSJUaGlzIGxpc3QgY29udGFpbnMgaW5kZXBlbmRlbnQgYm9uZHMiPk15IEdyb3VwIG9mIEJvbmRzPC9zcGFuPgoJCTxzcGFuIGNsYXNzPSd0b2dnbGUgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCTwvYm9uZHNsaXN0LWhlYWRlcj4KCTxib25kc2xpc3QtY29udGVudHM+Cgk8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgZnJlcWAnPgoJCUZyZXF1ZW5jeSBbR0h6XQoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPGJvbmQgZGVmPSJmcmVxIiB1bmlxdWVfaWQ9IkxCNWdFNFVWY0lNaSI+CjxzY3JpcHQ+Cgljb25zdCBkM2Zvcm1hdCA9IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCgljb25zdCBlbHAgPSBodG1sYAoJPHNwYW4gY2xhc3M9Im51bWJlcl9FZGl0YWJsZSIgc3R5bGU9IgoJdG91Y2gtYWN0aW9uOiBub25lOwoJcGFkZGluZzogMGVtIC4yZW07Cglib3JkZXItcmFkaXVzOiAuM2VtOwoJZm9udC13ZWlnaHQ6IGJvbGQ7Ij48c3BhbiBjb250ZW50RWRpdGFibGU9dHJ1ZT4yMDwvc3Bhbj4gR0h6PC9zcGFuPgoJYAoKCWNvbnN0IGZvcm1hdHRlciA9IHMgPT4gZDNmb3JtYXQuZm9ybWF0KCIiKShzKQoJY29uc3QgZWwgPSBlbHAucXVlcnlTZWxlY3Rvcigic3BhbiIpCgoJbGV0IGxvY2FsVmFsID0gcGFyc2VGbG9hdCgyMCkKCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcigyMCkKCQoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGVscCwidmFsdWUiLHsKCQlnZXQ6ICgpID0+IGxvY2FsVmFsLAoJCXNldDogeCA9PiB7CgkJCWxvY2FsVmFsID0gcGFyc2VGbG9hdCh4KQoJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoeCkKCQl9Cgl9KQoKCWNvbnN0IGRpc3BhdGNoRXZlbnQgPSAoZSkgPT4gewoJCWlmIChlbC5pbm5lclRleHQgPT09ICIiKSB7CgkJCWVscC52YWx1ZSA9IDIwICAgCgkJfSBlbHNlIHsKCQkJLyogCgkJCVRoZSByZXBsYWNlIGlzIG5lZWRlZCBiZWNhdXNlIGQzLWZvcm1hdCBvdXRwdXRzICctJyBhcyBpbiBVKzIyMTIgKG1hdGggc3ltYm9sKSBidXQgZmFpbHMgdG8gcGFyc2UgbmVnYXRpdmUgbnVtYmVyIGNvcnJlY3RseSBpZiB0aGV5IGhhdmUgdGhhdCBzaWduIGFzIG5lZ2F0aXZlIHNpZ24uIFNvIHdlIGp1c3QgcmVwbGFjZSBpdCB3aXRoIHRoZSBkYXNoIFUrMDAyRCBzaWduIAoJCQkqLwoJCQllbHAudmFsdWUgPSAgZWwuaW5uZXJUZXh0LnJlcGxhY2UoJ+KIkicsICctJykKCQl9CgkJZWxwLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQoKCS8vIEZ1bmN0aW9uIHRvIGJsdXIgdGhlIGVsZW1lbnQgd2hlbiBwcmVzc2luZyBlbnRlciBpbnN0ZWFkIG9mIGFkZGluZyBhIG5ld2xpbmUKCWNvbnN0IG9uRW50ZXIgPSAoZSkgPT4gewoJCWlmIChlLmtleUNvZGUgPT09IDEzKSB7CgkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCWVsLmJsdXIoKQoJCX0KCX0KCgllbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsKGUpID0+IHsKCQljb25zb2xlLmxvZyhlKQoJCWUucHJldmVudERlZmF1bHQoKQoJCWUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkKCX0pCgoJZnVuY3Rpb24gc2VsZWN0VGV4dChlbCl7CgkJdmFyIHNlbCwgcmFuZ2U7CgkJaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24gJiYgZG9jdW1lbnQuY3JlYXRlUmFuZ2UpIHsgLy9Ccm93c2VyIGNvbXBhdGliaWxpdHkKCQlzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7CgkJaWYoc2VsLnRvU3RyaW5nKCkgPT0gJycpeyAvL25vIHRleHQgc2VsZWN0aW9uCgkJCXdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CgkJCQlyYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7IC8vcmFuZ2Ugb2JqZWN0CgkJCQlyYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZWwpOyAvL3NldHMgUmFuZ2UKCQkJCXNlbC5yZW1vdmVBbGxSYW5nZXMoKTsgLy9yZW1vdmUgYWxsIHJhbmdlcyBmcm9tIHNlbGVjdGlvbgoJCQkJc2VsLmFkZFJhbmdlKHJhbmdlKTsvL2FkZCBSYW5nZSB0byBhIFNlbGVjdGlvbi4KCQkJfSwxKTsKCQl9CgkJfWVsc2UgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikgeyAvL29sZGVyIGllCgkJCXNlbCA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpOwoJCQlpZihzZWwudGV4dCA9PSAnJyl7IC8vbm8gdGV4dCBzZWxlY3Rpb24KCQkJCXJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTsvL0NyZWF0ZXMgVGV4dFJhbmdlIG9iamVjdAoJCQkJcmFuZ2UubW92ZVRvRWxlbWVudFRleHQoZWwpOy8vc2V0cyBSYW5nZQoJCQkJcmFuZ2Uuc2VsZWN0KCk7IC8vbWFrZSBzZWxlY3Rpb24uCgkJCX0KCQl9Cgl9CgoJCgllbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsZGlzcGF0Y2hFdmVudCkKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLG9uRW50ZXIpCgllbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkpIC8vIG1vZGlmeSB0ZXh0CgllbHAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiBzZWxlY3RUZXh0KGVsKSkgLy8gU2VsZWN0IGFsbCB0ZXh0CgoJcmV0dXJuIGVscAoKPC9zY3JpcHQ+CjxzdHlsZT4KCUBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGxpZ2h0KSB7CgkJc3Bhbi5udW1iZXJfRWRpdGFibGUgewoJCQliYWNrZ3JvdW5kOiBoc2woMjA0LCA5NSUsIDg0JSk7CgkJfQoJfQoJQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykgewoJCXNwYW4ubnVtYmVyX0VkaXRhYmxlIHsKCQkJYmFja2dyb3VuZDogaHNsKDIwNCwgOTUlLCA0MCUpOwoJCX0KCX0KPC9zdHlsZT4KPC9ib25kPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+Cjxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBhbHRgJz4KCQk8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+QWx0aXR1ZGUgPHNwYW4gY2xhc3M9InRleCI+JGgkPC9zcGFuPiAmIzkxO20mIzkzOzwvcD4KPC9kaXY+Cgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8Ym9uZCBkZWY9ImFsdCIgdW5pcXVlX2lkPSJIYjR2bzBZbmtQSW8iPjxzY3JpcHQ+Ci8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCndpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgpjb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKY29uc3QgdmFsdWVzID0gWzEwMCwgMTEwLCAxMjAsIDEzMCwgMTQwLCAxNTAsIDE2MCwgMTcwLCAxODAsIDE5MCwgMjAwXQoKY29uc3QgZWwgPSBodG1sYAo8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CnRvdWNoLWFjdGlvbjogbm9uZTsKYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwpjb2xvcjogYmxhY2s7CnBhZGRpbmc6IDBlbSAuMmVtOwpib3JkZXItcmFkaXVzOiAuM2VtOwpmb250LXdlaWdodDogYm9sZDsiPjE1MDwvc3Bhbj4KYAoKCgpsZXQgb2xkX3ggPSAwCmxldCBvbGRfaW5kZXggPSAwCmNvbnN0IGluaXRpYWxfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgMTUwKQpsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCmNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJc2V0OiB4ID0+IHsKCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7CgovLyBpbml0aWFsIHZhbHVlCmVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcigxNTApCgpjb25zdCBvblNjcnViID0gKGUpID0+IHsKCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94Cgljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJKSkKCglpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQp9Cgpjb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCglvbGRfeCA9IGUuY2xpZW50WAoJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQplbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgpjb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKfQplbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgpjb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCn0pCgpyZXR1cm4gZWwKCjwvc2NyaXB0PjwvYm9uZD4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgoJCgk8L2JvbmRzbGlzdC1jb250ZW50cz4KCTxzY3JpcHQgaWQ9J2ltdnVkZ2Fsbm8nPgoJCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnRhaW5lci5jb2xsYXBzZSA9IChmb3JjZSkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJywgZm9yY2UpCgkJfQoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuLmNvbGxhcHNlJykKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBjb250YWluZXIuY29sbGFwc2UoKQoJPC9zY3JpcHQ+Cgk8c3R5bGU+Cglib25kc2xpc3QtaGVhZGVyIHsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGRpc3BsYXk6IGZsZXg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwp9CmJvbmRzbGlzdC1oZWFkZXI6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMHB4OwogIGJvdHRvbTogMHB4OwogIGxlZnQ6IDBweDsKICByaWdodDogMHB4OwogIHotaW5kZXg6IC0xOwogIGJhY2tncm91bmQ6ICNmZmFjNDU0MDsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dCA+IGJvbmRzbGlzdC1oZWFkZXIgewogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgcGFkZGluZy10b3A6IDEycHg7CiAgbWFyZ2luLXRvcDogLTEycHg7CiAgei1pbmRleDogMTA7Cn0KYm9uZHNsaXN0LWNvbnRlbnRzIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dDpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGJsb2NrOwogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAganVzdGlmeS1zZWxmOiBjZW50ZXI7CiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkOwogIHBhZGRpbmctdG9wOiA1cHg7CiAgd2lkdGg6IDEwMCU7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgei1pbmRleDogMjA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5ib25kc2xpc3QtaWNvbiB7CiAgLS1zaXplOiAxN3B4OwogIGRpc3BsYXk6IGJsb2NrOwogIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgPiBib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAzMHB4OwogIG1hcmdpbjogMCAxMHB4Owp9CmJvbmRzbGlzdC1oZWFkZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgd2lkdGg6IDEwMCU7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIGZsZXgtZ3JvdzogMTsKICBmb250LXNpemU6IDE4cHg7CiAgZm9udC13ZWlnaHQ6IDYwMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgYWxpZ24tc2VsZjogY2VudGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkIGJvbmRzbGlzdC1oZWFkZXIgKyAqIHsKICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHJvdy1nYXA6IDVweDsKfQpib25kc3RhYmxlLWNvbnRhaW5lciBib25kc2xpc3QtY29udGFpbmVyIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQoJCQoJPC9zdHlsZT4KPC9ib25kc2xpc3QtY29udGFpbmVyPgqkbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlomJssmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQoQ0PjLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOCwm9/bVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAew8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+U29tZXRpbWVzIGN1c3RvbSBzdHJ1Y3RzIGFyZSBub3QgbmVlZGVkIGFuZCBpdCB3b3VsZCBiZSB1c2VmdWwgdG8ganVzdCB1c2UgdGhlIHNhbWUgbmljZSBib25kIHN0cnVjdHVyZSBvZiA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiB0byBzaW1wbHkgY3JlYXRlIGFyYml0cmFyeSBOYW1lZFR1cGxlcy4gPC9wPgo8cD5UaGlzIGlzIHBvc3NpYmxlIHdpdGggdGhlIGNvbnZlbmllbmNlIG1hY3JvIDxjb2RlPkBOVEJvbmQ8L2NvZGU+IHdoaWNoIGNhbiBiZSBjYWxsZWQgYXMgc2hvd24gYmVsb3cgdG8gY3JlYXRlIGEgbmljZSBkaXNwbGF5IGZvciBhbiBpbnRlcmFjdGl2ZSBib25kIGNyZWF0aW5nIGFuIGFyYml0cmFyeSBOYW1lZFR1cGxlLjwvcD4KPHA+VGhlIG1hY3JvIHNpbXBseSBjcmVhdGUgYSA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiB3cmFwcGluZyB0aGUgZGVzaXJlZCBOYW1lZFR1cGxlIHR5cGUuPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJk3h6WwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAFYTu1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52Sw8ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgxPlBvcG91dDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTulL7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAOQAbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAmg8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhlIGZpbmFsIGNvbnZlbmllbmNlIHN0cnVjdHVyZSBwcm92aWRlZCBieSB0aGlzIG1vZHVsZSBpcyB0aGUgPGNvZGU+Qm9uZFRhYmxlPC9jb2RlPi4gSXQgY2FuIGJlIGNyZWF0ZWQgdG8gZ3JvdXAgYSBsaXN0IG9mIGJvbmRzIGluIGEgZmxvYXRpbmcgdGFibGUgdGhhdCBzdGF5cyBvbiB0aGUgbGVmdCBzaWRlIG9mIHRoZSBub3RlYm9vayAmIzQwO3NpbWlsYXIgdG8gdGhlIFRhYmxlT2ZDb250ZW50cyBvZiBQbHV0b1VJJiM0MTsgYW5kIGNhbiBiZSBtb3ZlZCBhcm91bmQgYW5kIHJlc2l6ZWQgb3IgaGlkZGVuIGZvciBjb252ZW5pZW5jZS48L3A+CjxwPlRoZSBCb25kVGFibGUgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBlaXRoZXIgd2l0aCBib25kcyBjb250YWluaW5nIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IG9yIHdpdGggPGNvZGU+Qm9uZHNMaXN0PC9jb2RlPi4gRnV0dXJlIHR5cGVzIHdpdGggc2ltaWxhciBzdHJ1Y3R1cmUgd2lsbCBhbHNvIGJlIGFkZGVkLjwvcD4KPHA+SGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgYm9uZHRhYmxlIGNvbnRhaW5pbmcgYWxsIHRoZSBleGFtcGxlcyBvZiB0aGlzIG5vdGVib29rLjwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCZPC31sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTS5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABh2ntXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYWmcHJlZml4o0FTRKhlbGVtZW50c5WSoWGSoTGqdGV4dC9wbGFpbpKhYpKhNqp0ZXh0L3BsYWlukqFjkqIiIqp0ZXh0L3BsYWlukqFkkqIiIqp0ZXh0L3BsYWlukqFlkqIyMKp0ZXh0L3BsYWlupHR5cGWmc3RydWN0rHByZWZpeF9zaG9ydKNBU0Sob2JqZWN0aWSwYWQ1MTFjOGM4ZWY3MTIyN6RtaW1l2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3Sscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EKIFNIewcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lLrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnbAAHg5jxib25kdGFibGUtY29udGFpbmVyIGtleT0nZWVoYW9md3JpbCc+Cgk8Ym9uZHRhYmxlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0ndGFibGUtaGVscCBpY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5NeSBCb25kczwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0ndGFibGUtY29sbGFwc2UgaWNvbic+PC9zcGFuPgoJPC9ib25kdGFibGUtaGVhZGVyPgoJPGJvbmR0YWJsZS1jb250ZW50cz4KCQk8Ym9uZCBkZWY9ImFzZCIgdW5pcXVlX2lkPSJKcTk4cDZMc2VyUTAiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na29zaGl2dGNhcicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5NYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIDxzcGFuIGNsYXNzPSJ0ZXgiPiRMYVRlWCQ8L3NwYW4+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naHJ2cXVhZXZrZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdocnZxdWFldmtmJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaHJ2cXVhZXZrZiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3FzenN5d3l3Y3EnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzY3JpcHQ+Ci8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCndpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgpjb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKY29uc3QgdmFsdWVzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXQoKY29uc3QgZWwgPSBodG1sYAo8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CnRvdWNoLWFjdGlvbjogbm9uZTsKYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwpjb2xvcjogYmxhY2s7CnBhZGRpbmc6IDBlbSAuMmVtOwpib3JkZXItcmFkaXVzOiAuM2VtOwpmb250LXdlaWdodDogYm9sZDsiPjY8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCmxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCglzZXQ6IHggPT4gewoJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgl9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCi8vIGluaXRpYWwgdmFsdWUKZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgpjb25zdCBvblNjcnViID0gKGUpID0+IHsKCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94Cgljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJKSkKCglpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQp9Cgpjb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCglvbGRfeCA9IGUuY2xpZW50WAoJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQplbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgpjb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKfQplbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgpjb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCn0pCgpyZXR1cm4gZWwKCjwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3FzenN5d3l3Y3EnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJxc3pzeXd5d2NxIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd3d3NxcHlzYm9nJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nd3dzcXB5c2JvZyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInd3c3FweXNib2ciCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2VvZ2x1cGNwc3gnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbHFwaWJobHhwbCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2xxcGliaGx4cGwnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJscXBpYmhseHBsIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdvaWNjdWRseWduJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nb2ljY3VkbHlnbic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm9pY2N1ZGx5Z24iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdlb2dsdXBjcHN4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZW9nbHVwY3BzeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYEFTRGAiKQoKCQkvLyBhZGQgdGhlIGNvbGxhcHNlIGJ1dHRvbgoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGh0bWxgPHNwYW4gY2xhc3M9J2NvbGxhcHNlJz5gCgkJaGVhZGVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGNvbGxhcHNlX2J0bikKCgkJdHJjLmNvbGxhcHNlID0gKCkgPT4gewogIAkJCXRyYy5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQoJCX0KCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gdHJjLmNvbGxhcHNlKCkKCQkKCTwvc2NyaXB0PgoJCTxzdHlsZT4KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogY29udGVudHM7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCQkJZmxleDogMTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZ3JpZC1jb2x1bW46IDEgLyAtMTsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCS0tc2l6ZTogMTdweDsKCQkJICAgIGRpc3BsYXk6IGJsb2NrOwoJCQkgICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKCQkJICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkJCSAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwoJCQkgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwoJCQkgICAgd2lkdGg6IHZhcigtLXNpemUpOwoJCQkgICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgPiB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCQlhbGlnbi1pdGVtczogc3RyZXRjaDsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQlmbGV4LWdyb3c6IDE7CgkJCQlmb250LXNpemU6IDE4cHg7CgkJCQlmb250LXdlaWdodDogNjAwOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewoJCQkJYWxpZ24tc2VsZjogY2VudGVyCgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgKyAqIHsKCQkJCWRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0na29zaGl2dGNhcic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImtvc2hpdnRjYXIiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J256d2llbmlwb2QnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdxeW9uY3Frc3FpJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5pbm5lckhUTUwgPSAiQ3VzdG9tIERlc2NyaXB0aW9uIgoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+PGJvbmQgZGVmPSJudCIgdW5pcXVlX2lkPSJXMFN2OWRRdDZYaGQiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTmFtZWRUdXBsZXsoU3ltYm9sKCZxdW90OyMjMjMyJnF1b3Q7KSwgOmEsIDpiLCA6Yyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TmFtZWRUdXBsZTwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J211Z2J0Z2txZnMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2EnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2EnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGFgIj5EZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdzYWp4bW1jenVwJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NhanhtbWN6dXAnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJzYWp4bW1jenVwIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPjxzdHJvbmc+Qm9sZDwvc3Ryb25nPiBmaWVsZDwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3p2aGlveHlvYWknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nenZoaW94eW9haSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInp2aGlveHlvYWkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5jPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2JzaXp1bHR1cmMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nYnNpenVsdHVyYyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJzaXp1bHR1cmMiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdidWVub2VkYmJ4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiYnVlbm9lZGJieCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYE5hbWVkVHVwbGVgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J211Z2J0Z2txZnMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJtdWdidGdrcWZzIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdqd2dlb3Rkdm1zJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0ncmJ4d3hscmJ1Zyc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIk15IEZhbmN5IE5UdXBsZSIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjxib25kc2xpc3QtY29udGFpbmVyIGNsYXNzPSduby1wb3BvdXQnPgoJPGJvbmRzbGlzdC1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2NvbGxhcHNlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJyB0aXRsZT0iVGhpcyBsaXN0IGNvbnRhaW5zIGluZGVwZW5kZW50IGJvbmRzIj5NeSBHcm91cCBvZiBCb25kczwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0ndG9nZ2xlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+Cgk8L2JvbmRzbGlzdC1oZWFkZXI+Cgk8Ym9uZHNsaXN0LWNvbnRlbnRzPgoJPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYGZyZXFgJz4KCQlGcmVxdWVuY3kgW0dIel0KCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxib25kIGRlZj0iZnJlcSIgdW5pcXVlX2lkPSJMQjVnRTRVVmNJTWkiPgo8c2NyaXB0PgoJY29uc3QgZDNmb3JtYXQgPSBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgoJY29uc3QgZWxwID0gaHRtbGAKCTxzcGFuIGNsYXNzPSJudW1iZXJfRWRpdGFibGUiIHN0eWxlPSIKCXRvdWNoLWFjdGlvbjogbm9uZTsKCXBhZGRpbmc6IDBlbSAuMmVtOwoJYm9yZGVyLXJhZGl1czogLjNlbTsKCWZvbnQtd2VpZ2h0OiBib2xkOyI+PHNwYW4gY29udGVudEVkaXRhYmxlPXRydWU+MjA8L3NwYW4+IEdIejwvc3Bhbj4KCWAKCgljb25zdCBmb3JtYXR0ZXIgPSBzID0+IGQzZm9ybWF0LmZvcm1hdCgiIikocykKCWNvbnN0IGVsID0gZWxwLnF1ZXJ5U2VsZWN0b3IoInNwYW4iKQoKCWxldCBsb2NhbFZhbCA9IHBhcnNlRmxvYXQoMjApCgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoMjApCgkKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbHAsInZhbHVlIix7CgkJZ2V0OiAoKSA9PiBsb2NhbFZhbCwKCQlzZXQ6IHggPT4gewoJCQlsb2NhbFZhbCA9IHBhcnNlRmxvYXQoeCkKCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKHgpCgkJfQoJfSkKCgljb25zdCBkaXNwYXRjaEV2ZW50ID0gKGUpID0+IHsKCQlpZiAoZWwuaW5uZXJUZXh0ID09PSAiIikgewoJCQllbHAudmFsdWUgPSAyMCAgIAoJCX0gZWxzZSB7CgkJCS8qIAoJCQlUaGUgcmVwbGFjZSBpcyBuZWVkZWQgYmVjYXVzZSBkMy1mb3JtYXQgb3V0cHV0cyAnLScgYXMgaW4gVSsyMjEyIChtYXRoIHN5bWJvbCkgYnV0IGZhaWxzIHRvIHBhcnNlIG5lZ2F0aXZlIG51bWJlciBjb3JyZWN0bHkgaWYgdGhleSBoYXZlIHRoYXQgc2lnbiBhcyBuZWdhdGl2ZSBzaWduLiBTbyB3ZSBqdXN0IHJlcGxhY2UgaXQgd2l0aCB0aGUgZGFzaCBVKzAwMkQgc2lnbiAKCQkJKi8KCQkJZWxwLnZhbHVlID0gIGVsLmlubmVyVGV4dC5yZXBsYWNlKCfiiJInLCAnLScpCgkJfQoJCWVscC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KCgkvLyBGdW5jdGlvbiB0byBibHVyIHRoZSBlbGVtZW50IHdoZW4gcHJlc3NpbmcgZW50ZXIgaW5zdGVhZCBvZiBhZGRpbmcgYSBuZXdsaW5lCgljb25zdCBvbkVudGVyID0gKGUpID0+IHsKCQlpZiAoZS5rZXlDb2RlID09PSAxMykgewoJCWUucHJldmVudERlZmF1bHQoKTsKCQllbC5ibHVyKCkKCQl9Cgl9CgoJZWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLChlKSA9PiB7CgkJY29uc29sZS5sb2coZSkKCQllLnByZXZlbnREZWZhdWx0KCkKCQllLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpCgl9KQoKCWZ1bmN0aW9uIHNlbGVjdFRleHQoZWwpewoJCXZhciBzZWwsIHJhbmdlOwoJCWlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uICYmIGRvY3VtZW50LmNyZWF0ZVJhbmdlKSB7IC8vQnJvd3NlciBjb21wYXRpYmlsaXR5CgkJc2VsID0gd2luZG93LmdldFNlbGVjdGlvbigpOwoJCWlmKHNlbC50b1N0cmluZygpID09ICcnKXsgLy9ubyB0ZXh0IHNlbGVjdGlvbgoJCQl3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpewoJCQkJcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOyAvL3JhbmdlIG9iamVjdAoJCQkJcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGVsKTsgLy9zZXRzIFJhbmdlCgkJCQlzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7IC8vcmVtb3ZlIGFsbCByYW5nZXMgZnJvbSBzZWxlY3Rpb24KCQkJCXNlbC5hZGRSYW5nZShyYW5nZSk7Ly9hZGQgUmFuZ2UgdG8gYSBTZWxlY3Rpb24uCgkJCX0sMSk7CgkJfQoJCX1lbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHsgLy9vbGRlciBpZQoJCQlzZWwgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTsKCQkJaWYoc2VsLnRleHQgPT0gJycpeyAvL25vIHRleHQgc2VsZWN0aW9uCgkJCQlyYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7Ly9DcmVhdGVzIFRleHRSYW5nZSBvYmplY3QKCQkJCXJhbmdlLm1vdmVUb0VsZW1lbnRUZXh0KGVsKTsvL3NldHMgUmFuZ2UKCQkJCXJhbmdlLnNlbGVjdCgpOyAvL21ha2Ugc2VsZWN0aW9uLgoJCQl9CgkJfQoJfQoKCQoJZWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLGRpc3BhdGNoRXZlbnQpCgllbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJyxvbkVudGVyKQoJZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpKSAvLyBtb2RpZnkgdGV4dAoJZWxwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSkgPT4gc2VsZWN0VGV4dChlbCkpIC8vIFNlbGVjdCBhbGwgdGV4dAoKCXJldHVybiBlbHAKCjwvc2NyaXB0Pgo8c3R5bGU+CglAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBsaWdodCkgewoJCXNwYW4ubnVtYmVyX0VkaXRhYmxlIHsKCQkJYmFja2dyb3VuZDogaHNsKDIwNCwgOTUlLCA4NCUpOwoJCX0KCX0KCUBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHsKCQlzcGFuLm51bWJlcl9FZGl0YWJsZSB7CgkJCWJhY2tncm91bmQ6IGhzbCgyMDQsIDk1JSwgNDAlKTsKCQl9Cgl9Cjwvc3R5bGU+CjwvYm9uZD4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgo8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgYWx0YCc+CgkJPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPkFsdGl0dWRlIDxzcGFuIGNsYXNzPSJ0ZXgiPiRoJDwvc3Bhbj4gJiM5MTttJiM5Mzs8L3A+CjwvZGl2PgoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPGJvbmQgZGVmPSJhbHQiIHVuaXF1ZV9pZD0iSGI0dm8wWW5rUElvIj48c2NyaXB0PgovLyB3ZWlyZCBpbXBvcnQgdG8gbWFrZSBpdCBmYXN0ZXIuIFRoZSBgYXdhaXQgaW1wb3J0YCBjYW4gc3RpbGwgZGVsYXkgZXhlY3V0aW9uIGJ5IG9uZSBmcmFtZSBpZiBpdCBpcyBhbHJlYWR5IGxvYWRlZC4uLgp3aW5kb3cuZDNmb3JtYXQgPSB3aW5kb3cuZDNmb3JtYXQgPz8gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKY29uc3QgYXJnbWluID0geHMgPT4geHMuaW5kZXhPZihNYXRoLm1pbiguLi54cykpCmNvbnN0IGNsb3Nlc3RfaW5kZXggPSAoeHMsIHkpID0+IGFyZ21pbih4cy5tYXAoeCA9PiBNYXRoLmFicyh4LXkpKSkKCmNvbnN0IHZhbHVlcyA9IFsxMDAsIDExMCwgMTIwLCAxMzAsIDE0MCwgMTUwLCAxNjAsIDE3MCwgMTgwLCAxOTAsIDIwMF0KCmNvbnN0IGVsID0gaHRtbGAKPHNwYW4gdGl0bGU9IkNsaWNrIGFuZCBkcmFnIHRoaXMgbnVtYmVyIGxlZnQgb3IgcmlnaHQhIiBzdHlsZT0iY3Vyc29yOiBjb2wtcmVzaXplOwp0b3VjaC1hY3Rpb246IG5vbmU7CmJhY2tncm91bmQ6IHJnYigyNTIsIDIwOSwgMjA0KTsKY29sb3I6IGJsYWNrOwpwYWRkaW5nOiAwZW0gLjJlbTsKYm9yZGVyLXJhZGl1czogLjNlbTsKZm9udC13ZWlnaHQ6IGJvbGQ7Ij4xNTA8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDE1MCkKbGV0IGN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4Cgpjb25zdCBmb3JtYXR0ZXIgPSBzID0+ICIiICsgZDNmb3JtYXQuZm9ybWF0KCIiKShzKSArICIiCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlc1tjdXJyZW50X2luZGV4XSwKCXNldDogeCA9PiB7CgkJY3VycmVudF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCB4KQoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCX0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKLy8gaW5pdGlhbCB2YWx1ZQplbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoMTUwKQoKY29uc3Qgb25TY3J1YiA9IChlKSA9PiB7Cgljb25zdCBvZmZzZXQgPSBlLmNsaWVudFggLSBvbGRfeAoJY29uc3QgbmV3X2luZGV4ID0gTWF0aC5taW4odmFsdWVzLmxlbmd0aC0xLCBNYXRoLm1heCgwLCAKCQlNYXRoLnJvdW5kKG9mZnNldC8xMCkgKyBvbGRfaW5kZXgKCSkpCgoJaWYobmV3X2luZGV4ICE9PSBjdXJyZW50X2luZGV4KSB7CgkJY3VycmVudF9pbmRleCA9IG5ld19pbmRleAoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KfQoKY29uc3Qgb25wb2ludGVyZG93biA9IChlKSA9PiB7Cgl3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKQoJb2xkX3ggPSBlLmNsaWVudFgKCW9sZF9pbmRleCA9IGN1cnJlbnRfaW5kZXgKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoKY29uc3Qgb25kYmxjbGljayA9IChlKSA9PiB7CgljdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoKY29uc3Qgb25wb2ludGVydXAgPSAoKSA9PiB7Cgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCmVsLm9uc2VsZWN0c3RhcnQgPSAoKSA9PiBmYWxzZQoKaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQp9KQoKcmV0dXJuIGVsCgo8L3NjcmlwdD48L2JvbmQ+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCQoJPC9ib25kc2xpc3QtY29udGVudHM+Cgk8c2NyaXB0IGlkPSdpbXZ1ZGdhbG5vJz4KCQljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb250YWluZXIuY29sbGFwc2UgPSAoZm9yY2UpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcsIGZvcmNlKQoJCX0KCQljb25zdCBjb2xsYXBzZV9idG4gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3Bhbi5jb2xsYXBzZScpCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gY29udGFpbmVyLmNvbGxhcHNlKCkKCTwvc2NyaXB0PgoJPHN0eWxlPgoJYm9uZHNsaXN0LWhlYWRlciB7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBkaXNwbGF5OiBmbGV4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKfQpib25kc2xpc3QtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDBweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjZmZhYzQ1NDA7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQgPiBib25kc2xpc3QtaGVhZGVyIHsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIHBhZGRpbmctdG9wOiAxMnB4OwogIG1hcmdpbi10b3A6IC0xMnB4OwogIHotaW5kZXg6IDEwOwp9CmJvbmRzbGlzdC1jb250ZW50cyB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQ6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBibG9jazsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGp1c3RpZnktc2VsZjogY2VudGVyOwogIGJvcmRlci1ib3R0b206IDJweCBzb2xpZDsKICBwYWRkaW5nLXRvcDogNXB4OwogIHdpZHRoOiAxMDAlOwogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogIHotaW5kZXg6IDIwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuYm9uZHNsaXN0LWljb24gewogIC0tc2l6ZTogMTdweDsKICBkaXNwbGF5OiBibG9jazsKICBhbGlnbi1zZWxmOiBzdHJldGNoOwogIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgd2lkdGg6IHZhcigtLXNpemUpOwogIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgY3Vyc29yOiBwb2ludGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkID4gYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB3aWR0aDogMzBweDsKICBtYXJnaW46IDAgMTBweDsKfQpib25kc2xpc3QtaGVhZGVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogIHdpZHRoOiAxMDAlOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBmbGV4LWdyb3c6IDE7CiAgZm9udC1zaXplOiAxOHB4OwogIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGFsaWduLXNlbGY6IGNlbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCBib25kc2xpc3QtaGVhZGVyICsgKiB7CiAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CmJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICByb3ctZ2FwOiA1cHg7Cn0KYm9uZHN0YWJsZS1jb250YWluZXIgYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCQkKCTwvc3R5bGU+CjwvYm9uZHNsaXN0LWNvbnRhaW5lcj4KPGJvbmRzbGlzdC1jb250YWluZXIgY2xhc3M9J25vLXBvcG91dCc+Cgk8Ym9uZHNsaXN0LWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nY29sbGFwc2UgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nIHRpdGxlPSJUaGlzIGxpc3QgY29udGFpbnMgaW5kZXBlbmRlbnQgYm9uZHMiPlBvcG91dCBDb250YWluZXI8L3NwYW4+CgkJPHNwYW4gY2xhc3M9J3RvZ2dsZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJPC9ib25kc2xpc3QtaGVhZGVyPgoJPGJvbmRzbGlzdC1jb250ZW50cz4KCTxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBhc2RgJz4KCQlTdHJ1Y3R1cmUgQVNECgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cG9wb3V0LWNvbnRhaW5lciBrZXk9J3VuYnhtZWdnaGknPgoJPHBvcG91dC1oZWFkZXI+PHNwYW4gY2xhc3M9J3BvcG91dC1pY29uIHBvcG91dCc+PC9zcGFuPjwvcG9wb3V0LWhlYWRlcj4KCTxwb3BvdXQtY29udGVudHM+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nc2hkZndkdHdtcScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGJvbmQgZGVmPSJhc2QiIHVuaXF1ZV9pZD0iSnE5OHA2THNlclEwIj48c3RydWN0LWJvbmQgY2xhc3M9J01haW4udmFyJnF1b3Q7d29ya3NwYWNlIzQmcXVvdDsuQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na29zaGl2dGNhcicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5NYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIDxzcGFuIGNsYXNzPSJ0ZXgiPiRMYVRlWCQ8L3NwYW4+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naHJ2cXVhZXZrZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdocnZxdWFldmtmJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaHJ2cXVhZXZrZiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3FzenN5d3l3Y3EnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzY3JpcHQ+Ci8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCndpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgpjb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKY29uc3QgdmFsdWVzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXQoKY29uc3QgZWwgPSBodG1sYAo8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CnRvdWNoLWFjdGlvbjogbm9uZTsKYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwpjb2xvcjogYmxhY2s7CnBhZGRpbmc6IDBlbSAuMmVtOwpib3JkZXItcmFkaXVzOiAuM2VtOwpmb250LXdlaWdodDogYm9sZDsiPjY8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCmxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCglzZXQ6IHggPT4gewoJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgl9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCi8vIGluaXRpYWwgdmFsdWUKZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgpjb25zdCBvblNjcnViID0gKGUpID0+IHsKCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94Cgljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJKSkKCglpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQp9Cgpjb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCglvbGRfeCA9IGUuY2xpZW50WAoJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQplbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgpjb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKfQplbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgpjb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCn0pCgpyZXR1cm4gZWwKCjwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3FzenN5d3l3Y3EnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJxc3pzeXd5d2NxIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd3d3NxcHlzYm9nJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nd3dzcXB5c2JvZyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInd3c3FweXNib2ciCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2VvZ2x1cGNwc3gnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbHFwaWJobHhwbCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2xxcGliaGx4cGwnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJscXBpYmhseHBsIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdvaWNjdWRseWduJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nb2ljY3VkbHlnbic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm9pY2N1ZGx5Z24iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdlb2dsdXBjcHN4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZW9nbHVwY3BzeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYEFTRGAiKQoKCQkvLyBhZGQgdGhlIGNvbGxhcHNlIGJ1dHRvbgoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGh0bWxgPHNwYW4gY2xhc3M9J2NvbGxhcHNlJz5gCgkJaGVhZGVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGNvbGxhcHNlX2J0bikKCgkJdHJjLmNvbGxhcHNlID0gKCkgPT4gewogIAkJCXRyYy5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQoJCX0KCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gdHJjLmNvbGxhcHNlKCkKCQkKCTwvc2NyaXB0PgoJCTxzdHlsZT4KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogY29udGVudHM7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCQkJZmxleDogMTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZ3JpZC1jb2x1bW46IDEgLyAtMTsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCS0tc2l6ZTogMTdweDsKCQkJICAgIGRpc3BsYXk6IGJsb2NrOwoJCQkgICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKCQkJICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkJCSAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwoJCQkgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwoJCQkgICAgd2lkdGg6IHZhcigtLXNpemUpOwoJCQkgICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgPiB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCQlhbGlnbi1pdGVtczogc3RyZXRjaDsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQlmbGV4LWdyb3c6IDE7CgkJCQlmb250LXNpemU6IDE4cHg7CgkJCQlmb250LXdlaWdodDogNjAwOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewoJCQkJYWxpZ24tc2VsZjogY2VudGVyCgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgKyAqIHsKCQkJCWRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0na29zaGl2dGNhcic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImtvc2hpdnRjYXIiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J256d2llbmlwb2QnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdxeW9uY3Frc3FpJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5pbm5lckhUTUwgPSAiQ3VzdG9tIERlc2NyaXB0aW9uIgoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSd1bmJ4bWVnZ2hpJz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbScpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkKCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewoJCWNvbXB1dGVQb3NpdGlvbihoZWFkZXIsIGNvbnRlbnRzLCB7CgkJCXN0cmF0ZWd5OiAiZml4ZWQiLAoJCQltaWRkbGV3YXJlOiBbYXV0b1BsYWNlbWVudCgpXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgljb250ZW50cy5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCBmYWxzZSkKCgloZWFkZXIub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgdHJ1ZSkKCQljb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3BwZWQnKSA/IG51bGwgOiBwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIGZhbHNlKQo8L3NjcmlwdD4KPHN0eWxlPgoJcG9wb3V0LWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYm9yZGVyOiAzcHggZGFzaGVkIHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwp9CnBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBub25lOwogICAgd2lkdGg6IDQwMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tb3ZlcmxheS1idXR0b24tYm9yZGVyKTsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBwYWRkaW5nOiA4cHg7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgPiBwb3BvdXQtY29udGVudHMsCnBvcG91dC1jb250YWluZXIuaGVhZGVyLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgei1pbmRleDogNTAwOwp9CnBvcG91dC1jb250YWluZXIuY29udGVudHMtaG92ZXIgPiBwb3BvdXQtaGVhZGVyIHsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcGx1dG8tbG9ncy13YXJuLWFjY2VudC1jb2xvcik7Cn0KLnBvcG91dC1pY29uIHsKICAgIC0tc2l6ZTogMjBweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgbWluLWhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9Ci5wb3BvdXQtaWNvbi5wb3BvdXQgewkKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V4cGFuZC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIC5wb3BvdXQgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY29udHJhY3Quc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogICAgdG91Y2gtYWN0aW9uOiBub25lOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KPC9zdHlsZT4KPHNjcmlwdCBpZD0nc2hkZndkdHdtcSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInNoZGZ3ZHR3bXEiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgo8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgbnRgJz4KCQlOYW1lZFR1cGxlCgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cG9wb3V0LWNvbnRhaW5lciBrZXk9J3BtY3NuYW5mZ24nPgoJPHBvcG91dC1oZWFkZXI+PHNwYW4gY2xhc3M9J3BvcG91dC1pY29uIHBvcG91dCc+PC9zcGFuPjwvcG9wb3V0LWhlYWRlcj4KCTxwb3BvdXQtY29udGVudHM+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZnh2eWVoc3Jraicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGJvbmQgZGVmPSJudCIgdW5pcXVlX2lkPSJXMFN2OWRRdDZYaGQiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTmFtZWRUdXBsZXsoU3ltYm9sKCZxdW90OyMjMjMyJnF1b3Q7KSwgOmEsIDpiLCA6Yyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TmFtZWRUdXBsZTwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J211Z2J0Z2txZnMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2EnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2EnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGFgIj5EZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdzYWp4bW1jenVwJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NhanhtbWN6dXAnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJzYWp4bW1jenVwIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPjxzdHJvbmc+Qm9sZDwvc3Ryb25nPiBmaWVsZDwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3p2aGlveHlvYWknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nenZoaW94eW9haSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInp2aGlveHlvYWkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J1ZW5vZWRiYngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5jPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2JzaXp1bHR1cmMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nYnNpenVsdHVyYyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJzaXp1bHR1cmMiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdidWVub2VkYmJ4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiYnVlbm9lZGJieCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYE5hbWVkVHVwbGVgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J211Z2J0Z2txZnMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJtdWdidGdrcWZzIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdqd2dlb3Rkdm1zJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0ncmJ4d3hscmJ1Zyc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIk15IEZhbmN5IE5UdXBsZSIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0ncG1jc25hbmZnbic+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb20nKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCgkvLyBXZSB1c2UgdGhlIGludGVyYWN0anMgbGlicmFyeSB0byBwcm92aWRlIGRyYWcgYW5kIHJlc2l6ZSBoYW5kbGluZyBhY3Jvc3MgZGV2aWNlcwoJY29uc3QgeyBkZWZhdWx0OiBpbnRlcmFjdCB9ID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9pbnRlcmFjdGpzJykKCgljb250ZW50cy5vZmZzZXQgPSBjb250ZW50cy5vZmZzZXQgPz8geyB4OiAwLCB5OiAwfQoJY29uc3Qgc3RhcnRQb3NpdGlvbiA9IHt4OiAwLCB5OiAwfQoJaW50ZXJhY3QoY29udGVudHMucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5kZXNjcmlwdGlvbiwgYm9uZHNsaXN0LWhlYWRlciAuZGVzY3JpcHRpb24nKSkuZHJhZ2dhYmxlKHsKCQlsaXN0ZW5lcnM6IHsKCQkJc3RhcnQgKGV2ZW50KSB7CgkJCQljb250ZW50cy5vZmZzZXQueSA9IHN0YXJ0UG9zaXRpb24ueSA9IGNvbnRlbnRzLm9mZnNldFRvcAoJCQkJY29udGVudHMub2Zmc2V0LnggPSBzdGFydFBvc2l0aW9uLnggPSBjb250ZW50cy5vZmZzZXRMZWZ0CgkJCX0sCgkJCW1vdmUgKGV2ZW50KSB7CgkJICAgICAgY29udGVudHMub2Zmc2V0LnggKz0gZXZlbnQuZHgKCQkgICAgICBjb250ZW50cy5vZmZzZXQueSArPSBldmVudC5keQoJCQoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLnRvcCA9IGBtaW4oOTV2aCwgJHtjb250ZW50cy5vZmZzZXQueX1weGAKCQkgICAgICBjb250ZW50cy5zdHlsZS5sZWZ0ID0gYG1pbig5NXZ3LCAke2NvbnRlbnRzLm9mZnNldC54fXB4YAoJCSAgICB9LAoJCX0KCX0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gaGVhZGVyIHJlc2V0IHRoZSBwb3NpdGlvbgoJCWNvbnRhaW5lci5wb3BvdXQoKQoJfSkKCWludGVyYWN0KGNvbnRlbnRzKQoJICAucmVzaXphYmxlKHsKCSAgICBlZGdlczogeyB0b3A6IHRydWUsIGxlZnQ6IGZhbHNlLCBib3R0b206IHRydWUsIHJpZ2h0OiB0cnVlIH0sCgkgICAgbGlzdGVuZXJzOiB7CgkgICAgICBtb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHsJCQoJICAgICAgICBPYmplY3QuYXNzaWduKGV2ZW50LnRhcmdldC5zdHlsZSwgewoJICAgICAgICAgIHdpZHRoOiBgJHtldmVudC5yZWN0LndpZHRofXB4YCwKCSAgICAgICAgICBoZWlnaHQ6IGAke2V2ZW50LnJlY3QuaGVpZ2h0fXB4YCwKCSAgICAgICAgfSkKCSAgICAgIH0KCSAgICB9CgkgIH0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gcmVzaXplIHJlc2V0IHRoZSB3aWR0aAoJCQljb250ZW50cy5zdHlsZS53aWR0aCA9ICcnCgkJICAJY29udGVudHMuc3R5bGUuaGVpZ2h0ID0gJycKCSAgfSkKCgoJZnVuY3Rpb24gcG9zaXRpb25Db250ZW50cygpIHsKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogW2F1dG9QbGFjZW1lbnQoKV0sCgkJfSkudGhlbigocG9zKSA9PiB7CgkJCWNvbnRlbnRzLnN0eWxlLmxlZnQgPSBwb3MueCArICJweCIKCQkJY29udGVudHMuc3R5bGUudG9wID0gcG9zLnkgKyAicHgiCgkJfSkKCX0KCgljb250YWluZXIucG9wb3V0ID0gKGZvcmNlID0gdW5kZWZpbmVkKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ3BvcHBlZCcsIGZvcmNlKQoJCXBvc2l0aW9uQ29udGVudHMoKQoJfQoKCWhlYWRlci5vbmNsaWNrID0gKGUpID0+IHtjb250YWluZXIucG9wb3V0KCl9CgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50cy1ob3ZlcicsIHRydWUpCgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgZmFsc2UpCgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCBmYWxzZSkKPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J2Z4dnllaHNya2onPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJmeHZ5ZWhzcmtqIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCQoJPC9ib25kc2xpc3QtY29udGVudHM+Cgk8c2NyaXB0IGlkPSd4eXF4bXVrYm9wJz4KCQljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb250YWluZXIuY29sbGFwc2UgPSAoZm9yY2UpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcsIGZvcmNlKQoJCX0KCQljb25zdCBjb2xsYXBzZV9idG4gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3Bhbi5jb2xsYXBzZScpCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gY29udGFpbmVyLmNvbGxhcHNlKCkKCTwvc2NyaXB0PgoJPHN0eWxlPgoJYm9uZHNsaXN0LWhlYWRlciB7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBkaXNwbGF5OiBmbGV4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKfQpib25kc2xpc3QtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDBweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjZmZhYzQ1NDA7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQgPiBib25kc2xpc3QtaGVhZGVyIHsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIHBhZGRpbmctdG9wOiAxMnB4OwogIG1hcmdpbi10b3A6IC0xMnB4OwogIHotaW5kZXg6IDEwOwp9CmJvbmRzbGlzdC1jb250ZW50cyB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5uby1wb3BvdXQ6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBibG9jazsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGp1c3RpZnktc2VsZjogY2VudGVyOwogIGJvcmRlci1ib3R0b206IDJweCBzb2xpZDsKICBwYWRkaW5nLXRvcDogNXB4OwogIHdpZHRoOiAxMDAlOwogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogIHotaW5kZXg6IDIwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuYm9uZHNsaXN0LWljb24gewogIC0tc2l6ZTogMTdweDsKICBkaXNwbGF5OiBibG9jazsKICBhbGlnbi1zZWxmOiBzdHJldGNoOwogIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgd2lkdGg6IHZhcigtLXNpemUpOwogIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgY3Vyc29yOiBwb2ludGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkID4gYm9uZHNsaXN0LWhlYWRlciA+IC5jb2xsYXBzZSB7CiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB3aWR0aDogMzBweDsKICBtYXJnaW46IDAgMTBweDsKfQpib25kc2xpc3QtaGVhZGVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogIHdpZHRoOiAxMDAlOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBmbGV4LWdyb3c6IDE7CiAgZm9udC1zaXplOiAxOHB4OwogIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC50b2dnbGUgewogIGFsaWduLXNlbGY6IGNlbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCBib25kc2xpc3QtaGVhZGVyICsgKiB7CiAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CmJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICByb3ctZ2FwOiA1cHg7Cn0KYm9uZHN0YWJsZS1jb250YWluZXIgYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCQkKCTwvc3R5bGU+CjwvYm9uZHNsaXN0LWNvbnRhaW5lcj4KCgk8L2JvbmR0YWJsZS1jb250ZW50cz4KPC9ib25kdGFibGUtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdlZWhhb2Z3cmlsJz4KCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJY29uc3QgY2VsbCA9IGNvbnRhaW5lci5jbG9zZXN0KCdwbHV0by1jZWxsJykKCgkKCWNvbnN0IGhlbHBfYnRuID0gaGVhZGVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb2xsYXBzZV9idG4gPSBoZWFkZXIubGFzdEVsZW1lbnRDaGlsZAoKCWNvbnRhaW5lci5jb2xsYXBzZSA9IChmb3JjZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnLCBmb3JjZSkKCX0KCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gZSA9PiBjb250YWluZXIuY29sbGFwc2UoKQoKCS8vIExvYWQgdGhlIGludGVyYWN0IHNjcmlwdAoJCgkvLyBXZSB1c2UgdGhlIGludGVyYWN0anMgbGlicmFyeSB0byBwcm92aWRlIGRyYWcgYW5kIHJlc2l6ZSBoYW5kbGluZyBhY3Jvc3MgZGV2aWNlcwoJY29uc3QgeyBkZWZhdWx0OiBpbnRlcmFjdCB9ID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9pbnRlcmFjdGpzJykKCgljb250YWluZXIub2Zmc2V0ID0gY29udGFpbmVyLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignYm9uZHRhYmxlLWhlYWRlciAuZGVzY3JpcHRpb24nKSkuZHJhZ2dhYmxlKHsKCQlsaXN0ZW5lcnM6IHsKCQkJc3RhcnQgKGV2ZW50KSB7CgkJCQljb250YWluZXIub2Zmc2V0LnkgPSBzdGFydFBvc2l0aW9uLnkgPSBjb250YWluZXIub2Zmc2V0VG9wCgkJCQljb250YWluZXIub2Zmc2V0LnggPSBzdGFydFBvc2l0aW9uLnggPSBjb250YWluZXIub2Zmc2V0TGVmdAoJCQl9LAoJCQltb3ZlIChldmVudCkgewoJCSAgICAgIGNvbnRhaW5lci5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRhaW5lci5vZmZzZXQueSArPSBldmVudC5keQoJCQoJCSAgICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSBgbWluKDk1dmgsICR7Y29udGFpbmVyLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYG1pbig5NXZ3LCAke2NvbnRhaW5lci5vZmZzZXQueH1weGAKCQkgICAgfSwKCQl9Cgl9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIGhlYWRlciByZXNldCB0aGUgcG9zaXRpb24KCQljb250YWluZXIuc3R5bGUudG9wID0gJycKCQljb250YWluZXIuc3R5bGUubGVmdCA9ICcnCgl9KQoJaW50ZXJhY3QoY29udGFpbmVyKQoJICAucmVzaXphYmxlKHsKCQlpZ25vcmVGcm9tOiAncG9wb3V0LWNvbnRhaW5lcicsCgkgICAgZWRnZXM6IHsgdG9wOiB0cnVlLCBsZWZ0OiBmYWxzZSwgYm90dG9tOiB0cnVlLCByaWdodDogdHJ1ZSB9LAoJICAgIGxpc3RlbmVyczogewoJICAgICAgbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7CQkKCSAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudC50YXJnZXQuc3R5bGUsIHsKCSAgICAgICAgICB3aWR0aDogYCR7ZXZlbnQucmVjdC53aWR0aH1weGAsCgkgICAgICAgICAgaGVpZ2h0OiBgJHtldmVudC5yZWN0LmhlaWdodH1weGAsCgkJCSAgbWF4SGVpZ2h0OiAnbm9uZScsCgkgICAgICAgIH0pCgkgICAgICB9CgkgICAgfQoJICB9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIHJlc2l6ZSByZXNldCB0aGUgd2lkdGgKCQkJY29udGFpbmVyLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gJycKCQkgIAljb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gJycKCSAgfSkKCgoJLy8gTm93IHdlIGFzc2lnbiBhIHNwZWNpZmljIGNsYXNzIHRvIGFsbCB0b2dnbGUtY29udGFpbmVyIHRoYXQgYXJlIGRpcmVjdCBjaGlsZHJlbgoJZm9yIChjb25zdCB0ciBvZiBjb250ZW50cy5xdWVyeVNlbGVjdG9yQWxsKCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKSkgewoJCXRyLmNsb3Nlc3QoJ3BvcG91dC1jb250YWluZXInKSA/PyB0ci5jbGFzc0xpc3QudG9nZ2xlKCduby1wb3BvdXQnLCB0cnVlKQoJfQoJLy8gV2UgYWxzbyBmbGFnIHRoZSBmaXJzdCB0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgaW4gdGhlIHRhYmxlCgljb250ZW50cy5maXJzdEVsZW1lbnRDaGlsZC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIubm8tcG9wb3V0Jyk/LmNsYXNzTGlzdC50b2dnbGUoJ2ZpcnN0Jyx0cnVlKQoKCS8vIENsaWNrIHRvIGdvIHRvIGRlZmluaXRpb24KCWNvbnRhaW5lci5qdW1wVG9DZWxsID0gKCkgPT4gewoJCWNlbGwuc2Nyb2xsSW50b1ZpZXcoKQoJfQoJaGVscF9idG4ub25jbGljayA9IGNvbnRhaW5lci5qdW1wVG9DZWxsCjwvc2NyaXB0Pgo8c3R5bGU+Cglib25kdGFibGUtY29udGFpbmVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgdG9wOiA1MHB4OwogICAgbGVmdDogMTBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkICNlN2U3ZTc7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZy1sZWZ0OiA4cHg7CiAgICBwYWRkaW5nLXRvcDogOHB4OwogICAgei1pbmRleDogNjAwOwogICAgd2lkdGg6IDQwMHB4OwogICAgbWF4LWhlaWdodDogNjAwcHg7CiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMzAwbXMgY3ViaWMtYmV6aWVyKDAuMTgsIDAuODksIDAuNDUsIDEuMTIpOwp9CmJvbmR0YWJsZS1jb250YWluZXI6bm90KC5jb2xsYXBzZWQpID4gKiB7CiAgICBwYWRkaW5nLXJpZ2h0OiA4cHg7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIHBhZGRpbmctYm90dG9tOiA4cHg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgb3ZlcmZsb3c6IGF1dG87Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5uby1wb3BvdXQsCmJvbmR0YWJsZS1jb250ZW50cyA+ICosIApib25kdGFibGUtY29udGVudHMgc3RydWN0LWJvbmQgewogICAgZGlzcGxheTogY29udGVudHMKfQp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIubm8tcG9wb3V0OmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGp1c3RpZnktc2VsZjogY2VudGVyOwogICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkOwogICAgcGFkZGluZy10b3A6IDVweDsKICAgIHdpZHRoOiAxMDAlOwogICAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgICBwb3NpdGlvbjogc3RpY2t5OwogICAgdG9wOiAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICB6LWluZGV4OiAyMDsKfQp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIubm8tcG9wb3V0ID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGFsaWduLXNlbGY6IHN0YXJ0OwogICAgcG9zaXRpb246IHN0aWNreTsKICAgIHRvcDogMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgcGFkZGluZy10b3A6IDEycHg7CiAgICBtYXJnaW4tdG9wOiAtMTJweDsKICAgIHotaW5kZXg6IDEwOwp9CmJvbmR0YWJsZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktaXRlbXM6IHN0cmV0Y2g7Cn0KYm9uZHRhYmxlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICBmbGV4LWdyb3c6IDE7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmb250LXNpemU6IDIwcHg7CiAgICBmb250LXdlaWdodDogODAwOwogICAgdG91Y2gtYWN0aW9uOiBub25lOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KYm9uZHRhYmxlLWhlYWRlciA+IC5pY29uIHsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KYm9uZHRhYmxlLWhlYWRlciAudGFibGUtY29sbGFwc2UgewogICAgLS1zaXplOiAyM3B4OwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2Fycm93LWJhY2suc3ZnIik7Cn0KYm9uZHRhYmxlLWNvbnRhaW5lci5jb2xsYXBzZWQgLnRhYmxlLWNvbGxhcHNlIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9vcHRpb25zLW91dGxpbmUuc3ZnIik7CiAgICBtYXJnaW4tcmlnaHQ6IDBweDsKfQpib25kdGFibGUtY29udGFpbmVyLmNvbGxhcHNlZCAudGFibGUtY29sbGFwc2U6aG92ZXIgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2Fycm93LWZvcndhcmQuc3ZnIik7Cn0KYm9uZHRhYmxlLWNvbnRhaW5lci5jb2xsYXBzZWQgewogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKGNhbGMoLTEwMCUgKyAzNXB4KSk7CiAgICBoZWlnaHQ6IGF1dG8gIWltcG9ydGFudDsKICAgIGxlZnQ6IDBweCAhaW1wb3J0YW50OwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIHBhZGRpbmc6IDVweDsKfQpib25kdGFibGUtY29udGFpbmVyLmNvbGxhcHNlZCBib25kdGFibGUtY29udGVudHMsCmJvbmR0YWJsZS1jb250YWluZXIuY29sbGFwc2VkIHNlcGFyYXRvciB7CiAgICBkaXNwbGF5OiBub25lOwp9CkBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHsKICAgIGJvbmR0YWJsZS1jb250YWluZXIgewogICAgICAgIGJvcmRlci1jb2xvcjogIzdkN2Q3ZDsKICAgIH0KfQo8L3N0eWxlPgoKpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBChbAtwsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc2JUbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaagk8Ym9uZCBkZWY9ImFzZCIgdW5pcXVlX2lkPSJKcTk4cDZMc2VyUTAiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na29zaGl2dGNhcicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5NYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIDxzcGFuIGNsYXNzPSJ0ZXgiPiRMYVRlWCQ8L3NwYW4+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naHJ2cXVhZXZrZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdocnZxdWFldmtmJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaHJ2cXVhZXZrZiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3FzenN5d3l3Y3EnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzY3JpcHQ+Ci8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCndpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgpjb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKY29uc3QgdmFsdWVzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXQoKY29uc3QgZWwgPSBodG1sYAo8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CnRvdWNoLWFjdGlvbjogbm9uZTsKYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwpjb2xvcjogYmxhY2s7CnBhZGRpbmc6IDBlbSAuMmVtOwpib3JkZXItcmFkaXVzOiAuM2VtOwpmb250LXdlaWdodDogYm9sZDsiPjY8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCmxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCglzZXQ6IHggPT4gewoJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgl9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCi8vIGluaXRpYWwgdmFsdWUKZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgpjb25zdCBvblNjcnViID0gKGUpID0+IHsKCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94Cgljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJKSkKCglpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQp9Cgpjb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCglvbGRfeCA9IGUuY2xpZW50WAoJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQplbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgpjb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKfQplbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgpjb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCn0pCgpyZXR1cm4gZWwKCjwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3FzenN5d3l3Y3EnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJxc3pzeXd5d2NxIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd3d3NxcHlzYm9nJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nd3dzcXB5c2JvZyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInd3c3FweXNib2ciCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2VvZ2x1cGNwc3gnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbHFwaWJobHhwbCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2xxcGliaGx4cGwnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJscXBpYmhseHBsIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdvaWNjdWRseWduJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nb2ljY3VkbHlnbic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm9pY2N1ZGx5Z24iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdlb2dsdXBjcHN4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZW9nbHVwY3BzeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkJCgk8c2NyaXB0PgoJCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCQljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgYEFTRGAiKQoKCQkvLyBhZGQgdGhlIGNvbGxhcHNlIGJ1dHRvbgoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGh0bWxgPHNwYW4gY2xhc3M9J2NvbGxhcHNlJz5gCgkJaGVhZGVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGNvbGxhcHNlX2J0bikKCgkJdHJjLmNvbGxhcHNlID0gKCkgPT4gewogIAkJCXRyYy5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQoJCX0KCgkJY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gdHJjLmNvbGxhcHNlKCkKCQkKCTwvc2NyaXB0PgoJCTxzdHlsZT4KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogY29udGVudHM7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCQkJZmxleDogMTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZ3JpZC1jb2x1bW46IDEgLyAtMTsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCS0tc2l6ZTogMTdweDsKCQkJICAgIGRpc3BsYXk6IGJsb2NrOwoJCQkgICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKCQkJICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkJCSAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwoJCQkgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwoJCQkgICAgd2lkdGg6IHZhcigtLXNpemUpOwoJCQkgICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgPiB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCQlhbGlnbi1pdGVtczogc3RyZXRjaDsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQlmbGV4LWdyb3c6IDE7CgkJCQlmb250LXNpemU6IDE4cHg7CgkJCQlmb250LXdlaWdodDogNjAwOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewoJCQkJYWxpZ24tc2VsZjogY2VudGVyCgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgKyAqIHsKCQkJCWRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0na29zaGl2dGNhcic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImtvc2hpdnRjYXIiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J256d2llbmlwb2QnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwwLDAsLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdxeW9uY3Frc3FpJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkJZGVzYy5pbm5lckhUTUwgPSAiQ3VzdG9tIERlc2NyaXB0aW9uIgoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCgT+CksHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2a5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc54q6FCtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoB0zxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5HZW5lcmF0aW5nIGF1dG9tYXRpYyB3aWRnZXRzIGZvciBjdXN0b20gc3RydWN0cyBpcyBxdWl0ZSBzdHJhaWdodGZvcndhcmQgd2l0aCB0aGUgYWlkIG9mIHRoZSA8Y29kZT5AZmllbGRkYXRhPC9jb2RlPiBtYWNybyBhbmQgdGhlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IHR5cGUuPC9wPgo8cD5UaGUgdG9wLWxlZnQgYXJyb3cgY2FuIGJlIHVzZWQgdG8gc2hvdy1oaWRlIHRoZSBmaWVsZCBlbGVtZW50cyAmIzQwO3VzZWZ1bCBpbnNpZGUgYSA8Y29kZT5Cb25kVGFibGU8L2NvZGU+LCBzaG93biBiZWxvdyYjNDE7LCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLjwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCZN05NsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTC5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABOBAtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedktPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxoMT5ATlRCb25kPC9oMT4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCZN2h3sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjW5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4AAvgntXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhmiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keaCkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCdThznsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4CqXGetXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOWQ0NDU1YWYtOTZmMS00NmQ3LWE0ZjMtNDM0NDk1YjExYzhhiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedkuPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxoMT5QYWNrYWdlczwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTcUQLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOWQ0NDU1YWYtOTZmMS00NmQ3LWE0ZjMtNDM0NDk1YjExYzhhuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAN4HbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHna0qc8c2NyaXB0PgoJCi8vIExvYWQgdGhlIGxpYnJhcnkgZm9yIGNvbnNpc3RlbnQgc21vb3RoIHNjcm9sbGluZwpjb25zdCB7ZGVmYXVsdDogc2Nyb2xsSW50b1ZpZXd9ID0gYXdhaXQgaW1wb3J0KCJkYXRhOnRleHQvamF2YXNjcmlwdDtiYXNlNjQsZG1GeUlGRTlaVDArSW05aWFtVmpkQ0k5UFhSNWNHVnZaaUJsSmladWRXeHNJVDFsSmlZeFBUMDlaUzV1YjJSbFZIbHdaU3hWUFNobExIUXBQVDRvSVhSOGZDSm9hV1JrWlc0aUlUMDlaU2ttSmlKMmFYTnBZbXhsSWlFOVBXVW1KaUpqYkdsd0lpRTlQV1VzUVQwb1pTeDBLVDArZTJsbUtHVXVZMnhwWlc1MFNHVnBaMmgwUEdVdWMyTnliMnhzU0dWcFoyaDBmSHhsTG1Oc2FXVnVkRmRwWkhSb1BHVXVjMk55YjJ4c1YybGtkR2dwZTJ4bGRDQnNQV2RsZEVOdmJYQjFkR1ZrVTNSNWJHVW9aU3h1ZFd4c0tUdHlaWFIxY200Z1ZTaHNMbTkyWlhKbWJHOTNXU3gwS1h4OFZTaHNMbTkyWlhKbWJHOTNXQ3gwS1h4OEtHVTlQbnRzWlhRZ2REMG9aVDArZTJsbUtDRmxMbTkzYm1WeVJHOWpkVzFsYm5SOGZDRmxMbTkzYm1WeVJHOWpkVzFsYm5RdVpHVm1ZWFZzZEZacFpYY3BjbVYwZFhKdUlHNTFiR3c3ZEhKNWUzSmxkSFZ5YmlCbExtOTNibVZ5Ukc5amRXMWxiblF1WkdWbVlYVnNkRlpwWlhjdVpuSmhiV1ZGYkdWdFpXNTBmV05oZEdOb2UzSmxkSFZ5YmlCdWRXeHNmWDBwS0dVcE8zSmxkSFZ5YmlFaGRDWW1LSFF1WTJ4cFpXNTBTR1ZwWjJoMFBHVXVjMk55YjJ4c1NHVnBaMmgwZkh4MExtTnNhV1Z1ZEZkcFpIUm9QR1V1YzJOeWIyeHNWMmxrZEdncGZTa29aU2w5Y21WMGRYSnVJVEY5TEZnOUtHVXNkQ3hzTEc4c2JpeHlMR2tzY3lrOVBuSThaU1ltYVQ1MGZIeHlQbVVtSm1rOGREOHdPbkk4UFdVbUpuTThQV3g4ZkdrK1BYUW1Kbk0rUFd3L2NpMWxMVzg2YVQ1MEppWnpQR3g4ZkhJOFpTWW1jejVzUDJrdGRDdHVPakFzSkQxbFBUNWxMbkJoY21WdWRFVnNaVzFsYm5RL1B5aGxMbWRsZEZKdmIzUk9iMlJsS0NrdWFHOXpkSHg4Ym5Wc2JDa3NkSFE5S0dVc2RDazlQbnQyWVhJZ2JDeHZMRzRzY2p0cFppaDBlWEJsYjJZZ1pHOWpkVzFsYm5RK0luVWlLWEpsZEhWeWJsdGRPMnhsZEh0elkzSnZiR3hOYjJSbE9ta3NZbXh2WTJzNmN5eHBibXhwYm1VNllTeGliM1Z1WkdGeWVUcG9MSE5yYVhCUGRtVnlabXh2ZDBocFpHUmxia1ZzWlcxbGJuUnpPblY5UFhRc1p6MGlablZ1WTNScGIyNGlQVDEwZVhCbGIyWWdhRDlvT21VOVBtVWhQVDFvTzJsbUtDRlJLR1VwS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWdpU1c1MllXeHBaQ0IwWVhKblpYUWlLVHRzWlhRZ2RqMWtiMk4xYldWdWRDNXpZM0p2Ykd4cGJtZEZiR1Z0Wlc1MGZIeGtiMk4xYldWdWRDNWtiMk4xYldWdWRFVnNaVzFsYm5Rc2JUMWJYU3gzUFdVN1ptOXlLRHRSS0hjcEppWm5LSGNwT3lsN2FXWW9LSGM5SkNoM0tTazlQVDEyS1h0dExuQjFjMmdvZHlrN1luSmxZV3Q5Ym5Wc2JDRTlkeVltZHowOVBXUnZZM1Z0Wlc1MExtSnZaSGttSmtFb2R5a21KaUZCS0dSdlkzVnRaVzUwTG1SdlkzVnRaVzUwUld4bGJXVnVkQ2w4Zkc1MWJHd2hQWGNtSmtFb2R5eDFLU1ltYlM1d2RYTm9LSGNwZld4bGRDQlhQVzUxYkd3aFBTaHZQVzUxYkd3OVBTaHNQWGRwYm1SdmR5NTJhWE4xWVd4V2FXVjNjRzl5ZENrL2RtOXBaQ0F3T213dWQybGtkR2dwUDI4NmFXNXVaWEpYYVdSMGFDeElQVzUxYkd3aFBTaHlQVzUxYkd3OVBTaHVQWGRwYm1SdmR5NTJhWE4xWVd4V2FXVjNjRzl5ZENrL2RtOXBaQ0F3T200dWFHVnBaMmgwS1Q5eU9tbHVibVZ5U0dWcFoyaDBMSHR6WTNKdmJHeFlPbDhzYzJOeWIyeHNXVHA0ZlQxM2FXNWtiM2NzZTJobGFXZG9kRHBGTEhkcFpIUm9PbFFzZEc5d09rNHNjbWxuYUhRNlRDeGliM1IwYjIwNldTeHNaV1owT2tOOVBXVXVaMlYwUW05MWJtUnBibWREYkdsbGJuUlNaV04wS0Nrc1VqMGljM1JoY25RaVBUMDljM3g4SW01bFlYSmxjM1FpUFQwOWN6OU9PaUpsYm1RaVBUMDljejlaT2s0clJTOHlMRlk5SW1ObGJuUmxjaUk5UFQxaFAwTXJWQzh5T2lKbGJtUWlQVDA5WVQ5TU9rTXNRajFiWFR0bWIzSW9iR1YwSUVROU1EdEVQRzB1YkdWdVozUm9PMFFyS3lsN2JHVjBJRTg5YlZ0RVhTeDdhR1ZwWjJoME9tb3NkMmxrZEdnNlNTeDBiM0E2VXl4eWFXZG9kRHB4TEdKdmRIUnZiVHA2TEd4bFpuUTZSbjA5VHk1blpYUkNiM1Z1WkdsdVowTnNhV1Z1ZEZKbFkzUW9LVHRwWmlnaWFXWXRibVZsWkdWa0lqMDlQV2ttSms0K1BUQW1Ka00rUFRBbUpsazhQVWdtSmt3OFBWY21KazQrUFZNbUpsazhQWG9tSmtNK1BVWW1Ka3c4UFhFcFluSmxZV3M3YkdWMElFYzlaMlYwUTI5dGNIVjBaV1JUZEhsc1pTaFBLU3hLUFhCaGNuTmxTVzUwS0VjdVltOXlaR1Z5VEdWbWRGZHBaSFJvTERFd0tTeExQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlWRzl3VjJsa2RHZ3NNVEFwTEZBOWNHRnljMlZKYm5Rb1J5NWliM0prWlhKU2FXZG9kRmRwWkhSb0xERXdLU3hhUFhCaGNuTmxTVzUwS0VjdVltOXlaR1Z5UW05MGRHOXRWMmxrZEdnc01UQXBMR1ZsUFRBc1pYUTlNQ3hsYkQwaWIyWm1jMlYwVjJsa2RHZ2lhVzRnVHo5UExtOW1abk5sZEZkcFpIUm9MVTh1WTJ4cFpXNTBWMmxrZEdndFNpMVFPakFzWlc4OUltOW1abk5sZEVobGFXZG9kQ0pwYmlCUFAwOHViMlptYzJWMFNHVnBaMmgwTFU4dVkyeHBaVzUwU0dWcFoyaDBMVXN0V2pvd0xHVnVQU0p2Wm1aelpYUlhhV1IwYUNKcGJpQlBQekE5UFQxUExtOW1abk5sZEZkcFpIUm9QekE2U1M5UExtOW1abk5sZEZkcFpIUm9PakFzWlhJOUltOW1abk5sZEVobGFXZG9kQ0pwYmlCUFB6QTlQVDFQTG05bVpuTmxkRWhsYVdkb2REOHdPbW92VHk1dlptWnpaWFJJWldsbmFIUTZNRHRwWmloMlBUMDlUeWxsWlQwaWMzUmhjblFpUFQwOWN6OVNPaUpsYm1RaVBUMDljejlTTFVnNkltNWxZWEpsYzNRaVBUMDljejlZS0hnc2VDdElMRWdzU3l4YUxIZ3JVaXg0SzFJclJTeEZLVHBTTFVndk1peGxkRDBpYzNSaGNuUWlQVDA5WVQ5V09pSmpaVzUwWlhJaVBUMDlZVDlXTFZjdk1qb2laVzVrSWowOVBXRS9WaTFYT2xnb1h5eGZLMWNzVnl4S0xGQXNYeXRXTEY4clZpdFVMRlFwTEdWbFBVMWhkR2d1YldGNEtEQXNaV1VyZUNrc1pYUTlUV0YwYUM1dFlYZ29NQ3hsZEN0ZktUdGxiSE5sZTJWbFBTSnpkR0Z5ZENJOVBUMXpQMUl0VXkxTE9pSmxibVFpUFQwOWN6OVNMWG9yV2l0bGJ6b2libVZoY21WemRDSTlQVDF6UDFnb1V5eDZMR29zU3l4YUsyVnZMRklzVWl0RkxFVXBPbEl0S0ZNcmFpOHlLU3RsYnk4eUxHVjBQU0p6ZEdGeWRDSTlQVDFoUDFZdFJpMUtPaUpqWlc1MFpYSWlQVDA5WVQ5V0xTaEdLMGt2TWlrclpXd3ZNam9pWlc1a0lqMDlQV0UvVmkxeEsxQXJaV3c2V0NoR0xIRXNTU3hLTEZBclpXd3NWaXhXSzFRc1ZDazdiR1YwZTNOamNtOXNiRXhsWm5RNlpXa3NjMk55YjJ4c1ZHOXdPbVZrZlQxUE8yVmxQVTFoZEdndWJXRjRLREFzVFdGMGFDNXRhVzRvWldRclpXVXZaWElzVHk1elkzSnZiR3hJWldsbmFIUXRhaTlsY2l0bGJ5a3BMR1YwUFUxaGRHZ3ViV0Y0S0RBc1RXRjBhQzV0YVc0b1pXa3JaWFF2Wlc0c1R5NXpZM0p2Ykd4WGFXUjBhQzFKTDJWdUsyVnNLU2tzVWlzOVpXUXRaV1VzVmlzOVpXa3RaWFI5UWk1d2RYTm9LSHRsYkRwUExIUnZjRHBsWlN4c1pXWjBPbVYwZlNsOWNtVjBkWEp1SUVKOUxHWTlaVDArZTNaaGNpQjBPM0psZEhWeWJpRXhQVDA5WlQ5N1lteHZZMnM2SW1WdVpDSXNhVzVzYVc1bE9pSnVaV0Z5WlhOMEluMDZLSFE5WlNrOVBUMVBZbXBsWTNRb2RDa21KakFoUFQxUFltcGxZM1F1YTJWNWN5aDBLUzVzWlc1bmRHZy9aVHA3WW14dlkyczZJbk4wWVhKMElpeHBibXhwYm1VNkltNWxZWEpsYzNRaWZYMDdablZ1WTNScGIyNGdZeWhsTEhRcGUzWmhjaUJzTzJsbUtDRmxMbWx6UTI5dWJtVmpkR1ZrZkh3aEtHVTlQbnRzWlhRZ2REMWxPMlp2Y2lnN2RDWW1kQzV3WVhKbGJuUk9iMlJsT3lsN2FXWW9kQzV3WVhKbGJuUk9iMlJsUFQwOVpHOWpkVzFsYm5RcGNtVjBkWEp1SVRBN2REMTBMbkJoY21WdWRFNXZaR1VnYVc1emRHRnVZMlZ2WmlCVGFHRmtiM2RTYjI5MFAzUXVjR0Z5Wlc1MFRtOWtaUzVvYjNOME9uUXVjR0Z5Wlc1MFRtOWtaWDF5WlhSMWNtNGhNWDBwS0dVcEtYSmxkSFZ5Ymp0cFppZ2liMkpxWldOMElqMDlkSGx3Wlc5bUtHdzlkQ2ttSmlKbWRXNWpkR2x2YmlJOVBYUjVjR1Z2WmlCc0xtSmxhR0YyYVc5eUtYSmxkSFZ5YmlCMExtSmxhR0YyYVc5eUtIUjBLR1VzZENrcE8yeGxkQ0J2UFNKaWIyOXNaV0Z1SWowOWRIbHdaVzltSUhSOGZHNTFiR3c5UFhRL2RtOXBaQ0F3T25RdVltVm9ZWFpwYjNJN1ptOXlLR3hsZEh0bGJEcHVMSFJ2Y0RweUxHeGxablE2YVgxdlppQjBkQ2hsTEdZb2RDa3BLVzR1YzJOeWIyeHNLSHQwYjNBNmNpeHNaV1owT21rc1ltVm9ZWFpwYjNJNmIzMHBmWFpoY2lCa0xIQTlLQ2s5UGloa2ZId29aRDBpY0dWeVptOXliV0Z1WTJVaWFXNGdkMmx1Wkc5M1AzQmxjbVp2Y20xaGJtTmxMbTV2ZHk1aWFXNWtLSEJsY21admNtMWhibU5sS1RwRVlYUmxMbTV2ZHlrc1pDZ3BLVHRtZFc1amRHbHZiaUJpS0dVcGUyeGxkQ0IwUFUxaGRHZ3ViV2x1S0Nod0tDa3RaUzV6ZEdGeWRGUnBiV1VwTDJVdVpIVnlZWFJwYjI0c01Ta3NiRDFsTG1WaGMyVW9kQ2tzYnoxbExuTjBZWEowV0Nzb1pTNTRMV1V1YzNSaGNuUllLU3BzTEc0OVpTNXpkR0Z5ZEZrcktHVXVlUzFsTG5OMFlYSjBXU2txYkR0bExtMWxkR2h2WkNodkxHNHNkQ3hzS1N4dklUMDlaUzU0Zkh4dUlUMDlaUzU1UDNKbGNYVmxjM1JCYm1sdFlYUnBiMjVHY21GdFpTZ29LVDArWWlobEtTazZaUzVqWWlncGZXWjFibU4wYVc5dUlIa29aU3gwTEd3cGUyeGxkQ0J2UFdGeVozVnRaVzUwY3k1c1pXNW5kR2crTXlZbWRtOXBaQ0F3SVQwOVlYSm5kVzFsYm5Seld6TmRQMkZ5WjNWdFpXNTBjMXN6WFRvMk1EQXNiajFoY21kMWJXVnVkSE11YkdWdVozUm9QalFtSm5admFXUWdNQ0U5UFdGeVozVnRaVzUwYzFzMFhUOWhjbWQxYldWdWRITmJORjA2WlQwK01Tc3RMV1VxWlNwbEttVXFaU3h5UFdGeVozVnRaVzUwY3k1c1pXNW5kR2crTlQ5aGNtZDFiV1Z1ZEhOYk5WMDZkbTlwWkNBd0xHazlZWEpuZFcxbGJuUnpMbXhsYm1kMGFENDJQMkZ5WjNWdFpXNTBjMXMyWFRwMmIybGtJREFzY3oxbExuTmpjbTlzYkV4bFpuUXNZVDFsTG5OamNtOXNiRlJ2Y0R0aUtIdHpZM0p2Ykd4aFlteGxPbVVzYldWMGFHOWtLSFFzYkN4dkxHNHBlMnhsZENCeVBVMWhkR2d1WTJWcGJDaDBLU3h6UFUxaGRHZ3VZMlZwYkNoc0tUdGxMbk5qY205c2JFeGxablE5Y2l4bExuTmpjbTlzYkZSdmNEMXpMR2svTGloN2RHRnlaMlYwT21Vc1pXeGhjSE5sWkRwdkxIWmhiSFZsT200c2JHVm1kRHB5TEhSdmNEcHpmU2w5TEhOMFlYSjBWR2x0WlRwd0tDa3NjM1JoY25SWU9uTXNjM1JoY25SWk9tRXNlRHAwTEhrNmJDeGtkWEpoZEdsdmJqcHZMR1ZoYzJVNmJpeGpZanB5ZlNsOWRtRnlJRTA5WlQwK1pTWW1JV1V1WW1Wb1lYWnBiM0o4ZkNKemJXOXZkR2dpUFQwOVpTNWlaV2hoZG1sdmNpeHJQV1oxYm1OMGFXOXVLR1VzZENsN2JHVjBJR3c5ZEh4OGUzMDdjbVYwZFhKdUlFMG9iQ2svWXlobExIdGliRzlqYXpwc0xtSnNiMk5yTEdsdWJHbHVaVHBzTG1sdWJHbHVaU3h6WTNKdmJHeE5iMlJsT213dWMyTnliMnhzVFc5a1pTeGliM1Z1WkdGeWVUcHNMbUp2ZFc1a1lYSjVMSE5yYVhCUGRtVnlabXh2ZDBocFpHUmxia1ZzWlcxbGJuUnpPbXd1YzJ0cGNFOTJaWEptYkc5M1NHbGtaR1Z1Uld4bGJXVnVkSE1zWW1Wb1lYWnBiM0k2WlQwK1VISnZiV2x6WlM1aGJHd29aUzV5WldSMVkyVW9LR1VzZENrOVBudHNaWFI3Wld3NmJ5eHNaV1owT200c2RHOXdPbko5UFhRc2FUMXZMbk5qY205c2JFeGxablFzY3oxdkxuTmpjbTlzYkZSdmNEdHlaWFIxY200Z2FUMDlQVzRtSm5NOVBUMXlQMlU2V3k0dUxtVXNibVYzSUZCeWIyMXBjMlVvWlQwK2VTaHZMRzRzY2l4c0xtUjFjbUYwYVc5dUxHd3VaV0Z6WlN3b0tUMCtaU2g3Wld3NmJ5eHNaV1owT2x0cExHNWRMSFJ2Y0RwYmN5eHlYWDBwTEd3dWIyNVRZM0p2Ykd4RGFHRnVaMlVwS1YxOUxGdGRLU2w5S1RwUWNtOXRhWE5sTG5KbGMyOXNkbVVvWXlobExIUXBLWDA3Wlhod2IzSjBlMnNnWVhNZ1pHVm1ZWFZzZEgwNyIpCgpjb25zdCBpbmRlbnQgPSB0cnVlCmNvbnN0IGFzaWRlID0gdHJ1ZQpjb25zdCB0aXRsZV90ZXh0ID0gIlRhYmxlIG9mIENvbnRlbnRzIgpjb25zdCBpbmNsdWRlX2RlZmluaXRpb25zID0gZmFsc2UKCgpjb25zdCB0b2NOb2RlID0gaHRtbGA8bmF2IGNsYXNzPSJwbHV0b3VpLXRvYyI+Cgk8aGVhZGVyPgoJIDxzcGFuIGNsYXNzPSJ0b2MtdG9nZ2xlIG9wZW4tdG9jIj48L3NwYW4+CgkgPHNwYW4gY2xhc3M9InRvYy10b2dnbGUgY2xvc2VkLXRvYyI+PC9zcGFuPgoJICR7dGl0bGVfdGV4dH0KCTwvaGVhZGVyPgoJPHNlY3Rpb24+PC9zZWN0aW9uPgo8L25hdj5gCgp0b2NOb2RlLmNsYXNzTGlzdC50b2dnbGUoImFzaWRlIiwgYXNpZGUpCnRvY05vZGUuY2xhc3NMaXN0LnRvZ2dsZSgiaW5kZW50IiwgaW5kZW50KQoKCmNvbnN0IGdldFBhcmVudENlbGwgPSBlbCA9PiBlbC5jbG9zZXN0KCJwbHV0by1jZWxsIikKCmNvbnN0IGdldEhlYWRlcnMgPSAoKSA9PiB7Cgljb25zdCBkZXB0aCA9IE1hdGgubWF4KDEsIE1hdGgubWluKDYsIDMpKSAvLyBzaG91bGQgYmUgaW4gcmFuZ2UgMTo2Cgljb25zdCByYW5nZSA9IEFycmF5LmZyb20oe2xlbmd0aDogZGVwdGh9LCAoeCwgaSkgPT4gaSsxKSAvLyBbMSwgLi4uLCBkZXB0aF0KCQoJY29uc3Qgc2VsZWN0b3IgPSBbCgkJLi4uKGluY2x1ZGVfZGVmaW5pdGlvbnMgPyBbCgkJCWBwbHV0by1ub3RlYm9vayBwbHV0by1jZWxsIC5wbHV0by1kb2NzLWJpbmRpbmdgLCAKCQkJYHBsdXRvLW5vdGVib29rIHBsdXRvLWNlbGwgYXNzaWduZWU6bm90KDplbXB0eSlgLCAKCQldIDogW10pLAoJCS4uLnJhbmdlLm1hcChpID0+IGBwbHV0by1ub3RlYm9vayBwbHV0by1jZWxsIGgke2l9YCkKCV0uam9pbigiLCIpCglyZXR1cm4gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSkuZmlsdGVyKGVsID0+IAoJCS8vIGV4Y2x1ZGUgaGVhZGVycyBpbnNpZGUgb2YgYSBwbHV0by1kb2NzLWJpbmRpbmcgYmxvY2sKCQkhKGVsLm5vZGVOYW1lLnN0YXJ0c1dpdGgoIkgiKSAmJiBlbC5jbG9zZXN0KCIucGx1dG8tZG9jcy1iaW5kaW5nIikpCgkpCn0KCgpjb25zdCBkb2N1bWVudF9jbGlja19oYW5kbGVyID0gKGV2ZW50KSA9PiB7Cgljb25zdCBwYXRoID0gKGV2ZW50LnBhdGggfHwgZXZlbnQuY29tcG9zZWRQYXRoKCkpCgljb25zdCB0b2MgPSBwYXRoLmZpbmQoZWxlbSA9PiBlbGVtPy5jbGFzc0xpc3Q/LmNvbnRhaW5zPy4oInRvYy10b2dnbGUiKSkKCWlmICh0b2MpIHsKCQlldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKQoJCXRvYy5jbG9zZXN0KCIucGx1dG91aS10b2MiKS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRlIikKCX0KfQoKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBkb2N1bWVudF9jbGlja19oYW5kbGVyKQoKCmNvbnN0IGhlYWRlcl90b19pbmRleF9lbnRyeV9tYXAgPSBuZXcgTWFwKCkKY29uc3QgY3VycmVudGx5X2hpZ2hsaWdodGVkX3NldCA9IG5ldyBTZXQoKQoKY29uc3QgbGFzdF90b2NfZWxlbWVudF9jbGlja190aW1lID0geyBjdXJyZW50OiAwIH0KCmNvbnN0IGludGVyc2VjdGlvbl9jYWxsYmFjayA9IChpeHMpID0+IHsKCWxldCBvbl90b3AgPSBpeHMuZmlsdGVyKGl4ID0+IGl4LmludGVyc2VjdGlvblJhdGlvID4gMCAmJiBpeC5pbnRlcnNlY3Rpb25SZWN0LnkgPCBpeC5yb290Qm91bmRzLmhlaWdodCAvIDIpCglpZihvbl90b3AubGVuZ3RoID4gMCl7CgkJY3VycmVudGx5X2hpZ2hsaWdodGVkX3NldC5mb3JFYWNoKGEgPT4gYS5jbGFzc0xpc3QucmVtb3ZlKCJpbi12aWV3IikpCgkJY3VycmVudGx5X2hpZ2hsaWdodGVkX3NldC5jbGVhcigpCgkJb25fdG9wLnNsaWNlKDAsMSkuZm9yRWFjaChpID0+IHsKCQkJbGV0IGRpdiA9IGhlYWRlcl90b19pbmRleF9lbnRyeV9tYXAuZ2V0KGkudGFyZ2V0KQoJCQlkaXYuY2xhc3NMaXN0LmFkZCgiaW4tdmlldyIpCgkJCWN1cnJlbnRseV9oaWdobGlnaHRlZF9zZXQuYWRkKGRpdikKCQkJCgkJCS8vLyBzY3JvbGwgaW50byB2aWV3CgkJCS8qCgkJCWNvbnN0IHRvY19oZWlnaHQgPSB0b2NOb2RlLm9mZnNldEhlaWdodAoJCQljb25zdCBkaXZfcG9zID0gZGl2Lm9mZnNldFRvcAoJCQljb25zdCBkaXZfaGVpZ2h0ID0gZGl2Lm9mZnNldEhlaWdodAoJCQljb25zdCBjdXJyZW50X3Njcm9sbCA9IHRvY05vZGUuc2Nyb2xsVG9wCgkJCWNvbnN0IGhlYWRlcl9oZWlnaHQgPSB0b2NOb2RlLnF1ZXJ5U2VsZWN0b3IoImhlYWRlciIpLm9mZnNldEhlaWdodAoJCQkKCQkJY29uc3Qgc2Nyb2xsX3RvX3RvcCA9IGRpdl9wb3MgLSBoZWFkZXJfaGVpZ2h0CgkJCWNvbnN0IHNjcm9sbF90b19ib3R0b20gPSBkaXZfcG9zICsgZGl2X2hlaWdodCAtIHRvY19oZWlnaHQKCQkJCgkJCS8vIGlmIHdlIHNldCBhIHNjcm9sbFRvcCwgdGhlbiB0aGUgYnJvd3NlciB3aWxsIHN0b3AgYW55IGN1cnJlbnRseSBvbmdvaW5nIHNtb290aHNjcm9sbCBhbmltYXRpb24uIFNvIGxldCdzIG9ubHkgZG8gdGhpcyBpZiB5b3UgYXJlIG5vdCBjdXJyZW50bHkgaW4gYSBzbW9vdGhzY3JvbGwuCgkJCWlmKERhdGUubm93KCkgLSBsYXN0X3RvY19lbGVtZW50X2NsaWNrX3RpbWUuY3VycmVudCA+PSAyMDAwKQoJCQkJaWYoY3VycmVudF9zY3JvbGwgPCBzY3JvbGxfdG9fYm90dG9tKXsKCQkJCQl0b2NOb2RlLnNjcm9sbFRvcCA9IHNjcm9sbF90b19ib3R0b20KCQkJCX0gZWxzZSBpZihjdXJyZW50X3Njcm9sbCA+IHNjcm9sbF90b190b3ApewoJCQkJCXRvY05vZGUuc2Nyb2xsVG9wID0gc2Nyb2xsX3RvX3RvcAoJCQkJfQoJCQkqLwoJCX0pCgl9Cn0KbGV0IGludGVyc2VjdGlvbl9vYnNlcnZlcl8xID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGludGVyc2VjdGlvbl9jYWxsYmFjaywgewoJcm9vdDogbnVsbCwgLy8gaS5lLiB0aGUgdmlld3BvcnQKICAJdGhyZXNob2xkOiAxLAoJcm9vdE1hcmdpbjogIi0xNXB4IiwgLy8gc2xpZ2h0bHkgc21hbGxlciB0aGFuIHRoZSB2aWV3cG9ydAoJLy8gZGVsYXk6IDEwMCwKfSkKbGV0IGludGVyc2VjdGlvbl9vYnNlcnZlcl8yID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGludGVyc2VjdGlvbl9jYWxsYmFjaywgewoJcm9vdDogbnVsbCwgLy8gaS5lLiB0aGUgdmlld3BvcnQKICAJdGhyZXNob2xkOiAxLAoJcm9vdE1hcmdpbjogIjE1cHgiLCAvLyBzbGlnaHRseSBsYXJnZXIgdGhhbiB0aGUgdmlld3BvcnQKCS8vIGRlbGF5OiAxMDAsCn0pCgpjb25zdCByZW5kZXIgPSAoZWxlbWVudHMpID0+IHsKCWhlYWRlcl90b19pbmRleF9lbnRyeV9tYXAuY2xlYXIoKQoJY3VycmVudGx5X2hpZ2hsaWdodGVkX3NldC5jbGVhcigpCglpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMS5kaXNjb25uZWN0KCkKCWludGVyc2VjdGlvbl9vYnNlcnZlcl8yLmRpc2Nvbm5lY3QoKQoKCQlsZXQgbGFzdF9sZXZlbCA9IGBIMWAKCXJldHVybiBodG1sYCR7ZWxlbWVudHMubWFwKGggPT4gewoJY29uc3QgcGFyZW50X2NlbGwgPSBnZXRQYXJlbnRDZWxsKGgpCgoJCWxldCBbY2xhc3NOYW1lLCB0aXRsZV9lbF0gPSBoLm1hdGNoZXMoYC5wbHV0by1kb2NzLWJpbmRpbmdgKSA/IFsicGx1dG8tZG9jcy1iaW5kaW5nLWVsIiwgaC5maXJzdEVsZW1lbnRDaGlsZF0gOiBbaC5ub2RlTmFtZSwgaF0KCgljb25zdCBhID0gaHRtbGA8YSAKCQljbGFzcz0iJHtjbGFzc05hbWV9IiAKCQl0aXRsZT0iJHt0aXRsZV9lbC5pbm5lclRleHR9IgoJCWhyZWY9IiMke3BhcmVudF9jZWxsLmlkfSIKCT4ke3RpdGxlX2VsLmlubmVySFRNTH08L2E+YAoJLyogYS5vbm1vdXNlb3Zlcj0oKT0+ewoJCXBhcmVudF9jZWxsLmZpcnN0RWxlbWVudENoaWxkLmNsYXNzTGlzdC5hZGQoCgkJCSdoaWdobGlnaHQtcGx1dG8tY2VsbC1zaG91bGRlcicKCQkpCgl9CglhLm9ubW91c2VvdXQ9KCkgPT4gewoJCXBhcmVudF9jZWxsLmZpcnN0RWxlbWVudENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoCgkJCSdoaWdobGlnaHQtcGx1dG8tY2VsbC1zaG91bGRlcicKCQkpCgl9ICovCgkJCgkJCglhLm9uY2xpY2s9KGUpID0+IHsKCQllLnByZXZlbnREZWZhdWx0KCk7CgkJbGFzdF90b2NfZWxlbWVudF9jbGlja190aW1lLmN1cnJlbnQgPSBEYXRlLm5vdygpCgkJc2Nyb2xsSW50b1ZpZXcoaCwgewoJCQliZWhhdmlvcjogJ3Ntb290aCcsIAoJCQlibG9jazogJ3N0YXJ0JywKCQl9KS50aGVuKCgpID0+IAoJCQkvLyBzb21ldGltZXMgaXQgZG9lc24ndCBzY3JvbGwgdG8gdGhlIHJpZ2h0IHBsYWNlCgkJCS8vIHNvbHV0aW9uOiB0cnkgYSBzZWNvbmQgdGltZSEKCQkJc2Nyb2xsSW50b1ZpZXcoaCwgewoJCQkJYmVoYXZpb3I6ICdzbW9vdGgnLCAKCQkJCWJsb2NrOiAnc3RhcnQnLAoJCQl9KQoJICAgKQoJfQoKCWNvbnN0IHJvdyA9ICBodG1sYDxkaXYgY2xhc3M9InRvYy1yb3cgJHtjbGFzc05hbWV9IGFmdGVyLSR7bGFzdF9sZXZlbH0iPiR7YX08L2Rpdj5gCgkJaW50ZXJzZWN0aW9uX29ic2VydmVyXzEub2JzZXJ2ZSh0aXRsZV9lbCkKCQlpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMi5vYnNlcnZlKHRpdGxlX2VsKQoJCWhlYWRlcl90b19pbmRleF9lbnRyeV9tYXAuc2V0KHRpdGxlX2VsLCByb3cpCgoJaWYoY2xhc3NOYW1lLnN0YXJ0c1dpdGgoIkgiKSkKCQlsYXN0X2xldmVsID0gY2xhc3NOYW1lCgkJCglyZXR1cm4gcm93Cn0pfWAKfQoKY29uc3QgaW52YWxpZGF0ZWQgPSB7IGN1cnJlbnQ6IGZhbHNlIH0KCmNvbnN0IHVwZGF0ZUNhbGxiYWNrID0gKCkgPT4gewoJaWYgKCFpbnZhbGlkYXRlZC5jdXJyZW50KSB7CgkJdG9jTm9kZS5xdWVyeVNlbGVjdG9yKCJzZWN0aW9uIikucmVwbGFjZVdpdGgoCgkJCWh0bWxgPHNlY3Rpb24+JHtyZW5kZXIoZ2V0SGVhZGVycygpKX08L3NlY3Rpb24+YAoJCSkKCX0KfQp1cGRhdGVDYWxsYmFjaygpCnNldFRpbWVvdXQodXBkYXRlQ2FsbGJhY2ssIDEwMCkKc2V0VGltZW91dCh1cGRhdGVDYWxsYmFjaywgMTAwMCkKc2V0VGltZW91dCh1cGRhdGVDYWxsYmFjaywgNTAwMCkKCmNvbnN0IG5vdGVib29rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigicGx1dG8tbm90ZWJvb2siKQoKCi8vIFdlIGhhdmUgYSBtdXRhdGlvbm9ic2VydmVyIGZvciBlYWNoIGNlbGw6CmNvbnN0IG11dF9vYnNlcnZlcnMgPSB7CgljdXJyZW50OiBbXSwKfQoKY29uc3QgY3JlYXRlQ2VsbE9ic2VydmVycyA9ICgpID0+IHsKCW11dF9vYnNlcnZlcnMuY3VycmVudC5mb3JFYWNoKChvKSA9PiBvLmRpc2Nvbm5lY3QoKSkKCW11dF9vYnNlcnZlcnMuY3VycmVudCA9IEFycmF5LmZyb20obm90ZWJvb2sucXVlcnlTZWxlY3RvckFsbCgicGx1dG8tY2VsbCIpKS5tYXAoZWwgPT4gewoJCWNvbnN0IG8gPSBuZXcgTXV0YXRpb25PYnNlcnZlcih1cGRhdGVDYWxsYmFjaykKCQlvLm9ic2VydmUoZWwsIHthdHRyaWJ1dGVGaWx0ZXI6IFsiY2xhc3MiXX0pCgkJcmV0dXJuIG8KCX0pCn0KY3JlYXRlQ2VsbE9ic2VydmVycygpCgovLyBBbmQgb25lIGZvciB0aGUgbm90ZWJvb2sncyBjaGlsZCBsaXN0LCB3aGljaCB1cGRhdGVzIG91ciBjZWxsIG9ic2VydmVyczoKY29uc3Qgbm90ZWJvb2tPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHsKCXVwZGF0ZUNhbGxiYWNrKCkKCWNyZWF0ZUNlbGxPYnNlcnZlcnMoKQp9KQpub3RlYm9va09ic2VydmVyLm9ic2VydmUobm90ZWJvb2ssIHtjaGlsZExpc3Q6IHRydWV9KQoKLy8gQW5kIGZpbmFsbHksIGFuIG9ic2VydmVyIGZvciB0aGUgZG9jdW1lbnQuYm9keSBjbGFzc0xpc3QsIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSB0b2MgYWxzbyB3b3JrcyB3aGVuIGl0IGlzIGxvYWRlZCBkdXJpbmcgbm90ZWJvb2sgaW5pdGlhbGl6YXRpb24KY29uc3QgYm9keUNsYXNzT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcih1cGRhdGVDYWxsYmFjaykKYm9keUNsYXNzT2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7YXR0cmlidXRlRmlsdGVyOiBbImNsYXNzIl19KQoKLy8gSGlkZS9zaG93IHRoZSBUb0Mgd2hlbiB0aGUgc2NyZWVuIGdldHMgc21hbGwKbGV0IG0gPSBtYXRjaE1lZGlhKCIobWF4LXdpZHRoOiAxMDAwcHgpIikKbGV0IG1hdGNoX2xpc3RlbmVyID0gKCkgPT4gCgl0b2NOb2RlLmNsYXNzTGlzdC50b2dnbGUoImhpZGUiLCBtLm1hdGNoZXMpCm1hdGNoX2xpc3RlbmVyKCkKbS5hZGRMaXN0ZW5lcihtYXRjaF9saXN0ZW5lcikKCmludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCWludmFsaWRhdGVkLmN1cnJlbnQgPSB0cnVlCglpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMS5kaXNjb25uZWN0KCkKCWludGVyc2VjdGlvbl9vYnNlcnZlcl8yLmRpc2Nvbm5lY3QoKQoJbm90ZWJvb2tPYnNlcnZlci5kaXNjb25uZWN0KCkKCWJvZHlDbGFzc09ic2VydmVyLmRpc2Nvbm5lY3QoKQoJbXV0X29ic2VydmVycy5jdXJyZW50LmZvckVhY2goKG8pID0+IG8uZGlzY29ubmVjdCgpKQoJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBkb2N1bWVudF9jbGlja19oYW5kbGVyKQoJbS5yZW1vdmVMaXN0ZW5lcihtYXRjaF9saXN0ZW5lcikKfSkKCnJldHVybiB0b2NOb2RlCjwvc2NyaXB0Pgo8c3R5bGU+CkBtZWRpYSBub3QgcHJpbnQgewoKLnBsdXRvdWktdG9jIHsKCWZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywgT3h5Z2VuLVNhbnMsIENhbnRhcmVsbCwgSGVsdmV0aWNhLCBBcmlhbCwgIkFwcGxlIENvbG9yIEVtb2ppIiwKCQkiU2Vnb2UgVUkgRW1vamkiLCAiU2Vnb2UgVUkgU3ltYm9sIiwgc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwoJLS1tYWluLWJnLWNvbG9yOiAjZmFmYWZhOwoJLS1wbHV0by1vdXRwdXQtY29sb3I6IGhzbCgwLCAwJSwgMzYlKTsKCS0tcGx1dG8tb3V0cHV0LWgtY29sb3I6IGhzbCgwLCAwJSwgMjElKTsKCS0tc2lkZWJhci1saS1hY3RpdmUtYmc6IHJnYigyMzUsIDIzNSwgMjM1KTsKCS0taWNvbi1maWx0ZXI6IHVuc2V0Owp9CgpAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CgkucGx1dG91aS10b2MgewoJCS0tbWFpbi1iZy1jb2xvcjogIzMwMzAzMDsKCQktLXBsdXRvLW91dHB1dC1jb2xvcjogaHNsKDAsIDAlLCA5MCUpOwoJCS0tcGx1dG8tb3V0cHV0LWgtY29sb3I6IGhzbCgwLCAwJSwgOTclKTsKCQktLXNpZGViYXItbGktYWN0aXZlLWJnOiByZ2IoODIsIDgyLCA4Mik7CgkJLS1pY29uLWZpbHRlcjogaW52ZXJ0KDEpOwoJfQp9CgoucGx1dG91aS10b2MuYXNpZGUgewoJY29sb3I6IHZhcigtLXBsdXRvLW91dHB1dC1jb2xvcik7Cglwb3NpdGlvbjogZml4ZWQ7CglyaWdodDogMXJlbTsKCXRvcDogNXJlbTsKCXdpZHRoOiBtaW4oODB2dywgMzAwcHgpOwoJcGFkZGluZzogMC41cmVtOwoJcGFkZGluZy10b3A6IDBlbTsKCS8qIGJvcmRlcjogM3B4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xNSk7ICovCglib3JkZXItcmFkaXVzOiAxMHB4OwoJLyogYm94LXNoYWRvdzogMCAwIDExcHggMHB4ICMwMDAwMDAxMDsgKi8KCW1heC1oZWlnaHQ6IGNhbGMoMTAwdmggLSA1cmVtIC0gOTBweCk7CglvdmVyZmxvdzogYXV0bzsKCXotaW5kZXg6IDQwOwoJYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbWFpbi1iZy1jb2xvcik7Cgl0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMzAwbXMgY3ViaWMtYmV6aWVyKDAuMTgsIDAuODksIDAuNDUsIDEuMTIpOwp9CgoucGx1dG91aS10b2MuYXNpZGUuaGlkZSB7Cgl0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoY2FsYygxMDAlIC0gMjhweCkpOwp9Ci5wbHV0b3VpLXRvYy5hc2lkZS5oaWRlIHNlY3Rpb24gewoJZGlzcGxheTogbm9uZTsKfQoucGx1dG91aS10b2MuYXNpZGUuaGlkZSBoZWFkZXIgewoJbWFyZ2luLWJvdHRvbTogMGVtOwoJcGFkZGluZy1ib3R0b206IDBlbTsKCWJvcmRlci1ib3R0b206IG5vbmU7Cn0KfSAgLyogRW5kIG9mIE1lZGlhIHByaW50IHF1ZXJ5ICovCi5wbHV0b3VpLXRvYy5hc2lkZS5oaWRlIC5vcGVuLXRvYywKLnBsdXRvdWktdG9jLmFzaWRlOm5vdCguaGlkZSkgLmNsb3NlZC10b2MsCi5wbHV0b3VpLXRvYzpub3QoLmFzaWRlKSAuY2xvc2VkLXRvYyB7CglkaXNwbGF5OiBub25lOwp9CgpAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb24pIHsKICAucGx1dG91aS10b2MuYXNpZGUgewoJdHJhbnNpdGlvbi1kdXJhdGlvbjogMHM7CiAgfQp9CgoudG9jLXRvZ2dsZSB7CgljdXJzb3I6IHBvaW50ZXI7CiAgICBwYWRkaW5nOiAxZW07CiAgICBtYXJnaW46IC0xZW07CiAgICBtYXJnaW4tcmlnaHQ6IC0wLjdlbTsKICAgIGxpbmUtaGVpZ2h0OiAxZW07CiAgICBkaXNwbGF5OiBmbGV4Owp9CgoudG9jLXRvZ2dsZTo6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICIiOwogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgaGVpZ2h0OiAxZW07CiAgICB3aWR0aDogMWVtOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2xpc3Qtb3V0bGluZS5zdmciKTsKCS8qIGdlbmVyYXRlZCB1c2luZyBodHRwczovL2RvcGlhemEub3JnL3Rvb2xzL2RhdGF1cmkvaW5kZXgucGhwICovCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJMU1USWlJR2hsYVdkb2REMGlOVEV5SWlCMmFXVjNRbTk0UFNJd0lEQWdOVEV5SURVeE1pSStQSFJwZEd4bFBtbHZibWxqYjI1ekxYWTFMVzg4TDNScGRHeGxQanhzYVc1bElIZ3hQU0l4TmpBaUlIa3hQU0l4TkRRaUlIZ3lQU0kwTkRnaUlIa3lQU0l4TkRRaUlITjBlV3hsUFNKbWFXeHNPbTV2Ym1VN2MzUnliMnRsT2lNd01EQTdjM1J5YjJ0bExXeHBibVZqWVhBNmNtOTFibVE3YzNSeWIydGxMV3hwYm1WcWIybHVPbkp2ZFc1a08zTjBjbTlyWlMxM2FXUjBhRG96TW5CNElpOCtQR3hwYm1VZ2VERTlJakUyTUNJZ2VURTlJakkxTmlJZ2VESTlJalEwT0NJZ2VUSTlJakkxTmlJZ2MzUjViR1U5SW1acGJHdzZibTl1WlR0emRISnZhMlU2SXpBd01EdHpkSEp2YTJVdGJHbHVaV05oY0RweWIzVnVaRHR6ZEhKdmEyVXRiR2x1WldwdmFXNDZjbTkxYm1RN2MzUnliMnRsTFhkcFpIUm9Pak15Y0hnaUx6NDhiR2x1WlNCNE1UMGlNVFl3SWlCNU1UMGlNelk0SWlCNE1qMGlORFE0SWlCNU1qMGlNelk0SWlCemRIbHNaVDBpWm1sc2JEcHViMjVsTzNOMGNtOXJaVG9qTURBd08zTjBjbTlyWlMxc2FXNWxZMkZ3T25KdmRXNWtPM04wY205clpTMXNhVzVsYW05cGJqcHliM1Z1WkR0emRISnZhMlV0ZDJsa2RHZzZNekp3ZUNJdlBqeGphWEpqYkdVZ1kzZzlJamd3SWlCamVUMGlNVFEwSWlCeVBTSXhOaUlnYzNSNWJHVTlJbVpwYkd3NmJtOXVaVHR6ZEhKdmEyVTZJekF3TUR0emRISnZhMlV0YkdsdVpXTmhjRHB5YjNWdVpEdHpkSEp2YTJVdGJHbHVaV3B2YVc0NmNtOTFibVE3YzNSeWIydGxMWGRwWkhSb09qTXljSGdpTHo0OFkybHlZMnhsSUdONFBTSTRNQ0lnWTNrOUlqSTFOaUlnY2owaU1UWWlJSE4wZVd4bFBTSm1hV3hzT201dmJtVTdjM1J5YjJ0bE9pTXdNREE3YzNSeWIydGxMV3hwYm1WallYQTZjbTkxYm1RN2MzUnliMnRsTFd4cGJtVnFiMmx1T25KdmRXNWtPM04wY205clpTMTNhV1IwYURvek1uQjRJaTgrUEdOcGNtTnNaU0JqZUQwaU9EQWlJR041UFNJek5qZ2lJSEk5SWpFMklpQnpkSGxzWlQwaVptbHNiRHB1YjI1bE8zTjBjbTlyWlRvak1EQXdPM04wY205clpTMXNhVzVsWTJGd09uSnZkVzVrTzNOMGNtOXJaUzFzYVc1bGFtOXBianB5YjNWdVpEdHpkSEp2YTJVdGQybGtkR2c2TXpKd2VDSXZQand2YzNablBnPT0iKTsKICAgIGJhY2tncm91bmQtc2l6ZTogMWVtOwoJZmlsdGVyOiB2YXIoLS1pY29uLWZpbHRlcik7Cn0KCi5hc2lkZSAudG9jLXRvZ2dsZS5vcGVuLXRvYzpob3Zlcjo6YmVmb3JlIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9hcnJvdy1mb3J3YXJkLW91dGxpbmUuc3ZnIik7CgkvKiBnZW5lcmF0ZWQgdXNpbmcgaHR0cHM6Ly9kb3BpYXphLm9yZy90b29scy9kYXRhdXJpL2luZGV4LnBocCAqLwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSTFNVElpSUdobGFXZG9kRDBpTlRFeUlpQjJhV1YzUW05NFBTSXdJREFnTlRFeUlEVXhNaUkrUEhScGRHeGxQbWx2Ym1samIyNXpMWFkxTFdFOEwzUnBkR3hsUGp4d2IyeDViR2x1WlNCd2IybHVkSE05SWpJMk9DQXhNVElnTkRFeUlESTFOaUF5TmpnZ05EQXdJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxPM04wY205clpUb2pNREF3TzNOMGNtOXJaUzFzYVc1bFkyRndPbkp2ZFc1a08zTjBjbTlyWlMxc2FXNWxhbTlwYmpweWIzVnVaRHR6ZEhKdmEyVXRkMmxrZEdnNk5EaHdlQ0l2UGp4c2FXNWxJSGd4UFNJek9USWlJSGt4UFNJeU5UWWlJSGd5UFNJeE1EQWlJSGt5UFNJeU5UWWlJSE4wZVd4bFBTSm1hV3hzT201dmJtVTdjM1J5YjJ0bE9pTXdNREE3YzNSeWIydGxMV3hwYm1WallYQTZjbTkxYm1RN2MzUnliMnRsTFd4cGJtVnFiMmx1T25KdmRXNWtPM04wY205clpTMTNhV1IwYURvME9IQjRJaTgrUEM5emRtYysiKTsKfQouYXNpZGUgLnRvYy10b2dnbGUuY2xvc2VkLXRvYzpob3Zlcjo6YmVmb3JlIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9hcnJvdy1iYWNrLW91dGxpbmUuc3ZnIik7CgkvKiBnZW5lcmF0ZWQgdXNpbmcgaHR0cHM6Ly9kb3BpYXphLm9yZy90b29scy9kYXRhdXJpL2luZGV4LnBocCAqLwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSTFNVElpSUdobGFXZG9kRDBpTlRFeUlpQjJhV1YzUW05NFBTSXdJREFnTlRFeUlEVXhNaUkrUEhScGRHeGxQbWx2Ym1samIyNXpMWFkxTFdFOEwzUnBkR3hsUGp4d2IyeDViR2x1WlNCd2IybHVkSE05SWpJME5DQTBNREFnTVRBd0lESTFOaUF5TkRRZ01URXlJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxPM04wY205clpUb2pNREF3TzNOMGNtOXJaUzFzYVc1bFkyRndPbkp2ZFc1a08zTjBjbTlyWlMxc2FXNWxhbTlwYmpweWIzVnVaRHR6ZEhKdmEyVXRkMmxrZEdnNk5EaHdlQ0l2UGp4c2FXNWxJSGd4UFNJeE1qQWlJSGt4UFNJeU5UWWlJSGd5UFNJME1USWlJSGt5UFNJeU5UWWlJSE4wZVd4bFBTSm1hV3hzT201dmJtVTdjM1J5YjJ0bE9pTXdNREE3YzNSeWIydGxMV3hwYm1WallYQTZjbTkxYm1RN2MzUnliMnRsTFd4cGJtVnFiMmx1T25KdmRXNWtPM04wY205clpTMTNhV1IwYURvME9IQjRJaTgrUEM5emRtYysiKTsKfQoKCgoucGx1dG91aS10b2MgaGVhZGVyIHsKCWRpc3BsYXk6IGZsZXg7CglhbGlnbi1pdGVtczogY2VudGVyOwoJZ2FwOiAuM2VtOwoJZm9udC1zaXplOiAxLjVlbTsKCS8qIG1hcmdpbi10b3A6IC0wLjFlbTsgKi8KCW1hcmdpbi1ib3R0b206IDAuNGVtOwoJcGFkZGluZzogMC41cmVtOwoJbWFyZ2luLWxlZnQ6IDA7CgltYXJnaW4tcmlnaHQ6IDA7Cglmb250LXdlaWdodDogYm9sZDsKCS8qIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMTUpOyAqLwoJcG9zaXRpb246IHN0aWNreTsKCXRvcDogMHB4OwoJYmFja2dyb3VuZDogdmFyKC0tbWFpbi1iZy1jb2xvcik7Cgl6LWluZGV4OiA0MTsKfQoucGx1dG91aS10b2MuYXNpZGUgaGVhZGVyIHsKCXBhZGRpbmctbGVmdDogMDsKCXBhZGRpbmctcmlnaHQ6IDA7Cn0KCi5wbHV0b3VpLXRvYyBzZWN0aW9uIC50b2Mtcm93IHsKCXdoaXRlLXNwYWNlOiBub3dyYXA7CglvdmVyZmxvdzogaGlkZGVuOwoJdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CglwYWRkaW5nOiAuMWVtOwoJYm9yZGVyLXJhZGl1czogLjJlbTsKfQoKLnBsdXRvdWktdG9jIHNlY3Rpb24gLnRvYy1yb3cuSDEgewoJbWFyZ2luLXRvcDogMWVtOwp9CgoKLnBsdXRvdWktdG9jLmFzaWRlIHNlY3Rpb24gLnRvYy1yb3cuaW4tdmlldyB7CgliYWNrZ3JvdW5kOiB2YXIoLS1zaWRlYmFyLWxpLWFjdGl2ZS1iZyk7Cn0KCgoJCi5oaWdobGlnaHQtcGx1dG8tY2VsbC1zaG91bGRlciB7CgliYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOwoJYmFja2dyb3VuZC1jbGlwOiBwYWRkaW5nLWJveDsKfQoKLnBsdXRvdWktdG9jIHNlY3Rpb24gYSB7Cgl0ZXh0LWRlY29yYXRpb246IG5vbmU7Cglmb250LXdlaWdodDogbm9ybWFsOwoJY29sb3I6IHZhcigtLXBsdXRvLW91dHB1dC1jb2xvcik7Cn0KLnBsdXRvdWktdG9jIHNlY3Rpb24gYTpob3ZlciB7Cgljb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWgtY29sb3IpOwp9CgoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5IMSB7Cglmb250LXdlaWdodDogNzAwOwoJbGluZS1oZWlnaHQ6IDFlbTsKfQoKLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIC5hZnRlci1IMiBhIHsgcGFkZGluZy1sZWZ0OiAxMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiAuYWZ0ZXItSDMgYSB7IHBhZGRpbmctbGVmdDogMjBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gLmFmdGVyLUg0IGEgeyBwYWRkaW5nLWxlZnQ6IDMwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIC5hZnRlci1INSBhIHsgcGFkZGluZy1sZWZ0OiA0MHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiAuYWZ0ZXItSDYgYSB7IHBhZGRpbmctbGVmdDogNTBweDsgfQoKLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuSDEgeyBwYWRkaW5nLWxlZnQ6IDBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5IMiB7IHBhZGRpbmctbGVmdDogMTBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5IMyB7IHBhZGRpbmctbGVmdDogMjBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5INCB7IHBhZGRpbmctbGVmdDogMzBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5INSB7IHBhZGRpbmctbGVmdDogNDBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5INiB7IHBhZGRpbmctbGVmdDogNTBweDsgfQoKCi5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLnBsdXRvLWRvY3MtYmluZGluZy1lbCwKLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuQVNTSUdORUUKCXsKCWZvbnQtZmFtaWx5OiBKdWxpYU1vbm8sIG1vbm9zcGFjZTsKCWZvbnQtc2l6ZTogLjhlbTsKCS8qIGJhY2tncm91bmQ6IGJsYWNrOyAqLwoJZm9udC13ZWlnaHQ6IDcwMDsKICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsKCWNvbG9yOiB2YXIoLS1jbS12YXItY29sb3IpOyAvKiB0aGlzIGlzIHN0ZWFsaW5nIGEgdmFyaWFibGUgZnJvbSBQbHV0bywgYnV0IGl0J3MgZmluZSBpZiB0aGF0IGRvZXNudCB3b3JrICovCn0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEucGx1dG8tZG9jcy1iaW5kaW5nLWVsOjpiZWZvcmUsCi5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkFTU0lHTkVFOjpiZWZvcmUKCXsKCWNvbnRlbnQ6ICI+ICI7CglvcGFjaXR5OiAuMzsKfQo8L3N0eWxlPgoKPHNjcmlwdCBpZD0nM2VoeUtKJz4KICAgIAoJLyogIyMjIyBCRUdJTk5JTkcgT0YgUEFSVCBBVVRPTUFUSUNBTExZIEFEREVEIEJZIEhUTFNDUklQVCAjIyMjICovCgkvLyBBcnJheSB3aGVyZSBhbGwgdGhlIGV2ZW50IGxpc3RlbmVycyBhcmUgc3RvcmVkCgljb25zdCBfZXZlbnRzX2xpc3RlbmVyc18gPSBbXQoKCS8vIEZ1bmN0aW9uIHRoYXQgY2FuIGJlIGNhbGxlZCB0byBhZGQgZXZlbnRzIGxpc3RlbmVycyB3aXRoaW4gdGhlIHNjcmlwdAoJZnVuY3Rpb24gYWRkU2NyaXB0RXZlbnRMaXN0ZW5lcnMoZWxlbWVudCwgbGlzdGVuZXJzKSB7CgkJaWYgKGxpc3RlbmVycy5jb25zdHJ1Y3RvciAhPSBPYmplY3QpIHtlcnJvcignT25seSBvYmplY3RzIHdpdGgga2V5cyBhcyBldmVudCBuYW1lcyBhbmQgdmFsdWVzIGFzIGxpc3RlbmVyIGZ1bmN0aW9ucyBhcmUgc3VwcG9ydGVkJyl9CgkJX2V2ZW50c19saXN0ZW5lcnNfLnB1c2goe2VsZW1lbnQsIGxpc3RlbmVyc30pCgl9CgkvKiAjIyMjIEVORCBPRiBQQVJUIEFVVE9NQVRJQ0FMTFkgQURERUQgQlkgSFRMU0NSSVBUICMjIyMgKi8KY29uc3QgaGlkZV9wcmVhbWJsZSA9IHRydWUKY29uc3QgZm9yY2VfaGlkZV9lbmFibGVkID0gdHJ1ZQoKLy8gTG9hZCB0aGUgbGlicmFyeSBmb3IgY29uc2lzdGVudCBzbW9vdGggc2Nyb2xsaW5nCmNvbnN0IHtkZWZhdWx0OiBzY3JvbGxJbnRvVmlld30gPSBhd2FpdCBpbXBvcnQoImRhdGE6dGV4dC9qYXZhc2NyaXB0O2Jhc2U2NCxkbUZ5SUZFOVpUMCtJbTlpYW1WamRDSTlQWFI1Y0dWdlppQmxKaVp1ZFd4c0lUMWxKaVl4UFQwOVpTNXViMlJsVkhsd1pTeFZQU2hsTEhRcFBUNG9JWFI4ZkNKb2FXUmtaVzRpSVQwOVpTa21KaUoyYVhOcFlteGxJaUU5UFdVbUppSmpiR2x3SWlFOVBXVXNRVDBvWlN4MEtUMCtlMmxtS0dVdVkyeHBaVzUwU0dWcFoyaDBQR1V1YzJOeWIyeHNTR1ZwWjJoMGZIeGxMbU5zYVdWdWRGZHBaSFJvUEdVdWMyTnliMnhzVjJsa2RHZ3BlMnhsZENCc1BXZGxkRU52YlhCMWRHVmtVM1I1YkdVb1pTeHVkV3hzS1R0eVpYUjFjbTRnVlNoc0xtOTJaWEptYkc5M1dTeDBLWHg4VlNoc0xtOTJaWEptYkc5M1dDeDBLWHg4S0dVOVBudHNaWFFnZEQwb1pUMCtlMmxtS0NGbExtOTNibVZ5Ukc5amRXMWxiblI4ZkNGbExtOTNibVZ5Ukc5amRXMWxiblF1WkdWbVlYVnNkRlpwWlhjcGNtVjBkWEp1SUc1MWJHdzdkSEo1ZTNKbGRIVnliaUJsTG05M2JtVnlSRzlqZFcxbGJuUXVaR1ZtWVhWc2RGWnBaWGN1Wm5KaGJXVkZiR1Z0Wlc1MGZXTmhkR05vZTNKbGRIVnliaUJ1ZFd4c2ZYMHBLR1VwTzNKbGRIVnliaUVoZENZbUtIUXVZMnhwWlc1MFNHVnBaMmgwUEdVdWMyTnliMnhzU0dWcFoyaDBmSHgwTG1Oc2FXVnVkRmRwWkhSb1BHVXVjMk55YjJ4c1YybGtkR2dwZlNrb1pTbDljbVYwZFhKdUlURjlMRmc5S0dVc2RDeHNMRzhzYml4eUxHa3NjeWs5UG5JOFpTWW1hVDUwZkh4eVBtVW1KbWs4ZEQ4d09uSThQV1VtSm5NOFBXeDhmR2srUFhRbUpuTStQV3cvY2kxbExXODZhVDUwSmlaelBHeDhmSEk4WlNZbWN6NXNQMmt0ZEN0dU9qQXNKRDFsUFQ1bExuQmhjbVZ1ZEVWc1pXMWxiblEvUHlobExtZGxkRkp2YjNST2IyUmxLQ2t1YUc5emRIeDhiblZzYkNrc2RIUTlLR1VzZENrOVBudDJZWElnYkN4dkxHNHNjanRwWmloMGVYQmxiMllnWkc5amRXMWxiblErSW5VaUtYSmxkSFZ5Ymx0ZE8yeGxkSHR6WTNKdmJHeE5iMlJsT21rc1lteHZZMnM2Y3l4cGJteHBibVU2WVN4aWIzVnVaR0Z5ZVRwb0xITnJhWEJQZG1WeVpteHZkMGhwWkdSbGJrVnNaVzFsYm5Sek9uVjlQWFFzWnowaVpuVnVZM1JwYjI0aVBUMTBlWEJsYjJZZ2FEOW9PbVU5UG1VaFBUMW9PMmxtS0NGUktHVXBLWFJvY205M0lGUjVjR1ZGY25KdmNpZ2lTVzUyWVd4cFpDQjBZWEpuWlhRaUtUdHNaWFFnZGoxa2IyTjFiV1Z1ZEM1elkzSnZiR3hwYm1kRmJHVnRaVzUwZkh4a2IyTjFiV1Z1ZEM1a2IyTjFiV1Z1ZEVWc1pXMWxiblFzYlQxYlhTeDNQV1U3Wm05eUtEdFJLSGNwSmlabktIY3BPeWw3YVdZb0tIYzlKQ2gzS1NrOVBUMTJLWHR0TG5CMWMyZ29keWs3WW5KbFlXdDliblZzYkNFOWR5WW1kejA5UFdSdlkzVnRaVzUwTG1KdlpIa21Ka0VvZHlrbUppRkJLR1J2WTNWdFpXNTBMbVJ2WTNWdFpXNTBSV3hsYldWdWRDbDhmRzUxYkd3aFBYY21Ka0VvZHl4MUtTWW1iUzV3ZFhOb0tIY3BmV3hsZENCWFBXNTFiR3doUFNodlBXNTFiR3c5UFNoc1BYZHBibVJ2ZHk1MmFYTjFZV3hXYVdWM2NHOXlkQ2svZG05cFpDQXdPbXd1ZDJsa2RHZ3BQMjg2YVc1dVpYSlhhV1IwYUN4SVBXNTFiR3doUFNoeVBXNTFiR3c5UFNodVBYZHBibVJ2ZHk1MmFYTjFZV3hXYVdWM2NHOXlkQ2svZG05cFpDQXdPbTR1YUdWcFoyaDBLVDl5T21sdWJtVnlTR1ZwWjJoMExIdHpZM0p2Ykd4WU9sOHNjMk55YjJ4c1dUcDRmVDEzYVc1a2IzY3NlMmhsYVdkb2REcEZMSGRwWkhSb09sUXNkRzl3T2s0c2NtbG5hSFE2VEN4aWIzUjBiMjA2V1N4c1pXWjBPa045UFdVdVoyVjBRbTkxYm1ScGJtZERiR2xsYm5SU1pXTjBLQ2tzVWowaWMzUmhjblFpUFQwOWMzeDhJbTVsWVhKbGMzUWlQVDA5Y3o5T09pSmxibVFpUFQwOWN6OVpPazRyUlM4eUxGWTlJbU5sYm5SbGNpSTlQVDFoUDBNclZDOHlPaUpsYm1RaVBUMDlZVDlNT2tNc1FqMWJYVHRtYjNJb2JHVjBJRVE5TUR0RVBHMHViR1Z1WjNSb08wUXJLeWw3YkdWMElFODliVnRFWFN4N2FHVnBaMmgwT21vc2QybGtkR2c2U1N4MGIzQTZVeXh5YVdkb2REcHhMR0p2ZEhSdmJUcDZMR3hsWm5RNlJuMDlUeTVuWlhSQ2IzVnVaR2x1WjBOc2FXVnVkRkpsWTNRb0tUdHBaaWdpYVdZdGJtVmxaR1ZrSWowOVBXa21KazQrUFRBbUprTStQVEFtSmxrOFBVZ21Ka3c4UFZjbUprNCtQVk1tSmxrOFBYb21Ka00rUFVZbUprdzhQWEVwWW5KbFlXczdiR1YwSUVjOVoyVjBRMjl0Y0hWMFpXUlRkSGxzWlNoUEtTeEtQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlUR1ZtZEZkcFpIUm9MREV3S1N4TFBYQmhjbk5sU1c1MEtFY3VZbTl5WkdWeVZHOXdWMmxrZEdnc01UQXBMRkE5Y0dGeWMyVkpiblFvUnk1aWIzSmtaWEpTYVdkb2RGZHBaSFJvTERFd0tTeGFQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlRbTkwZEc5dFYybGtkR2dzTVRBcExHVmxQVEFzWlhROU1DeGxiRDBpYjJabWMyVjBWMmxrZEdnaWFXNGdUejlQTG05bVpuTmxkRmRwWkhSb0xVOHVZMnhwWlc1MFYybGtkR2d0U2kxUU9qQXNaVzg5SW05bVpuTmxkRWhsYVdkb2RDSnBiaUJQUDA4dWIyWm1jMlYwU0dWcFoyaDBMVTh1WTJ4cFpXNTBTR1ZwWjJoMExVc3RXam93TEdWdVBTSnZabVp6WlhSWGFXUjBhQ0pwYmlCUFB6QTlQVDFQTG05bVpuTmxkRmRwWkhSb1B6QTZTUzlQTG05bVpuTmxkRmRwWkhSb09qQXNaWEk5SW05bVpuTmxkRWhsYVdkb2RDSnBiaUJQUHpBOVBUMVBMbTltWm5ObGRFaGxhV2RvZEQ4d09tb3ZUeTV2Wm1aelpYUklaV2xuYUhRNk1EdHBaaWgyUFQwOVR5bGxaVDBpYzNSaGNuUWlQVDA5Y3o5U09pSmxibVFpUFQwOWN6OVNMVWc2SW01bFlYSmxjM1FpUFQwOWN6OVlLSGdzZUN0SUxFZ3NTeXhhTEhnclVpeDRLMUlyUlN4RktUcFNMVWd2TWl4bGREMGljM1JoY25RaVBUMDlZVDlXT2lKalpXNTBaWElpUFQwOVlUOVdMVmN2TWpvaVpXNWtJajA5UFdFL1ZpMVhPbGdvWHl4ZksxY3NWeXhLTEZBc1h5dFdMRjhyVml0VUxGUXBMR1ZsUFUxaGRHZ3ViV0Y0S0RBc1pXVXJlQ2tzWlhROVRXRjBhQzV0WVhnb01DeGxkQ3RmS1R0bGJITmxlMlZsUFNKemRHRnlkQ0k5UFQxelAxSXRVeTFMT2lKbGJtUWlQVDA5Y3o5U0xYb3JXaXRsYnpvaWJtVmhjbVZ6ZENJOVBUMXpQMWdvVXl4NkxHb3NTeXhhSzJWdkxGSXNVaXRGTEVVcE9sSXRLRk1yYWk4eUtTdGxieTh5TEdWMFBTSnpkR0Z5ZENJOVBUMWhQMVl0UmkxS09pSmpaVzUwWlhJaVBUMDlZVDlXTFNoR0swa3ZNaWtyWld3dk1qb2laVzVrSWowOVBXRS9WaTF4SzFBclpXdzZXQ2hHTEhFc1NTeEtMRkFyWld3c1ZpeFdLMVFzVkNrN2JHVjBlM05qY205c2JFeGxablE2Wldrc2MyTnliMnhzVkc5d09tVmtmVDFQTzJWbFBVMWhkR2d1YldGNEtEQXNUV0YwYUM1dGFXNG9aV1FyWldVdlpYSXNUeTV6WTNKdmJHeElaV2xuYUhRdGFpOWxjaXRsYnlrcExHVjBQVTFoZEdndWJXRjRLREFzVFdGMGFDNXRhVzRvWldrclpYUXZaVzRzVHk1elkzSnZiR3hYYVdSMGFDMUpMMlZ1SzJWc0tTa3NVaXM5WldRdFpXVXNWaXM5WldrdFpYUjlRaTV3ZFhOb0tIdGxiRHBQTEhSdmNEcGxaU3hzWldaME9tVjBmU2w5Y21WMGRYSnVJRUo5TEdZOVpUMCtlM1poY2lCME8zSmxkSFZ5YmlFeFBUMDlaVDk3WW14dlkyczZJbVZ1WkNJc2FXNXNhVzVsT2lKdVpXRnlaWE4wSW4wNktIUTlaU2s5UFQxUFltcGxZM1FvZENrbUpqQWhQVDFQWW1wbFkzUXVhMlY1Y3loMEtTNXNaVzVuZEdnL1pUcDdZbXh2WTJzNkluTjBZWEowSWl4cGJteHBibVU2SW01bFlYSmxjM1FpZlgwN1puVnVZM1JwYjI0Z1l5aGxMSFFwZTNaaGNpQnNPMmxtS0NGbExtbHpRMjl1Ym1WamRHVmtmSHdoS0dVOVBudHNaWFFnZEQxbE8yWnZjaWc3ZENZbWRDNXdZWEpsYm5ST2IyUmxPeWw3YVdZb2RDNXdZWEpsYm5ST2IyUmxQVDA5Wkc5amRXMWxiblFwY21WMGRYSnVJVEE3ZEQxMExuQmhjbVZ1ZEU1dlpHVWdhVzV6ZEdGdVkyVnZaaUJUYUdGa2IzZFNiMjkwUDNRdWNHRnlaVzUwVG05a1pTNW9iM04wT25RdWNHRnlaVzUwVG05a1pYMXlaWFIxY200aE1YMHBLR1VwS1hKbGRIVnlianRwWmlnaWIySnFaV04wSWowOWRIbHdaVzltS0d3OWRDa21KaUptZFc1amRHbHZiaUk5UFhSNWNHVnZaaUJzTG1KbGFHRjJhVzl5S1hKbGRIVnliaUIwTG1KbGFHRjJhVzl5S0hSMEtHVXNkQ2twTzJ4bGRDQnZQU0ppYjI5c1pXRnVJajA5ZEhsd1pXOW1JSFI4Zkc1MWJHdzlQWFEvZG05cFpDQXdPblF1WW1Wb1lYWnBiM0k3Wm05eUtHeGxkSHRsYkRwdUxIUnZjRHB5TEd4bFpuUTZhWDF2WmlCMGRDaGxMR1lvZENrcEtXNHVjMk55YjJ4c0tIdDBiM0E2Y2l4c1pXWjBPbWtzWW1Wb1lYWnBiM0k2YjMwcGZYWmhjaUJrTEhBOUtDazlQaWhrZkh3b1pEMGljR1Z5Wm05eWJXRnVZMlVpYVc0Z2QybHVaRzkzUDNCbGNtWnZjbTFoYm1ObExtNXZkeTVpYVc1a0tIQmxjbVp2Y20xaGJtTmxLVHBFWVhSbExtNXZkeWtzWkNncEtUdG1kVzVqZEdsdmJpQmlLR1VwZTJ4bGRDQjBQVTFoZEdndWJXbHVLQ2h3S0NrdFpTNXpkR0Z5ZEZScGJXVXBMMlV1WkhWeVlYUnBiMjRzTVNrc2JEMWxMbVZoYzJVb2RDa3NiejFsTG5OMFlYSjBXQ3NvWlM1NExXVXVjM1JoY25SWUtTcHNMRzQ5WlM1emRHRnlkRmtyS0dVdWVTMWxMbk4wWVhKMFdTa3FiRHRsTG0xbGRHaHZaQ2h2TEc0c2RDeHNLU3h2SVQwOVpTNTRmSHh1SVQwOVpTNTVQM0psY1hWbGMzUkJibWx0WVhScGIyNUdjbUZ0WlNnb0tUMCtZaWhsS1NrNlpTNWpZaWdwZldaMWJtTjBhVzl1SUhrb1pTeDBMR3dwZTJ4bGRDQnZQV0Z5WjNWdFpXNTBjeTVzWlc1bmRHZytNeVltZG05cFpDQXdJVDA5WVhKbmRXMWxiblJ6V3pOZFAyRnlaM1Z0Wlc1MGMxc3pYVG8yTURBc2JqMWhjbWQxYldWdWRITXViR1Z1WjNSb1BqUW1Kblp2YVdRZ01DRTlQV0Z5WjNWdFpXNTBjMXMwWFQ5aGNtZDFiV1Z1ZEhOYk5GMDZaVDArTVNzdExXVXFaU3BsS21VcVpTeHlQV0Z5WjNWdFpXNTBjeTVzWlc1bmRHZytOVDloY21kMWJXVnVkSE5iTlYwNmRtOXBaQ0F3TEdrOVlYSm5kVzFsYm5SekxteGxibWQwYUQ0MlAyRnlaM1Z0Wlc1MGMxczJYVHAyYjJsa0lEQXNjejFsTG5OamNtOXNiRXhsWm5Rc1lUMWxMbk5qY205c2JGUnZjRHRpS0h0elkzSnZiR3hoWW14bE9tVXNiV1YwYUc5a0tIUXNiQ3h2TEc0cGUyeGxkQ0J5UFUxaGRHZ3VZMlZwYkNoMEtTeHpQVTFoZEdndVkyVnBiQ2hzS1R0bExuTmpjbTlzYkV4bFpuUTljaXhsTG5OamNtOXNiRlJ2Y0QxekxHay9MaWg3ZEdGeVoyVjBPbVVzWld4aGNITmxaRHB2TEhaaGJIVmxPbTRzYkdWbWREcHlMSFJ2Y0RwemZTbDlMSE4wWVhKMFZHbHRaVHB3S0Nrc2MzUmhjblJZT25Nc2MzUmhjblJaT21Fc2VEcDBMSGs2YkN4a2RYSmhkR2x2YmpwdkxHVmhjMlU2Yml4allqcHlmU2w5ZG1GeUlFMDlaVDArWlNZbUlXVXVZbVZvWVhacGIzSjhmQ0p6Ylc5dmRHZ2lQVDA5WlM1aVpXaGhkbWx2Y2l4clBXWjFibU4wYVc5dUtHVXNkQ2w3YkdWMElHdzlkSHg4ZTMwN2NtVjBkWEp1SUUwb2JDay9ZeWhsTEh0aWJHOWphenBzTG1Kc2IyTnJMR2x1YkdsdVpUcHNMbWx1YkdsdVpTeHpZM0p2Ykd4TmIyUmxPbXd1YzJOeWIyeHNUVzlrWlN4aWIzVnVaR0Z5ZVRwc0xtSnZkVzVrWVhKNUxITnJhWEJQZG1WeVpteHZkMGhwWkdSbGJrVnNaVzFsYm5Sek9td3VjMnRwY0U5MlpYSm1iRzkzU0dsa1pHVnVSV3hsYldWdWRITXNZbVZvWVhacGIzSTZaVDArVUhKdmJXbHpaUzVoYkd3b1pTNXlaV1IxWTJVb0tHVXNkQ2s5UG50c1pYUjdaV3c2Ynl4c1pXWjBPbTRzZEc5d09uSjlQWFFzYVQxdkxuTmpjbTlzYkV4bFpuUXNjejF2TG5OamNtOXNiRlJ2Y0R0eVpYUjFjbTRnYVQwOVBXNG1Kbk05UFQxeVAyVTZXeTR1TG1Vc2JtVjNJRkJ5YjIxcGMyVW9aVDArZVNodkxHNHNjaXhzTG1SMWNtRjBhVzl1TEd3dVpXRnpaU3dvS1QwK1pTaDdaV3c2Ynl4c1pXWjBPbHRwTEc1ZExIUnZjRHBiY3l4eVhYMHBMR3d1YjI1VFkzSnZiR3hEYUdGdVoyVXBLVjE5TEZ0ZEtTbDlLVHBRY205dGFYTmxMbkpsYzI5c2RtVW9ZeWhsTEhRcEtYMDdaWGh3YjNKMGUyc2dZWE1nWkdWbVlYVnNkSDA3IikKCmZ1bmN0aW9uIHNjcm9sbF90byhoLCBjb25maWcgPSB7CgkJCWJlaGF2aW9yOiAnc21vb3RoJywgCgkJCWJsb2NrOiAnc3RhcnQnLAoJCX0pIHsKCXNjcm9sbEludG9WaWV3KGgsIGNvbmZpZykudGhlbigoKSA9PiAKCQkJLy8gc29tZXRpbWVzIGl0IGRvZXNuJ3Qgc2Nyb2xsIHRvIHRoZSByaWdodCBwbGFjZQoJCQkvLyBzb2x1dGlvbjogdHJ5IGEgc2Vjb25kIHRpbWUhCgkJCXNjcm9sbEludG9WaWV3KGgsIGNvbmZpZykKCSAgICkKCX0KCgpsZXQgY2VsbCA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgncGx1dG8tY2VsbCcpCmxldCBwbHV0b19hY3Rpb25zID0gY2VsbC5faW50ZXJuYWxfcGx1dG9fYWN0aW9ucwpsZXQgdG9jID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbmF2LnBsdXRvdWktdG9jJykKCmZ1bmN0aW9uIGdldFJvdyhlbCkgewoJY29uc3Qgcm93ID0gZWw/LmNsb3Nlc3QoJy50b2Mtcm93JykKCXJldHVybiByb3cKfQoJCmZ1bmN0aW9uIGdldF9saW5rX2lkKGVsKSB7Cgljb25zdCByb3cgPSBnZXRSb3coZWwpCglpZiAoXy5pc05pbChyb3cpKSB7IHJldHVybiBudWxsIH0KCWNvbnN0IGEgPSByb3cucXVlcnlTZWxlY3RvcignYScpCglyZXR1cm4gYS5ocmVmLnNsaWNlKC0zNikgLy8gZXh0cmFjdCB0aGUgbGFzdCAzNiBjaGFyYWN0ZXJzLCBjb3JyZXNwb25kaW5nIHRvIHRoZSBjZWxsIGlkCn0KCmZ1bmN0aW9uIGdldEhlYWRpbmdMZXZlbChyb3cpIHsKCWNvbnN0IGEgPSByb3cucXVlcnlTZWxlY3RvcignYScpCgkvLyBXZSByZXR1cm4gdGhlIGxpbmsgY2xhc3Mgd2l0aG91dCB0aGUgZmlyc3QgSAoJcmV0dXJuIE51bWJlcihhLmNsYXNzTGlzdFswXS5zbGljZSgxKSkKfQoKZnVuY3Rpb24gZ2VuZXJhdGVDaGVja2VyKHNlbGVjdG9yKSB7Cglzd2l0Y2ggKHR5cGVvZiBzZWxlY3RvcikgewoJCWNhc2UgJ3N0cmluZyc6CgkJCWNvbnN0IGZ1bmMgPSBlbCA9PiB7CgkJCQlyZXR1cm4gZWwubWF0Y2hlcyhzZWxlY3RvcikKCQkJfQoJCQlyZXR1cm4gZnVuYwoJCWNhc2UgJ2Z1bmN0aW9uJzoKCQkJcmV0dXJuIHNlbGVjdG9yCgkJZGVmYXVsdDoKCQkJY29uc29sZS5lcnJvcihgVGhlIHR5cGUgKCR7dHlwZW9mIHNlbGVjdG9yfSkgb2YgdGhlIHByb3ZpZGVkIGFyZ3VtZW50IGlzIG5vdCB2YWxpZGApCgl9Cn0KCi8vIEdldCBuZXh0IGFuZCBwcmV2aW91cyBzaWJsaW5nLCBhZGFwdGVkIGZyb206Ci8vIGh0dHBzOi8vZ29tYWtldGhpbmdzLmNvbS9maW5kaW5nLXRoZS1uZXh0LWFuZC1wcmV2aW91cy1zaWJsaW5nLWVsZW1lbnRzLXRoYXQtbWF0Y2gtYS1zZWxlY3Rvci13aXRoLXZhbmlsbGEtanMvCnZhciBnZXROZXh0U2libGluZyA9IGZ1bmN0aW9uIChlbGVtLCBzZWxlY3RvcikgewoKCS8vIEFkZGVkIHRvIHJldHVybiB1bmRlZmluZWQgaXMgY2FsbGVkIHdpdGggdW5kZWZpbmVkCglpZiAoXy5pc05pbChlbGVtKSkge3JldHVybiB1bmRlZmluZWR9CgoJLy8gR2V0IHRoZSBuZXh0IHNpYmxpbmcgZWxlbWVudAoJdmFyIHNpYmxpbmcgPSBlbGVtLm5leHRFbGVtZW50U2libGluZzsKCgkvLyBJZiB0aGVyZSdzIG5vIHNlbGVjdG9yLCByZXR1cm4gdGhlIGZpcnN0IHNpYmxpbmcKCWlmICghc2VsZWN0b3IpIHJldHVybiBzaWJsaW5nOwoKCWNvbnN0IGNoZWNrZXIgPSBnZW5lcmF0ZUNoZWNrZXIoc2VsZWN0b3IpCgoJLy8gSWYgdGhlIHNpYmxpbmcgbWF0Y2hlcyBvdXIgc2VsZWN0b3IsIHVzZSBpdAoJLy8gSWYgbm90LCBqdW1wIHRvIHRoZSBuZXh0IHNpYmxpbmcgYW5kIGNvbnRpbnVlIHRoZSBsb29wCgl3aGlsZSAoc2libGluZykgewoJCWlmIChjaGVja2VyKHNpYmxpbmcpKSByZXR1cm4gc2libGluZzsKCQlzaWJsaW5nID0gc2libGluZy5uZXh0RWxlbWVudFNpYmxpbmcKCX0KCn07CnZhciBnZXRQcmV2aW91c1NpYmxpbmcgPSBmdW5jdGlvbiAoZWxlbSwgc2VsZWN0b3IpIHsKCgkvLyBBZGRlZCB0byByZXR1cm4gdW5kZWZpbmVkIGlzIGNhbGxlZCB3aXRoIHVuZGVmaW5lZAoJaWYgKF8uaXNOaWwoZWxlbSkpIHtyZXR1cm4gdW5kZWZpbmVkfQoJCgkvLyBHZXQgdGhlIG5leHQgc2libGluZyBlbGVtZW50Cgl2YXIgc2libGluZyA9IGVsZW0ucHJldmlvdXNFbGVtZW50U2libGluZzsKCgkvLyBJZiB0aGVyZSdzIG5vIHNlbGVjdG9yLCByZXR1cm4gdGhlIGZpcnN0IHNpYmxpbmcKCWlmICghc2VsZWN0b3IpIHJldHVybiBzaWJsaW5nOwoKCWNvbnN0IGNoZWNrZXIgPSBnZW5lcmF0ZUNoZWNrZXIoc2VsZWN0b3IpCgoJLy8gSWYgdGhlIHNpYmxpbmcgbWF0Y2hlcyBvdXIgc2VsZWN0b3IsIHVzZSBpdAoJLy8gSWYgbm90LCBqdW1wIHRvIHRoZSBuZXh0IHNpYmxpbmcgYW5kIGNvbnRpbnVlIHRoZSBsb29wCgl3aGlsZSAoc2libGluZykgewoJCWlmIChjaGVja2VyKHNpYmxpbmcpKSByZXR1cm4gc2libGluZzsKCQlzaWJsaW5nID0gc2libGluZy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOwoJfQoKfTsKCgovLyBHZXQgdGhlIGxhc3QgdG9jIGVudHJ5IGRlc2NlbmRhbnQgZnJvbSB0aGUgcHJvdmlkZWQgb25lCmZ1bmN0aW9uIGdldExhc3REZXNjZW5kYW50KGVsKSB7Cgljb25zdCByb3cgPSBnZXRSb3coZWwpCglpZiAoXy5pc05pbChyb3cpKSB7cmV0dXJufQoJY29uc3QgY2hpbGRyZW4gPSByb3cuZGlyZWN0Q2hpbGRyZW4KCWlmIChfLmlzRW1wdHkoY2hpbGRyZW4pKSB7CgkJcmV0dXJuIHJvdwoJfSBlbHNlIHsKCQlyZXR1cm4gZ2V0TGFzdERlc2NlbmRhbnQoXy5sYXN0KGNoaWxkcmVuKSkKCX0KfQoKLy8gRmluZCBhbGwgdGhlIGNlbGwgaWRzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIHRhcmdldCB0b2Mgcm93cyBhbmQgYWxsIGl0cyBkZXNjZW5kYW50cwpmdW5jdGlvbiBnZXRCbG9ja0lkcyhlbCkgewoJY29uc3Qgcm93ID0gZ2V0Um93KGVsKQoJaWYgKF8uaXNOaWwocm93KSkge3JldHVybn0KCWZ1bmN0aW9uIGdldEluZGV4KHJvdykgewoJCXJldHVybiBlZGl0b3Jfc3RhdGUubm90ZWJvb2suY2VsbF9vcmRlci5pbmRleE9mKGdldF9saW5rX2lkKHJvdykpCgl9Cgljb25zdCBzdGFydCA9IGdldEluZGV4KHJvdykKCgljb25zdCBsYXN0Q2hpbGQgPSBnZXRMYXN0RGVzY2VuZGFudChyb3cpCgljb25zdCBlbmQgPSBnZXRJbmRleChnZXROZXh0U2libGluZyhsYXN0Q2hpbGQsICcudG9jLXJvdycpKQoKCXJldHVybiBlZGl0b3Jfc3RhdGUubm90ZWJvb2suY2VsbF9vcmRlci5zbGljZShzdGFydCwgZW5kIDwgMCA/IEluZmluaXR5IDogZW5kKQp9CgkKd2luZG93LnRvY191dGlscyA9IHsKCWdldE5leHRTaWJsaW5nLAoJZ2V0UHJldmlvdXNTaWJsaW5nLAoJZ2V0TGFzdERlc2NlbmRhbnQsCglnZXRCbG9ja0lkcywKfQoKLy8gRnVuY3Rpb25zIHRvIHNldCBhbmQgcHJvcGFnYXRlIGhpZGRlbiBhbmQgY29sbGFwc2VkIHN0YXRlcwoKZnVuY3Rpb24gcHJvcGFnYXRlX3BhcmVudChkaXYsIHBhcmVudD1udWxsKSB7CglpZiAocGFyZW50ICE9IG51bGwpIHsKCQlkaXYuYWxsUGFyZW50cyA9IF8udW5pb24oZGl2LmFsbFBhcmVudHMsIFtwYXJlbnRdKQkKCX0KCWlmIChfLmlzRW1wdHkoZGl2LmRpcmVjdENoaWxkcmVuKSkge3JldHVybn0KCWZvciAoY29uc3QgY2hpbGQgb2YgZGl2LmRpcmVjdENoaWxkcmVuKSB7CgkJcHJvcGFnYXRlX3BhcmVudChjaGlsZCwgcGFyZW50ID8/IGRpdikKCX0KfQoKLy8gUmV0dXJucyB0cnVlIGlmIHRoZSBjdXJyZW50IGhpZGRlbi9jb2xsYXBzZWQgdG9jIHN0YXRlIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBvbmUgc2F2ZWQgaW4gdGhlIGZpbGUgd2l0aGluIGNlbGwgbWV0YWRhdGEKZnVuY3Rpb24gc3RhdGVEaWZmZXJzRmlsZShzdGF0ZSkgewoJZm9yIChjb25zdCBbaWQsIHN0XSBvZiBfLmVudHJpZXMoc3RhdGUpKSB7CgkJaWYgKGhhc19jZWxsX2F0dHJpYnV0ZShpZCwgJ3RvYy1oaWRkZW4nKSAhPSBzdC5oaWRkZW4pIHsgcmV0dXJuIHRydWUgfQoJCWlmIChoYXNfY2VsbF9hdHRyaWJ1dGUoaWQsICd0b2MtY29sbGFwc2VkJykgIT0gc3QuY29sbGFwc2VkKSB7IHJldHVybiB0cnVlIH0KCX0KCXJldHVybiBmYWxzZQp9CgpmdW5jdGlvbiBzZXRfc3RhdGUoZGl2LCBzdGF0ZSwgdmFsdWUsIGluaXQgPSBmYWxzZSkgewoJZGl2LmNsYXNzTGlzdC50b2dnbGUoc3RhdGUsIHZhbHVlKQoJaWYgKCFpbml0KSB7CgkJd2luZG93LnRvY19zdGF0ZVtnZXRfbGlua19pZChkaXYpXVtzdGF0ZV0gPSB2YWx1ZQoJCXRvYy5jbGFzc0xpc3QudG9nZ2xlKCdmaWxlLXN0YXRlLWRpZmZlcnMnLCBzdGF0ZURpZmZlcnNGaWxlKHdpbmRvdy50b2Nfc3RhdGUpKQoJfQoJaWYgKF8uaXNFbXB0eShkaXYuZGlyZWN0Q2hpbGRyZW4pKSB7cmV0dXJufQoJZm9yIChjb25zdCBjaGlsZCBvZiBkaXYuZGlyZWN0Q2hpbGRyZW4pIHsKCQlwcm9wYWdhdGVfc3RhdGUoY2hpbGQsIHN0YXRlKQoJfQp9CmZ1bmN0aW9uIHByb3BhZ2F0ZV9zdGF0ZShkaXYsIHN0YXRlKSB7CglsZXQgbmV3X3N0YXRlID0gYHBhcmVudC0ke3N0YXRlfWAKCWRpdi5jbGFzc0xpc3QudG9nZ2xlKG5ld19zdGF0ZSwgZmFsc2UpCgkvLyBDaGVjayB0aGUgcGFyZW50cyBmb3IgdGhlIHN0YXRlCglmb3IgKGNvbnN0IHBhcmVudCBvZiBkaXYuYWxsUGFyZW50cykgewoJCWlmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHN0YXRlKSkgewoJCQlkaXYuY2xhc3NMaXN0LnRvZ2dsZShuZXdfc3RhdGUsIHRydWUpCgkJCWJyZWFrCgkJfQoJfQoJaWYgKF8uaXNFbXB0eShkaXYuZGlyZWN0Q2hpbGRyZW4pKSB7cmV0dXJufQoJZm9yIChjb25zdCBjaGlsZCBvZiBkaXYuZGlyZWN0Q2hpbGRyZW4pIHsKCQlwcm9wYWdhdGVfc3RhdGUoY2hpbGQsIHN0YXRlKQoJfQp9CgoKCWNvbnN0IGZsb2F0aW5nX3VpID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9AZmxvYXRpbmctdWkvZG9tJykKCS8vIHdpbmRvdy5mbG9hdGluZ191aSA9IGZsb2F0aW5nX3VpCgoKCQlmdW5jdGlvbiBhZGRfbm90ZWJvb2tfYXR0cmlidXRlcyhhdHRycykgewoJCXBsdXRvX2FjdGlvbnMudXBkYXRlX25vdGVib29rKChub3RlYm9vaykgPT4gewoJCQlsZXQgbWQgPSBub3RlYm9vay5tZXRhZGF0YQoJCQltZFsiY3VzdG9tX2F0dHJzIl0gPSBfLnVuaW9uKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cnMpCgkJfSkKCQlsZXQgbm90ZWJvb2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdwbHV0by1ub3RlYm9vaycpCgkJZm9yIChsZXQgYXR0ciBvZiBhdHRycykgewoJCQlub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgdHJ1ZSkKCQl9Cgl9CgoJZnVuY3Rpb24gcmVtb3ZlX25vdGVib29rX2F0dHJpYnV0ZXMoYXR0cnMpIHsKCQlwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKCQkJbGV0IG1kID0gbm90ZWJvb2subWV0YWRhdGEKCQkJbGV0IGFmdGVyID0gXy5kaWZmZXJlbmNlKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cnMpCgkJCWlmIChfLmlzRW1wdHkoYWZ0ZXIpKSB7CgkJCQlkZWxldGUgbWRbImN1c3RvbV9hdHRycyJdCgkJCX0gZWxzZSB7CgkJCQltZFsiY3VzdG9tX2F0dHJzIl0gPSBhZnRlcgoJCQl9CgkJfSkKCQlsZXQgbm90ZWJvb2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdwbHV0by1ub3RlYm9vaycpCgkJZm9yIChsZXQgYXR0ciBvZiBhdHRycykgewoJCQlub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgZmFsc2UpCgkJfQoJfQoKCWZ1bmN0aW9uIHRvZ2dsZV9ub3RlYm9va19hdHRyaWJ1dGUoYXR0ciwgZm9yY2U9J3RvZ2dsZScpIHsKCQlwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKCQkJbGV0IG1kID0gbm90ZWJvb2subWV0YWRhdGEKCQkJbGV0IGYgPSBmb3JjZSA9PSAndG9nZ2xlJyA/IF8ueG9yIDogZm9yY2UgPyBfLnVuaW9uIDogXy5kaWZmZXJlbmNlCgkJCWxldCBhZnRlciA9IGYobWRbImN1c3RvbV9hdHRycyJdLCBbYXR0cl0pCgkJCWlmIChfLmlzRW1wdHkoYWZ0ZXIpKSB7CgkJCQlkZWxldGUgbWRbImN1c3RvbV9hdHRycyJdCgkJCX0gZWxzZSB7CgkJCQltZFsiY3VzdG9tX2F0dHJzIl0gPSBhZnRlcgoJCQl9CgkJfSkKCQlsZXQgbm90ZWJvb2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdwbHV0by1ub3RlYm9vaycpCgkJZm9yY2UgPT0gJ3RvZ2dsZScgPyBub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0cikgOiBub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgZm9yY2UpCgl9CgoJaWYgKGZvcmNlX2hpZGVfZW5hYmxlZCkgewoJIAl0b2dnbGVfbm90ZWJvb2tfYXR0cmlidXRlKCdoaWRlLWVuYWJsZWQnLHRydWUpCgl9CgoKCWZ1bmN0aW9uIGhhc19jZWxsX2F0dHJpYnV0ZShjZWxsX2lkLCBhdHRyKSB7CgkJY29uc3QgbWQgPSBlZGl0b3Jfc3RhdGUubm90ZWJvb2suY2VsbF9pbnB1dHNbY2VsbF9pZF0ubWV0YWRhdGEKCQlyZXR1cm4gXy5pbmNsdWRlcyhtZFsiY3VzdG9tX2F0dHJzIl0sIGF0dHIpCgl9CgkKCWZ1bmN0aW9uIGFkZF9jZWxsX2F0dHJpYnV0ZXMoY2VsbF9pZCwgYXR0cnMpIHsKCQlwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKCQkJbGV0IG1kID0gbm90ZWJvb2suY2VsbF9pbnB1dHNbY2VsbF9pZF0ubWV0YWRhdGEKCQkJbWRbImN1c3RvbV9hdHRycyJdID0gXy51bmlvbihtZFsiY3VzdG9tX2F0dHJzIl0sIGF0dHJzKQoJCX0pCgkJbGV0IGNlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjZWxsX2lkKQoJCWZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHsKCQkJY2VsbC50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgdHJ1ZSkKCQl9Cgl9CgoJZnVuY3Rpb24gcmVtb3ZlX2NlbGxfYXR0cmlidXRlcyhjZWxsX2lkLCBhdHRycykgewoJCXBsdXRvX2FjdGlvbnMudXBkYXRlX25vdGVib29rKChub3RlYm9vaykgPT4gewoJCQlsZXQgbWQgPSBub3RlYm9vay5jZWxsX2lucHV0c1tjZWxsX2lkXS5tZXRhZGF0YQoJCQlsZXQgYWZ0ZXIgPSBfLmRpZmZlcmVuY2UobWRbImN1c3RvbV9hdHRycyJdLCBhdHRycykKCQkJaWYgKF8uaXNFbXB0eShhZnRlcikpIHsKCQkJCWRlbGV0ZSBtZFsiY3VzdG9tX2F0dHJzIl0KCQkJfSBlbHNlIHsKCQkJCW1kWyJjdXN0b21fYXR0cnMiXSA9IGFmdGVyCgkJCX0KCQl9KQoJCWxldCBjZWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2VsbF9pZCkKCQlmb3IgKGxldCBhdHRyIG9mIGF0dHJzKSB7CgkJCWNlbGwudG9nZ2xlQXR0cmlidXRlKGF0dHIsIGZhbHNlKQoJCX0KCX0KCglmdW5jdGlvbiB0b2dnbGVfY2VsbF9hdHRyaWJ1dGUoY2VsbF9pZCwgYXR0ciwgZm9yY2U9J3RvZ2dsZScpIHsKCQlwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKCQkJbGV0IG1kID0gbm90ZWJvb2suY2VsbF9pbnB1dHNbY2VsbF9pZF0ubWV0YWRhdGEKCQkJbGV0IGYgPSBmb3JjZSA9PSAndG9nZ2xlJyA/IF8ueG9yIDogZm9yY2UgPyBfLnVuaW9uIDogXy5kaWZmZXJlbmNlCgkJCWxldCBhZnRlciA9IGYobWRbImN1c3RvbV9hdHRycyJdLCBbYXR0cl0pCgkJCWlmIChfLmlzRW1wdHkoYWZ0ZXIpKSB7CgkJCQlkZWxldGUgbWRbImN1c3RvbV9hdHRycyJdCgkJCX0gZWxzZSB7CgkJCQltZFsiY3VzdG9tX2F0dHJzIl0gPSBhZnRlcgoJCQl9CgkJfSkKCQlsZXQgY2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNlbGxfaWQpCgkJZm9yY2UgPT0gJ3RvZ2dsZScgPyBjZWxsLnRvZ2dsZUF0dHJpYnV0ZShhdHRyKSA6IGNlbGwudG9nZ2xlQXR0cmlidXRlKGF0dHIsIGZvcmNlKQoJfQoKCgkvLyBGb3IgZWFjaCBmcm9tIGFuZCB0bywgd2UgaGF2ZSB0byBzcGVjaWZ5IGBwbHV0by1jZWxsW2lkXWAgaW4gdGhlIHBhcnQgYmVmb3JlIHRoZSBjb21tIGFuZCBqdXN0IGBbaWRdYCBpbiB0aGUgcGFydCBhZnRlciB0aGUgY29tbWEgdG8gZW5zdXJlIHRoZSBzcGVjaWZpY2l0eSBvZiB0aGUgdHdvIGNvbW1hLXNlcGFyYXRlZCBzZWxlY3RvcnMgaXMgdGhlIHNhbWUgKHRoZSBwYXJ0IGFmdGVyIHRoZSBjb21tYSBoYXMgdGhlIGFkZGl0aW9uIG9mIGB+IHBsdXRvLWNlbGxgLCBzbyBpdCBoYXMgaW5oZXJlbnRseSArMSBlbGVtZW50IHNwZWNpZmljaXR5KQoJZnVuY3Rpb24gaGlkZV9mcm9tX3RvX3N0cmluZyhmcm9tX2lkLCB0b19pZCkgewoJCWlmIChfLmlzRW1wdHkoZnJvbV9pZCkgJiYgXy5pc0VtcHR5KHRvX2lkKSkge3JldHVybiAnJ30KCQkKCQljb25zdCBmcm9tX3ByZXNlbGVjdG9yID0gXy5pc0VtcHR5KGZyb21faWQpID8gJycgOiBgcGx1dG8tY2VsbFtpZD0nJHtmcm9tX2lkfSddLCBwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIFtpZD0nJHtmcm9tX2lkfSddIH4gYAoJCWNvbnN0IHRvX3N0eWxlID0gXy5pc0VtcHR5KHRvX2lkKSA/ICcnIDogYHBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFtpZD0nJHt0b19pZH0nXSwgcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBbaWQ9JyR7dG9faWR9J10gfiBwbHV0by1jZWxsIHsKCQlkaXNwbGF5OiBibG9jazsKCX0KCSBgCgkJY29uc3Qgc3R5bGVfc3RyaW5nID0gCWBwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdICR7ZnJvbV9wcmVzZWxlY3Rvcn1wbHV0by1jZWxsIHsKCQlkaXNwbGF5OiBub25lOwoJfQoJJHt0b19zdHlsZX0KIGAKCQlyZXR1cm4gc3R5bGVfc3RyaW5nCgkJLy9yZXR1cm4gaHRtbGA8c3R5bGU+JHtzdHlsZV9zdHJpbmd9PC9zdHlsZT5gCgl9CgoJZnVuY3Rpb24gaGlkZV9mcm9tX3RvX2xpc3Rfc3RyaW5nKHZlY3RvcikgewoJCWxldCBvdXQgPSBgYAoJCWZvciAoY29uc3QgbGltcyBvZiB2ZWN0b3IpIHsKCQkJY29uc3QgZnJvbSA9IGxpbXNbMF0KCQkJY29uc3QgdG8gPSBsaW1zWzFdCgkJCQoJCQlvdXQgPSBgJHtvdXR9CSR7aGlkZV9mcm9tX3RvX3N0cmluZyhmcm9tLHRvKX1gCgkJfQoJCW91dCA9IGAke291dH0JcGx1dG8tY2VsbFthbHdheXMtc2hvd10gewogIAkJCWRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7CiAgCQl9CiAgYAoJCXJldHVybiBvdXQKCX0KCWZ1bmN0aW9uIGhpZGVfZnJvbV90b19saXN0KHZlY3RvcikgewoJCWNvbnN0IHN0ciA9IGhpZGVfZnJvbV90b19saXN0X3N0cmluZyh2ZWN0b3IpCgkJcmV0dXJuIGh0bWxgPHN0eWxlPiR7c3RyfTwvc3R5bGU+YAoJfQoJZnVuY3Rpb24gaGlkZV9saXN0X3N0eWxlKHZlY3RvcikgewoJCWxldCBzdHlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoaWRlLWNlbGxzLXN0eWxlJykKCQlpZiAoc3R5bGUgPT0gbnVsbCkgewogIAkJCXN0eWxlID0gZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChodG1sYDxzdHlsZSBpZD0naGlkZS1jZWxscy1zdHlsZSc+PC9zdHlsZT5gKQoJCX0KCQlzdHlsZS5pbm5lckhUTUwgPSBoaWRlX2Zyb21fdG9fbGlzdF9zdHJpbmcodmVjdG9yKQoJfQoKCglmdW5jdGlvbiBzYXZlX3RvX2ZpbGUoKSB7CgkJY29uc3Qgc3RhdGUgPSB3aW5kb3cudG9jX3N0YXRlCgkJZm9yIChjb25zdCBbayx2XSBvZiBPYmplY3QuZW50cmllcyhzdGF0ZSkpIHsKCQkJdG9nZ2xlX2NlbGxfYXR0cmlidXRlKGssICd0b2MtaGlkZGVuJywgdi5oaWRkZW4pCQoJCQl0b2dnbGVfY2VsbF9hdHRyaWJ1dGUoaywgJ3RvYy1jb2xsYXBzZWQnLCB2LmNvbGxhcHNlZCkJCgkJfQoJCXNldFRpbWVvdXQoKCkgPT4gewoJCQl0b2MuY2xhc3NMaXN0LnRvZ2dsZSgnZmlsZS1zdGF0ZS1kaWZmZXJzJywgc3RhdGVEaWZmZXJzRmlsZShzdGF0ZSkpCgkJfSwgNTAwKQoJfQoKCgljb25zdCBoZWFkZXIgPSB0b2MucXVlcnlTZWxlY3RvcignaGVhZGVyJykKCWNvbnN0IGhlYWRlcl9jb250YWluZXIgPSBoZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWhlYWRlci1jb250YWluZXInPmApCgkKCQoJY29uc3Qgbm90ZWJvb2tfaGlkZV9pY29uID0gaGVhZGVyX2NvbnRhaW5lci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1oZWFkZXItaWNvbiB0b2MtaGVhZGVyLWhpZGUnPmApCgkKCWNvbnN0IHNhdmVfZmlsZV9pY29uID0gaGVhZGVyX2NvbnRhaW5lci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1oZWFkZXItaWNvbiB0b2MtaGVhZGVyLXNhdmUnPmApCglzYXZlX2ZpbGVfaWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVfdG9fZmlsZSkKCgloZWFkZXJfY29udGFpbmVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWhlYWRlci1maWxsZXInPmApCgkKCWhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gewoJCWlmIChlLnRhcmdldCAhPSBoZWFkZXIpIHtyZXR1cm59CgkJc2Nyb2xsX3RvKGNlbGwsIHtibG9jazogJ2NlbnRlcicsIGJlaGF2aW9yOiAnc21vb3RoJ30pCgl9KQoKCWhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKGUpID0+IHsKCQlmbG9hdGluZ191aS5jb21wdXRlUG9zaXRpb24oaGVhZGVyLCBoZWFkZXJfY29udGFpbmVyLCB7CgkJCXBsYWNlbWVudDogImxlZnQiLAoJCQlzdHJhdGVneTogImZpeGVkIiwKCQl9KS50aGVuKHBvcyA9PiB7CgkJCWhlYWRlcl9jb250YWluZXIuc3R5bGUudG9wID0gcG9zLnkgKyAicHgiCgkJCS8vIGhlYWRlcl9jb250YWluZXIuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQkvLyBoZWFkZXJfY29udGFpbmVyLnN0eWxlLnJpZ2h0ID0gYGNhbGMoMXJlbSArIG1pbig4MHZ3LCAzMDBweCkpYAoJCX0pCgl9KQoKCW5vdGVib29rX2hpZGVfaWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CgkJCS8vIFdlIGZpbmQgdGhlIHggY29vcmRpbmF0ZSBvZiB0aGUgcGx1dG8tbm90ZWJvb2sgZWxlbWVudCwgdG8gYXZvaWQgbWlzc2luZyB0aGUgY2VsbCB3aGVuIFVJIGlzIGRpc2FibGVkCgkJCWNvbnN0IHsgeCB9ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncGx1dG8tbm90ZWJvb2snKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCQljb25zdCByZWYgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHgrMSwxMDApLmNsb3Nlc3QoJ3BsdXRvLWNlbGwnKQoJCQljb25zdCB7IHkgfSA9IHJlZi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCQl0b2dnbGVfbm90ZWJvb2tfYXR0cmlidXRlKCdoaWRlLWVuYWJsZWQnKQoJCQljb25zdCBkeSA9IHJlZi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS55IC0geQoJCQl3aW5kb3cuc2Nyb2xsQnkoMCwgZHkpCgl9KQoKY2VsbC50b2dnbGVBdHRyaWJ1dGUoJ2Fsd2F5cy1zaG93JywgdHJ1ZSkKCglmdW5jdGlvbiB0b2dnbGVfc3RhdGUobmFtZSkgewoJCXJldHVybiAoZSkgPT4gewoJCQllLnByZXZlbnREZWZhdWx0KCkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlsZXQgZGl2ID0gZS50YXJnZXQuY2xvc2VzdCgnZGl2JykKCQkJY29uc3QgbmV3X3ZhbCA9ICFkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKG5hbWUpCgkJCXNldF9zdGF0ZShkaXYsIG5hbWUsIG5ld192YWwpCgkJfQoJfQoKCWZ1bmN0aW9uIHVwZGF0ZV9oaWRkZW4oZSkgewoJCWxldCBuZXdfaGlkZSA9IFtdCgkJaWYgKGhpZGVfcHJlYW1ibGUpIHsKCQkJbmV3X2hpZGUucHVzaChbJycsIGdldF9saW5rX2lkKHRvYy5xdWVyeVNlbGVjdG9yKCdkaXYudG9jLXJvdycpKV0pCgkJfQoJCWxldCB0cmFja2luZ19oaWRkZW4gPSBudWxsCgkJbGV0IGRpdnMgPSB0b2MucXVlcnlTZWxlY3RvckFsbCgnZGl2LnRvYy1yb3cnKQoJCWZvciAoY29uc3QgZGl2IG9mIGRpdnMpIHsKCQkJaWYgKHRyYWNraW5nX2hpZGRlbiAhPSBudWxsKSB7CgkJCQljb25zdCBoaWRkZW4gPSBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSB8fCBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdwYXJlbnQtaGlkZGVuJykKCQkJCWlmICghaGlkZGVuKSB7CgkJCQkJbmV3X2hpZGUucHVzaChbdHJhY2tpbmdfaGlkZGVuLCBnZXRfbGlua19pZChkaXYpXSkJCgkJCQkJdHJhY2tpbmdfaGlkZGVuID0gbnVsbAoJCQkJfQoJCQl9IGVsc2UgewoJCQkJY29uc3QgaGlkZGVuID0gZGl2LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykKCQkJCWlmIChoaWRkZW4pIHsKCQkJCQl0cmFja2luZ19oaWRkZW4gPSBnZXRfbGlua19pZChkaXYpCgkJCQl9CgkJCX0KCQl9CgkJaWYgKHRyYWNraW5nX2hpZGRlbiAhPSBudWxsKSB7CgkJCQluZXdfaGlkZS5wdXNoKFt0cmFja2luZ19oaWRkZW4sICIiXSkJCgkJfQoJCWhpZGVfbGlzdF9zdHlsZShuZXdfaGlkZSkKCX0KCgkvLyBSZXBvc2l0aW9uIHRoZSBoaWRlX2NvbnRhaW5lciB1c2luZyB0aGUgZmxvYXRpbmctdWkgbGlicmFyeQoJZnVuY3Rpb24gcmVwb3NpdGlvblRvb2x0aXAoZSkgewoJCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uIH0gPSBmbG9hdGluZ191aQoJCWNvbnN0IHJlZiA9IGUudGFyZ2V0CgkJY29uc3QgdG9vbHRpcCA9IHJlZi5xdWVyeVNlbGVjdG9yKCcudG9jLWhpZGUtY29udGFpbmVyJykKCQlpZiAoXy5pc05pbCh0b29sdGlwKSkgewoJCQljb25zb2xlLndhcm4oIlNvbWV0aGluZyB3ZW50IHdyb25nLCBubyB0b29sdGlwIGZvdW5kIikKCQkJcmV0dXJuCgkJfQoJCWNvbXB1dGVQb3NpdGlvbihyZWYsIHRvb2x0aXAsIHsKCQkJcGxhY2VtZW50OiAibGVmdCIsCgkJCXN0cmF0ZWd5OiAiZml4ZWQiLAoJCX0pLnRoZW4ocG9zID0+IHsKCQkJdG9vbHRpcC5zdHlsZS50b3AgPSBwb3MueSArICJweCIKCQl9KQoJfQoJCglmdW5jdGlvbiBwcm9jZXNzX3JvdyhkaXYsIGhpc3RvcnksIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKSB7CgoJCS8vIFdlIGFkZCB0aGUgc2VwYXJhdG9yCgkJZGl2Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCBodG1sYDxkaXYgY2xhc3M9J3RvYy1yb3ctc2VwYXJhdG9yJz48L2Rpdj5gKQoJCS8vIElmIHdlIGFyZSBqdXN0IHByb2Nlc3NpbmcgdGhlIGZpcnN0IGVsZW1lbnQgKHNvIHRoZSBsYXN0IHJvdykgd2UgYWxzbyBhZGQgYSBzZXBhcmF0b3IgYXQgdGhlIGJvdHRvbQoJCWlmIChfLmlzRW1wdHkobmV3X3N0YXRlKSAmJiBfLmV2ZXJ5KGhpc3RvcnksIF8uaXNFbXB0eSkpIHsKCQkJZGl2Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBodG1sYDxkaXYgY2xhc3M9J3RvYy1yb3ctc2VwYXJhdG9yJz48L2Rpdj5gKQoJCX0KCgkJLy8gV2UgYWRkIHRoZSByZXBvc2l0aW9uIGV2ZW50IHRvIHRoZSByb3cKCQlkaXYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHJlcG9zaXRpb25Ub29sdGlwKQoJCQoJCWxldCBpZCA9IGdldF9saW5rX2lkKGRpdikKCQljb25zdCBhID0gZGl2LnF1ZXJ5U2VsZWN0b3IoJ2EnKQoJCWxldCBvbGRfZiA9IGEub25jbGljazsKCQlhLm9uY2xpY2sgPSAoZSkgPT4gewoJCQllLnByZXZlbnREZWZhdWx0KCkKCQkJLy8gV2UgYXZvaWQgdHJpZ2dlcmluZyB0aGUgY2xpY2sgaWYgY29taW5nIG91dCBvZiBhIGRyYWcKCQkJaWYgKHRvYy5jbGFzc0xpc3QuY29udGFpbnMoJ3JlY2VudC1kcmFnJykpIHsgcmV0dXJuIH0KCQkJb2xkX2YoZSkKCQl9CQkJCgkJY29uc3QgbGV2ZWwgPSBnZXRIZWFkaW5nTGV2ZWwoZGl2KQoJCWlmIChsZXZlbCA+IDEpIHsKCQkJaGlzdG9yeVtsZXZlbF0udW5zaGlmdChkaXYpCgkJfQoJCS8vIFdlIGl0ZXJhdGUgdGhyb3VnaCB0aGUgaGlzdG9yeSBhbmQgYXNzaWduIHRoZSBkaXJlY3QgY2hpbGRyZW4gaWYgdGhleSBleGlzdCwgd2hpbGUgY2xlYXJpbmcgbG93ZXIgbGV2ZWxzIGhpc3RvcnkKCQlmb3IgKGxldCBpID0gNjsgaSA+IGxldmVsOyBpLS0pIHsKCQkJaWYgKF8uaXNFbXB0eShoaXN0b3J5W2ldKSkge2NvbnRpbnVlfQoJCQlpZiAoZGl2LmRpcmVjdENoaWxkcmVuICE9IHVuZGVmaW5lZCkge3Rocm93KCdtdWx0aXBsZSBsZXZlbCB3aXRoIGNoaWxkcmVuLCB1bmV4cGVjdGVkIScpfQoJCQlkaXYuZGlyZWN0Q2hpbGRyZW4gPSBoaXN0b3J5W2ldCgkJCWhpc3RvcnlbaV0gPSBbXSAvLyBlbXB0eSBhcnJheQoJCX0KCQljb25zdCBjb2xsYXBzZV9zcGFuID0gYS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBodG1sYDxzcGFuIGNsYXNzPSd0b2MtaWNvbiB0b2MtY29sbGFwc2UnPmApCgkJbGV0IGhpZGVfc3R5bGUgPSBgLS1oZWlnaHQ6ICR7YS5jbGllbnRIZWlnaHR9cHhgCgkJY29uc3QgaGlkZV9jb250YWluZXIgPSBkaXYuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWhpZGUtY29udGFpbmVyJyBzdHlsZT0nJHtoaWRlX3N0eWxlfSc+YCkKCQljb25zdCBoaWRlX3NwYW4gPSBoaWRlX2NvbnRhaW5lci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBodG1sYDxzcGFuIGNsYXNzPSd0b2MtaWNvbiB0b2MtaGlkZSc+YCkKCQloaWRlX3NwYW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewoJCQl0b2dnbGVfc3RhdGUoJ2hpZGRlbicpKGUpCgkJCXVwZGF0ZV9oaWRkZW4oZSkKCQl9KQoJCWlmIChkaXYuZGlyZWN0Q2hpbGRyZW4gPT0gdW5kZWZpbmVkKSB7CgkJCWNvbGxhcHNlX3NwYW4uY2xhc3NMaXN0LnRvZ2dsZSgnbm8tY2hpbGRyZW4nLCB0cnVlKQoJCX0gZWxzZSB7CgkJCXByb3BhZ2F0ZV9wYXJlbnQoZGl2KQoJCQljb2xsYXBzZV9zcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlX3N0YXRlKCdjb2xsYXBzZWQnKSkKCQl9CgkJbGV0IG1kID0gZWRpdG9yX3N0YXRlLm5vdGVib29rLmNlbGxfaW5wdXRzW2lkXS5tZXRhZGF0YQoJCWxldCBjb2xsYXBzZWQgPSBvbGRfc3RhdGVbaWRdPy5jb2xsYXBzZWQgPz8gIF8uaW5jbHVkZXMobWRbJ2N1c3RvbV9hdHRycyddLCAndG9jLWNvbGxhcHNlZCcpCgkJbGV0IGhpZGRlbiA9IG9sZF9zdGF0ZVtpZF0/LmhpZGRlbiA/PyBfLmluY2x1ZGVzKG1kWydjdXN0b21fYXR0cnMnXSwgJ3RvYy1oaWRkZW4nKQoJCXNldF9zdGF0ZShkaXYsICdjb2xsYXBzZWQnLCBjb2xsYXBzZWQsIHRydWUpCgkJc2V0X3N0YXRlKGRpdiwgJ2hpZGRlbicsIGhpZGRlbiwgdHJ1ZSkKCQluZXdfc3RhdGVbaWRdID0geyBjb2xsYXBzZWQsIGhpZGRlbiB9CgkJCgl9CgoJY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7CgkJY29uc3Qgcm93cyA9IHRvYy5xdWVyeVNlbGVjdG9yQWxsKCdzZWN0aW9uIGRpdi50b2Mtcm93JykKCQlsZXQgb2xkX3N0YXRlID0gd2luZG93LnRvY19zdGF0ZSA/PyB7fQoJCWxldCBuZXdfc3RhdGUgPSB7fQoJCWxldCBoaXN0b3J5ID0gewoJCQkyOiBbXSwKCQkJMzogW10sCgkJCTQ6IFtdLAoJCQk1OiBbXSwKCQkJNjogW10sCgkJfQoJCWZvciAoY29uc3Qgcm93IG9mIFsuLi5yb3dzXS5yZXZlcnNlKCkpIHsKCQkJcHJvY2Vzc19yb3cocm93LCBoaXN0b3J5LCBvbGRfc3RhdGUsIG5ld19zdGF0ZSkKCQl9CgkJd2luZG93LnRvY19zdGF0ZSA9IG5ld19zdGF0ZQoJCXRvYy5jbGFzc0xpc3QudG9nZ2xlKCdmaWxlLXN0YXRlLWRpZmZlcnMnLCBzdGF0ZURpZmZlcnNGaWxlKG5ld19zdGF0ZSkpCgkJdXBkYXRlX2hpZGRlbigpCgl9KQoKCW9ic2VydmVyLm9ic2VydmUodG9jLCB7Y2hpbGRMaXN0OiB0cnVlfSkKCgoJY29uc3QgeyBkZWZhdWx0OiBpbnRlcmFjdCB9ID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9pbnRlcmFjdGpzJykKCgkvLyBXZSBoYXZlIHRvIGVuYWJsZSBkeW5hbWljRHJvcCB0byBoYXZlIGRyb3B6b25lIHJlY29tcHV0ZWQgb24gZHJhZ21vdmUKCWludGVyYWN0LmR5bmFtaWNEcm9wKHRydWUpCgoJZnVuY3Rpb24gZHJhZ0VuYWJsZXIoZSkgewoJCWlmICghdG9jLmNsYXNzTGlzdC5jb250YWlucygnZHJhZ19lbmFibGVkJykgfHwgZS5rZXkgIT09ICdTaGlmdCcpIHsgcmV0dXJuIHRydWUgfQoJCXN3aXRjaCAoZS50eXBlKSB7CgkJCWNhc2UgImtleWRvd24iOgoJCQkJdG9jLmNsYXNzTGlzdC5hZGQoJ2FsbG93X2FsbF9kcm9wJykKCQkJCWJyZWFrOwoJCQljYXNlICJrZXl1cCI6CgkJCQl0b2MuY2xhc3NMaXN0LnJlbW92ZSgnYWxsb3dfYWxsX2Ryb3AnKQoJCQkJYnJlYWs7CgkJfQoJCXVwZGF0ZUFjdGl2ZVNlcGFyYXRvcigpCgl9CgoJY29uc3Qgd2luZG93X2V2ZW50cyA9IHsKCQlrZXlkb3duOiBkcmFnRW5hYmxlciwKCQlrZXl1cDogZHJhZ0VuYWJsZXIsCgl9CgoJYWRkU2NyaXB0RXZlbnRMaXN0ZW5lcnMod2luZG93LCB3aW5kb3dfZXZlbnRzKQoKCS8vIEludGVyYWN0LmpzIHBhcnQKCglsZXQgYWN0aXZlRHJvcCA9IHVuZGVmaW5lZAoKCWZ1bmN0aW9uIHRhZ0FkamFjZW50U2VwYXJhdG9ycyhlbCwgYWN0aXZlKSB7CgkJY29uc3QgbmV4dCA9IGdldE5leHRTaWJsaW5nKGVsLCAnLnRvYy1yb3ctc2VwYXJhdG9yJykKCQljb25zdCBwcmV2ID0gZ2V0UHJldmlvdXNTaWJsaW5nKGVsLCAnLnRvYy1yb3ctc2VwYXJhdG9yJykKCQlpZiAoYWN0aXZlKSB7CiAgCQkJbmV4dD8uY2xhc3NMaXN0LmFkZCgnbm9zaG93JykKICAJCQlwcmV2Py5jbGFzc0xpc3QuYWRkKCdub3Nob3cnKQoJCX0gZWxzZSB7CiAgCQkJbmV4dD8uY2xhc3NMaXN0LnJlbW92ZSgnbm9zaG93JykKICAJCQlwcmV2Py5jbGFzc0xpc3QucmVtb3ZlKCdub3Nob3cnKQkJCQkKCQl9Cgl9CgoJZnVuY3Rpb24gZ2V0U2VwYXJhdG9yKHN0YXJ0RWxlbWVudCwgYmVsb3csIGFsbG93QWxsLCBoZWFkaW5nTGV2ZWwgPSA4KSB7CgkJbGV0IHNlcGFyYXRvcgoJCWlmIChiZWxvdykgewoJCQljb25zdCBzZWxlY3RvciA9ICcudG9jLXJvdzpub3QoLnBhcmVudC1jb2xsYXBzZWQpJwoJCQljb25zdCBjaGVja2VyRnVuYyA9IGFsbG93QWxsID8gZ2VuZXJhdGVDaGVja2VyKHNlbGVjdG9yKSA6IChlbCkgPT4gewoJCQkJaWYgKCFlbC5tYXRjaGVzKHNlbGVjdG9yKSkgeyByZXR1cm4gZmFsc2UgfQoJCQkJLy8gQ2hlY2sgZm9yIHRoZSByaWdodCBoZWFkaW5nIGxldmVsCgkJCQlmb3IgKGxldCBpID0gaGVhZGluZ0xldmVsOyBpID4gMDsgaS0tKSB7CgkJCQkJY29uc3QgY2wgPSAiSCIgKyBpCgkJCQkJaWYgKGVsLmNsYXNzTGlzdC5jb250YWlucyhjbCkpIHsgcmV0dXJuIHRydWUgfQoJCQkJfQoJCQkJcmV0dXJuIGZhbHNlCgkJCX0KCQkJY29uc3QgdmFsaWRSb3cgPSBnZXROZXh0U2libGluZyhzdGFydEVsZW1lbnQsIGNoZWNrZXJGdW5jKQoJCQkvLyBJZiB0aGUgYWN0aXZlRHJvcCBpcyB0aGUgbGFzdCByb3cgb3IgdGhlIHRoZSBsYXN0IG5vbi1jb2xsYXBzZWQgb25lLCB0aGUgdmFsaWRSb3cgd2lsbCBiZSBgdW5kZWZpbmVkYCwgc28gaW4gdGhhdCBjYXNlIHdlIHRha2UgdGhlIGxhc3Qgc2VwYXJhdG9yCgkJCXNlcGFyYXRvciA9IGdldFByZXZpb3VzU2libGluZyh2YWxpZFJvdywgJy50b2Mtcm93LXNlcGFyYXRvcicpID8/IF8ubGFzdCh0b2MucXVlcnlTZWxlY3RvckFsbCgnLnRvYy1yb3ctc2VwYXJhdG9yJykpCgkJfSBlbHNlIHsKCQkJc2VwYXJhdG9yID0gZ2V0UHJldmlvdXNTaWJsaW5nKHN0YXJ0RWxlbWVudCwgJy50b2Mtcm93LXNlcGFyYXRvcicpCgkJfQoJCXJldHVybiBzZXBhcmF0b3IKCX0KCglmdW5jdGlvbiBnZXRIaWdoZXJQYXJlbnQocm93LCBsZXZlbCkgewoJCWNvbnN0IGN1cnJlbnRMZXZlbCA9IGdldEhlYWRpbmdMZXZlbChyb3cpCgkJaWYgKGN1cnJlbnRMZXZlbCA8PSBsZXZlbCkge3JldHVybiByb3d9CgkJZm9yIChjb25zdCBwYXIgb2Ygcm93LmFsbFBhcmVudHMpIHsKCQkJLy8gUGFyZW50cyBjeWNsZSBmcm9tIGhpZ2hlciBsZXZlbCB0byBsb3dlciBsZXZlbHMKCQkJaWYgKGdldEhlYWRpbmdMZXZlbChwYXIpIDw9IGxldmVsKSB7cmV0dXJuIHBhcn0KCQl9CgkJcmV0dXJuIHJvdwoJfQoJCQoJbGV0IHVuY29sbGFwc2VkID0gW10KCglmdW5jdGlvbiByZUNvbGxhcHNlKHJvdykgewoJCWNvbnN0IHBhcmVudHMgPSByb3c/LmFsbFBhcmVudHMgPz8gW10KCQljb25zdCB0b1JlbW92ZSA9IF8uZGlmZmVyZW5jZSh1bmNvbGxhcHNlZCwgWy4uLnBhcmVudHMsIHJvd10pCgkJZm9yIChjb25zdCBlbCBvZiB0b1JlbW92ZSkgewoJCQkvLyBkZWJ1Z2dlcgoJCQlzZXRfc3RhdGUoZWwsICJjb2xsYXBzZWQiLCB0cnVlKQoJCQlfLnJlbW92ZSh1bmNvbGxhcHNlZCwgeCA9PiB4ID09PSBlbCkKCQl9Cgl9CgoKCWZ1bmN0aW9uIHVwZGF0ZURyb3Bab25lKHJvdykgewoJCWNvbnN0IHByZXYgPSB0b2MucXVlcnlTZWxlY3RvcignLnRvYy1yb3cuYWN0aXZlX2Ryb3AnKQoJCWlmIChfLmlzTmlsKHJvdykgfHwgcHJldiA9PT0gcm93KSB7cmV0dXJufQoJCWlmIChwcmV2Py50aW1lb3V0SWQpIHsKCQkJY2xlYXJUaW1lb3V0KHByZXYudGltZW91dElkKQoJCQlwcmV2LnRpbWVvdXRJZCA9IHVuZGVmaW5lZAoJCX0KCQlwcmV2Py5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmVfZHJvcCcpCgkJcm93LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZV9kcm9wJykKCQlyZUNvbGxhcHNlKHJvdykKCQlpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJykpIHsKCQkJcm93LnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gewoJCQkJdW5jb2xsYXBzZWQucHVzaChyb3cpCgkJCQlzZXRfc3RhdGUocm93LCAiY29sbGFwc2VkIiwgZmFsc2UpCgkJCQl1cGRhdGVBY3RpdmVTZXBhcmF0b3IoKQoJCQl9LCA1MDApCgkJfQoJCWFjdGl2ZURyb3AgPSByb3cKCX0KCglmdW5jdGlvbiB1cGRhdGVBY3RpdmVTZXBhcmF0b3IoKSB7CgkJY29uc3QgZSA9IHRvYy5sYXN0RHJhZ0V2ZW50CgkJaWYgKF8uaXNOaWwoZSkpIHsgcmV0dXJuIH0KCQljb25zdCBlbEJlbG93ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChlLmNsaWVudC54LCBlLmNsaWVudC55KQoJCWlmICghZWxCZWxvdy5tYXRjaGVzKCcucGx1dG91aS10b2MgOnNjb3BlJykpIHsKCQkJLy8gV2UgYXJlIG91dCBvZiB0aGUgVG9DLCByZWNvbGxhcHNlIGFuZCByZW1vdmUgYWN0aXZlIHNlcGFyYXRvcgoJCQlyZUNvbGxhcHNlKHVuZGVmaW5lZCkKCQkJdG9jLnF1ZXJ5U2VsZWN0b3IoJy50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUnKT8uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykKCQkJcmV0dXJuCgkJfQoJCWNvbnN0IHJvd0JlbG93ID0gZ2V0Um93KGVsQmVsb3cpCgkJdXBkYXRlRHJvcFpvbmUocm93QmVsb3cpCgkJaWYgKF8uaXNOaWwoYWN0aXZlRHJvcCkpIHtyZXR1cm59CgkJY29uc3QgYWxsb3dBbGwgPSB0b2MuY2xhc3NMaXN0LmNvbnRhaW5zKCdhbGxvd19hbGxfZHJvcCcpCgkJY29uc3QgaGVhZGluZ0xldmVsID0gZ2V0SGVhZGluZ0xldmVsKHRvYy5kcmFnZ2VkRWxlbWVudCkKCQljb25zdCB7IHksIGhlaWdodCB9ID0gYWN0aXZlRHJvcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCWxldCB0aHJlc2hvbGRZID0geSArIGhlaWdodC8yCgkJaWYgKCFhbGxvd0FsbCkgewoJCQkvLyBXZSBvbmx5IGFsbG93IHB1dHRpbmcgdGhlIGRyYWdnZWQgZWxlbWVudCBhYm92ZS9iZWxvdyByb3dzIHdpdGggZXF1YWwgb3IgaGlnaGVyIGhlYWRpbmcgbGV2ZWwKCQkJY29uc3QgY3VycmVudEhlYWRpbmdMZXZlbCA9IGdldEhlYWRpbmdMZXZlbChhY3RpdmVEcm9wKQoJCQlpZiAoY3VycmVudEhlYWRpbmdMZXZlbCA+IGhlYWRpbmdMZXZlbCkgewoJCQkJLy8gV2UgdXBkYXRlIHRoZSB0aHJlc2hvbGQgYmFzZWQgb24gdGhlIHJlbGV2YW50IHBhcmVudAoJCQkJY29uc3QgcGFyID0gZ2V0SGlnaGVyUGFyZW50KGFjdGl2ZURyb3AsIGhlYWRpbmdMZXZlbCkKCQkJCWNvbnN0IHsgeSwgaGVpZ2h0IH0gPSBwYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKCQkJCXRocmVzaG9sZFkgPSB5ICsgaGVpZ2h0LzIJCQkJCQkKCQkJfQoJCX0KCQkvLyBDaGVjayBpZiB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgbW91c2UgaXMgYmVsb3cgb3IgYWJvdmUgdGhlIG1pZGRsZSBvZiB0aGUgYWN0aXZlIGRyb3Agem9uZQoJCWNvbnN0IGlzQmVsb3cgPSBlLmNsaWVudC55ID4gdGhyZXNob2xkWQoJCWNvbnN0IG5ld1NlcCA9IGdldFNlcGFyYXRvcihhY3RpdmVEcm9wLCBpc0JlbG93LCBhbGxvd0FsbCwgaGVhZGluZ0xldmVsKQoJCWNvbnN0IGN1cnJlbnRTZXAgPSB0b2MucXVlcnlTZWxlY3RvcignLnRvYy1yb3ctc2VwYXJhdG9yLmFjdGl2ZScpID8/IG5ld1NlcAoJCWlmIChjdXJyZW50U2VwICE9PSBuZXdTZXApIHsKCQkJY3VycmVudFNlcC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKQoJCX0KCQluZXdTZXAuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJykKCX0KCgljb25zdCBkcmFnSGFuZGxlcyA9IGludGVyYWN0KCcudG9jLXJvdycpLmRyYWdnYWJsZSh7CgkJY3Vyc29yQ2hlY2tlciAoYWN0aW9uLCBpbnRlcmFjdGFibGUsIGVsZW1lbnQsIGludGVyYWN0aW5nKSB7CgkJCS8vIGNvbnNvbGUubG9nKHthY3Rpb24sIGludGVyYWN0YWJsZSwgZWxlbWVudCwgaW50ZXJhY3Rpbmd9KQoJCQlyZXR1cm4gbnVsbAoJCX0sCgkJbWFudWFsU3RhcnQ6IHRydWUsIC8vIG5lZWRlZCBmb3IgY29uc2lzdGVudCBzdGFydCBhZnRlciBob2xkCgkJbGlzdGVuZXJzOiB7CgkJCXN0YXJ0OiBmdW5jdGlvbiAoZSkgewoJCQkJdG9jLmNsYXNzTGlzdC5hZGQoJ2RyYWdfZW5hYmxlZCcpCgkJCQljb25zdCByb3cgPSBlLnRhcmdldAoJCQkJLy8gY29uc29sZS5sb2coJ3N0YXJ0OiAnLCBlKQoJCQkJdG9jLmxhc3REcmFnRXZlbnQgPSBlCgkJCQlyb3cuY2xhc3NMaXN0LmFkZCgnZHJhZ2dlZCcpCgkJCQl0b2MuZHJhZ2dlZEVsZW1lbnQgPSByb3cKCQkJCXRhZ0FkamFjZW50U2VwYXJhdG9ycyhyb3csIHRydWUpCgkJCX0sCgkJCW1vdmU6IGZ1bmN0aW9uIChlKSB7CgkJCQl0b2MubGFzdERyYWdFdmVudCA9IGUKCQkJCXVwZGF0ZUFjdGl2ZVNlcGFyYXRvcigpCgkJCX0sCgkJCS8vIG1vdmU6IGZ1bmN0aW9uIChlKSB7Y29uc29sZS5sb2coJ21vdmU6ICcsZSl9LAoJCQllbmQ6IGZ1bmN0aW9uIChlKSB7CgkJCQlhY3RpdmVEcm9wID0gdW5kZWZpbmVkCgkJCQllLnByZXZlbnREZWZhdWx0KCkKCQkJCXRvYy5sYXN0RHJhZ0V2ZW50ID0gZQoJCQkJLy8gY29uc29sZS5sb2coJ2VuZDogJywgZSkKCQkJCWNvbnN0IHJvdyA9IGUudGFyZ2V0CgkJCQkvLyBDbGVhbnVwCgkJCQlyb3cuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dlZCcpCgkJCQl0b2MuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ19lbmFibGVkJykJCgkJCQlmb3IgKGNvbnN0IGVsIG9mIHRvYy5xdWVyeVNlbGVjdG9yQWxsKCcuYWN0aXZlX2Ryb3AnKSkgewoJCQkJCWVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZV9kcm9wJykKCQkJCX0KCQkJCXJlQ29sbGFwc2UoKQkJCQkKCQkJCXRhZ0FkamFjZW50U2VwYXJhdG9ycyhyb3csIGZhbHNlKQkJCQkKCQkJCXRvYy5jbGFzc0xpc3QucmVtb3ZlKCdhbGxvd19hbGxfZHJvcCcpCgkJCQkvLyBXZSB0ZW1wb3Jhcnkgc2V0IHRoZSByZWNlbnREcmFnIGZsYWcKCQkJCXRvYy5jbGFzc0xpc3QuYWRkKCdyZWNlbnQtZHJhZycpCgkJCQlzZXRUaW1lb3V0KCgpID0+IHsKCQkJCQl0b2MuY2xhc3NMaXN0LnJlbW92ZSgncmVjZW50LWRyYWcnKQoJCQkJfSwgMzAwKQoJCQkJLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gYWN0aXZlIGRyb3B6b25lCgkJCQljb25zdCBkcm9wWm9uZSA9IHRvYy5xdWVyeVNlbGVjdG9yKCcudG9jLXJvdy1zZXBhcmF0b3IuYWN0aXZlJykKCQkJCWlmIChfLmlzTmlsKGRyb3Bab25lKSB8fCBkcm9wWm9uZS5jbGFzc0xpc3QuY29udGFpbnMoJ25vc2hvdycpKSB7cmV0dXJufQoJCQkJZHJvcFpvbmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykKCQkJCS8vIFdlIGZpbmQgdGhlIGNlbGwgYWZ0ZXIgdGhlIGFjdGl2ZSBzZXBhcmF0b3IgYW5kIG1vdmUgdGhlIGRyYWdnZWQgcm93IGJlZm9yZSB0aGF0CgkJCQljb25zdCByb3dBZnRlciA9IGdldE5leHRTaWJsaW5nKGRyb3Bab25lKQoJCQkJY29uc3QgY2VsbElkc1RvTW92ZSA9IGdldEJsb2NrSWRzKHJvdykKCQkJCS8vIEZpbmQgdGhlIGluZGV4IG9mIHRoZSBjZWxsIHRoYXQgd2lsbCBzdGF5IGFmdGVyIG91ciBtb3ZlZCBibG9jawoJCQkJY29uc3QgZW5kID0gZWRpdG9yX3N0YXRlLm5vdGVib29rLmNlbGxfb3JkZXIuaW5kZXhPZihnZXRfbGlua19pZChyb3dBZnRlcikpCgkJCQkvLyBJZiB3ZSBnb3QgLTEsIGl0IG1lYW5zIHdlIGhhdmUgdG8gcHV0IHRoZSBjZWxscyBhdCB0aGUgZW5kCgkJCQlwbHV0b19hY3Rpb25zLm1vdmVfcmVtb3RlX2NlbGxzKGNlbGxJZHNUb01vdmUsIGVuZCA8IDAgPyBJbmZpbml0eSA6IGVuZCkKCQkJCXRvYy5kcmFnZ2VkRWxlbWVudCA9IHVuZGVmaW5lZAkJCgkJCX0sCgkJfQoJfSkub24oJ2hvbGQnLGZ1bmN0aW9uIChlKSB7CgkJaWYgKGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCdkaXNhYmxlX3VpJykpIHsgY29uc29sZS5sb2coJ1VJIGRpc2FibGVkLCBubyBpbnRlcmFjdGlvbiEnKTsgcmV0dXJuIH0KCQllLnByZXZlbnREZWZhdWx0KCkKCQllLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpCgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCS8vIGNvbnNvbGUubG9nKCd0aGlzIGlzIGhvbGQnLCBlKQoJCXZhciBpbnRlcmFjdGlvbiA9IGUuaW50ZXJhY3Rpb24KCgkgICAgaWYgKCFpbnRlcmFjdGlvbi5pbnRlcmFjdGluZygpKSB7CgkgICAgICBpbnRlcmFjdGlvbi5zdGFydCgKCSAgICAgICAgeyBuYW1lOiAnZHJhZycgfSwKCSAgICAgICAgZS5pbnRlcmFjdGFibGUsCgkgICAgICAgIGUuY3VycmVudFRhcmdldCwKCSAgICAgICkKCSAgICB9Cgl9KQoKCgoJLyogIyMjIyBCRUdJTk5JTkcgT0YgUEFSVCBBVVRPTUFUSUNBTExZIEFEREVEIEJZIEhUTFNDUklQVCAjIyMjICovCgkvLyBBc3NpZ24gdGhlIHZhcmlvdXMgZXZlbnRzIGxpc3RlbmVycyBkZWZpbmVkIHdpdGhpbiB0aGUgc2NyaXB0Cglmb3IgKGNvbnN0IGl0ZW0gb2YgX2V2ZW50c19saXN0ZW5lcnNfKSB7CgkJY29uc3QgeyBlbGVtZW50LCBsaXN0ZW5lcnMgfSA9IGl0ZW0KCQlmb3IgKGNvbnN0IFtuYW1lLCBmdW5jXSBvZiBfLmVudHJpZXMobGlzdGVuZXJzKSkgewogIAkJCWVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jKQoJCX0KCX0KCS8qICMjIyMgRU5EIE9GIFBBUlQgQVVUT01BVElDQUxMWSBBRERFRCBCWSBIVExTQ1JJUFQgIyMjIyAqLwoKICAgIGludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKICAgIAkKCQkvKiAjIyMjIEJFR0lOTklORyBPRiBQQVJUIEFVVE9NQVRJQ0FMTFkgQURERUQgQlkgSFRMU0NSSVBUICMjIyMgKi8KCQkvLyBSZW1vdmUgdGhlIGV2ZW50cyBsaXN0ZW5lcnMgZHVyaW5nIGludmFsaWRhdGlvbgoJCWZvciAoY29uc3QgaXRlbSBvZiBfZXZlbnRzX2xpc3RlbmVyc18pIHsKCQkJY29uc3QgeyBlbGVtZW50LCBsaXN0ZW5lcnMgfSA9IGl0ZW0KCQkJZm9yIChjb25zdCBbbmFtZSwgZnVuY10gb2YgXy5lbnRyaWVzKGxpc3RlbmVycykpIHsKCSAgCQkJZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIGZ1bmMpCgkJCX0KCQl9CgkJLyogIyMjIyBFTkQgT0YgUEFSVCBBVVRPTUFUSUNBTExZIEFEREVEIEJZIEhUTFNDUklQVCAjIyMjICovCm9ic2VydmVyLmRpc2Nvbm5lY3QoKQpkcmFnSGFuZGxlcy51bnNldCgpCgoKICAgIH0pCgo8L3NjcmlwdD4KCjxzdHlsZT4JCgkucGx1dG91aS10b2MgaGVhZGVyIHsKCQljdXJzb3I6IHBvaW50ZXI7Cgl9CglzcGFuLnRvYy1oZWFkZXItY29udGFpbmVyIHsKCQlwb3NpdGlvbjogZml4ZWQ7CgkJZGlzcGxheTogbm9uZTsKCQktLXNpemU6IDI1cHg7CgkJaGVpZ2h0OiBjYWxjKDUxcHggLSAxcmVtKTsKCQlmbGV4LWRpcmVjdGlvbjogcm93LXJldmVyc2U7CgkJcmlnaHQ6IGNhbGMoMXJlbSArIG1pbig4MHZoLCAzMDBweCkpOwoJfQoJLnRvYy1oZWFkZXItaWNvbiB7CgkJbWFyZ2luLXJpZ2h0OiAwLjNyZW07CgkJYWxpZ24tc2VsZjogc3RyZXRjaDsKCQlkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CgkJd2lkdGg6IHZhcigtLXNpemUpOwoJCWJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CgkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCQljdXJzb3I6IHBvaW50ZXI7Cgl9CgkudG9jLWhlYWRlci1maWxsZXIgewoJCW1hcmdpbjogLjI1cmVtOwoJfQoJaGVhZGVyOmhvdmVyIHNwYW4udG9jLWhlYWRlci1jb250YWluZXIsCglzcGFuLnRvYy1oZWFkZXItY29udGFpbmVyOmhvdmVyIHsKCQlkaXNwbGF5OiBmbGV4OwoJfQoJLnRvYy1oZWFkZXItaGlkZSB7CgkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXllLW91dGxpbmUuc3ZnKTsKCQlvcGFjaXR5OiA1MCU7CgkJLS1zaXplOiAxZW07Cgl9CgkudG9jLWhlYWRlci1zYXZlIHsKCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9zYXZlLW91dGxpbmUuc3ZnKTsKCQlvcGFjaXR5OiA1MCU7Cgl9CgluYXY6bm90KC5maWxlLXN0YXRlLWRpZmZlcnMpIC50b2MtaGVhZGVyLXNhdmUgewoJCWRpc3BsYXk6IG5vbmU7Cgl9CglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHNwYW4udG9jLWhlYWRlci1oaWRlIHsKCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leWUtb2ZmLW91dGxpbmUuc3ZnKTsKCX0KPC9zdHlsZT4KCjxzdHlsZT4KCXNwYW4udG9jLWhpZGUtY29udGFpbmVyIHsKCQktLXdpZHRoOiBtaW4oODB2dywgMzAwcHgpOwoJCXBvc2l0aW9uOiBmaXhlZDsKCQlkaXNwbGF5OiBmbGV4OwoJCXJpZ2h0OiBjYWxjKHZhcigtLXdpZHRoKSArIDFyZW0gKyAyMnB4IC0gMTAwcHgpOwoJCWhlaWdodDogdmFyKC0taGVpZ2h0KTsKCQl3aWR0aDogMTAwcHg7CgkJei1pbmRleDogLTE7Cgl9CglzcGFuLnRvYy1oaWRlIHsKCQl2aXNpYmlsaXR5OiBoaWRkZW47CgkJb3BhY2l0eTogNTAlOwoJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V5ZS1vdXRsaW5lLnN2Zyk7CgkJY3Vyc29yOiBwb2ludGVyOwoJfQoJZGl2LnRvYy1yb3cuaGlkZGVuIHNwYW4udG9jLWhpZGUgewoJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V5ZS1vZmYtb3V0bGluZS5zdmcpOwoJfQoJc3Bhbi50b2MtaGlkZS1jb250YWluZXI6aG92ZXIgPiAudG9jLWhpZGUsCglkaXYudG9jLXJvdzpob3ZlciAudG9jLWhpZGUgewoJCXZpc2liaWxpdHk6IHZpc2libGU7Cgl9CglkaXYudG9jLXJvdyBhIHsKCQlkaXNwbGF5OiBmbGV4OwoJfQoJc3Bhbi50b2MtaWNvbiB7CgkJLS1zaXplOiAxN3B4OwoJCWRpc3BsYXk6IGJsb2NrOwoJCWFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCSAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwoJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQl3aWR0aDogdmFyKC0tc2l6ZSk7CgkJZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKCX0KCXNwYW4udG9jLWNvbGxhcHNlIHsKCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQltYXJnaW4tcmlnaHQ6IDNweDsKCQltaW4td2lkdGg6IHZhcigtLXNpemUpOwoJfQoJLnBsdXRvdWktdG9jIHNlY3Rpb24gZGl2LnRvYy1yb3cuY29sbGFwc2VkIHNwYW4udG9jLWNvbGxhcHNlIHsKCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCX0KCS5wbHV0b3VpLXRvYyBzZWN0aW9uIGRpdi50b2Mtcm93IGEgc3Bhbi50b2MtY29sbGFwc2Uubm8tY2hpbGRyZW4gewoJCWJhY2tncm91bmQtaW1hZ2U6IG5vbmU7Cgl9CglkaXYudG9jLXJvdy5wYXJlbnQtaGlkZGVuIHsKCQl0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZSBkb3R0ZWQgLjVweDsKCQl0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDJweDsKCX0KCWRpdi50b2Mtcm93LmhpZGRlbiB7CgkJdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmUgZGFzaGVkIDFweDsKCQl0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDJweDsKCX0KCS5wbHV0b3VpLXRvYyBkaXYucGFyZW50LWNvbGxhcHNlZCB7CgkJZGlzcGxheTogbm9uZTsKCX0KCXBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gZGl2LnRvYy1yb3cuaGlkZGVuLAoJcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBkaXYudG9jLXJvdy5wYXJlbnQtaGlkZGVuIHsKCQlkaXNwbGF5OiBub25lOwoJfQoJLmRyYWdfZW5hYmxlZCAudG9jLXJvdy5kcmFnZ2VkIHsKCQlib3JkZXI6IDJweCBkYXNoZWQgZ3JleTsKCX0KPC9zdHlsZT4KCjxzdHlsZT4KCWRpdi50b2Mtcm93LXNlcGFyYXRvciB7CgkJaGVpZ2h0OiAycHg7CgkJbWFyZ2luOiAzcHggMHB4OwoJCWJhY2tncm91bmQ6ICNhYWE7CgkJZGlzcGxheTogbm9uZTsKCX0KCWRpdi50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUgewoJCWRpc3BsYXk6IGJsb2NrOwoJfQoJZGl2LnRvYy1yb3ctc2VwYXJhdG9yLmFjdGl2ZS5ub3Nob3cgewoJCWRpc3BsYXk6IG5vbmU7Cgl9Cjwvc3R5bGU+Cgo8c3R5bGU+CgkvKiBUaGlzIHN0eWxlIHBlcm1pdHMgdG8gaGF2ZSBhIGNlbGwgd2hvc2Ugb3V0cHV0IGlzIHN0aWxsIGJlaW5nIHNob3duIHdoZW4KCSAgIHRoZSBjZWxsIGlzIGhpZGRlbi4gVGhpcyBpcyB1c2VmdWwgZm9yIGhhdmluZyBoaWRkZW4gY2VsbHMgdGhhdCBzdGlsbCBhcmUKCSAgIHNlbmRpbmcgSFRNTCBhcyBvdXRwdXQgKGxpa2UgVG9DIGFuZCBCb25kVGFibGUpICovCgkKCXBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdIHsKCQlkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50OwoJfQoJcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF06bm90KC5jb2RlX2RpZmZlcnMpID4gcGx1dG8taW5wdXQsCglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XTpub3QoLmNvZGVfZGlmZmVycykgPiBwbHV0by1zaG91bGRlciwKCXBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdOm5vdCguY29kZV9kaWZmZXJzKSA+IHBsdXRvLXRyYWZmaWNsaWdodCwKCXBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdOm5vdCguY29kZV9kaWZmZXJzKSA+IHBsdXRvLXJ1bmFyZWEsCglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XTpub3QoLmNvZGVfZGlmZmVycykgPiBidXR0b24gewoJCWRpc3BsYXk6IG5vbmU7Cgl9CglwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XTpub3QoLmNvZGVfZGlmZmVycykgewoJCW1hcmdpbi10b3A6IDBweDsKCX0KPC9zdHlsZT4KCqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQn5bPxLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOBpufV7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaA5g8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhlIHN0cnVjdHVyZXMgYWJvdmUgY2FuIGFsc28gYmUgdXNlZCBuZXN0ZWQgd2l0aGluIG9uZSBhbm90aGVyLiBUbyBmYWNpbGl0YXRlIGFjY2Vzc2luZyBuZXN0ZWQgc3RydWN0dXJlcywgb25lIGNhbiB1c2UgdGhlIDxjb2RlPlBvcG91dDwvY29kZT4gdHlwZS48L3A+CjxwPkluIGl0cyBzaW1wbGUgZm9ybSwgeW91IGNhbiBnaXZlIGFuIGluc3RhbmNlIG9mIGEgU3RydWN0Qm9uZCwgYSBib25kIHdyYXBwaW5nIGEgU3RydWN0Qm9uZCBvciBhIEJvbmRzTGlzdCBhcyBpbnB1dCB0byBQb3BvdXQgdG8gY3JlYXRlIGEgdGFibGUgdGhhdCBpcyBoaWRkZW4gYmVoaW5kIGEgcG9wdXAgd2luZG93LiBJZiBhbiBpbnN0YW5jZSBwcmVzZW50LCBidXQgeW91IHdhbnQgYSBjdXN0b20gdHlwZSBmb3Igd2hpY2ggeW91IGhhdmUgZGVmaW5lZCBjdXN0b20gYm9uZHMgYW5kIGRlc2NyaXB0aW9ucyB3aXRoIDxjb2RlPkBmaWVsZGRhdGE8L2NvZGU+IHRvIGFwcGVhciBhcyBwb3BvdXQsIHlvdSBjYW4gdXNlIHRoZSBmdW5jdGlvbiA8Y29kZT5wb3BvdXR3cmFwJiM0MDtUWVBFJiM0MTs8L2NvZGU+IHRvIGdlbmVyYXRlIGEgc21hbGwgaWNvbiB3aGljaCBoaWRlcyBhIHBvcHVwIGNvbnRhaW5pbmcgdGhlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IG9mIHRoZSBwcm92aWRlZCB0eXBlIDxjb2RlPlRZUEU8L2NvZGU+LjwvcD4KPHA+VGhlIFN0cnVjdEJvbmQgdGFibGUgYXBwZWFycyBvbiBob3ZlciB1cG9uIHRoZSBpY29uLCBjYW4gYmUgbWFkZSBmaXhlZCBieSBjbGlja2luZyBvbiB0aGUgaWNvbiBhbmQgY2FuIHRoZW4gYmUgbW92ZWQgYXJvdW5kIG9yIHJlc2l6ZWQuIEEgZG91YmxlIGNsaWNrIG9uIHRoZSBoZWFkZXIgb2YgdGhlIHBvcG91dCBoaWRlcyBpdCBhZ2Fpbjo8L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTvICLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAcWPLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZLzxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+Qm9uZFRhYmxlPC9oMT4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCZO/92sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDW5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4AAyhqtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedr06Txib25kc2xpc3QtY29udGFpbmVyIGNsYXNzPSduby1wb3BvdXQnPgoJPGJvbmRzbGlzdC1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2NvbGxhcHNlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJyB0aXRsZT0iVGhpcyBsaXN0IGNvbnRhaW5zIGluZGVwZW5kZW50IGJvbmRzIj5Qb3BvdXQgQ29udGFpbmVyPC9zcGFuPgoJCTxzcGFuIGNsYXNzPSd0b2dnbGUgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCTwvYm9uZHNsaXN0LWhlYWRlcj4KCTxib25kc2xpc3QtY29udGVudHM+Cgk8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgYXNkYCc+CgkJU3RydWN0dXJlIEFTRAoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSd1bmJ4bWVnZ2hpJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3lmamRuY3hvYnInIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxib25kIGRlZj0iYXNkIiB1bmlxdWVfaWQ9IkpxOThwNkxzZXJRMCI+PHN0cnVjdC1ib25kIGNsYXNzPSdNYWluLnZhciZxdW90O3dvcmtzcGFjZSM0JnF1b3Q7LkFTRCc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPkFTRDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2tvc2hpdnRjYXInIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2VvZ2x1cGNwc3gnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2EnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2EnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGFgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+TWFya2Rvd24gZGVzY3JpcHRpb24sIGluY2x1ZGluZyA8c3BhbiBjbGFzcz0idGV4Ij4kTGFUZVgkPC9zcGFuPjwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2EnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2hydnF1YWV2a2YnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0naHJ2cXVhZXZrZic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImhydnF1YWV2a2YiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2VvZ2x1cGNwc3gnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2InPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2InIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGJgIj48c3Bhbj5GaWVsZCB3aXRoIDxiPkhUTUw8L2I+IGRlc2NyaXB0aW9uPC9zcGFuPjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdxc3pzeXd5d2NxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c2NyaXB0PgovLyB3ZWlyZCBpbXBvcnQgdG8gbWFrZSBpdCBmYXN0ZXIuIFRoZSBgYXdhaXQgaW1wb3J0YCBjYW4gc3RpbGwgZGVsYXkgZXhlY3V0aW9uIGJ5IG9uZSBmcmFtZSBpZiBpdCBpcyBhbHJlYWR5IGxvYWRlZC4uLgp3aW5kb3cuZDNmb3JtYXQgPSB3aW5kb3cuZDNmb3JtYXQgPz8gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKY29uc3QgYXJnbWluID0geHMgPT4geHMuaW5kZXhPZihNYXRoLm1pbiguLi54cykpCmNvbnN0IGNsb3Nlc3RfaW5kZXggPSAoeHMsIHkpID0+IGFyZ21pbih4cy5tYXAoeCA9PiBNYXRoLmFicyh4LXkpKSkKCmNvbnN0IHZhbHVlcyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF0KCmNvbnN0IGVsID0gaHRtbGAKPHNwYW4gdGl0bGU9IkNsaWNrIGFuZCBkcmFnIHRoaXMgbnVtYmVyIGxlZnQgb3IgcmlnaHQhIiBzdHlsZT0iY3Vyc29yOiBjb2wtcmVzaXplOwp0b3VjaC1hY3Rpb246IG5vbmU7CmJhY2tncm91bmQ6IHJnYigyNTIsIDIwOSwgMjA0KTsKY29sb3I6IGJsYWNrOwpwYWRkaW5nOiAwZW0gLjJlbTsKYm9yZGVyLXJhZGl1czogLjNlbTsKZm9udC13ZWlnaHQ6IGJvbGQ7Ij42PC9zcGFuPgpgCgoKCmxldCBvbGRfeCA9IDAKbGV0IG9sZF9pbmRleCA9IDAKY29uc3QgaW5pdGlhbF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCA2KQpsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCmNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJc2V0OiB4ID0+IHsKCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7CgovLyBpbml0aWFsIHZhbHVlCmVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcig2KQoKY29uc3Qgb25TY3J1YiA9IChlKSA9PiB7Cgljb25zdCBvZmZzZXQgPSBlLmNsaWVudFggLSBvbGRfeAoJY29uc3QgbmV3X2luZGV4ID0gTWF0aC5taW4odmFsdWVzLmxlbmd0aC0xLCBNYXRoLm1heCgwLCAKCQlNYXRoLnJvdW5kKG9mZnNldC8xMCkgKyBvbGRfaW5kZXgKCSkpCgoJaWYobmV3X2luZGV4ICE9PSBjdXJyZW50X2luZGV4KSB7CgkJY3VycmVudF9pbmRleCA9IG5ld19pbmRleAoJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCX0KfQoKY29uc3Qgb25wb2ludGVyZG93biA9IChlKSA9PiB7Cgl3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKQoJb2xkX3ggPSBlLmNsaWVudFgKCW9sZF9pbmRleCA9IGN1cnJlbnRfaW5kZXgKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoKY29uc3Qgb25kYmxjbGljayA9IChlKSA9PiB7CgljdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCn0KZWwuYWRkRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoKY29uc3Qgb25wb2ludGVydXAgPSAoKSA9PiB7Cgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQp9CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCmVsLm9uc2VsZWN0c3RhcnQgPSAoKSA9PiBmYWxzZQoKaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQp9KQoKcmV0dXJuIGVsCgo8L3NjcmlwdD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdxc3pzeXd5d2NxJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAicXN6c3l3eXdjcSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYycgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgY2AiPk5vcm1hbCBTdHJpbmcgRGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nd3dzcXB5c2JvZycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3d3c3FweXNib2cnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ3d3NxcHlzYm9nIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlb2dsdXBjcHN4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdkJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdkJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBkYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPlRoaXMgZmllbGQgaXMgPGVtPnNwZWNpYWw8L2VtPjwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2QnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2xxcGliaGx4cGwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSd0ZXh0JyB2YWx1ZT0nJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdscXBpYmhseHBsJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibHFwaWJobHhwbCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZW9nbHVwY3BzeCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nZSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nZScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgZWAiPmU8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nb2ljY3VkbHlnbicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nNicgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J29pY2N1ZGx5Z24nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJvaWNjdWRseWduIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nZW9nbHVwY3BzeCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVvZ2x1cGNwc3giCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBBU0RgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2tvc2hpdnRjYXInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJrb3NoaXZ0Y2FyIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSduendpZW5pcG9kJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0ncXlvbmNxa3NxaSc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIkN1c3RvbSBEZXNjcmlwdGlvbiIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0ndW5ieG1lZ2doaSc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb20nKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCgkvLyBXZSB1c2UgdGhlIGludGVyYWN0anMgbGlicmFyeSB0byBwcm92aWRlIGRyYWcgYW5kIHJlc2l6ZSBoYW5kbGluZyBhY3Jvc3MgZGV2aWNlcwoJY29uc3QgeyBkZWZhdWx0OiBpbnRlcmFjdCB9ID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9pbnRlcmFjdGpzJykKCgljb250ZW50cy5vZmZzZXQgPSBjb250ZW50cy5vZmZzZXQgPz8geyB4OiAwLCB5OiAwfQoJY29uc3Qgc3RhcnRQb3NpdGlvbiA9IHt4OiAwLCB5OiAwfQoJaW50ZXJhY3QoY29udGVudHMucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5kZXNjcmlwdGlvbiwgYm9uZHNsaXN0LWhlYWRlciAuZGVzY3JpcHRpb24nKSkuZHJhZ2dhYmxlKHsKCQlsaXN0ZW5lcnM6IHsKCQkJc3RhcnQgKGV2ZW50KSB7CgkJCQljb250ZW50cy5vZmZzZXQueSA9IHN0YXJ0UG9zaXRpb24ueSA9IGNvbnRlbnRzLm9mZnNldFRvcAoJCQkJY29udGVudHMub2Zmc2V0LnggPSBzdGFydFBvc2l0aW9uLnggPSBjb250ZW50cy5vZmZzZXRMZWZ0CgkJCX0sCgkJCW1vdmUgKGV2ZW50KSB7CgkJICAgICAgY29udGVudHMub2Zmc2V0LnggKz0gZXZlbnQuZHgKCQkgICAgICBjb250ZW50cy5vZmZzZXQueSArPSBldmVudC5keQoJCQoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLnRvcCA9IGBtaW4oOTV2aCwgJHtjb250ZW50cy5vZmZzZXQueX1weGAKCQkgICAgICBjb250ZW50cy5zdHlsZS5sZWZ0ID0gYG1pbig5NXZ3LCAke2NvbnRlbnRzLm9mZnNldC54fXB4YAoJCSAgICB9LAoJCX0KCX0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gaGVhZGVyIHJlc2V0IHRoZSBwb3NpdGlvbgoJCWNvbnRhaW5lci5wb3BvdXQoKQoJfSkKCWludGVyYWN0KGNvbnRlbnRzKQoJICAucmVzaXphYmxlKHsKCSAgICBlZGdlczogeyB0b3A6IHRydWUsIGxlZnQ6IGZhbHNlLCBib3R0b206IHRydWUsIHJpZ2h0OiB0cnVlIH0sCgkgICAgbGlzdGVuZXJzOiB7CgkgICAgICBtb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHsJCQoJICAgICAgICBPYmplY3QuYXNzaWduKGV2ZW50LnRhcmdldC5zdHlsZSwgewoJICAgICAgICAgIHdpZHRoOiBgJHtldmVudC5yZWN0LndpZHRofXB4YCwKCSAgICAgICAgICBoZWlnaHQ6IGAke2V2ZW50LnJlY3QuaGVpZ2h0fXB4YCwKCSAgICAgICAgfSkKCSAgICAgIH0KCSAgICB9CgkgIH0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gcmVzaXplIHJlc2V0IHRoZSB3aWR0aAoJCQljb250ZW50cy5zdHlsZS53aWR0aCA9ICcnCgkJICAJY29udGVudHMuc3R5bGUuaGVpZ2h0ID0gJycKCSAgfSkKCgoJZnVuY3Rpb24gcG9zaXRpb25Db250ZW50cygpIHsKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogW2F1dG9QbGFjZW1lbnQoKV0sCgkJfSkudGhlbigocG9zKSA9PiB7CgkJCWNvbnRlbnRzLnN0eWxlLmxlZnQgPSBwb3MueCArICJweCIKCQkJY29udGVudHMuc3R5bGUudG9wID0gcG9zLnkgKyAicHgiCgkJfSkKCX0KCgljb250YWluZXIucG9wb3V0ID0gKGZvcmNlID0gdW5kZWZpbmVkKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ3BvcHBlZCcsIGZvcmNlKQoJCXBvc2l0aW9uQ29udGVudHMoKQoJfQoKCWhlYWRlci5vbmNsaWNrID0gKGUpID0+IHtjb250YWluZXIucG9wb3V0KCl9CgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50cy1ob3ZlcicsIHRydWUpCgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgZmFsc2UpCgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCBmYWxzZSkKPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J3lmamRuY3hvYnInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ5ZmpkbmN4b2JyIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYG50YCc+CgkJTmFtZWRUdXBsZQoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSdwbWNzbmFuZmduJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2pkY2NqbmRrbWQnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxib25kIGRlZj0ibnQiIHVuaXF1ZV9pZD0iVzBTdjlkUXQ2WGhkIj48c3RydWN0LWJvbmQgY2xhc3M9J05hbWVkVHVwbGV7KFN5bWJvbCgmcXVvdDsjIzIzMiZxdW90OyksIDphLCA6YiwgOmMpfSc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPk5hbWVkVHVwbGU8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtdWdidGdrcWZzJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nc2FqeG1tY3p1cCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdzYWp4bW1jenVwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAic2FqeG1tY3p1cCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnVlbm9lZGJieCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd6dmhpb3h5b2FpJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3p2aGlveHlvYWknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ6dmhpb3h5b2FpIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdic2l6dWx0dXJjJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JzaXp1bHR1cmMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJic2l6dWx0dXJjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYnVlbm9lZGJieCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJ1ZW5vZWRiYngiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBOYW1lZFR1cGxlYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdtdWdidGdrcWZzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibXVnYnRna3FmcyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nandnZW90ZHZtcyc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JieHd4bHJidWcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJNeSBGYW5jeSBOVHVwbGUiCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvcG9wb3V0LWNvbnRlbnRzPgo8L3BvcG91dC1jb250YWluZXI+CjxzY3JpcHQgaWQ9J3BtY3NuYW5mZ24nPgoJLy8gTG9hZCB0aGUgZmxvYXRpbmctdWkgYW5kIGludGVyYWN0IGxpYnJhcmllcwoJd2luZG93LmZsb2F0aW5nX3VpID0gYXdhaXQgaW1wb3J0KCdodHRwczovL2VzbS5zaC9AZmxvYXRpbmctdWkvZG9tJykKCgljb25zdCB7IGNvbXB1dGVQb3NpdGlvbiwgYXV0b1BsYWNlbWVudCB9ID0gZmxvYXRpbmdfdWkKCQoJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgljb25zdCBoZWFkZXIgPSBjb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGNvbnRlbnRzID0gY29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQKCgkvLyBMb2FkIHRoZSBpbnRlcmFjdGpzIHBhcnQKCQoJLy8gV2UgdXNlIHRoZSBpbnRlcmFjdGpzIGxpYnJhcnkgdG8gcHJvdmlkZSBkcmFnIGFuZCByZXNpemUgaGFuZGxpbmcgYWNyb3NzIGRldmljZXMKCWNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgoJY29udGVudHMub2Zmc2V0ID0gY29udGVudHMub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuZGVzY3JpcHRpb24sIGJvbmRzbGlzdC1oZWFkZXIgLmRlc2NyaXB0aW9uJykpLmRyYWdnYWJsZSh7CgkJbGlzdGVuZXJzOiB7CgkJCXN0YXJ0IChldmVudCkgewoJCQkJY29udGVudHMub2Zmc2V0LnkgPSBzdGFydFBvc2l0aW9uLnkgPSBjb250ZW50cy5vZmZzZXRUb3AKCQkJCWNvbnRlbnRzLm9mZnNldC54ID0gc3RhcnRQb3NpdGlvbi54ID0gY29udGVudHMub2Zmc2V0TGVmdAoJCQl9LAoJCQltb3ZlIChldmVudCkgewoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGVudHMub2Zmc2V0LnkgKz0gZXZlbnQuZHkKCQkKCQkgICAgICBjb250ZW50cy5zdHlsZS50b3AgPSBgbWluKDk1dmgsICR7Y29udGVudHMub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGVudHMuc3R5bGUubGVmdCA9IGBtaW4oOTV2dywgJHtjb250ZW50cy5vZmZzZXQueH1weGAKCQkgICAgfSwKCQl9Cgl9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIGhlYWRlciByZXNldCB0aGUgcG9zaXRpb24KCQljb250YWluZXIucG9wb3V0KCkKCX0pCglpbnRlcmFjdChjb250ZW50cykKCSAgLnJlc2l6YWJsZSh7CgkgICAgZWRnZXM6IHsgdG9wOiB0cnVlLCBsZWZ0OiBmYWxzZSwgYm90dG9tOiB0cnVlLCByaWdodDogdHJ1ZSB9LAoJICAgIGxpc3RlbmVyczogewoJICAgICAgbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7CQkKCSAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudC50YXJnZXQuc3R5bGUsIHsKCSAgICAgICAgICB3aWR0aDogYCR7ZXZlbnQucmVjdC53aWR0aH1weGAsCgkgICAgICAgICAgaGVpZ2h0OiBgJHtldmVudC5yZWN0LmhlaWdodH1weGAsCgkgICAgICAgIH0pCgkgICAgICB9CgkgICAgfQoJICB9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIHJlc2l6ZSByZXNldCB0aGUgd2lkdGgKCQkJY29udGVudHMuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRlbnRzLnN0eWxlLmhlaWdodCA9ICcnCgkgIH0pCgoKCWZ1bmN0aW9uIHBvc2l0aW9uQ29udGVudHMoKSB7CgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFthdXRvUGxhY2VtZW50KCldLAoJCX0pLnRoZW4oKHBvcykgPT4gewoJCQljb250ZW50cy5zdHlsZS5sZWZ0ID0gcG9zLnggKyAicHgiCgkJCWNvbnRlbnRzLnN0eWxlLnRvcCA9IHBvcy55ICsgInB4IgoJCX0pCgl9CgoJY29udGFpbmVyLnBvcG91dCA9IChmb3JjZSA9IHVuZGVmaW5lZCkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdwb3BwZWQnLCBmb3JjZSkKCQlwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCgloZWFkZXIub25jbGljayA9IChlKSA9PiB7Y29udGFpbmVyLnBvcG91dCgpfQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCB0cnVlKQoJY29udGVudHMub25tb3VzZWxlYXZlID0gKGUpID0+IGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50cy1ob3ZlcicsIGZhbHNlKQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJfQoJaGVhZGVyLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgZmFsc2UpCjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdqZGNjam5ka21kJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiamRjY2puZGttZCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+CgkKCTwvYm9uZHNsaXN0LWNvbnRlbnRzPgoJPHNjcmlwdCBpZD0neHlxeG11a2JvcCc+CgkJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29udGFpbmVyLmNvbGxhcHNlID0gKGZvcmNlKSA9PiB7CgkJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnLCBmb3JjZSkKCQl9CgkJY29uc3QgY29sbGFwc2VfYnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4uY29sbGFwc2UnKQoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IGNvbnRhaW5lci5jb2xsYXBzZSgpCgk8L3NjcmlwdD4KCTxzdHlsZT4KCWJvbmRzbGlzdC1oZWFkZXIgewogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgZGlzcGxheTogZmxleDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7Cn0KYm9uZHNsaXN0LWhlYWRlcjpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAwcHg7CiAgYm90dG9tOiAwcHg7CiAgbGVmdDogMHB4OwogIHJpZ2h0OiAwcHg7CiAgei1pbmRleDogLTE7CiAgYmFja2dyb3VuZDogI2ZmYWM0NTQwOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0ID4gYm9uZHNsaXN0LWhlYWRlciB7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBwYWRkaW5nLXRvcDogMTJweDsKICBtYXJnaW4tdG9wOiAtMTJweDsKICB6LWluZGV4OiAxMDsKfQpib25kc2xpc3QtY29udGVudHMgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0OmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogYmxvY2s7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBqdXN0aWZ5LXNlbGY6IGNlbnRlcjsKICBib3JkZXItYm90dG9tOiAycHggc29saWQ7CiAgcGFkZGluZy10b3A6IDVweDsKICB3aWR0aDogMTAwJTsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICB6LWluZGV4OiAyMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLmJvbmRzbGlzdC1pY29uIHsKICAtLXNpemU6IDE3cHg7CiAgZGlzcGxheTogYmxvY2s7CiAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogIHdpZHRoOiB2YXIoLS1zaXplKTsKICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogIGN1cnNvcjogcG9pbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCA+IGJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgd2lkdGg6IDMwcHg7CiAgbWFyZ2luOiAwIDEwcHg7Cn0KYm9uZHNsaXN0LWhlYWRlciB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICB3aWR0aDogMTAwJTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgZmxleC1ncm93OiAxOwogIGZvbnQtc2l6ZTogMThweDsKICBmb250LXdlaWdodDogNjAwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBhbGlnbi1zZWxmOiBjZW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgYm9uZHNsaXN0LWhlYWRlciArICogewogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQpib25kc2xpc3QtY29udGFpbmVyIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgcm93LWdhcDogNXB4Owp9CmJvbmRzdGFibGUtY29udGFpbmVyIGJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CgkJCgk8L3N0eWxlPgo8L2JvbmRzbGlzdC1jb250YWluZXI+CqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWWjYmxjsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQoUyJQLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAALRtbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmgpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQoRw+GLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAcHLBLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM4qmcXVldWVkwqRsb2dzkYikbGluZf+jbXNnktlCV0FSTklORzogY291bGQgbm90IGltcG9ydCBQbHV0b1VJLkB3aXRoX3Rlcm1pbmFsIGludG8gd29ya3NwYWNlIzMKqnRleHQvcGxhaW6nY2VsbF9pZNkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpmt3YXJnc5CiaWS5TWFpbl9QbHV0b1J1bm5lcl8zMDQzZGI4Y6RmaWxl2UQvaG9tZS9hbWVuZ2FsaS8uanVsaWEvcGFja2FnZXMvUGx1dG8va3hlc28vc3JjL3J1bm5lci9QbHV0b1J1bm5lci5qbKVncm91cKtQbHV0b1J1bm5lcqVsZXZlbK5Mb2dMZXZlbCgtNTU1KadydW5uaW5nwqZvdXRwdXSGpGJvZHnaCOM8c2NyaXB0IGlkPSd5U3dqd24nPgogICAgCgkJY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZnJvbXBhcmVudC1jb250YWluZXInKSA/PyBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGh0bWxgPGZyb21wYXJlbnQtY29udGFpbmVyPmApCgkJY29udGFpbmVyLmlubmVySFRNTCA9ICJSZWxvYWQgQGZyb21wYWNrYWdlIgoJCS8vIFdlIHNldCB0aGUgZXJyb3JlZCBzdGF0ZQoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdlcnJvcmVkJywgZmFsc2UpCgkJY29uc3Qgc3R5bGUgPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3R5bGUnKSA/PyBjb250YWluZXIuYXBwZW5kQ2hpbGQoaHRtbGA8c3R5bGU+YCkKCQlzdHlsZS5pbm5lckhUTUwgPSAiCWZyb21wYXJlbnQtY29udGFpbmVyIHtcbgkgICAgaGVpZ2h0OiAyMHB4O1xuCSAgICBwb3NpdGlvbjogZml4ZWQ7XG4JICAgIHRvcDogNDBweDtcbgkJcmlnaHQ6IDEwcHg7XG4JICAgIG1hcmdpbi10b3A6IDVweDtcbgkgICAgcGFkZGluZy1yaWdodDogNXB4O1xuCSAgICB6LWluZGV4OiAyMDA7XG4JCWJhY2tncm91bmQ6ICNmZmZmZmY7XG4JICAgIHBhZGRpbmc6IDVweCA4cHg7XG4JICAgIGJvcmRlcjogM3B4IHNvbGlkICNlM2UzZTM7XG4JICAgIGJvcmRlci1yYWRpdXM6IDEycHg7XG4JICAgIGhlaWdodDogMzVweDtcbgkgICAgZm9udC1mYW1pbHk6IFwiU2Vnb2UgVUkgRW1vamlcIiwgXCJSb2JvdG8gTW9ub1wiLCBtb25vc3BhY2U7XG4JICAgIGZvbnQtc2l6ZTogMC43NXJlbTtcbgl9XG4JZnJvbXBhcmVudC1jb250YWluZXIuZXJyb3JlZCB7XG4JCWJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY2VsbC1jb2xvcilcbgl9XG4JZnJvbXBhcmVudC1jb250YWluZXI6aG92ZXIge1xuCSAgICBmb250LXdlaWdodDogODAwO1xuCQljdXJzb3I6IHBvaW50ZXI7XG4JfVxuCWJvZHkuZGlzYWJsZV91aSBmcm9tcGFyZW50LWNvbnRhaW5lciB7XG4JCWRpc3BsYXk6IG5vbmU7XG4JfVxuCXBsdXRvLWxvZy1kb3QtcG9zaXRpb25lcltoaWRkZW5dIHtcbgkJZGlzcGxheTogbm9uZTtcbgl9XG4iCgkJY29uc3QgY2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCI5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDMiKQoJCWNvbnN0IGFjdGlvbnMgPSBjZWxsLl9pbnRlcm5hbF9wbHV0b19hY3Rpb25zCgkJY29udGFpbmVyLm9uY2xpY2sgPSAoZSkgPT4gewoJCQlpZiAoZS5jdHJsS2V5KSB7CgkJCQloaXN0b3J5LnB1c2hTdGF0ZSh7fSwnJykJCQkKCQkJCWNlbGwuc2Nyb2xsSW50b1ZpZXcoewoJCQkJCWJlaGF2aW9yOiAnYXV0bycsCgkJCQkJYmxvY2s6ICdjZW50ZXInLAkJCQkKCQkJCX0pCgkJCX0gZWxzZSB7CgkJCQlhY3Rpb25zLnNldF9hbmRfcnVuX211bHRpcGxlKFsiOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzIl0pCgkJCX0KCQl9Cgpjb25zdCBsb2dzX3Bvc2l0aW9uZXIgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3BsdXRvLWxvZy1kb3QtcG9zaXRpb25lcicpCmlmIChsb2dzX3Bvc2l0aW9uZXIgPT0gdW5kZWZpbmVkKSB7cmV0dXJufQpjb25zdCBsb2dzID0gbG9nc19wb3NpdGlvbmVyLnBhcmVudEVsZW1lbnQKY29uc3QgbG9nc19jb250YWluZXIgPSBsb2dzLnBhcmVudEVsZW1lbnQKCmNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9uTGlzdCwgb2JzZXJ2ZXIpID0+IHsKCWZvciAoY29uc3QgY2hpbGQgb2YgbG9ncy5jaGlsZHJlbikgewoJCWlmICghY2hpbGQuaGFzQXR0cmlidXRlKCdoaWRkZW4nKSkgewoJCQlsb2dzLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siCgkJCWxvZ3NfY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siCgkJCXJldHVybgoJCX0KCX0KCS8vIElmIHdlIHJlYWNoIGhlcmUgYWxsIHRoZSBjaGlsZHJlbiBhcmUgaGlkZGVuLCBzbyB3ZSBoaWRlIHRoZSBjb250YWluZXIgYXMgd2VsbAkJCglsb2dzLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIKCWxvZ3NfY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIKfSkKCm9ic2VydmVyLm9ic2VydmUobG9ncywge3N1YnRyZWU6IHRydWUsIGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZX0pCmxvZ3NfcG9zaXRpb25lci50b2dnbGVBdHRyaWJ1dGUoJ2hpZGRlbicsdHJ1ZSkKCgogICAgaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewogICAgCWNvbnNvbGUubG9nKCdpbnZhbGlkYXRpb24nKQoJb2JzZXJ2ZXIuZGlzY29ubmVjdCgpCgoKICAgIH0pCgo8L3NjcmlwdD4KpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCe59vosHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDO5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc8AAAABAgT/qLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZMDxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+U3RydWN0Qm9uZDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTcvG7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAMSarVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjN4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZMDxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDE+QEJvbmRzTGlzdDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTekI7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM3uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAPp9LVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmmMi4wZTEwpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQogVxLrBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWU+tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYOoZWxlbWVudHOTkqFhkqExqnRleHQvcGxhaW6SoWKSoTGqdGV4dC9wbGFpbpKhY5KhMap0ZXh0L3BsYWlupHR5cGWqTmFtZWRUdXBsZahvYmplY3RpZLAyYTljMTU2Y2E1NWU2N2M1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwRmMFfGLBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWUttXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoEGjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5JbiBzb21lIGNhc2VzLCBvbmUgZG9lcyBub3Qgd2FudCB0byBoYXZlIGEgc2luZ2xlIGJvbmQgd3JhcHBpbmcgZWl0aGVyIGEgU3RydWN0dXJlIG9yIGEgTmFtZWRUdXBsZSwgYW5kIHNpbmdsZSBpbmRlcGVuZGVudCBib25kcyBhcmUgbW9yZSBjb252ZW5pZW50LjwvcD4KPHA+PGNvZGU+QEJvbmRzTGlzdDwvY29kZT4gaXMgYSBjb252ZW5pZW5jZSBtYWNybyB0byBjcmVhdGUgYW4gb2JqZWN0IG9mIHR5cGUgPGNvZGU+Qm9uZHNMaXN0PC9jb2RlPiB3aGljaCBzaW1wbHkgYWxsb3cgdG8gYWRkIGEgZGVzY3JpcHRpb24gdG8gc2VwYXJhdGUgYm9uZHMgYW5kIGdyb3VwIHRoZW0gYWxsIHRvZ2V0aGVyIGluIGEgdGFibGUtbGlrZSBmb3JtYXQgZXF1aXZhbGVudCB0byB0aG9zZSBvZiA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPi48L3A+CjxkaXYgY2xhc3M9ImFkbW9uaXRpb24gbm90ZSI+PHAgY2xhc3M9ImFkbW9uaXRpb24tdGl0bGUiPk5vdGU8L3A+PHA+VW5saWtlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+LCBhIEJvbmRzTGlzdCBpcyBhbHJlYWR5IGNvbXBvc2VkIG9mIGJvbmQgY3JlYXRlZCB3aXRoIDxjb2RlPkBiaW5kPC9jb2RlPiBhbmQgaXQganVzdCBncm91cHMgdGhlbSB1cCB3aXRoIGEgZGVzY3JpcHRpb24uIFRoZSBvdXRwdXQgb2YgPGNvZGU+QEJvbmRzTGlzdDwvY29kZT4gaXMgbm90IHN1cHBvc2VkIHRvIGJlIGJvdW5kIHRvIGEgdmFyaWFibGUgdXNpbmcgPGNvZGU+QGJpbmQ8L2NvZGU+LjxiciAvPlRoZSBib25kcyBncm91cGVkIGluIGEgQm9uZHNMaXN0IHN0aWxsIGFjdCBhbmQgdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSBvbmUgYW5vdGhlci48L3A+CjwvZGl2Pgo8cD5TZWUgdGhlIGV4YW1wbGUgYmVsb3cgZm9yIHVuZGVyc3RhbmRpbmcgdGhlIHN5bnRoYXguIFRoZSBoZWFkZXIgb2YgYSBCb25kc0xpc3QgaXMgc2hvd24gaW4gYW4gb3JhbmdlIGJhY2tncm91bmQgdG8gZWFzaWx5IGRpZmZlcmVudGlhdGUgaXQgZnJvbSA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPi48L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2TwQmTuDF7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAdX3bVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAYM8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhlIGFiaWxpdHkgdG8gYWxzbyB3cmFwIHByZS1leGlzdGluZyBib25kcyBhcm91bmQgU3RydWN0Qm9uZHMgaXMgY29udmVuaWVudCBmb3Igb3JnYW5pemluZyB0aGUgdmFyaW91cyBib25kcyBvbmUgaGF2ZSBpbiBhIDxjb2RlPkJvbmRzTGlzdDwvY29kZT4gb3IgPGNvZGU+Qm9uZFRhYmxlPC9jb2RlPjwvcD4KPHA+QXMgYW4gZXhhbXBsZSwgb25lIGNhbiBjcmVhdGUgYSA8Y29kZT5Cb25kc0xpc3Q8L2NvZGU+IGNvbnRhaW5pbmcgdGhlIHR3byA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiBib25kcyBnZW5lcmF0ZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGlzIG5vdGVib29rIHdpdGggdGhlIGZvbGx3aW5nIGNvZGUuPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EJk75N6wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAEtUW1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52l5bPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSdnemRtcm56aGVzJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2d0dm51bmxuZWUnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTWFpbi52YXImcXVvdDt3b3Jrc3BhY2UjNCZxdW90Oy5MT0wnPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5MT0w8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSd1cWdvemZmeG1vJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd5ZXBlemtnYW55JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPldvbmRlciYjMzM7PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndHF4cmh6cXVmeicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd0cXhyaHpxdWZ6Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidHF4cmh6cXVmeiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0neWVwZXprZ2FueScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxzcGFuPkZpZWxkIEI8L3NwYW4+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3NraG56dHdmanInIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzY3JpcHQ+Ci8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCndpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgpjb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKY29uc3QgdmFsdWVzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXQoKY29uc3QgZWwgPSBodG1sYAo8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CnRvdWNoLWFjdGlvbjogbm9uZTsKYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwpjb2xvcjogYmxhY2s7CnBhZGRpbmc6IDBlbSAuMmVtOwpib3JkZXItcmFkaXVzOiAuM2VtOwpmb250LXdlaWdodDogYm9sZDsiPjY8L3NwYW4+CmAKCgoKbGV0IG9sZF94ID0gMApsZXQgb2xkX2luZGV4ID0gMApjb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCmxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCglzZXQ6IHggPT4gewoJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgl9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCi8vIGluaXRpYWwgdmFsdWUKZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgpjb25zdCBvblNjcnViID0gKGUpID0+IHsKCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94Cgljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJKSkKCglpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJfQp9Cgpjb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCglvbGRfeCA9IGUuY2xpZW50WAoJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKfQplbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgpjb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKfQplbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgpjb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCn0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCn0pCgpyZXR1cm4gZWwKCjwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NraG56dHdmanInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJza2huenR3ZmpyIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0neWVwZXprZ2FueSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInllcGV6a2dhbnkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBMT0xgIikKCgkJLy8gYWRkIHRoZSBjb2xsYXBzZSBidXR0b24KCQljb25zdCBjb2xsYXBzZV9idG4gPSBodG1sYDxzcGFuIGNsYXNzPSdjb2xsYXBzZSc+YAoJCWhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb2xsYXBzZV9idG4pCgoJCXRyYy5jb2xsYXBzZSA9ICgpID0+IHsKICAJCQl0cmMuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKCQl9CgoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHRyYy5jb2xsYXBzZSgpCgkJCgk8L3NjcmlwdD4KCQk8c3R5bGU+CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGNvbnRlbnRzOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQkJCWZsZXg6IDE7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKCQkJCWdyaWQtY29sdW1uOiAxIC8gLTE7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQktLXNpemU6IDE3cHg7CgkJCSAgICBkaXNwbGF5OiBibG9jazsKCQkJICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CgkJCSAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwoJCQkgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKCQkJICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKCQkJICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKCQkJICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkID4gdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmNvbGxhcHNlIHsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQkJYWxpZ24taXRlbXM6IHN0cmV0Y2g7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJZmxleC1ncm93OiAxOwoJCQkJZm9udC1zaXplOiAxOHB4OwoJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKCQkJCWFsaWduLXNlbGY6IGNlbnRlcgoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyICsgKiB7CgkJCQlkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3VxZ296ZmZ4bW8nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ1cWdvemZmeG1vIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdjYWh5dWt2Z2VzJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9CnRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsMCwwLC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nYXloanJubGxpcic+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2MuaW5uZXJIVE1MID0gIkxPTCIKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdnemRtcm56aGVzJz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbScpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkKCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewoJCWNvbXB1dGVQb3NpdGlvbihoZWFkZXIsIGNvbnRlbnRzLCB7CgkJCXN0cmF0ZWd5OiAiZml4ZWQiLAoJCQltaWRkbGV3YXJlOiBbYXV0b1BsYWNlbWVudCgpXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgljb250ZW50cy5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCBmYWxzZSkKCgloZWFkZXIub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWhvdmVyJywgdHJ1ZSkKCQljb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3BwZWQnKSA/IG51bGwgOiBwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIGZhbHNlKQo8L3NjcmlwdD4KPHN0eWxlPgoJcG9wb3V0LWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYm9yZGVyOiAzcHggZGFzaGVkIHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwp9CnBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBub25lOwogICAgd2lkdGg6IDQwMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tb3ZlcmxheS1idXR0b24tYm9yZGVyKTsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBwYWRkaW5nOiA4cHg7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgPiBwb3BvdXQtY29udGVudHMsCnBvcG91dC1jb250YWluZXIuaGVhZGVyLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgei1pbmRleDogNTAwOwp9CnBvcG91dC1jb250YWluZXIuY29udGVudHMtaG92ZXIgPiBwb3BvdXQtaGVhZGVyIHsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcGx1dG8tbG9ncy13YXJuLWFjY2VudC1jb2xvcik7Cn0KLnBvcG91dC1pY29uIHsKICAgIC0tc2l6ZTogMjBweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgbWluLWhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9Ci5wb3BvdXQtaWNvbi5wb3BvdXQgewkKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V4cGFuZC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIC5wb3BvdXQgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY29udHJhY3Quc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogICAgdG91Y2gtYWN0aW9uOiBub25lOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KPC9zdHlsZT4KPHNjcmlwdCBpZD0nZ3R2bnVubG5lZSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImd0dm51bmxuZWUiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EKE7Ku2wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgZ0Y521cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ3MDVlMzBmZS03N2EzLTRiMDYtOGI5OS0xODA3MjkwZWRmZmKKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5ozE1MKRtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdk8EfkM3TOwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzTWXtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedpJ+Txib25kIGRlZj0ibnQiIHVuaXF1ZV9pZD0iVzBTdjlkUXQ2WGhkIj48c3RydWN0LWJvbmQgY2xhc3M9J05hbWVkVHVwbGV7KFN5bWJvbCgmcXVvdDsjIzIzMiZxdW90OyksIDphLCA6YiwgOmMpfSc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPk5hbWVkVHVwbGU8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtdWdidGdrcWZzJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nc2FqeG1tY3p1cCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdzYWp4bW1jenVwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAic2FqeG1tY3p1cCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYnVlbm9lZGJieCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd6dmhpb3h5b2FpJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3p2aGlveHlvYWknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ6dmhpb3h5b2FpIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdidWVub2VkYmJ4JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdic2l6dWx0dXJjJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JzaXp1bHR1cmMnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJic2l6dWx0dXJjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYnVlbm9lZGJieCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJ1ZW5vZWRiYngiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCQoJPHNjcmlwdD4KCQljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIGBOYW1lZFR1cGxlYCIpCgoJCS8vIGFkZCB0aGUgY29sbGFwc2UgYnV0dG9uCgkJY29uc3QgY29sbGFwc2VfYnRuID0gaHRtbGA8c3BhbiBjbGFzcz0nY29sbGFwc2UnPmAKCQloZWFkZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29sbGFwc2VfYnRuKQoKCQl0cmMuY29sbGFwc2UgPSAoKSA9PiB7CiAgCQkJdHJjLmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCgkJfQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiB0cmMuY29sbGFwc2UoKQoJCQoJPC9zY3JpcHQ+CgkJPHN0eWxlPgoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBjb250ZW50czsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJCQlmbGV4OiAxOwoJCQl9CgkJCXRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CgkJCQlncmlkLWNvbHVtbjogMSAvIC0xOwoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAuY29sbGFwc2UgewoJCQkJLS1zaXplOiAxN3B4OwoJCQkgICAgZGlzcGxheTogYmxvY2s7CgkJCSAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwoJCQkgICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKCQkJICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CgkJCSAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CgkJCSAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CgkJCSAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwoJCQkJYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNlZCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5jb2xsYXBzZSB7CgkJCQliYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewoJCQkJZGlzcGxheTogZmxleDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWZsZXgtZ3JvdzogMTsKCQkJCWZvbnQtc2l6ZTogMThweDsKCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCX0KCQkJdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CgkJCQlhbGlnbi1zZWxmOiBjZW50ZXIKCQkJfQoJCQl0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciArICogewoJCQkJZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdtdWdidGdrcWZzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibXVnYnRna3FmcyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nandnZW90ZHZtcyc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQp0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgPiAudG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLDAsMCwuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JieHd4bHJidWcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQlkZXNjLmlubmVySFRNTCA9ICJNeSBGYW5jeSBOVHVwbGUiCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlp250X2JvbmSybGFzdF9ydW5fdGltZXN0YW1wy0HZPBCg19ORsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjm5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4XSi+CtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwqtzdGF0dXNfdHJlZYSkbmFtZahub3RlYm9va6hzdWJ0YXNrc4Smc2F2aW5nhKRuYW1lpnNhdmluZ6hzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8FUsi7CWqc3RhcnRlZF9hdMtB2TwVSyLHKql3b3Jrc3BhY2WEpG5hbWWpd29ya3NwYWNlqHN1YnRhc2tzgqxpbml0X3Byb2Nlc3OEpG5hbWWsaW5pdF9wcm9jZXNzqHN1YnRhc2tzhKE0hKRuYW1loTSoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HZPBCcE2yLqnN0YXJ0ZWRfYXTLQdk8EJtg39+hMYSkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2TwQm1pz2qpzdGFydGVkX2F0y0HZPBCa8espoTKEpG5hbWWhMqhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EJtfQLOqc3RhcnRlZF9hdMtB2TwQm1qRfaEzhKRuYW1loTOoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HZPBCbYN+1qnN0YXJ0ZWRfYXTLQdk8EJtfXkqrZmluaXNoZWRfYXTLQdk8EJwTsnSqc3RhcnRlZF9hdMtB2TwQmvHq3a5jcmVhdGVfcHJvY2Vzc4SkbmFtZa5jcmVhdGVfcHJvY2Vzc6hzdWJ0YXNrc4KhMYSkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2TwQmgjKyapzdGFydGVkX2F0y0HZPBCZPEnpoTKEpG5hbWWhMqhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EJrx6siqc3RhcnRlZF9hdMtB2TwQmgjpS6tmaW5pc2hlZF9hdMtB2TwQmvHK5qpzdGFydGVkX2F0y0HZPBCZPEnLq2ZpbmlzaGVkX2F0y0HZPBCcE7KOqnN0YXJ0ZWRfYXTLQdk8EJk8SaqjcGtnhKRuYW1lo3BrZ6hzdWJ0YXNrc4SjYWRkhKRuYW1lo2FkZKhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EfkLMMKqc3RhcnRlZF9hdMtB2TwR+QswwqhhbmFseXNpc4SkbmFtZahhbmFseXNpc6hzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EfkKRhuqc3RhcnRlZF9hdMtB2TwR+Qo7AKxpbnN0YW50aWF0ZTKEpG5hbWWsaW5zdGFudGlhdGUyqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2TwR+Qswy6pzdGFydGVkX2F0y0HZPBH5CzDLqnByZWNvbXBpbGWEpG5hbWWqcHJlY29tcGlsZahzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EfkLMMaqc3RhcnRlZF9hdMtB2TwR+QswxqtmaW5pc2hlZF9hdMtB2TwR+QswvqpzdGFydGVkX2F0y0HZPBH5CjrWo3J1boSkbmFtZaNydW6oc3VidGFza3OCsHJlc29sdmVfdG9wb2xvZ3mEpG5hbWWwcmVzb2x2ZV90b3BvbG9neahzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdk8EfkLY16qc3RhcnRlZF9hdMtB2TwR+QtZU6hldmFsdWF0ZYSkbmFtZahldmFsdWF0ZahzdWJ0YXNrc4GhMYSkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2TwR+QzdZqpzdGFydGVkX2F0y0HZPBH5C4FWq2ZpbmlzaGVkX2F0y0HZPBH5DP5+qnN0YXJ0ZWRfYXTLQdk8EfkLY16rZmluaXNoZWRfYXTLQdk8EfkM/nqqc3RhcnRlZF9hdMtB2TwR+QtZIatmaW5pc2hlZF9hdMCqc3RhcnRlZF9hdMtB2TwQmSC8DrFjZWxsX2RlcGVuZGVuY2llc94AGtkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjtGRvd25zdHJlYW1fY2VsbHNfbWFwg6NhbHSR2SQ3MDVlMzBmZS03N2EzLTRiMDYtOGI5OS0xODA3MjkwZWRmZmKkZnJlcZHZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNKJibJHZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNrJ1cHN0cmVhbV9jZWxsc19tYXCNqkBCb25kc0xpc3SR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOtQmFzZS5nZXRpbmRleJChOpDZIE1haW4uUGx1dG9SdW5uZXIuQ29yZS5hcHBsaWNhYmxlkKdQbHV0b1VJkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzuU1haW4uUGx1dG9SdW5uZXIuQmFzZS5nZXSQpUBiaW5kkKhFZGl0YWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9koTWFpbi5QbHV0b1J1bm5lci5QbHV0b1J1bm5lci5jcmVhdGVfYm9uZJCkTWFpbpCkQmFzZZChKpCqU2NydWJiYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBo2FzZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCFp250X2JvbmSR2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjmjYmxjkdkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1qUJvbmRUYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6hhc2RfYm9uZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZqJibJHZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmtGRvd25zdHJlYW1fY2VsbHNfbWFwhalmaWVsZGJvbmSQsGZpZWxkZGVzY3JpcHRpb26Qo2FzZJHZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3Nqhhc2RfYm9uZJLZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2o0FTRJCydXBzdHJlYW1fY2VsbHNfbWFw3gAcp0BtZF9zdHKQqGhhc2ZpZWxkkKZTdHJpbmeQpEBodGyR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkTWFpbpCpVGV4dEZpZWxkkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzqkBmaWVsZGRhdGGR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDO3SHlwZXJ0ZXh0TGl0ZXJhbC5SZXN1bHSQpEBkb2OQrUJhc2UuZ2V0aW5kZXiQ2SBNYWluLlBsdXRvUnVubmVyLkNvcmUuYXBwbGljYWJsZZChOpClZXJyb3KQt0h5cGVydGV4dExpdGVyYWwuQnlwYXNzkKpTdHJ1Y3RCb25kkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzuU1haW4uUGx1dG9SdW5uZXIuQmFzZS5nZXSQpUBiaW5kkLojX19fdGhpc19wbHV0b19tb2R1bGVfbmFtZZCrQmFzZS5Aa3dkZWaQplNsaWRlcpHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9koTWFpbi5QbHV0b1J1bm5lci5QbHV0b1J1bm5lci5jcmVhdGVfYm9uZJCkQmFzZZCjVmFskKNJbnSQsEh5cGVydGV4dExpdGVyYWyR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkVHlwZZClVW5pb26QqlNjcnViYmFibGWR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNbRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMHp2NlbGxfaWTZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZrRkb3duc3RyZWFtX2NlbGxzX21hcIGuUGx1dG9EZXZNYWNyb3OQsnVwc3RyZWFtX2NlbGxzX21hcIDZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YbRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M4S0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M7Rkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgbdFeHRlbmRlZFRhYmxlT2ZDb250ZW50c5HZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUytGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1tGRvd25zdHJlYW1fY2VsbHNfbWFwgaNibGOR2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTaydXBzdHJlYW1fY2VsbHNfbWFwhKpAQm9uZHNMaXN0kdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzp250X2JvbmSR2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjmmUG9wb3V0kdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzqGFzZF9ib25kkdkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjK0ZG93bnN0cmVhbV9jZWxsc19tYXCDqWZpZWxkYm9uZJCwZmllbGRkZXNjcmlwdGlvbpCjTE9MkdkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0snVwc3RyZWFtX2NlbGxzX21hcN4AEadAbWRfc3RykK1CYXNlLmdldGluZGV4kKE6kKhoYXNmaWVsZJClZXJyb3KQt0h5cGVydGV4dExpdGVyYWwuQnlwYXNzkKtCYXNlLkBrd2RlZpCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpEBodGyR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkQmFzZZCqQGZpZWxkZGF0YZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6NWYWyQo0ludJCkVHlwZZCwSHlwZXJ0ZXh0TGl0ZXJhbJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM7dIeXBlcnRleHRMaXRlcmFsLlJlc3VsdJCqU2NydWJiYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzhLRwcmVjZWRlbmNlX2hldXJpc3RpYwenY2VsbF9pZNkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAztGRvd25zdHJlYW1fY2VsbHNfbWFw3gBFsEJ1aWx0aW5zTm90ZWJvb2uQqEBodGxfc3RykKVQcmludJCnUGx1dG9VSZHZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY61Db3VudGVyQnV0dG9ukKtNdWx0aVNlbGVjdJCoRWRpdGFibGWR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOvVGFibGVPZkNvbnRlbnRzkK9Db25maXJtTm90ZWJvb2uQqVRleHRGaWVsZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZqtMYWJlbEJ1dHRvbpCmYXNfc3ZnkKpAZmllbGRkYXRhktkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKqcG9wb3V0d3JhcJHZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NKJicpClUmFkaW+QrlJlbW90ZVJlc291cmNlkKZCdXR0b26QrkRvd25sb2FkQnV0dG9ukKdjb25maXJtkKtXZWJjYW1JbnB1dJCqQEJvbmRzTGlzdJLZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1plBvcG91dJHZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNa1DbG9ja05vdGVib29rkKpUaW1lUGlja2VykKREdW1wkKZTbGlkZXKT2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyqURhdGVGaWVsZJC3VGFibGVPZkNvbnRlbnRzTm90ZWJvb2uQpUNsb2NrkLFDb2xvclN0cmluZ1BpY2tlcpCtd2l0aF90ZXJtaW5hbJCkU2hvd5CrTnVtYmVyRmllbGSQp2FzX21pbWWQsFRlcm1pbmFsTm90ZWJvb2uQp2FzX3RleHSQrEB0eXBlYXNmaWVsZJCxQGZpZWxkZGVzY3JpcHRpb26QpmFzX3BuZ5CrUmFuZ2VTbGlkZXKQsFN0cnVjdEJvbmRNb2R1bGWQ2ThfZnJvbXBhcmVudF9jZWxsX2lkXzk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM5CrQ29sb3JQaWNrZXKQqkRhdGVQaWNrZXKQs1JhbmdlU2xpZGVyTm90ZWJvb2uQtU11bHRpQ2hlY2tCb3hOb3RlYm9va5CkQGh0bJLZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyt0V4dGVuZGVkVGFibGVPZkNvbnRlbnRzkdkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzrVdpdGhJT0NvbnRleHSQqUJvbmRUYWJsZZHZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNq5AcG9wb3V0YXNmaWVsZJCqQGZpZWxkYm9uZJCnQE5UQm9uZJHZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOapTdHJ1Y3RCb25kkdkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmrUxvY2FsUmVzb3VyY2WQqVRpbWVGaWVsZJCzV2ViY2FtSW5wdXROb3RlYm9va5CtUGFzc3dvcmRGaWVsZJCuQHdpdGhfdGVybWluYWyQqENoZWNrQm94kK1NdWx0aUNoZWNrQm94kKhSZXNvdXJjZZCqRmlsZVBpY2tlcpCwSHlwZXJ0ZXh0TGl0ZXJhbJLZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyslNjcnViYmFibGVOb3RlYm9va5CnYXNfaHRtbJCmU2VsZWN0kKpTY3J1YmJhYmxlk9kkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMrJ1cHN0cmVhbV9jZWxsc19tYXCMvUJhc2UuQ29yZUxvZ2dpbmcuaW52b2tlbGF0ZXN0kLRCYXNlLkNvcmVMb2dnaW5nLj09PZC6I19fX3RoaXNfcGx1dG9fbW9kdWxlX25hbWWQp3JldGhyb3eQskJhc2UuQ29yZUxvZ2dpbmcuIZDZJ0Jhc2UuQ29yZUxvZ2dpbmcuQmFzZS5maXh1cF9zdGRsaWJfcGF0aJCkQmFzZZC0QmFzZS5Db3JlTG9nZ2luZy5pc2GQsUJhc2UuaW52b2tlbGF0ZXN0kKxAZnJvbXBhY2thZ2WQs0Jhc2UuQ29yZUxvZ2dpbmcuPj2Q2SdCYXNlLkNvcmVMb2dnaW5nLmN1cnJlbnRfbG9nZ2VyX2Zvcl9lbnaQ2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzCEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzC0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYze0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTSEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTS0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGkZnJlcZHZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBom50kdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY52SQ5NTlhY2I0MC0xZmQ2LTQzZjUtYTFhNi03M2E2Y2VhYWUxZDeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5NTlhY2I0MC0xZmQ2LTQzZjUtYTFhNi03M2E2Y2VhYWUxZDe0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTe0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODS0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKqcG9wb3V0d3JhcJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6NMT0yR2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjLZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaNhbHSR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmObRkb3duc3RyZWFtX2NlbGxzX21hcIKnbnRfYm9uZJLZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2om50kdkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4snVwc3RyZWFtX2NlbGxzX21hcI+nQG1kX3N0cpCtQmFzZS5nZXRpbmRleJCnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kgTWFpbi5QbHV0b1J1bm5lci5Db3JlLmFwcGxpY2FibGWQoTqQpWVycm9ykLlNYWluLlBsdXRvUnVubmVyLkJhc2UuZ2V0kKVAYmluZJCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2ShNYWluLlBsdXRvUnVubmVyLlBsdXRvUnVubmVyLmNyZWF0ZV9ib25kkKRNYWlukKRCYXNlkKNWYWyQpFR5cGWQqGhhc2ZpZWxkkLRjZWxsX2V4ZWN1dGlvbl9vcmRlctwAGtkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhm2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YdkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkz2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzDZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMNkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzbZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNdkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQw2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjnZJGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzONkkOWQyMzM4MmMtY2YzNS00YjIwLWE0NmMtMGY0ZTJkZTE3ZmM32SQ5NTlhY2I0MC0xZmQ2LTQzZjUtYTFhNi03M2E2Y2VhYWUxZDfZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU02SQ3MDVlMzBmZS03N2EzLTRiMDYtOGI5OS0xODA3MjkwZWRmZmLZJDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3Y9kkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUy2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjLZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NNkkMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk32SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjXZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNdkkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE02SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTa0bGFzdF9ob3RfcmVsb2FkX3RpbWXLAAAAAAAAAACpc2hvcnRwYXRos3N0cnVjdGJvbmRtb2R1bGUuamyucHJvY2Vzc19zdGF0dXOlcmVhZHmkcGF0aNlPL2hvbWUvYW1lbmdhbGkvUmVwb3MvZ2l0aHViL21pbmUvUGx1dG9FeHRyYXMvdGVzdC9ub3RlYm9va3Mvc3RydWN0Ym9uZG1vZHVsZS5qbK5sYXN0X3NhdmVfdGltZctB2TwVSyLHGapjZWxsX29yZGVy3AAa2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGHZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZtkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SQ3MDcxNzVhOS1kMzU2LTQzY2YtODAzOC02MjBlYmM0MDFjOTPZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MNkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2Ew2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NtkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI12SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDDZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM42SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzfZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN9kkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYtkkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0Njdj2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTLZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMtkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg02SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTfZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNdkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ12SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTTZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNrFwdWJsaXNoZWRfb2JqZWN0c4ClbmJwa2eIsmluc3RhbGxlZF92ZXJzaW9uc4GuUGx1dG9EZXZNYWNyb3OlMC41LjiwdGVybWluYWxfb3V0cHV0c4SqbmJwa2dfc3luY9nvCkluc3RhbnRpYXRpbmcuLi4KClJlc29sdmluZy4uLgobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9Qcm9qZWN0LnRvbWxgChtbMzJtG1sxbSAgTm8gQ2hhbmdlcxtbMjJtG1szOW0gdG8gYC90bXAvamxfVWpUQmRLL01hbmlmZXN0LnRvbWxgCgpQcmVjb21waWxpbmcuLi4KG1szMm0bWzFtICBBY3RpdmF0aW5nG1syMm0bWzM5bSBwcm9qZWN0IGF0IGAvdG1wL2psX1VqVEJkS2CuUGx1dG9EZXZNYWNyb3PZ7wpJbnN0YW50aWF0aW5nLi4uCgpSZXNvbHZpbmcuLi4KG1szMm0bWzFtICBObyBDaGFuZ2VzG1syMm0bWzM5bSB0byBgL3RtcC9qbF9ValRCZEsvUHJvamVjdC50b21sYAobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9NYW5pZmVzdC50b21sYAoKUHJlY29tcGlsaW5nLi4uChtbMzJtG1sxbSAgQWN0aXZhdGluZxtbMjJtG1szOW0gcHJvamVjdCBhdCBgL3RtcC9qbF9ValRCZEtgoV7Z7wpJbnN0YW50aWF0aW5nLi4uCgpSZXNvbHZpbmcuLi4KG1szMm0bWzFtICBObyBDaGFuZ2VzG1syMm0bWzM5bSB0byBgL3RtcC9qbF9ValRCZEsvUHJvamVjdC50b21sYAobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9NYW5pZmVzdC50b21sYAoKUHJlY29tcGlsaW5nLi4uChtbMzJtG1sxbSAgQWN0aXZhdGluZxtbMjJtG1szOW0gcHJvamVjdCBhdCBgL3RtcC9qbF9ValRCZEtgoT7Z7wpJbnN0YW50aWF0aW5nLi4uCgpSZXNvbHZpbmcuLi4KG1szMm0bWzFtICBObyBDaGFuZ2VzG1syMm0bWzM5bSB0byBgL3RtcC9qbF9ValRCZEsvUHJvamVjdC50b21sYAobWzMybRtbMW0gIE5vIENoYW5nZXMbWzIybRtbMzltIHRvIGAvdG1wL2psX1VqVEJkSy9NYW5pZmVzdC50b21sYAoKUHJlY29tcGlsaW5nLi4uChtbMzJtG1sxbSAgQWN0aXZhdGluZxtbMjJtG1szOW0gcHJvamVjdCBhdCBgL3RtcC9qbF9ValRCZEtgp2VuYWJsZWTDt3Jlc3RhcnRfcmVjb21tZW5kZWRfbXNnwLRyZXN0YXJ0X3JlcXVpcmVkX21zZ8CtYnVzeV9wYWNrYWdlc5CvaW5zdGFsbF90aW1lX25zzwAAAAEXXbzMrGluc3RhbnRpYXRlZMOrY2VsbF9pbnB1dHPeABrZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY4SnY2VsbF9pZNkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjpGNvZGXaATNibCA9IEBCb25kc0xpc3QgIk15IEdyb3VwIG9mIEJvbmRzIiBsZXQgdHYgPSBQbHV0b1VJLkV4cGVyaW1lbnRhbC50cmFuc2Zvcm1lZF92YWx1ZQoJICMgV2UgdXNlIHRyYW5zZm9ybWVkX3ZhbHVlIHRvIHRyYW5zbGF0ZSBHSHogdG8gSHogaW4gdGhlIGJvdW5kIHZhcmlhYmxlIGBmcmVxYAoJIkZyZXF1ZW5jeSBbR0h6XSIgPSBAYmluZCBmcmVxIHR2KHggLT4geCAqIDFlOSwgRWRpdGFibGUoMjA7IHN1ZmZpeCA9ICIgR0h6IikpCgltZCJBbHRpdHVkZSBgYGhgYCBbbV0iID0gQGJpbmQgYWx0IFNjcnViYmFibGUoMTAwOjEwOjIwMCkKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDCEp2NlbGxfaWTZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MKRjb2Rl2gGlbWQiIiIKU29tZXRpbWVzIGN1c3RvbSBzdHJ1Y3RzIGFyZSBub3QgbmVlZGVkIGFuZCBpdCB3b3VsZCBiZSB1c2VmdWwgdG8ganVzdCB1c2UgdGhlIHNhbWUgbmljZSBib25kIHN0cnVjdHVyZSBvZiBgU3RydWN0Qm9uZGAgdG8gc2ltcGx5IGNyZWF0ZSBhcmJpdHJhcnkgTmFtZWRUdXBsZXMuIAoKVGhpcyBpcyBwb3NzaWJsZSB3aXRoIHRoZSBjb252ZW5pZW5jZSBtYWNybyBgQE5UQm9uZGAgd2hpY2ggY2FuIGJlIGNhbGxlZCBhcyBzaG93biBiZWxvdyB0byBjcmVhdGUgYSBuaWNlIGRpc3BsYXkgZm9yIGFuIGludGVyYWN0aXZlIGJvbmQgY3JlYXRpbmcgYW4gYXJiaXRyYXJ5IE5hbWVkVHVwbGUuCgpUaGUgbWFjcm8gc2ltcGx5IGNyZWF0ZSBhIGBTdHJ1Y3RCb25kYCB3cmFwcGluZyB0aGUgZGVzaXJlZCBOYW1lZFR1cGxlIHR5cGUuCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjhKdjZWxsX2lk2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OkY29kZbJtZCIiIgojIFBvcG91dAoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNISnY2VsbF9pZNkkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0pGNvZGXaAhltZCIiIgpUaGUgZmluYWwgY29udmVuaWVuY2Ugc3RydWN0dXJlIHByb3ZpZGVkIGJ5IHRoaXMgbW9kdWxlIGlzIHRoZSBgQm9uZFRhYmxlYC4gSXQgY2FuIGJlIGNyZWF0ZWQgdG8gZ3JvdXAgYSBsaXN0IG9mIGJvbmRzIGluIGEgZmxvYXRpbmcgdGFibGUgdGhhdCBzdGF5cyBvbiB0aGUgbGVmdCBzaWRlIG9mIHRoZSBub3RlYm9vayAoc2ltaWxhciB0byB0aGUgVGFibGVPZkNvbnRlbnRzIG9mIFBsdXRvVUkpIGFuZCBjYW4gYmUgbW92ZWQgYXJvdW5kIGFuZCByZXNpemVkIG9yIGhpZGRlbiBmb3IgY29udmVuaWVuY2UuCgpUaGUgQm9uZFRhYmxlIGlzIGludGVuZGVkIHRvIGJlIHVzZWQgZWl0aGVyIHdpdGggYm9uZHMgY29udGFpbmluZyBgU3RydWN0Qm9uZGAgb3Igd2l0aCBgQm9uZHNMaXN0YC4gRnV0dXJlIHR5cGVzIHdpdGggc2ltaWxhciBzdHJ1Y3R1cmUgd2lsbCBhbHNvIGJlIGFkZGVkLgoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgYm9uZHRhYmxlIGNvbnRhaW5pbmcgYWxsIHRoZSBleGFtcGxlcyBvZiB0aGlzIG5vdGVib29rLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NoSnY2VsbF9pZNkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2pGNvZGWjYXNkqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTaEp2NlbGxfaWTZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNqRjb2Rl2UdCb25kVGFibGUoWwoJYXNkX2JvbmQsCgludF9ib25kLAoJYmwsCglibGMKXTsgZGVzY3JpcHRpb24gPSAiTXkgQm9uZHMiKahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmhKdjZWxsX2lk2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2akY29kZdoCUmJlZ2luCiIiIgoJc3RydWN0IEFTRAoiIiIKQmFzZS5Aa3dkZWYgc3RydWN0IEFTRAoJYTo6SW50IAoJYjo6SW50CgljOjpTdHJpbmcKCSJUaGlzIGZpZWxkIGlzIF9zcGVjaWFsXyIKCWQ6OlN0cmluZwoJZTo6SW50CmVuZApAZmllbGRkYXRhIEFTRCBiZWdpbgoJYSA9IChtZCJNYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIGBgTGFUZVhgYCIsIFNsaWRlcigxOjEwKSkKCWIgPSAoQGh0bCgiPHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj4iKSwgU2NydWJiYWJsZSgxOjEwKSkKCWMgPSAoIk5vcm1hbCBTdHJpbmcgRGVzY3JpcHRpb24iLCBUZXh0RmllbGQoKSkKCWQgPSBUZXh0RmllbGQoKSAjIE5vIGRlc2NyaXB0aW9uLCBkZWZhdWx0cyB0byB0aGUgZG9jc3RyaW5nIHNpbmNlIGl0J3MgcHJlc2VudAoJZSA9IFNsaWRlcigyMDoyNSkgIyBObyBkZXNjcmlwdGlvbiwgZGVmYXVsdHMgdG8gdGhlIGZpZWxkbmFtZSBhcyBubyBkb2NzdHJpbmcgaXMgcHJlc2VudAplbmQKYXNkX2JvbmQgPSBAYmluZCBhc2QgU3RydWN0Qm9uZChBU0Q7IGRlc2NyaXB0aW9uID0gIkN1c3RvbSBEZXNjcmlwdGlvbiIpCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwhKdjZWxsX2lk2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTCkY29kZdoBim1kIiIiCkdlbmVyYXRpbmcgYXV0b21hdGljIHdpZGdldHMgZm9yIGN1c3RvbSBzdHJ1Y3RzIGlzIHF1aXRlIHN0cmFpZ2h0Zm9yd2FyZCB3aXRoIHRoZSBhaWQgb2YgdGhlIGBAZmllbGRkYXRhYCBtYWNybyBhbmQgdGhlIGBTdHJ1Y3RCb25kYCB0eXBlLgoKVGhlIHRvcC1sZWZ0IGFycm93IGNhbiBiZSB1c2VkIHRvIHNob3ctaGlkZSB0aGUgZmllbGQgZWxlbWVudHMgKHVzZWZ1bCBpbnNpZGUgYSBgQm9uZFRhYmxlYCwgc2hvd24gYmVsb3cpLCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNYSnY2VsbF9pZNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1pGNvZGWzbWQiIiIKIyBATlRCb25kCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhmhKdjZWxsX2lk2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGakY29kZb9iZWdpbgoJdXNpbmcgUGx1dG9EZXZNYWNyb3MKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGGEp2NlbGxfaWTZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YaRjb2RltG1kIiIiCiMgUGFja2FnZXMKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ3MDcxNzVhOS1kMzU2LTQzY2YtODAzOC02MjBlYmM0MDFjOTOEp2NlbGxfaWTZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M6Rjb2RluUV4dGVuZGVkVGFibGVPZkNvbnRlbnRzKCmobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMoSnY2VsbF9pZNkkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUypGNvZGXaAzNtZCIiIgpUaGUgc3RydWN0dXJlcyBhYm92ZSBjYW4gYWxzbyBiZSB1c2VkIG5lc3RlZCB3aXRoaW4gb25lIGFub3RoZXIuIFRvIGZhY2lsaXRhdGUgYWNjZXNzaW5nIG5lc3RlZCBzdHJ1Y3R1cmVzLCBvbmUgY2FuIHVzZSB0aGUgYFBvcG91dGAgdHlwZS4KCkluIGl0cyBzaW1wbGUgZm9ybSwgeW91IGNhbiBnaXZlIGFuIGluc3RhbmNlIG9mIGEgU3RydWN0Qm9uZCwgYSBib25kIHdyYXBwaW5nIGEgU3RydWN0Qm9uZCBvciBhIEJvbmRzTGlzdCBhcyBpbnB1dCB0byBQb3BvdXQgdG8gY3JlYXRlIGEgdGFibGUgdGhhdCBpcyBoaWRkZW4gYmVoaW5kIGEgcG9wdXAgd2luZG93LgpJZiBhbiBpbnN0YW5jZSBwcmVzZW50LCBidXQgeW91IHdhbnQgYSBjdXN0b20gdHlwZSBmb3Igd2hpY2ggeW91IGhhdmUgZGVmaW5lZCBjdXN0b20gYm9uZHMgYW5kIGRlc2NyaXB0aW9ucyB3aXRoIGBAZmllbGRkYXRhYCB0byBhcHBlYXIgYXMgcG9wb3V0LCB5b3UgY2FuIHVzZSB0aGUgZnVuY3Rpb24gYHBvcG91dHdyYXAoVFlQRSlgIHRvIGdlbmVyYXRlIGEgc21hbGwgaWNvbiB3aGljaCBoaWRlcyBhIHBvcHVwIGNvbnRhaW5pbmcgdGhlIGBTdHJ1Y3RCb25kYCBvZiB0aGUgcHJvdmlkZWQgdHlwZSBgVFlQRWAuCgpUaGUgU3RydWN0Qm9uZCB0YWJsZSBhcHBlYXJzIG9uIGhvdmVyIHVwb24gdGhlIGljb24sIGNhbiBiZSBtYWRlIGZpeGVkIGJ5IGNsaWNraW5nIG9uIHRoZSBpY29uIGFuZCBjYW4gdGhlbiBiZSBtb3ZlZCBhcm91bmQgb3IgcmVzaXplZC4KQSBkb3VibGUgY2xpY2sgb24gdGhlIGhlYWRlciBvZiB0aGUgcG9wb3V0IGhpZGVzIGl0IGFnYWluOgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNYSnY2VsbF9pZNkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1pGNvZGW1bWQiIiIKIyBCb25kVGFibGUKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjWEp2NlbGxfaWTZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNaRjb2Rl2XFibGMgPSBAQm9uZHNMaXN0ICJQb3BvdXQgQ29udGFpbmVyIiBiZWdpbgoJIlN0cnVjdHVyZSBBU0QiID0gUG9wb3V0KGFzZF9ib25kKQoJIk5hbWVkVHVwbGUiID0gUG9wb3V0KG50X2JvbmQpCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyhKdjZWxsX2lk2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKkY29kZdmlYmVnaW4KQmFzZS5Aa3dkZWYgc3RydWN0IExPTAoJYTo6SW50IAoJYjo6SW50CmVuZApAZmllbGRkYXRhIExPTCBiZWdpbgoJYSA9IChtZCJXb25kZXIhIiwgU2xpZGVyKDE6MTApKQoJYiA9IChAaHRsKCI8c3Bhbj5GaWVsZCBCPC9zcGFuPiIpLCBTY3J1YmJhYmxlKDE6MTApKQplbmQKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOEp2NlbGxfaWTZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6Rjb2Rl2Y9AZnJvbXBhY2thZ2UgIi4uLy4uIiBiZWdpbgoJdXNpbmcgXi5TdHJ1Y3RCb25kTW9kdWxlCgl1c2luZyBeOiBFeHRlbmRlZFRhYmxlT2ZDb250ZW50cywgRWRpdGFibGUKCXVzaW5nID4uSHlwZXJ0ZXh0TGl0ZXJhbAoJdXNpbmcgPi5QbHV0b1VJCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwhKdjZWxsX2lk2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzCkY29kZbZtZCIiIgojIFN0cnVjdEJvbmQKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzeEp2NlbGxfaWTZJDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjN6Rjb2Rltm1kIiIiCiMgQEJvbmRzTGlzdAoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNISnY2VsbF9pZNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0pGNvZGWkZnJlcahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4hKdjZWxsX2lk2SRlMmI3OWE1OC1lNjZlLTRkNDAtODY3My00MTg4MjM3NTNiMzikY29kZaJudKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3hKdjZWxsX2lk2SQ5NTlhY2I0MC0xZmQ2LTQzZjUtYTFhNi03M2E2Y2VhYWUxZDekY29kZdoDVW1kIiIiCkluIHNvbWUgY2FzZXMsIG9uZSBkb2VzIG5vdCB3YW50IHRvIGhhdmUgYSBzaW5nbGUgYm9uZCB3cmFwcGluZyBlaXRoZXIgYSBTdHJ1Y3R1cmUgb3IgYSBOYW1lZFR1cGxlLCBhbmQgc2luZ2xlIGluZGVwZW5kZW50IGJvbmRzIGFyZSBtb3JlIGNvbnZlbmllbnQuCgpgQEJvbmRzTGlzdGAgaXMgYSBjb252ZW5pZW5jZSBtYWNybyB0byBjcmVhdGUgYW4gb2JqZWN0IG9mIHR5cGUgYEJvbmRzTGlzdGAgd2hpY2ggc2ltcGx5IGFsbG93IHRvIGFkZCBhIGRlc2NyaXB0aW9uIHRvIHNlcGFyYXRlIGJvbmRzIGFuZCBncm91cCB0aGVtIGFsbCB0b2dldGhlciBpbiBhIHRhYmxlLWxpa2UgZm9ybWF0IGVxdWl2YWxlbnQgdG8gdGhvc2Ugb2YgYFN0cnVjdEJvbmRgLgoKISEhIG5vdGUKCVVubGlrZSBgU3RydWN0Qm9uZGAsIGEgQm9uZHNMaXN0IGlzIGFscmVhZHkgY29tcG9zZWQgb2YgYm9uZCBjcmVhdGVkIHdpdGggYEBiaW5kYCBhbmQgaXQganVzdCBncm91cHMgdGhlbSB1cCB3aXRoIGEgZGVzY3JpcHRpb24uIFRoZSBvdXRwdXQgb2YgYEBCb25kc0xpc3RgIGlzIG5vdCBzdXBwb3NlZCB0byBiZSBib3VuZCB0byBhIHZhcmlhYmxlIHVzaW5nIGBAYmluZGAuXAoJVGhlIGJvbmRzIGdyb3VwZWQgaW4gYSBCb25kc0xpc3Qgc3RpbGwgYWN0IGFuZCB1cGRhdGUgaW5kZXBlbmRlbnRseSBmcm9tIG9uZSBhbm90aGVyLgoKU2VlIHRoZSBleGFtcGxlIGJlbG93IGZvciB1bmRlcnN0YW5kaW5nIHRoZSBzeW50aGF4LiBUaGUgaGVhZGVyIG9mIGEgQm9uZHNMaXN0IGlzIHNob3duIGluIGFuIG9yYW5nZSBiYWNrZ3JvdW5kIHRvIGVhc2lseSBkaWZmZXJlbnRpYXRlIGl0IGZyb20gYFN0cnVjdEJvbmRgLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N4SnY2VsbF9pZNkkMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk3pGNvZGXaATdtZCIiIgpUaGUgYWJpbGl0eSB0byBhbHNvIHdyYXAgcHJlLWV4aXN0aW5nIGJvbmRzIGFyb3VuZCBTdHJ1Y3RCb25kcyBpcyBjb252ZW5pZW50IGZvciBvcmdhbml6aW5nIHRoZSB2YXJpb3VzIGJvbmRzIG9uZSBoYXZlIGluIGEgYEJvbmRzTGlzdGAgb3IgYEJvbmRUYWJsZWAKCkFzIGFuIGV4YW1wbGUsIG9uZSBjYW4gY3JlYXRlIGEgYEJvbmRzTGlzdGAgY29udGFpbmluZyB0aGUgdHdvIGBTdHJ1Y3RCb25kYCBib25kcyBnZW5lcmF0ZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGlzIG5vdGVib29rIHdpdGggdGhlIGZvbGx3aW5nIGNvZGUuCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0hKdjZWxsX2lk2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSkY29kZa9wb3BvdXR3cmFwKExPTCmobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYoSnY2VsbF9pZNkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZipGNvZGWjYWx0qG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjmEp2NlbGxfaWTZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOaRjb2Rl2cdudF9ib25kID0gQGJpbmQgbnQgQE5UQm9uZCAiTXkgRmFuY3kgTlR1cGxlIiBiZWdpbgoJYSA9ICgiRGVzY3JpcHRpb24iLCBTbGlkZXIoMToxMCkpCgliID0gKG1kIioqQm9sZCoqIGZpZWxkIiwgU2xpZGVyKDE6MTApKQoJYyA9IFNsaWRlcigxOjEwKSAjIE5vIGRlc2NyaXB0aW9uLCBkZWZhdWx0cyB0byB0aGUgbmFtZSBvZiB0aGUgZmllbGQKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTCq25vdGVib29rX2lk2SRiZGYyZjUxMC00N2QwLTExZWUtMzQwOS00ZDU0ODM2ZjkxMDSraW5fdGVtcF9kaXLCqG1ldGFkYXRhgaxjdXN0b21fYXR0cnORrGhpZGUtZW5hYmxlZA==";
window.pluto_preamble_html = undefined;
</script>

<meta name="pluto-insertion-spot-parameters">
<script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.0caa001c.js" type="module" defer="" integrity="sha384-pHXNjYSrnFaNwPp9QkuM2L6oJwAC/Oa8XjuXJ4lBzdeKwH4AcU1yYMGLN0NEAXWx" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.19.27/frontend-dist/editor.8a3292da.js" integrity="sha384-itp4oE2PRbSrrTHVpWh8sqAuVUsz7ja6L2Dgp/JRfMCD2AwVdTk56K96POF3oLmu" crossorigin="anonymous"></script><script type="text/javascript" id="MathJax-script" integrity="sha384-4kE/rQ11E8xT9QgrCBTyvenkuPfQo8rXYQvJZuMgxyPOoUfpatjQPlgdv6V5yhUK" crossorigin="" not-the-src-yet="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-svg-full.js" async=""></script></head><body class="loading no-MÎ±Î¸Jax"> <div style="display:flex;min-height:100vh;"> <pluto-editor class="fullscreen"></pluto-editor> </div> </body></html>